<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>抖音protobuf协议解析直播弹幕获取</title>
      <link href="/2023/05/29/%E6%8A%96%E9%9F%B3protobuf%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E7%9B%B4%E6%92%AD%E5%BC%B9%E5%B9%95%E8%8E%B7%E5%8F%96/"/>
      <url>/2023/05/29/%E6%8A%96%E9%9F%B3protobuf%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E7%9B%B4%E6%92%AD%E5%BC%B9%E5%B9%95%E8%8E%B7%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<h3 id="解析流程："><a href="#解析流程：" class="headerlink" title="解析流程："></a>解析流程：</h3><p><strong>绿色表示客户端消息发给服务器，红色表示服务器下发数据给客户端</strong></p><p><img src="/images/image-20230619165907932.png" alt="image-20230619165907932"></p><p><img src="/images/image-20230619165940578.png" alt="image-20230619165940578"></p><p>从第一个堆栈开始看起，下面的四个方法，<code>onError(e)，onMessage(e)，onOpen(e)，onClose(e)</code>分别对应着websocket的四个触发事件，分别是 连接错误，接受数据，连接成功，连接关闭</p><p><img src="/images/image-20230619170121530.png" alt="image-20230619170121530"></p><p>我们直接在 onOpen 打上断点，查看上一个调用堆栈，看一下绑定的方法</p><p><img src="/images/image-20230619170908161.png" alt="image-20230619170908161"></p><p><img src="/images/image-20230619171155888.png" alt="image-20230619171155888"></p><p>onOpen方法里面都是一些赋值操作，我们直接看 ping方法，我们可以看到关键字 <code>serializeBinary</code> 很明显在这里做了序列化操作 我们看一下 e.serializeBinary() 方法，我们在这一块能看到下面是序列化操作，上面是反序列化操作，后面要跟着写proto文件</p><p><img src="/images/image-20230619171647356.png" alt="image-20230619171647356"></p><p>接着我们看一下第二个堆栈<code>fetchSocketServer</code>  这个方法处理数据接收，这里同样绑定四个事件，我们直接看 <code>bindClientMessage</code> 方法</p><p><img src="/images/image-20230619175330246.png" alt="image-20230619175330246"></p><p>这里就是websocket的消息处理部分了，我们看下代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = p.<span class="hljs-property">PushFrame</span>.<span class="hljs-title function_">deserializeBinary</span>(e.<span class="hljs-property">data</span>) <span class="hljs-comment">//反序列化得到数组对象</span><br> , r = o.<span class="hljs-property">Response</span>.<span class="hljs-title function_">deserializeBinary</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> t <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(e.<span class="hljs-title function_">getHeadersList</span>()))<br>     f (<span class="hljs-string">&quot;compress_type&quot;</span> === t.<span class="hljs-title function_">getKey</span>() &amp;&amp; <span class="hljs-string">&quot;gzip&quot;</span> === t.<span class="hljs-title function_">getValue</span>())<br>                                <span class="hljs-keyword">return</span> !<span class="hljs-number">0</span>;<br>                        <span class="hljs-keyword">return</span> !<span class="hljs-number">1</span><br>&#125;(a) ?<br>(<span class="hljs-number">0</span>,n.<span class="hljs-property">ec</span>)(a.<span class="hljs-title function_">getPayload</span>()) : a.<span class="hljs-title function_">getPayload_asU8</span>()); <span class="hljs-comment">//选择表达式，如果真就走第一个，假就走后面那个，得到的值再反序列化得到a，这里应该都是压缩过的，所以都会走第一个，所以需要再去看一下 n.ec方法</span><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 第二段</span><br><span class="hljs-keyword">if</span> (r.<span class="hljs-title function_">getNeedAck</span>()) &#123;<br>                        <span class="hljs-keyword">let</span> e = r.<span class="hljs-title function_">getInternalExt</span>(), t = r.<span class="hljs-title function_">getCursor</span>();<br>(a.<span class="hljs-title function_">getHeadersList</span>() || []).<span class="hljs-title function_">forEach</span>((<span class="hljs-function"><span class="hljs-params">i</span>=&gt;</span>&#123;<br>                            <span class="hljs-string">&quot;im-internal_ext&quot;</span> === (<span class="hljs-literal">null</span> == i ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : i.<span class="hljs-title function_">getKey</span>()) &amp;&amp; (e = <span class="hljs-literal">null</span> == i ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : i.<span class="hljs-title function_">getValue</span>()),<br>                            <span class="hljs-string">&quot;im-cursor&quot;</span> === (<span class="hljs-literal">null</span> == i ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : i.<span class="hljs-title function_">getKey</span>()) &amp;&amp; (t = <span class="hljs-literal">null</span> == i ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : i.<span class="hljs-title function_">getValue</span>())<br>                        &#125;<br>                        )),<br>    <span class="hljs-comment">// 这里是核心部门，数据处理</span><br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">internalExt</span> = e,<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cursor</span> = t;<br>                        <span class="hljs-keyword">const</span> i = <span class="hljs-keyword">new</span> p.<span class="hljs-property">PushFrame</span>;<br>    <span class="hljs-comment">// ack是 即时消息 ACK机制</span><br>                        i.<span class="hljs-title function_">setPayloadType</span>(<span class="hljs-string">&quot;ack&quot;</span>),<br>                        i.<span class="hljs-title function_">setPayload</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>                            <span class="hljs-keyword">const</span> t = [];<br>                            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> i <span class="hljs-keyword">of</span> e) &#123;<br>                                <span class="hljs-keyword">const</span> e = i.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>);<br>                                e &lt; <span class="hljs-number">128</span> ? t.<span class="hljs-title function_">push</span>(e) : e &lt; <span class="hljs-number">2048</span> ? (t.<span class="hljs-title function_">push</span>(<span class="hljs-number">192</span> + (e &gt;&gt; <span class="hljs-number">6</span>)),<br>                                t.<span class="hljs-title function_">push</span>(<span class="hljs-number">128</span> + (<span class="hljs-number">63</span> &amp; e))) : e &lt; <span class="hljs-number">65536</span> &amp;&amp; (t.<span class="hljs-title function_">push</span>(<span class="hljs-number">224</span> + (e &gt;&gt; <span class="hljs-number">12</span>)),<br>                                t.<span class="hljs-title function_">push</span>(<span class="hljs-number">128</span> + (e &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span>)),<br>                                t.<span class="hljs-title function_">push</span>(<span class="hljs-number">128</span> + (<span class="hljs-number">63</span> &amp; e)))<br>                            &#125;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Uint8Array</span>.<span class="hljs-title function_">from</span>(t)<br>                        &#125;(e)),<br>                        i.<span class="hljs-title function_">setLogid</span>(a.<span class="hljs-title function_">getLogid</span>()),<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">send</span>(i.<span class="hljs-title function_">serializeBinary</span>())<br>                    &#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230619175528039.png" alt="image-20230619175528039"></p><p>大致的思路就是：n.ec函数处理数据后，然后再来反序列化得到我们要的数据给后面展示，r就是我们要的数据对象，然后如果需要ack就发，最后通过emit函数处理展示值</p><p><img src="/images/image-20230619181546345.png" alt="image-20230619181546345"></p><p>我们看下 n.ec函数，点进去看一下代码，在上面能看到是webpack打包，在下面能看到，这里应该是用来给数据进行压缩获取解压缩</p><p><img src="/images/image-20230619183322882.png" alt="image-20230619183322882"></p><p><img src="/images/image-20230619183423594.png" alt="image-20230619183423594"></p><h3 id="proto文件编写"><a href="#proto文件编写" class="headerlink" title="proto文件编写"></a>proto文件编写</h3><p>接下来我们就要考虑编写proto文件了，我们知道 <code> a = p.PushFrame.deserializeBinary(e.data)</code> 是反序列化后的数据，那我们看下proto对象是怎么写的 点击 <code>p.PushFrame</code> </p><p><img src="/images/image-20230620102517020.png" alt="image-20230620102517020"></p><p>往下拉，我们就能看到 proto对象有哪些字段了，这里需要注意 <code>headersList</code> 字段，<code>headersList</code> 添加了另一个proto对象</p><p><img src="/images/image-20230620102724034.png" alt="image-20230620102724034"></p><p><img src="/images/image-20230620103029726.png" alt="image-20230620103029726"></p><p><code>PushFrame</code> 对象的结构我们就知道了，可以这么写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">message HeadersList &#123;<br>    string key = 1;<br>    string value = 2;<br>&#125;<br><br>message PushFrame &#123;<br>    uint64 seqId = 1;<br>    uint64 logId = 2;<br>    uint64 service = 3;<br>    uint64 method = 4;<br>    repeated HeadersList headersList = 5;<br>    string payloadEncoding = 6;<br>    string payloadType = 7;<br>    bytes payload = 8;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们再看下 <code>o.Response</code> 看下响应的结构</p><p><img src="/images/image-20230620103337753.png" alt="image-20230620103337753"></p><p><img src="/images/image-20230620103402400.png" alt="image-20230620103402400"></p><p><code>Response</code> 里面有个 <code>messagesList</code> 里面又有个 <code>message</code>对象, 这里也需要补全</p><p><img src="/images/image-20230620103740743.png" alt="image-20230620103740743"></p><p><img src="/images/image-20230620103800009.png" alt="image-20230620103800009"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">message Message &#123;<br>    string method = 1;<br>    bytes payload = 2;<br>    int64 msgId = 3;<br>    int32 msgType = 4;<br>    int64 offset = 5;<br>    bool needWrdsStore = 6;<br>    int64 wrdsVersion = 7;<br>    string wrdsSubKey = 8;<br>&#125;<br><br>message Response &#123;<br>    repeated Message messagesList = 1;<br>    string cursor = 2;<br>    uint64 fetchInterval = 3;<br>    uint64 now = 4;<br>    string internalExt = 5;<br>    uint32 fetchType = 6;<br>    map&lt;string, string&gt; routeParams = 7;<br>    uint64 heartbeatDuration = 8;<br>    bool needAck = 9;<br>    string pushServer = 10;<br>    string liveCursor = 11;<br>    bool historyNoMore = 12;<br>&#125;<br></code></pre></td></tr></table></figure><p>至此，最基本的两个proto对象我们已经写好了，回到源代码里面来，我们知道最后的展示数据是交给了 <code>this.emit(r))</code> 进行处理，我们看下 <code>this.emit()</code>方法 </p><p><img src="/images/image-20230620104604818.png" alt="image-20230620104604818"></p><p><img src="/images/image-20230620104642729.png" alt="image-20230620104642729"></p><p>我们能看到代码里面有个 forEach循环，这里的意思是 它一次性并不是只接收一条数据，最多的时候好像可以接收五条数据，所以这里需要有个for循环来逐一处理，处理的方法是 <code>this.runAllEvents(t, e)</code>，点进来，我们看一下</p><p><img src="/images/image-20230620105021719.png" alt="image-20230620105021719"></p><p>这里就是处理数据类型，通过查看 <code>this.eventsMap</code> 我们可以看到，抖音分了456种数据类型，而此时进来的数据类型是 <code>&quot;WebcastMemberMessage&quot;</code>表示是有新的观众进来， 我们把断点打在下面，多运行几次，我们能看到有很多种不同类型的数据进来。</p><p>我们只拿弹幕，如果要采集其它数据类型，比如礼物啥的，可以看下 gift 字眼的数据类型</p><p><img src="/images/image-20230620105319173.png" alt="image-20230620105319173"></p><p><code>&quot;WebcastChatMessage&quot;</code> 就代表是有观众在发送弹幕，这也就是我们要的数据，这个时候我们可以看一下  <code>s.toObject</code> 就是 <code>WebcastChatMessage</code> 的proto对象<img src="/images/image-20230620105825541.png" alt="image-20230620105825541"></p><p><img src="/images/image-20230620110024791.png" alt="image-20230620110024791"></p><p>进来可以发现字段比较多，但是我们可以精简一下，只要一个 user 和 content就好了，其他的都不重要，而user对象又是另一个proto对象，且user对象也巨长无比，我们也可以精简一下</p><p><img src="/images/image-20230620110131517.png" alt="image-20230620110131517"></p><p><img src="/images/image-20230620111046544.png" alt="image-20230620111046544"></p><p>最终的proto文件就是这样，然后转换成py文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">syntax = &quot;proto3&quot;;<br><br>package douyin;<br><br>message HeadersList &#123;<br>    string key = 1;<br>    string value = 2;<br>&#125;<br><br>message PushFrame &#123;<br>    uint64 seqId = 1;<br>    uint64 logId = 2;<br>    uint64 service = 3;<br>    uint64 method = 4;<br>    repeated HeadersList headersList = 5;<br>    string payloadEncoding = 6;<br>    string payloadType = 7;<br>    bytes payload = 8;<br>&#125;<br><br><br>message Message &#123;<br>    string method = 1;<br>    bytes payload = 2;<br>    int64 msgId = 3;<br>    int32 msgType = 4;<br>    int64 offset = 5;<br>    bool needWrdsStore = 6;<br>    int64 wrdsVersion = 7;<br>    string wrdsSubKey = 8;<br>&#125;<br><br>message Response &#123;<br>    repeated Message messagesList = 1;<br>    string cursor = 2;<br>    uint64 fetchInterval = 3;<br>    uint64 now = 4;<br>    string internalExt = 5;<br>    uint32 fetchType = 6;<br>    map&lt;string, string&gt; routeParams = 7;<br>    uint64 heartbeatDuration = 8;<br>    bool needAck = 9;<br>    string pushServer = 10;<br>    string liveCursor = 11;<br>    bool historyNoMore = 12;<br>&#125;<br><br><br>message ChatMessage &#123;<br>    User user = 2;<br>    string content = 3;<br>    bool visibleToSender = 4;<br>&#125;<br><br><br>message User &#123;<br>    uint64 id = 1;<br>    uint64 shortId = 2;<br>    string nickName = 3;<br>    uint32 gender = 4;<br>    string Signature = 5;<br>    uint32 Level = 6;<br>    uint64 Birthday = 7;<br>    string Telephone = 8;<br>    string city = 14;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="代码与展示"><a href="#代码与展示" class="headerlink" title="代码与展示"></a>代码与展示</h3><p>转换完成后，我们就可以开始编写py代码了，建立连接后，最重要的是pb2文件的使用，以及注意我们上面讲的数据解压和发送ack包，最后再根据数据类型的不同进行数据处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_message</span>(<span class="hljs-params">ws, content</span>):<br>    frame = PushFrame()<br>    frame.ParseFromString(content)<br>    <span class="hljs-comment"># 对PushFrame的 payload 内容进行gzip解压</span><br>    origin_bytes = gzip.decompress(frame.payload)<br>    <span class="hljs-comment"># 根据Response+gzip解压数据，生成数据对象</span><br>    response = Response()<br>    response.ParseFromString(origin_bytes)<br>    <span class="hljs-comment"># print(response)</span><br>    <span class="hljs-keyword">if</span> response.needAck:<br>        s = PushFrame()<br>        s.payloadType = <span class="hljs-string">&quot;ack&quot;</span><br>        s.payload = response.internalExt.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        s.logId = frame.logId<br>        ws.send(s.SerializeToString())<br>    <span class="hljs-comment"># 获取数据内容（需根据不同method，使用不同的结构对象对 数据 进行解析）</span><br>    <span class="hljs-comment">#   注意：此处只处理 WebcastChatMessage ，其他处理方式都是类似的。</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> response.messagesList:<br>        <span class="hljs-keyword">if</span> item.method != <span class="hljs-string">&quot;WebcastChatMessage&quot;</span>:<br>            <span class="hljs-keyword">continue</span><br>        message = ChatMessage()<br>        message.ParseFromString(item.payload)<br>        <span class="hljs-keyword">if</span> message.content == <span class="hljs-string">&quot;&quot;</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> message.user.gender == <span class="hljs-literal">None</span>:<br>            message.user.gender = <span class="hljs-number">0</span><br>        logger.info(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;message.user.nickName&#125;</span>:<span class="hljs-subst">&#123;message.content&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>最终效果展示：</p><p><img src="/images/image-20230620100622021.png" alt="image-20230620100622021"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> protobuf </tag>
            
            <tag> 抖音 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>极验滑块验证三个W超详细解密(3)</title>
      <link href="/2023/04/11/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-3/"/>
      <url>/2023/04/11/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-3/</url>
      
        <content type="html"><![CDATA[<p><strong>书接上文</strong></p><h3 id="5-第五个请求，返回生成验证码的三张图片"><a href="#5-第五个请求，返回生成验证码的三张图片" class="headerlink" title="5.第五个请求，返回生成验证码的三张图片"></a>5.第五个请求，返回生成验证码的三张图片</h3><blockquote><p>接口地址：<a href="https://api.geetest.com/get.php">https://api.geetest.com/get.php</a></p></blockquote><p><img src="/images/image-20230527115446875.png" alt="image-20230527115446875"></p><p><img src="/images/image-20230527115504124.png" alt="image-20230527115504124"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># 第五次请求，获取各项图片<br>params = &#123;<br>    <span class="hljs-string">&#x27;is_next&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;slide3&#x27;</span>,<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;challenge&#x27;</span>: challenge,<br>    <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;https&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;protocol&#x27;</span>: <span class="hljs-string">&#x27;https://&#x27;</span>,<br>    <span class="hljs-string">&#x27;offline&#x27;</span>: <span class="hljs-string">&#x27;false&#x27;</span>,<br>    <span class="hljs-string">&#x27;product&#x27;</span>: <span class="hljs-string">&#x27;popup&#x27;</span>,<br>    <span class="hljs-string">&#x27;api_server&#x27;</span>: <span class="hljs-string">&#x27;api.geetest.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;isPC&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;autoReset&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;width&#x27;</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-title function_">format</span>(<span class="hljs-title function_">get_time</span>()),<br>&#125;<br><br>response = requests.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;https://api.geetest.com/get.php&#x27;</span>, params=params, headers=headers)<br>res_img = <span class="hljs-title function_">jsonp_data</span>(response.<span class="hljs-property">text</span>)<br>bg_url = <span class="hljs-string">&quot;https://static.geetest.com/&quot;</span> + res_img[<span class="hljs-string">&#x27;bg&#x27;</span>]<br>fullbg_url = <span class="hljs-string">&quot;https://static.geetest.com/&quot;</span> + res_img[<span class="hljs-string">&#x27;fullbg&#x27;</span>]<br>slice_url = <span class="hljs-string">&quot;https://static.geetest.com/&quot;</span> + res_img[<span class="hljs-string">&#x27;slice&#x27;</span>]<br>new_challenge = res_img[<span class="hljs-string">&#x27;challenge&#x27;</span>]<br><span class="hljs-title function_">download_img</span>(<span class="hljs-string">&#x27;./imgs/bg.jpg&#x27;</span>,bg_url)<br><span class="hljs-title function_">download_img</span>(<span class="hljs-string">&#x27;./imgs/fullbg.jpg&#x27;</span>,fullbg_url)<br><span class="hljs-title function_">download_img</span>(<span class="hljs-string">&#x27;./imgs/slice.jpg&#x27;</span>,slice_url)<br><span class="hljs-title function_">print</span>(bg_url)<br><span class="hljs-title function_">print</span>(fullbg_url)<br><span class="hljs-title function_">print</span>(slice_url)<br></code></pre></td></tr></table></figure><h3 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h3><h4 id="乱序处理"><a href="#乱序处理" class="headerlink" title="乱序处理"></a>乱序处理</h4><p> 图片下载下来后，发现是乱序的，在页面里面发现canvas， 怀疑可能是对图片进行了重绘<img src="/images/image-20230531114025800.png" alt="image-20230531114025800"></p><p><img src="/images/image-20230531114124412.png" alt="image-20230531114124412"></p><p>我们直接在 事件侦听器断点中，监控一下画布，</p><p><img src="/images/image-20230531114910905.png" alt="image-20230531114910905"></p><p>刷新一下验证码，断点进来，我们看一下代码,可以看到 i和e都是canvas，却别在于一个显示，一个不显示，o和s是两个画笔，i中写入乱序的背景图，而s画笔会在此基础上对乱序的图片进行重绘</p><p><img src="/images/image-20230531114938335.png" alt="image-20230531114938335"></p><p><img src="/images/image-20230531115309764.png" alt="image-20230531115309764"></p><p>我们直接看他是怎么重绘的</p><p>c的值是x轴的坐标，图片分成52份，上面26份，下面26份，</p><p>u 的值 是判断数组中的值是否大于25，否则返回80或者0 ，这里代表的是画布的高度是160，然后分成上下两部分，上面26份，下面26份，80和0都是y轴的坐标</p><p>l的值，是从画布o，就是乱序的图里面 c ,u xy轴坐标，10指图片的宽度，a,指图片的高度</p><p><code>s[$_CJEq(95)](l, _ % 26 * 10, 25 &lt; _ ? a : 0);</code>  这里代表的意思是 s[“putImageData”] 就是从乱序的图片里面获取l,然后再通过顺序写入到新的图片里面去， Ut就是图片还原的正确顺序</p><p>我们直接用python 还原就好了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">true_back</span>(<span class="hljs-params">path</span>):<br>    old_img = Image.<span class="hljs-built_in">open</span>(path)<br>    new_img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (<span class="hljs-number">260</span>, <span class="hljs-number">160</span>))  <span class="hljs-comment"># 创建一张新的图片</span><br>    Ut = [<br>        <span class="hljs-number">5</span>,<br>        <span class="hljs-number">19</span>,<br>        <span class="hljs-number">18</span>,<br>        <span class="hljs-number">16</span>,<br>        <span class="hljs-number">17</span><br>    ]<br>    r = <span class="hljs-number">160</span>  <span class="hljs-comment"># 图片的高度</span><br>    a = r // <span class="hljs-number">2</span>  <span class="hljs-comment"># 上下切成两份</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">52</span>):  <span class="hljs-comment"># 处理成52张图片</span><br>        c = Ut[_] % <span class="hljs-number">26</span> * <span class="hljs-number">12</span> + <span class="hljs-number">1</span><br>        u = a <span class="hljs-keyword">if</span> <span class="hljs-number">25</span> &lt; Ut[_] <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        <span class="hljs-comment"># 获取一个区域，这个地方不一样，js是前两个参数是左上角的坐标，后面两个参数是宽和高</span><br>        <span class="hljs-comment"># python 里面 前两个参数是左上角的坐标，后面两个参数是右下角的坐标</span><br>        l = old_img.crop((c, u, c + <span class="hljs-number">10</span>, u + a))<br>        x1 = _ % <span class="hljs-number">26</span> * <span class="hljs-number">10</span><br>        y1 = a <span class="hljs-keyword">if</span> <span class="hljs-number">25</span> &lt; _ <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        new_img.paste(l, (x1, y1))<br>    new_img.save(<span class="hljs-string">&quot;./imgs/new_full_img.jpg&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="滑动距离"><a href="#滑动距离" class="headerlink" title="滑动距离"></a>滑动距离</h4><p>使用opencv进行处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_slice</span>():<br>    <span class="hljs-comment"># 读取图片</span><br>    bg = cv2.imread(<span class="hljs-string">&quot;./imgs/new_bg.jpg&quot;</span>)  <span class="hljs-comment"># 获取带缺口的背景图片</span><br>    <span class="hljs-built_in">slice</span> = cv2.imread(<span class="hljs-string">&quot;./imgs/slice.jpg&quot;</span>)  <span class="hljs-comment"># 滑块图片</span><br><br>    <span class="hljs-comment"># 灰度处理，将rgb三原色全部改成灰色，这样便于图片亮度处理</span><br>    bg = cv2.cvtColor(bg, cv2.COLOR_BGR2GRAY)  <span class="hljs-comment"># 蓝绿红改灰色</span><br>    <span class="hljs-built_in">slice</span> = cv2.cvtColor(<span class="hljs-built_in">slice</span>, cv2.COLOR_BGR2GRAY)<br><br>    <span class="hljs-comment"># 边缘检测,图片边缘处理</span><br>    bg_cam = cv2.Canny(bg, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-built_in">slice</span> = cv2.Canny(<span class="hljs-built_in">slice</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br><br>    <span class="hljs-comment"># 将两张图片进行匹配，会对每一个像素点进行匹配</span><br>    r = cv2.matchTemplate(bg_cam, <span class="hljs-built_in">slice</span>, cv2.TM_CCOEFF_NORMED)<br>    <span class="hljs-comment"># print(r)</span><br><br>    <span class="hljs-comment"># 获取最佳匹配多，返回四个结果</span><br>    <span class="hljs-comment"># 第一个是最不匹配的值，第三个是最不匹配的坐标</span><br>    <span class="hljs-comment"># 第二个是最匹配的值，第四个是最匹配的坐标</span><br>    minVal, maxVal, minLoc, maxLoc = cv2.minMaxLoc(r)<br>    <span class="hljs-comment"># print(minVal, maxVal, minLoc, maxLoc)</span><br>    distance = maxLoc[<span class="hljs-number">0</span>]  <span class="hljs-comment"># maxLoc是最匹配的坐标，第一个值就代表着横向的距离</span><br>    <span class="hljs-keyword">return</span> distance<br></code></pre></td></tr></table></figure><h4 id="滑动轨迹"><a href="#滑动轨迹" class="headerlink" title="滑动轨迹"></a>滑动轨迹</h4><p>使用随机算法生成</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__ease_out_expo</span>(<span class="hljs-params">sep</span>):<br>    <span class="hljs-keyword">if</span> sep == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> - <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, -<span class="hljs-number">10</span> * sep)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_slide_track</span>(<span class="hljs-params">distance</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    根据滑动的距离生成轨迹</span><br><span class="hljs-string">    return 滑动轨迹，x 已滑动的横向距离， y已滑动的纵向距离，除起点完 都为0 t:滑动过程消耗的时间</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(distance, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">or</span> distance &lt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&#x27;distance类型必须是大于等于0的整数&#x27;</span>)<br>    <span class="hljs-comment"># 初始化轨迹列表,正常开始是000，但是网页可能会记录鼠标干了什么导致第一个是随机的，第二个是000</span><br>    slide_track = [[random.randint(-<span class="hljs-number">50</span>, -<span class="hljs-number">10</span>), random.randint(-<span class="hljs-number">50</span>, -<span class="hljs-number">10</span>), <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], ]<br>    <span class="hljs-comment"># 共记录count此滑块位置信息</span><br>    count = <span class="hljs-number">30</span> + <span class="hljs-built_in">int</span>(distance / <span class="hljs-number">2</span>)<br>    <span class="hljs-comment"># 初始滑块时间</span><br>    t = random.randint(<span class="hljs-number">50</span>, <span class="hljs-number">100</span>)<br>    <span class="hljs-comment"># 记录上一次滑动的距离</span><br>    _x = <span class="hljs-number">0</span><br>    _y = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(count):<br>        <span class="hljs-comment"># 已滑动的横向距离,用离散法获取随机的横向距离</span><br>        x = <span class="hljs-built_in">round</span>(__ease_out_expo(i / count) * distance)<br>        <span class="hljs-comment"># 滑动过程消耗的时间</span><br>        t += random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)<br>        <span class="hljs-comment"># 如果与上次一相同 就不记录</span><br>        <span class="hljs-keyword">if</span> x == _x:<br>            <span class="hljs-keyword">continue</span><br>        slide_track.append([x, _y, t])<br>        _x = x<br>    slide_track.append([distance, <span class="hljs-number">0</span>, t])<br>    <span class="hljs-keyword">return</span> slide_track, t<br></code></pre></td></tr></table></figure><h3 id="6-第六个请求，验证验证码是否成功"><a href="#6-第六个请求，验证验证码是否成功" class="headerlink" title="6.第六个请求，验证验证码是否成功"></a>6.第六个请求，验证验证码是否成功</h3><p>滑动滑块，生成最后一个请求，该请求同样需要携带w,唯一的区别在于这个w相比较之前的w更短一点，而且challenge参数会和之前不一样，多了个cb，这个参数是来自于第五个请求返回的新的challenge，需要注意</p><p><img src="/images/image-20230531151118913.png" alt="image-20230531151118913"></p><h3 id="第三个W解密流程："><a href="#第三个W解密流程：" class="headerlink" title="第三个W解密流程："></a>第三个W解密流程：</h3><p>从发起程序中进入堆栈，同样按照最开始的流程 搜索”\u0077”，只有一个，直接断点进来，其中h + u就是我们要的w</p><p><img src="/images/image-20230531151325564.png" alt="image-20230531151325564"></p><p><img src="/images/image-20230531151556237.png" alt="image-20230531151556237"></p><p>我们把这里一大段代码都扣下来，看一下具体代码流程, 传入的参数通过调试可知分别为滑动的距离、被加密后的轨迹、滑动的时间，o当中的参数的最后一个, 他其实跟之前写的那个鼠标移动的轨迹时间是一样的，我们也同样可以用之前算差值的方法算tm的参数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// t:滑动的距离 e：被加密后的轨迹 n: 滑动的时间</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_3w</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-variable language_">this</span><br>        , i = r[<span class="hljs-string">&#x27;$_CJV&#x27;</span>]<br>        , o = &#123;<br>        <span class="hljs-string">&quot;\u006c\u0061\u006e\u0067&quot;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>        <span class="hljs-string">&quot;\u0075\u0073\u0065\u0072\u0072\u0065\u0073\u0070\u006f\u006e\u0073\u0065&quot;</span>: <span class="hljs-title function_">H</span>(t, i[<span class="hljs-string">&#x27;challenge&#x27;</span>]),<br>        <span class="hljs-string">&quot;\u0070\u0061\u0073\u0073\u0074\u0069\u006d\u0065&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0069\u006d\u0067\u006c\u006f\u0061\u0064&quot;</span>: <span class="hljs-number">21</span>,<br>        <span class="hljs-string">&quot;\u0061\u0061&quot;</span>: e,<br>        <span class="hljs-string">&quot;\u0065\u0070&quot;</span>: $_CCCP()<br>    &#125;;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[<span class="hljs-string">&#x27;_gct&#x27;</span>]) &#123;<br>            <span class="hljs-keyword">var</span> s = &#123;<br>                <span class="hljs-string">&quot;\u006c\u0061\u006e\u0067&quot;</span>: o[<span class="hljs-string">&#x27;lang&#x27;</span>],<br>                <span class="hljs-string">&quot;\u0065\u0070&quot;</span>: o[<span class="hljs-string">&#x27;ep&#x27;</span>]<br>            &#125;<br>                , a = <span class="hljs-variable language_">window</span>[<span class="hljs-string">&#x27;_gct&#x27;</span>](s);<br>            <span class="hljs-keyword">if</span> (a[<span class="hljs-string">&#x27;lang&#x27;</span>]) &#123;<br>                <span class="hljs-keyword">var</span> _ = <span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">t</span>) &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e <span class="hljs-keyword">in</span> t)<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;ep&#x27;</span> !== e &amp;&amp; <span class="hljs-string">&#x27;lang&#x27;</span> !== e)<br>                            <span class="hljs-keyword">return</span> e;<br>                &#125;(s)<br>                    , c = <span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = <span class="hljs-keyword">new</span> t[(<span class="hljs-string">&#x27;gg&#x27;</span>)][(<span class="hljs-string">&#x27;f&#x27;</span>)](e, n), i = [<span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;es&#x27;</span>, <span class="hljs-string">&#x27;en&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;wn&#x27;</span>, <span class="hljs-string">&#x27;ws&#x27;</span>], o = i[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">2</span>, s = <span class="hljs-number">0</span>; s &lt; n[<span class="hljs-string">&#x27;length&#x27;</span>]; s++) &#123;<br>                        <span class="hljs-keyword">var</span> a, _ = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](n[s][<span class="hljs-string">&#x27;charCodeAt&#x27;</span>]() - <span class="hljs-number">70</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>]()[<span class="hljs-number">1</span>];<br>                        a = o &lt; _ ? t[<span class="hljs-string">&#x27;gg&#x27;</span>][i[<span class="hljs-number">1</span> + o]](r) : t[<span class="hljs-string">&#x27;gg&#x27;</span>][i[_]](r);<br>                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](n[s][<span class="hljs-string">&#x27;charCodeAt&#x27;</span>]() - <span class="hljs-number">70</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>]()[<span class="hljs-number">0</span>], u = <span class="hljs-number">0</span>; u &lt; c; u++)<br>                            a[<span class="hljs-string">&#x27;cc&#x27;</span>]();<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> r[<span class="hljs-string">&#x27;random&#x27;</span>][<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>)[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);<br>                &#125;(a, s, _);<br>                s[_] = c;<br>            &#125;<br>            !<span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">t</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">aa</span>(<span class="hljs-number">3</span>) == <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Object</span>[<span class="hljs-string">&#x27;assign&#x27;</span>])<br>                    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>[<span class="hljs-string">&#x27;assign&#x27;</span>][<span class="hljs-string">&#x27;apply&#x27;</span>](<span class="hljs-title class_">Object</span>, <span class="hljs-variable language_">arguments</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == t)<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Cannot convert undefined or null to object&#x27;</span>);<br>                t = <span class="hljs-title class_">Object</span>(t);<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">1</span>; e &lt; <span class="hljs-variable language_">arguments</span>[<span class="hljs-string">&#x27;length&#x27;</span>]; e++) &#123;<br>                    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">arguments</span>[e];<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> !== n)<br>                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r <span class="hljs-keyword">in</span> n)<br>                            <span class="hljs-title class_">Object</span>[<span class="hljs-string">&#x27;prototype&#x27;</span>][<span class="hljs-string">&#x27;hasOwnProperty&#x27;</span>][<span class="hljs-string">&#x27;call&#x27;</span>](n, r) &amp;&amp; (t[r] = n[r]);<br>                &#125;<br>                <span class="hljs-keyword">return</span> t;<br>            &#125;(o, s);<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (v) &#123;<br>    &#125;<br>    i[<span class="hljs-string">&#x27;offline&#x27;</span>] &amp;&amp; (o[<span class="hljs-string">&#x27;x&#x27;</span>] = t),<br>        o[<span class="hljs-string">&#x27;rp&#x27;</span>] = <span class="hljs-title function_">X</span>(i[<span class="hljs-string">&#x27;gt&#x27;</span>] + i[<span class="hljs-string">&#x27;challenge&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">32</span>) + o[<span class="hljs-string">&#x27;passtime&#x27;</span>]);<br>    <span class="hljs-keyword">var</span> u = r[<span class="hljs-string">&#x27;$_CCDf&#x27;</span>]()<br>        , l = V[<span class="hljs-string">&#x27;encrypt&#x27;</span>](gt[<span class="hljs-string">&#x27;stringify&#x27;</span>](o), r[<span class="hljs-string">&#x27;$_CCEV&#x27;</span>]())<br>        , h = m[<span class="hljs-string">&#x27;$_FEE&#x27;</span>](l)<br>        , f = &#123;<br>        <span class="hljs-string">&quot;\u0067\u0074&quot;</span>: i[<span class="hljs-string">&#x27;gt&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0063\u0068\u0061\u006c\u006c\u0065\u006e\u0067\u0065&quot;</span>: i[<span class="hljs-string">&#x27;challenge&#x27;</span>],<br>        <span class="hljs-string">&quot;\u006c\u0061\u006e\u0067&quot;</span>: o[<span class="hljs-string">&#x27;lang&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0024\u005f\u0042\u0043\u0058&quot;</span>: r[<span class="hljs-string">&#x27;$_BHIK&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0063\u006c\u0069\u0065\u006e\u0074\u005f\u0074\u0079\u0070\u0065&quot;</span>: r[<span class="hljs-string">&#x27;$_BHJU&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0077&quot;</span>: h + u<br>    &#125;;<br>    <span class="hljs-keyword">return</span> f;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230531163529174.png" alt="image-20230531163529174"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCCP</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()<br>    <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;7.9.0&quot;</span>,<br>    <span class="hljs-string">&quot;$_BIo&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;me&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;tm&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;a&quot;</span>: now - <span class="hljs-number">2367</span>,<br>        <span class="hljs-string">&quot;b&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;c&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;e&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;f&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span>,<br>        <span class="hljs-string">&quot;g&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&quot;h&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;i&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;j&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;k&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-string">&quot;l&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;m&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span>,<br>        <span class="hljs-string">&quot;n&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;o&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span>,<br>        <span class="hljs-string">&quot;p&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;q&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;r&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span>,<br>        <span class="hljs-string">&quot;s&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;t&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;u&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span><br>    &#125;,<br>    <span class="hljs-string">&quot;td&quot;</span>: -<span class="hljs-number">1</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>H方法是一个控制流,和之前的一样，它的控制判断流程没有意义，直接拿循环的主题部分就好了</p><p><img src="/images/image-20230531163816356.png" alt="image-20230531163816356"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">t, e</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = e[<span class="hljs-string">&#x27;slice&#x27;</span>](-<span class="hljs-number">2</span>), r = [], i = <span class="hljs-number">0</span>; i &lt; n[<span class="hljs-string">&#x27;length&#x27;</span>]; i++) &#123;<br>        <span class="hljs-keyword">var</span> o = n[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](i);<br>        r[i] = <span class="hljs-number">57</span> &lt; o ? o - <span class="hljs-number">87</span> : o - <span class="hljs-number">48</span>;<br>    &#125;<br>    n = <span class="hljs-number">36</span> * r[<span class="hljs-number">0</span>] + r[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">var</span> s, a = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;round&#x27;</span>](t) + n, _ = [[], [], [], [], []], c = &#123;&#125;, u = <span class="hljs-number">0</span>;<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> l = (e = e[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, -<span class="hljs-number">2</span>))[<span class="hljs-string">&#x27;length&#x27;</span>]; i &lt; l; i++)<br>        c[s = e[<span class="hljs-string">&#x27;charAt&#x27;</span>](i)] || (c[s] = <span class="hljs-number">1</span>,<br>            _[u][<span class="hljs-string">&#x27;push&#x27;</span>](s),<br>            u = <span class="hljs-number">5</span> == ++u ? <span class="hljs-number">0</span> : u);<br>    <span class="hljs-keyword">var</span> h, f = a, d = <span class="hljs-number">4</span>, p = <span class="hljs-string">&#x27;&#x27;</span>, g = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>];<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">0</span> &lt; f)<br>        <span class="hljs-number">0</span> &lt;= f - g[d] ? (h = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;random&#x27;</span>]() * _[d][<span class="hljs-string">&#x27;length&#x27;</span>], <span class="hljs-number">10</span>),<br>            p += _[d][h],<br>            f -= g[d]) : (_[<span class="hljs-string">&#x27;splice&#x27;</span>](d, <span class="hljs-number">1</span>),<br>            g[<span class="hljs-string">&#x27;splice&#x27;</span>](d, <span class="hljs-number">1</span>),<br>            d -= <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> p;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们再处理一下轨迹，即找一下e的加密过程，看一下这边轨迹做了哪些处理，我们把堆栈往上走一步，这个l呢就是轨迹处理，第一个参数就是轨迹， <code>l = n[$_DAAAt(912)][$_CJJJp(1034)](n[$_DAAAt(912)][$_CJJJp(1069)](), n[$_DAAAt(71)][$_DAAAt(1091)], n[$_CJJJp(71)][$_DAAAt(389)])</code> 这段代码有点长，我们先看，我们处理一下</p><p><img src="/images/image-20230531174448247.png" alt="image-20230531174448247"></p><p>外层的括号代表是一个方法  <code>n[$_DAAAt(912)][$_CJJJp(1034)]</code> ，该方法传入三个参数，第一个参数是 <code>n[$_DAAAt(912)][$_CJJJp(1069)]()</code>,可以很明显的看到，<code>[$_CJJJp(1069)]</code> 是 <code>n[$_DAAAt(912)]</code> 原型链上的一个方法，其实就相当于 &#96;[$_CJJJp(1069)].n[$_DAAAt(912)] 我们把外层的方法和里面的方法一起抠出来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">l = n[$_DAAAt(<span class="hljs-number">912</span>)][$_CJJJp(<span class="hljs-number">1034</span>)](<br>    n[$_DAAAt(<span class="hljs-number">912</span>)][$_CJJJp(<span class="hljs-number">1069</span>)](), <br>    n[$_DAAAt(<span class="hljs-number">71</span>)][$_DAAAt(<span class="hljs-number">1091</span>)], <br>    n[$_CJJJp(<span class="hljs-number">71</span>)][$_DAAAt(<span class="hljs-number">389</span>)]<br>)<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230531175231123.png" alt="image-20230531175231123"></p><p>抠出来整理后的代码是这样的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CJJJp_34</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!e || !n)<br>        <span class="hljs-keyword">return</span> t;<br>    <span class="hljs-keyword">var</span> r, i = <span class="hljs-number">0</span>, o = t, s = e[<span class="hljs-number">0</span>], a = e[<span class="hljs-number">2</span>], _ = e[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">while</span> (r = n[<span class="hljs-string">&#x27;substr&#x27;</span>](i, <span class="hljs-number">2</span>)) &#123;<br>        i += <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">parseInt</span>(r, <span class="hljs-number">16</span>)<br>            , u = <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](c)<br>            , l = (s * c * c + a * c + _) % t[<span class="hljs-string">&#x27;length&#x27;</span>];<br>        o = o[<span class="hljs-string">&#x27;substr&#x27;</span>](<span class="hljs-number">0</span>, l) + u + o[<span class="hljs-string">&#x27;substr&#x27;</span>](l);<br>    &#125;<br>    <span class="hljs-keyword">return</span> o;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CJJJp_69</span>(<span class="hljs-params">guiji</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">t</span>) &#123;<br>        <span class="hljs-keyword">var</span> e = <span class="hljs-string">&#x27;()*,-./0123456789:?@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqr&#x27;</span><br>            , n = e[<span class="hljs-string">&#x27;length&#x27;</span>]<br>            , r = <span class="hljs-string">&#x27;&#x27;</span><br>            , i = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](t)<br>            , o = <span class="hljs-built_in">parseInt</span>(i / n);<br>        n &lt;= o &amp;&amp; (o = n - <span class="hljs-number">1</span>),<br>        o &amp;&amp; (r = e[<span class="hljs-string">&#x27;charAt&#x27;</span>](o));<br>        <span class="hljs-keyword">var</span> s = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">return</span> t &lt; <span class="hljs-number">0</span> &amp;&amp; (s += <span class="hljs-string">&#x27;!&#x27;</span>),<br>        r &amp;&amp; (s += <span class="hljs-string">&#x27;$&#x27;</span>),<br>        s + r + e[<span class="hljs-string">&#x27;charAt&#x27;</span>](i %= n);<br><br>    &#125;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e, n, r, i = [], o = <span class="hljs-number">0</span>, s = <span class="hljs-number">0</span>, a = t[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">1</span>; s &lt; a; s++)<br>            e = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;round&#x27;</span>](t[s + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - t[s][<span class="hljs-number">0</span>]),<br>                n = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;round&#x27;</span>](t[s + <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] - t[s][<span class="hljs-number">1</span>]),<br>                r = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;round&#x27;</span>](t[s + <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] - t[s][<span class="hljs-number">2</span>]),<br>            <span class="hljs-number">0</span> == e &amp;&amp; <span class="hljs-number">0</span> == n &amp;&amp; <span class="hljs-number">0</span> == r || (<span class="hljs-number">0</span> == e &amp;&amp; <span class="hljs-number">0</span> == n ? o += r : (i[<span class="hljs-string">&#x27;push&#x27;</span>]([e, n, r + o]),<br>                o = <span class="hljs-number">0</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> !== o &amp;&amp; i[<span class="hljs-string">&#x27;push&#x27;</span>]([e, n, o]),<br>            i;<br>    &#125;(guiji)<br>        , r = []<br>        , i = []<br>        , o = [];<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ct</span>(t)[<span class="hljs-string">&#x27;$_CAd&#x27;</span>](<span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) &#123;<br>        <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = [[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>]], n = <span class="hljs-number">0</span>, r = e[<span class="hljs-string">&#x27;length&#x27;</span>]; n &lt; r; n++)<br>                <span class="hljs-keyword">if</span> (t[<span class="hljs-number">0</span>] == e[n][<span class="hljs-number">0</span>] &amp;&amp; t[<span class="hljs-number">1</span>] == e[n][<span class="hljs-number">1</span>])<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;stuvwxyz~&#x27;</span>[n];<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;(t);<br>        e ? i[<span class="hljs-string">&#x27;push&#x27;</span>](e) : (r[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">n</span>(t[<span class="hljs-number">0</span>])),<br>            i[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">n</span>(t[<span class="hljs-number">1</span>]))),<br>            o[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">n</span>(t[<span class="hljs-number">2</span>]));<br>    &#125;),<br>    r[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>) + <span class="hljs-string">&#x27;!!&#x27;</span> + i[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>) + <span class="hljs-string">&#x27;!!&#x27;</span> + o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>需要注意的几个地方，一个是这里,括号里面的那个方法没有传递参数，但实际上这个就相当于参数传递，这个东西是轨迹，this.轨迹，这就是为什么是原型链上的方法，因为this的作用域指向的就是轨迹，所以这里我们直接从函数上面把轨迹传递进来就好了</p><p><img src="/images/image-20230531181250554.png" alt="image-20230531181250554"></p><p>还有一个地方是这里, 这里新建了一个ct方法，然后再ct方法的原型链上又添加了一个新方法，我们需要把这两个方法找出来</p><p><img src="/images/image-20230531181458174.png" alt="image-20230531181458174"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ct</span>(<span class="hljs-params">t</span>) &#123;<br>  <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BCAc&#x27;</span>] = t || [];<br>&#125;<br><br>ct.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$_CAd</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BCAc&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (e[<span class="hljs-string">&#x27;map&#x27;</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ct</span>(e[<span class="hljs-string">&#x27;map&#x27;</span>](t));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, i = e[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; i; r += <span class="hljs-number">1</span>)<br>        n[r] = <span class="hljs-title function_">t</span>(e[r], r, <span class="hljs-variable language_">this</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ct</span>(n);<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来我们就可以测试一下括号内的方法有没有什么问题了,运行结果没什么问题，那我们就看下一个外层的方法</p><p><img src="/images/image-20230531182741153.png" alt="image-20230531182741153"></p><p>我们先看下外层方法的另外两个参数  <code>n[$_DAAAt(71)][$_DAAAt(1091)], n[$_CJJJp(71)][$_DAAAt(389)]</code> </p><p>简化一下就是 <code>n[$_DAAAt(71)][&quot;c&quot;], n[$_CJJJp(71)][&quot;s&quot;]</code> 而c 和 s就是上一个请求，即获取验证码图片的那个请求中的c和s参数,我们这里先固定写死，后面再传参</p><p><img src="/images/image-20230531185533521.png" alt="image-20230531185533521"></p><p>运行一下,和浏览器里面一样，这样l参数我们就解决了，也就是被加密的轨迹 e参数解决了</p><p><img src="/images/image-20230531185812219.png" alt="image-20230531185812219"></p><p>现在 我们回到最开始的try 条件那里，看一下这一部走了什么，我们的最终目的是为了完成 h + u，在这里还需要知道o是什么，而o是在try之前就做了定义，这一段try catch会非常头疼，所以我们直接看结果，看一下进try之后做了什么</p><p><img src="/images/image-20230601110259671.png" alt="image-20230601110259671"></p><p>将断点设在上下两个地方,可以很明显看到就多了一个 h9s9的值，而其它值我们已经搞定了，而这个值好像又和random值有关系，那么我们也可以直接在这里用定值，直接把try catch这一段给删掉，然后给o加定值，而且这个值并没有在后续进行校验，所以可以随便给,再整理一下，就是这样了</p><p><img src="/images/image-20230601110640578.png" alt="image-20230601110640578"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_3w</span>(<span class="hljs-params">t, guiji, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = [<span class="hljs-number">12</span>, <span class="hljs-number">58</span>, <span class="hljs-number">98</span>, <span class="hljs-number">36</span>, <span class="hljs-number">43</span>, <span class="hljs-number">95</span>, <span class="hljs-number">62</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>];<br>    <span class="hljs-keyword">var</span> s = <span class="hljs-string">&quot;7546376a&quot;</span>;<br>    <span class="hljs-keyword">var</span> guiji = [[<br>        -<span class="hljs-number">24</span>,<br>        -<span class="hljs-number">23</span>,<br>        <span class="hljs-number">0</span><br>    ],]<br>    <span class="hljs-keyword">var</span> l = <span class="hljs-title function_">get_l</span>(guiji)<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-variable language_">this</span><br>        , i = r[<span class="hljs-string">&#x27;$_CJV&#x27;</span>]<br>        , o = &#123;<br>        <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>        <span class="hljs-string">&#x27;userresponse&#x27;</span>: <span class="hljs-title function_">H</span>(t, i[<span class="hljs-string">&#x27;challenge&#x27;</span>]),<br>        <span class="hljs-string">&#x27;passtime&#x27;</span>: n,<br>        <span class="hljs-string">&#x27;imgload&#x27;</span>: <span class="hljs-number">21</span>,<br>        <span class="hljs-string">&#x27;aa&#x27;</span>: l,<br>        <span class="hljs-string">&#x27;ep&#x27;</span>: $_CCCP(),<br>        <span class="hljs-string">&quot;h9s9&quot;</span>: <span class="hljs-string">&quot;1816378497&quot;</span>,<br>    &#125;;<br>    <span class="hljs-comment">// i[&#x27;offline&#x27;] &amp;&amp; (o[&#x27;x&#x27;] = t),</span><br>    o[<span class="hljs-string">&#x27;rp&#x27;</span>] = <span class="hljs-title function_">X</span>(i[<span class="hljs-string">&#x27;gt&#x27;</span>] + i[<span class="hljs-string">&#x27;challenge&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">32</span>) + o[<span class="hljs-string">&#x27;passtime&#x27;</span>]);<br>    <span class="hljs-keyword">var</span> u = r[<span class="hljs-string">&#x27;$_CCDf&#x27;</span>]()<br>        , l = V[<span class="hljs-string">&#x27;encrypt&#x27;</span>](gt[<span class="hljs-string">&#x27;stringify&#x27;</span>](o), r[<span class="hljs-string">&#x27;$_CCEV&#x27;</span>]())<br>        , h = m[<span class="hljs-string">&#x27;$_FEE&#x27;</span>](l)<br>        , f = &#123;<br>        <span class="hljs-string">&quot;\u0067\u0074&quot;</span>: i[<span class="hljs-string">&#x27;gt&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0063\u0068\u0061\u006c\u006c\u0065\u006e\u0067\u0065&quot;</span>: i[<span class="hljs-string">&#x27;challenge&#x27;</span>],<br>        <span class="hljs-string">&quot;\u006c\u0061\u006e\u0067&quot;</span>: o[<span class="hljs-string">&#x27;lang&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0024\u005f\u0042\u0043\u0058&quot;</span>: r[<span class="hljs-string">&#x27;$_BHIK&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0063\u006c\u0069\u0065\u006e\u0074\u005f\u0074\u0079\u0070\u0065&quot;</span>: r[<span class="hljs-string">&#x27;$_BHJU&#x27;</span>],<br>        <span class="hljs-string">&quot;\u0077&quot;</span>: h + u<br>    &#125;;<br>    <span class="hljs-keyword">return</span> f;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们再看一下X方法，X方法比较长，它其实是一个md5方法,随便抠一下就好了，运行结果和md5方法一样就可以了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">X</span>(<span class="hljs-params">t, e</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_</span>(<span class="hljs-params">t, e</span>) &#123;<br>        <span class="hljs-keyword">return</span> t &lt;&lt; e | t &gt;&gt;&gt; <span class="hljs-number">32</span> - e;<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">t, e</span>) &#123;<br>        <span class="hljs-keyword">var</span> n, r, i, o, s;<br>        <span class="hljs-keyword">return</span> i = <span class="hljs-number">2147483648</span> &amp; t,<br>            o = <span class="hljs-number">2147483648</span> &amp; e,<br>            s = (<span class="hljs-number">1073741823</span> &amp; t) + (<span class="hljs-number">1073741823</span> &amp; e),<br>            (n = <span class="hljs-number">1073741824</span> &amp; t) &amp; (r = <span class="hljs-number">1073741824</span> &amp; e) ? <span class="hljs-number">2147483648</span> ^ s ^ i ^ o : n | r ? <span class="hljs-number">1073741824</span> &amp; s ? <span class="hljs-number">3221225472</span> ^ s ^ i ^ o : <span class="hljs-number">1073741824</span> ^ s ^ i ^ o : s ^ i ^ o;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">e</span>(<span class="hljs-params">t, e, n, r, i, o, s</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">c</span>(<span class="hljs-title function_">_</span>(t = <span class="hljs-title function_">c</span>(t, <span class="hljs-title function_">c</span>(<span class="hljs-title function_">c</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t &amp; e | ~t &amp; n;<br>        &#125;(e, n, r), i), s)), o), e);<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">t, e, n, r, i, o, s</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">c</span>(<span class="hljs-title function_">_</span>(t = <span class="hljs-title function_">c</span>(t, <span class="hljs-title function_">c</span>(<span class="hljs-title function_">c</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t &amp; n | e &amp; ~n;<br>        &#125;(e, n, r), i), s)), o), e);<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">t, e, n, r, i, o, s</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">c</span>(<span class="hljs-title function_">_</span>(t = <span class="hljs-title function_">c</span>(t, <span class="hljs-title function_">c</span>(<span class="hljs-title function_">c</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t ^ e ^ n;<br>        &#125;(e, n, r), i), s)), o), e);<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">i</span>(<span class="hljs-params">t, e, n, r, i, o, s</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">c</span>(<span class="hljs-title function_">_</span>(t = <span class="hljs-title function_">c</span>(t, <span class="hljs-title function_">c</span>(<span class="hljs-title function_">c</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e ^ (t | ~n);<br>        &#125;(e, n, r), i), s)), o), e);<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">t</span>) &#123;<br><br>        <span class="hljs-keyword">var</span> e, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (e = <span class="hljs-number">0</span>; e &lt;= <span class="hljs-number">3</span>; e++)<br>            n += (r = <span class="hljs-string">&#x27;0&#x27;</span> + (t &gt;&gt;&gt; <span class="hljs-number">8</span> * e &amp; <span class="hljs-number">255</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>))[<span class="hljs-string">&#x27;substr&#x27;</span>](r[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">return</span> n;<br><br>    &#125;<br><br>    <span class="hljs-keyword">var</span> s, a, u, l, h, f, d, p, g, v;<br>    <span class="hljs-keyword">for</span> (s = <span class="hljs-keyword">function</span> <span class="hljs-title function_">m</span>(<span class="hljs-params">t</span>) &#123;<br>        <span class="hljs-keyword">var</span> e, n = t[<span class="hljs-string">&#x27;length&#x27;</span>], r = n + <span class="hljs-number">8</span>, i = <span class="hljs-number">16</span> * (<span class="hljs-number">1</span> + (r - r % <span class="hljs-number">64</span>) / <span class="hljs-number">64</span>), o = <span class="hljs-title class_">Array</span>(i - <span class="hljs-number">1</span>), s = <span class="hljs-number">0</span>,<br>            a = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (a &lt; n)<br>            s = a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>                o[e = (a - a % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = o[e] | t[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](a) &lt;&lt; s,<br>                a++;<br>        <span class="hljs-keyword">return</span> s = a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>            o[e = (a - a % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = o[e] | <span class="hljs-number">128</span> &lt;&lt; s,<br>            o[i - <span class="hljs-number">2</span>] = n &lt;&lt; <span class="hljs-number">3</span>,<br>            o[i - <span class="hljs-number">1</span>] = n &gt;&gt;&gt; <span class="hljs-number">29</span>,<br>            o;<br>    &#125;(t = <span class="hljs-keyword">function</span> <span class="hljs-title function_">y</span>(<span class="hljs-params">t</span>) &#123;<br>        t = t[<span class="hljs-string">&#x27;replace&#x27;</span>](<span class="hljs-regexp">/\r\n/g</span>, <span class="hljs-string">&#x27;\n&#x27;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-string">&#x27;&#x27;</span>, n = <span class="hljs-number">0</span>; n &lt; t[<span class="hljs-string">&#x27;length&#x27;</span>]; n++) &#123;<br>            <span class="hljs-keyword">var</span> r = t[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](n);<br>            r &lt; <span class="hljs-number">128</span> ? e += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r) : (<span class="hljs-number">127</span> &lt; r &amp;&amp; r &lt; <span class="hljs-number">2048</span> ? e += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> | <span class="hljs-number">192</span>) : (e += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">12</span> | <span class="hljs-number">224</span>),<br>                e += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>)),<br>                e += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](<span class="hljs-number">63</span> &amp; r | <span class="hljs-number">128</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> e;<br>    &#125;(t)),<br>             d = <span class="hljs-number">1732584193</span>,<br>             p = <span class="hljs-number">4023233417</span>,<br>             g = <span class="hljs-number">2562383102</span>,<br>             v = <span class="hljs-number">271733878</span>,<br>             a = <span class="hljs-number">0</span>; a &lt; s[<span class="hljs-string">&#x27;length&#x27;</span>]; a += <span class="hljs-number">16</span>)<br>        p = <span class="hljs-title function_">i</span>(p = <span class="hljs-title function_">i</span>(p = <span class="hljs-title function_">i</span>(p = <span class="hljs-title function_">i</span>(p = <span class="hljs-title function_">r</span>(p = <span class="hljs-title function_">r</span>(p = <span class="hljs-title function_">r</span>(p = <span class="hljs-title function_">r</span>(p = <span class="hljs-title function_">n</span>(p = <span class="hljs-title function_">n</span>(p = <span class="hljs-title function_">n</span>(p = <span class="hljs-title function_">n</span>(p = <span class="hljs-title function_">e</span>(p = <span class="hljs-title function_">e</span>(p = <span class="hljs-title function_">e</span>(p = <span class="hljs-title function_">e</span>(l = p, g = <span class="hljs-title function_">e</span>(h = g, v = <span class="hljs-title function_">e</span>(f = v, d = <span class="hljs-title function_">e</span>(u = d, p, g, v, s[a + <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">3614090360</span>), p, g, s[a + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">3905402710</span>), d, p, s[a + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>), v, d, s[a + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">3250441966</span>), g = <span class="hljs-title function_">e</span>(g, v = <span class="hljs-title function_">e</span>(v, d = <span class="hljs-title function_">e</span>(d, p, g, v, s[a + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">4118548399</span>), p, g, s[a + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>), d, p, s[a + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2821735955</span>), v, d, s[a + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">4249261313</span>), g = <span class="hljs-title function_">e</span>(g, v = <span class="hljs-title function_">e</span>(v, d = <span class="hljs-title function_">e</span>(d, p, g, v, s[a + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>), p, g, s[a + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">2336552879</span>), d, p, s[a + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">4294925233</span>), v, d, s[a + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">2304563134</span>), g = <span class="hljs-title function_">e</span>(g, v = <span class="hljs-title function_">e</span>(v, d = <span class="hljs-title function_">e</span>(d, p, g, v, s[a + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>), p, g, s[a + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">4254626195</span>), d, p, s[a + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2792965006</span>), v, d, s[a + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, d = <span class="hljs-title function_">n</span>(d, p, g, v, s[a + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">4129170786</span>), p, g, s[a + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3225465664</span>), d, p, s[a + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>), v, d, s[a + <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3921069994</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, d = <span class="hljs-title function_">n</span>(d, p, g, v, s[a + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">3593408605</span>), p, g, s[a + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>), d, p, s[a + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">3634488961</span>), v, d, s[a + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3889429448</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, d = <span class="hljs-title function_">n</span>(d, p, g, v, s[a + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>), p, g, s[a + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3275163606</span>), d, p, s[a + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">4107603335</span>), v, d, s[a + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, d = <span class="hljs-title function_">n</span>(d, p, g, v, s[a + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">2850285829</span>), p, g, s[a + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">4243563512</span>), d, p, s[a + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>), v, d, s[a + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">2368359562</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, d = <span class="hljs-title function_">r</span>(d, p, g, v, s[a + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">4294588738</span>), p, g, s[a + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">2272392833</span>), d, p, s[a + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>), v, d, s[a + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">4259657740</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, d = <span class="hljs-title function_">r</span>(d, p, g, v, s[a + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">2763975236</span>), p, g, s[a + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>), d, p, s[a + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">4139469664</span>), v, d, s[a + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3200236656</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, d = <span class="hljs-title function_">r</span>(d, p, g, v, s[a + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>), p, g, s[a + <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3936430074</span>), d, p, s[a + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">3572445317</span>), v, d, s[a + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, d = <span class="hljs-title function_">r</span>(d, p, g, v, s[a + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">3654602809</span>), p, g, s[a + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3873151461</span>), d, p, s[a + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>), v, d, s[a + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3299628645</span>), g = <span class="hljs-title function_">i</span>(g, v = <span class="hljs-title function_">i</span>(v, d = <span class="hljs-title function_">i</span>(d, p, g, v, s[a + <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4096336452</span>), p, g, s[a + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>), d, p, s[a + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2878612391</span>), v, d, s[a + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">4237533241</span>), g = <span class="hljs-title function_">i</span>(g, v = <span class="hljs-title function_">i</span>(v, d = <span class="hljs-title function_">i</span>(d, p, g, v, s[a + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>), p, g, s[a + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">2399980690</span>), d, p, s[a + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">4293915773</span>), v, d, s[a + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">2240044497</span>), g = <span class="hljs-title function_">i</span>(g, v = <span class="hljs-title function_">i</span>(v, d = <span class="hljs-title function_">i</span>(d, p, g, v, s[a + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>), p, g, s[a + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">4264355552</span>), d, p, s[a + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2734768916</span>), v, d, s[a + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>), g = <span class="hljs-title function_">i</span>(g, v = <span class="hljs-title function_">i</span>(v, d = <span class="hljs-title function_">i</span>(d, p, g, v, s[a + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4149444226</span>), p, g, s[a + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">3174756917</span>), d, p, s[a + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>), v, d, s[a + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">3951481745</span>),<br>            d = <span class="hljs-title function_">c</span>(d, u),<br>            p = <span class="hljs-title function_">c</span>(p, l),<br>            g = <span class="hljs-title function_">c</span>(g, h),<br>            v = <span class="hljs-title function_">c</span>(v, f);<br>    <span class="hljs-keyword">return</span> (<span class="hljs-title function_">o</span>(d) + <span class="hljs-title function_">o</span>(p) + <span class="hljs-title function_">o</span>(g) + <span class="hljs-title function_">o</span>(v))[<span class="hljs-string">&#x27;toLowerCase&#x27;</span>]();<br>&#125;<br></code></pre></td></tr></table></figure><p>在接下来就剩下最后的 u l h 的计算了 , <code>u = r[&#39;$_CCDf&#39;]()</code> u其实是RSA加密，跟第一个W那里的RSA加密一模一样，把相关的函数和参数挪过来就好了， <code>$_CCIl</code> 就是aeskey</p><p><img src="/images/image-20230601115041534.png" alt="image-20230601115041534"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">te</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">e</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">65536</span> * (<span class="hljs-number">1</span> + <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;random&#x27;</span>]()) | <span class="hljs-number">0</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>)[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCIl</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">return</span> quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] &amp;&amp; !e || (quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] = <span class="hljs-title function_">te</span>()),  <span class="hljs-comment">// 如果aeskey 有 并且 e没有 返回 this[&#x27;$_EIk&#x27;][&#x27;aeskey&#x27;]</span><br>        quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>];  <span class="hljs-comment">// 如果上述是否 那就重新创建一个aeskey，从te()方法创建</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCDf</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RSAKey</span>();  <span class="hljs-comment">// 因为源码中，没有下面这一步，所以我们得手动补上设置公钥的步骤</span><br>    <span class="hljs-keyword">var</span> public_key = <span class="hljs-string">&quot;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&quot;</span><br>    rsa.<span class="hljs-title function_">setPublic</span>(public_key, <span class="hljs-string">&#x27;10001&#x27;</span>)<br><br>    <span class="hljs-keyword">var</span> t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(e));  <span class="hljs-comment">// 对aeskey进行加密</span><br>    <span class="hljs-keyword">while</span> (!t || <span class="hljs-number">256</span> !== t[<span class="hljs-string">&#x27;length&#x27;</span>])  <span class="hljs-comment">// 如果t的长度不等于256就一直加密</span><br>        t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(!<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来就是l参数了 <code>l = V[&#39;encrypt&#39;](JSON[&#39;stringify&#39;](o), r[&#39;$_CCEV&#39;]())</code> 这里就是个aes加密，和第一个w里面扣的时候一模一样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> key = t;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;0000000000000000&quot;</span>;<br><br>    key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e, key, &#123;<br>        <span class="hljs-attr">iv</span>: iv,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];<br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; i; a++) &#123;<br>        <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>        s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后  <code>h = m[&#39;$_FEE&#39;](l)</code> 这里和第一个w那里的 <code>i = $_HEf(o)</code> 处理方式一模一样，同样呢直接挪过来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HEf</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = $_HCh(e);<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HCh</span>(<span class="hljs-params">e, o</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>;<br>    o || (o = i);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)<br>            <span class="hljs-number">1</span> === $_HBw(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBw(e, r));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> c;<br>        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)<br>            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">235</span>));<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;<br>            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-string">&#x27;.&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;\u0072\u0065\u0073&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0065\u006e\u0064&quot;</span>: r<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HBw</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GJz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&#x27;</span>;<br>    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&#x27;length&#x27;</span>] ? <span class="hljs-string">&#x27;.&#x27;</span> : t[<span class="hljs-string">&#x27;charAt&#x27;</span>](e);<br>&#125;<br></code></pre></td></tr></table></figure><p>最终将代码整理一下，看一下跑出来的结果,看上去好像没什么问题，然后我们回去处理一下轨迹和滑动距离</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// t:滑动的距离 e：被加密后的轨迹 n: 滑动的时间</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_3w</span>(<span class="hljs-params">gt,challenge,s,c,t, guiji, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> l = <span class="hljs-title function_">get_l</span>(guiji,c,s)<br>    <span class="hljs-keyword">var</span> i = &#123;<br>        <span class="hljs-string">&quot;gt&quot;</span> :gt,<br>        <span class="hljs-string">&quot;challenge&quot;</span>:challenge,<br>    &#125;<br>    <span class="hljs-keyword">var</span> o = &#123;<br>        <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>        <span class="hljs-string">&#x27;userresponse&#x27;</span>: <span class="hljs-title function_">H</span>(t, i[<span class="hljs-string">&#x27;challenge&#x27;</span>]),<br>        <span class="hljs-string">&#x27;passtime&#x27;</span>: n,<br>        <span class="hljs-string">&#x27;imgload&#x27;</span>: <span class="hljs-number">21</span>,<br>        <span class="hljs-string">&#x27;aa&#x27;</span>: l,<br>        <span class="hljs-string">&#x27;ep&#x27;</span>: $_CCCP(),<br>        <span class="hljs-string">&quot;h9s9&quot;</span>: <span class="hljs-string">&quot;1816378497&quot;</span>,<br>    &#125;;<br>    <span class="hljs-comment">// i[&#x27;offline&#x27;] &amp;&amp; (o[&#x27;x&#x27;] = t),</span><br>    o[<span class="hljs-string">&#x27;rp&#x27;</span>] = <span class="hljs-title function_">X</span>(i[<span class="hljs-string">&#x27;gt&#x27;</span>] + i[<span class="hljs-string">&#x27;challenge&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">32</span>) + o[<span class="hljs-string">&#x27;passtime&#x27;</span>]);<br><br>    <span class="hljs-keyword">var</span> u = $_CCDf()  <span class="hljs-comment">// RSA加密</span><br>        , l = <span class="hljs-title function_">encrypt1</span>(<span class="hljs-title class_">JSON</span>[<span class="hljs-string">&#x27;stringify&#x27;</span>](o), $_CCIl())  <span class="hljs-comment">// AES加密</span><br>        , h = $_HEf(l)  <span class="hljs-comment">// 数据处理</span><br>        , f = &#123;<br>        <span class="hljs-string">&quot;gt&quot;</span>: i[<span class="hljs-string">&#x27;gt&#x27;</span>],<br>        <span class="hljs-string">&quot;challenge&quot;</span>: i[<span class="hljs-string">&#x27;challenge&#x27;</span>],<br>        <span class="hljs-string">&quot;lang&quot;</span>:<span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>        <span class="hljs-string">&#x27;$_BCX&#x27;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;client_type&#x27;</span>: <span class="hljs-string">&#x27;web&#x27;</span>,<br>        <span class="hljs-string">&quot;w&quot;</span>: h + u<br>    &#125;;<br>    <span class="hljs-keyword">return</span> f;<br>&#125;<br><br><span class="hljs-keyword">var</span> c = [<span class="hljs-number">12</span>, <span class="hljs-number">58</span>, <span class="hljs-number">98</span>, <span class="hljs-number">36</span>, <span class="hljs-number">43</span>, <span class="hljs-number">95</span>, <span class="hljs-number">62</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>];<br><span class="hljs-keyword">var</span> s = <span class="hljs-string">&quot;7546376a&quot;</span>;<br><span class="hljs-keyword">var</span> guiji = [<br>    [<br>        -<span class="hljs-number">24</span>,<br>        -<span class="hljs-number">23</span>,<br>        <span class="hljs-number">0</span><br>    ]<br><br>]<br><span class="hljs-keyword">var</span> gt = <span class="hljs-string">&#x27;019924a82c70bb123aae90d483087f94&#x27;</span><br><span class="hljs-keyword">var</span> challenge = <span class="hljs-string">&#x27;a2968f8eecf3aec14f1a741af0f08ad89x&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">get_3w</span>(gt,challenge,s,c,<span class="hljs-number">159</span>, guiji, <span class="hljs-number">590</span>))<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230601121140334.png" alt="image-20230601121140334"></p><h3 id="提交验证"><a href="#提交验证" class="headerlink" title="提交验证"></a>提交验证</h3><p>最后也是没有任何问题，验证成功</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 第五次请求，获取各项图片</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;is_next&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;slide3&#x27;</span>,<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;challenge&#x27;</span>: challenge,<br>    <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;https&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;protocol&#x27;</span>: <span class="hljs-string">&#x27;https://&#x27;</span>,<br>    <span class="hljs-string">&#x27;offline&#x27;</span>: <span class="hljs-string">&#x27;false&#x27;</span>,<br>    <span class="hljs-string">&#x27;product&#x27;</span>: <span class="hljs-string">&#x27;popup&#x27;</span>,<br>    <span class="hljs-string">&#x27;api_server&#x27;</span>: <span class="hljs-string">&#x27;api.geetest.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;isPC&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;autoReset&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;width&#x27;</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br><br>response = session.get(<span class="hljs-string">&#x27;https://api.geetest.com/get.php&#x27;</span>, params=params)<br><span class="hljs-comment"># print(response.text)</span><br>res_img = jsonp_data(response.text)<br>bg_url = <span class="hljs-string">&quot;https://static.geetest.com/&quot;</span> + res_img[<span class="hljs-string">&#x27;bg&#x27;</span>]<br><span class="hljs-comment"># fullbg_url = &quot;https://static.geetest.com/&quot; + res_img[&#x27;fullbg&#x27;]</span><br>slice_url = <span class="hljs-string">&quot;https://static.geetest.com/&quot;</span> + res_img[<span class="hljs-string">&#x27;slice&#x27;</span>]<br>resp = session.get(bg_url)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./imgs/bg.jpg&quot;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(resp.content)<br>resp = session.get(slice_url)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./imgs/slice.jpg&quot;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(resp.content)<br><span class="hljs-built_in">print</span>(challenge)<br>new_challenge = res_img[<span class="hljs-string">&#x27;challenge&#x27;</span>]<br><span class="hljs-built_in">print</span>(new_challenge)<br>c = res_img[<span class="hljs-string">&#x27;c&#x27;</span>]<br>s = res_img[<span class="hljs-string">&#x27;s&#x27;</span>]<br><span class="hljs-comment"># 还原图片顺序</span><br><span class="hljs-comment"># true_back(&quot;fullbg.jpg&quot;)</span><br>true_back(<span class="hljs-string">&quot;bg.jpg&quot;</span>)<br><span class="hljs-comment"># 获取滑动距离</span><br>distance = get_slice()<br><span class="hljs-built_in">print</span>(distance)<br><span class="hljs-comment"># 获取轨迹，和滑动时间</span><br>slide_track, t = get_slide_track(distance)<br><span class="hljs-comment"># console.log(get_3w(gt, challenge, s, c, 159, guiji, 590))</span><br><br><span class="hljs-built_in">print</span>(gt, new_challenge, s, c, distance, slide_track, t)<br>W3 = three_js.call(<span class="hljs-string">&#x27;get_3w&#x27;</span>, gt, new_challenge, s, c, distance, slide_track, t)<br><br><br><span class="hljs-comment"># 第六次请求，获取验证码结果</span><br>params3 = W3<br>params3[<span class="hljs-string">&#x27;callback&#x27;</span>] = <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time())<br><span class="hljs-built_in">print</span>(params3)<br>response = session.get(<span class="hljs-string">&#x27;https://api.geetest.com/ajax.php&#x27;</span>, params=params3)<br><span class="hljs-comment"># res_img = jsonp_data(response.text)</span><br><span class="hljs-built_in">print</span>(response.text)<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230601162115557.png" alt="image-20230601162115557"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 验证码 </tag>
            
            <tag> 极验 </tag>
            
            <tag> 滑块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>极验滑块验证三个W超详细解密(2)</title>
      <link href="/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/"/>
      <url>/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/</url>
      
        <content type="html"><![CDATA[<p><strong>书接上文</strong></p><h3 id="第二个w获取流程"><a href="#第二个w获取流程" class="headerlink" title="第二个w获取流程"></a>第二个w获取流程</h3><blockquote><p>第二个w也可以不用去获取，因为第二个w不涉及到验证码的获取和验证，至少现在还没有</p></blockquote><p>点击验证码，获取到如下包，一个 ajax.php 和 get.php</p><p><img src="/images%5Cimage-20230527114721325.png" alt="image-20230527114721325"></p><h4 id="4-第四个请求，携带解密后的w-用于识别验证码是否加载成功"><a href="#4-第四个请求，携带解密后的w-用于识别验证码是否加载成功" class="headerlink" title="4.第四个请求，携带解密后的w,用于识别验证码是否加载成功"></a>4.第四个请求，携带解密后的w,用于识别验证码是否加载成功</h4><blockquote><p>接口地址：<a href="https://api.geetest.com/ajax.php">https://api.geetest.com/ajax.php</a></p></blockquote><p><img src="/images/image-20230527115052238.png" alt="image-20230527115052238"></p><p><img src="/images/image-20230527115101034.png" alt="image-20230527115101034"></p><h3 id="第二个w解密流程"><a href="#第二个w解密流程" class="headerlink" title="第二个w解密流程"></a>第二个w解密流程</h3><p>第二个w要找到加密位置，需要看html页面，他是通过动态加载script标签，然后通过加载js来完成加密</p><p><img src="/images%5Cimage-20230527205716028.png" alt="image-20230527205716028"></p><p>打上断点，刷新页面,通过观察加载德script标签，发现并不是我们需要的请求，所以直接过掉</p><p><img src="/images/image-20230527205824553.png" alt="image-20230527205824553"></p><p><img src="/images/image-20230527210024419.png" alt="image-20230527210024419"></p><p>过掉所有断点后，我们再点击按钮，将验证码加载出来,这一次断点再次打上，通过观察会发现是我们要请求的接口，然后我们向上追栈</p><p><img src="/images/image-20230527210334696.png" alt="image-20230527210334696"></p><p>向上追一个栈，我们来到这个函数,我们分析一下 <code>[$_HCDk(340)]</code> 就是调用最上面的那个方法， 他传入了一个new le(f)，</p><p><img src="/images/image-20230527211333882.png" alt="image-20230527211333882"></p><p><img src="/images/image-20230527211503385.png" alt="image-20230527211503385"></p><p>往上面看,这里创建了几个参数，其中n已经包含了src，也就是在这里已经完成了w的加密，我们在上面打一下断点，看一下n在这里做了什么</p><p><img src="/images/image-20230527212047263.png" alt="image-20230527212047263"></p><p>在n下面重新打上断点后，进来发现n里面的script标签里面并没有src属性,第二步将n里面的script标签传给了r，再往下一步，发现是对s进行正则操作，我们看下s是什么,发现s就是我们想要的src,接下来 我们要找到这个s是怎么生成的了</p><p><img src="/images/image-20230527212445650.png" alt="image-20230527212445650"></p><p><img src="/images/image-20230527212626434.png" alt="image-20230527212626434"></p><p><img src="/images/image-20230527212847127.png" alt="image-20230527212847127"></p><p><img src="/images/image-20230527212939133.png" alt="image-20230527212939133"></p><p>我们在往上看，会发现s是传入进来的，我们也可以在这里打断点看一下是否是传进来就已经加密好，还是就是在这里加密的,经过测试会发现是传进来就加密好了，所以我们要去找是谁调用了这个函数，传入的第一个参数是什么，同样进行追栈</p><p><img src="/images/image-20230527213253183.png" alt="image-20230527213253183"></p><p><img src="/images/image-20230527213402609.png" alt="image-20230527213402609"></p><p>往上追一个栈之后来到这里,同样的，验证一下，发现n在进去函数c之前就已经完成了加密，所以我们追函数C的栈</p><p><img src="/../../../../imgs/image-20230527214330057.png" alt="image-20230527214330057"></p><p>就在下面，进来之后我们会发现i参数里面包含了该接口请求的所有参数包括加密的w参数，所以我们得去找一下i的来源,再往上看，D函数传入的参数包含i,同样的验证一下是否是传进来就加密好了</p><p><img src="/images/image-20230527214605844.png" alt="image-20230527214605844"></p><p><img src="/images/image-20230527214925324.png" alt="image-20230527214925324"></p><p>答案显而易见，我们再次追栈</p><p><img src="/images/image-20230527215036178.png" alt="image-20230527215036178"></p><p>来到上一个函数,继续验证,验证结果，继续朔源</p><p><img src="/images/image-20230527215519876.png" alt="image-20230527215519876"></p><p><img src="/images/image-20230527215612277.png" alt="image-20230527215612277"></p><p>发现还是传进来的，继续验证,验证完成，继续朔源</p><p><img src="/images/image-20230527215722044.png" alt="image-20230527215722044"></p><p><img src="/images/image-20230527215743104.png" alt="image-20230527215743104"></p><p><img src="/images/image-20230527215828871.png" alt="image-20230527215828871"></p><p>断点来到N的上面，我们会发现n在这里进行了组装</p><p><img src="/images/image-20230527221231133.png" alt="image-20230527221231133"></p><p><img src="/images/image-20230527221345196.png" alt="image-20230527221345196"></p><p>我们再看一下这个代码,t是this,而t[xxx(1481)] 等于我们想要的w,xxx(1481)肯定是做了混淆，但是可以肯定的是，在某一段代码里面肯定执行了，xxx(1481) &#x3D; w 的操作，xxx我们搜不到做了混淆，但是1481应该是可以搜索得到的</p><p><img src="/images/image-20230527221811251.png" alt="image-20230527221811251"></p><p>这里一共就三个，去掉本身那个，还有一个是一串数字，剩下的就只有这个符合我们的要求了，我们在这里打上断点。会发现 i[xxxx] &#x3D; w ，而i在上面, i就是this，而我们要完成的就是 <code>p[$_CGBDY(1303)](_[$_CGBDY(12)](r, i[$_CGBDY(1361)]()))</code> 的解密 </p><p><img src="/images/image-20230527222112657.png" alt="image-20230527222112657"></p><p><img src="/images/image-20230527222241640.png" alt="image-20230527222241640"></p><p><img src="/images/image-20230527222331169.png" alt="image-20230527222331169"></p><h3 id="第二个w获取流程-1"><a href="#第二个w获取流程-1" class="headerlink" title="第二个w获取流程"></a>第二个w获取流程</h3><p>我们先把w加密的这一段代码扣下来,前面五行也是跟之前一样毫无意义的循环，都是一样的值，直接删掉</p><p><img src="/images/image-20230529201246396.png" alt="image-20230529201246396"></p><p>删完之后我们来看一下这个控制流，发现会走所有的流程，所以我们直接精简一下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[$_CGBCi(<span class="hljs-number">95</span>)](e[$_CGBDY(<span class="hljs-number">73</span>)]());<br>    <span class="hljs-keyword">var</span> r = $_CGBCi(<span class="hljs-number">226</span>);<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> $_DEFIu = <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">4</span>][<span class="hljs-number">14</span>];<br>            <span class="hljs-keyword">for</span> (; $_DEFIu !== <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">8</span>][<span class="hljs-number">12</span>];) &#123;<br>                <span class="hljs-keyword">switch</span> ($_DEFIu) &#123;<br>                    <span class="hljs-keyword">case</span> <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">4</span>][<span class="hljs-number">14</span>]:<br>                        <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span><br>                            , n = e[$_CGBHd(<span class="hljs-number">54</span>)]<br>                            , r = <span class="hljs-number">0</span>;<br>                        <span class="hljs-keyword">while</span> (n--)<br>                            t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[$_CGBIC(<span class="hljs-number">94</span>)](r++);<br>                        $_DEFIu = <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">0</span>][<span class="hljs-number">13</span>];<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">case</span> <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">8</span>][<span class="hljs-number">13</span>]:<br>                        <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>                        <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[$_CGBIC(<span class="hljs-number">256</span>)]() - t[$_CGBIC(<span class="hljs-number">256</span>)]() &amp;&amp; (e = $_CGBIC(<span class="hljs-number">1474</span>)),<br>            r = $_CGBHd(<span class="hljs-number">764</span>) + i[$_CGBIC(<span class="hljs-number">1448</span>)] + $_CGBIC(<span class="hljs-number">1427</span>) + <span class="hljs-title function_">n</span>(o[$_CGBIC(<span class="hljs-number">73</span>)]() + <span class="hljs-title function_">n</span>(n[$_CGBHd(<span class="hljs-number">73</span>)]()) + <span class="hljs-title function_">n</span>(e[$_CGBHd(<span class="hljs-number">73</span>)]())) + $_CGBHd(<span class="hljs-number">1471</span>);<br>    &#125;(t[$_CGBDY(<span class="hljs-number">1440</span>)](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        i[$_CGBCi(<span class="hljs-number">1481</span>)] = p[$_CGBDY(<span class="hljs-number">1303</span>)](_[$_CGBDY(<span class="hljs-number">12</span>)](r, i[$_CGBDY(<span class="hljs-number">1361</span>)]()));<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230529202254446.png" alt="image-20230529202254446"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;toString&#x27;</span>]());<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + i[<span class="hljs-string">&#x27;$_CEG_&#x27;</span>] + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o[<span class="hljs-string">&#x27;toString&#x27;</span>]() + <span class="hljs-title function_">n</span>(n[<span class="hljs-string">&#x27;toString&#x27;</span>]()) + <span class="hljs-title function_">n</span>(e[<span class="hljs-string">&#x27;toString&#x27;</span>]())) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;<br>    (t[<span class="hljs-string">&#x27;shift&#x27;</span>](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        i[<span class="hljs-string">&#x27;$_CEEK&#x27;</span>] = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](_[<span class="hljs-string">&#x27;encrypt&#x27;</span>](r, i[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]()));<br>&#125;<br></code></pre></td></tr></table></figure><p>我们先看一下 r ,o和n视乎是现成的，就在上面，我们看下 <code>o[&#39;toString&#39;]()</code>  和 <code>n[&#39;toString&#39;]()</code>，以及 <code>e[&#39;toString&#39;]()</code> 怀疑这里是否是做了代码检测，这里的运行结果肯定是会和我们精简话后的代码运行结果不一样的，我们直接把这三个的值给写死，直接复制控制台输出出来的</p><p><img src="/images/image-20230530100647305.png" alt="image-20230530100647305"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;toString&#x27;</span>]());<br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var...&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function ...&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;bbOy&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + i[<span class="hljs-string">&#x27;$_CEG_&#x27;</span>] + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(t[<span class="hljs-string">&#x27;shift&#x27;</span>](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),i[<span class="hljs-string">&#x27;$_CEEK&#x27;</span>] = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](_[<span class="hljs-string">&#x27;encrypt&#x27;</span>](r, i[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]()));<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来 我们来找一下 <code>i[&#39;$_CEG_&#39;]</code> 是怎么生成的，源代码是<code>i[$_CGBIC(1448)]</code>，还是那个逻辑，从某个地方取值，那肯定会有从这个地方存值的操作，直接搜索1448，搜索出来的结果有三个我们直接在其它两个地方打断点</p><p><img src="/images/image-20230530101948282.png" alt="image-20230530101948282"></p><p>可以看到，在最开始的时候，做了一个赋值空字符串的操作，接下来就是一个大号的循环在循环里面做一个拼接的操作，这里一大串都是 for(;;) 也就是for循环里面的判断和自增条件，而真正的循环体只有最后一个拼接的操作</p><p><img src="/images/image-20230530103343268.png" alt="image-20230530103343268"></p><p>我们把代码复制出来，处理一下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_i</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span><br>        , e = i[<span class="hljs-string">&#x27;$_BJJF&#x27;</span>][<span class="hljs-string">&#x27;$_BIBF&#x27;</span>]()<br>        , t = i[<span class="hljs-string">&#x27;$_BJJF&#x27;</span>][<span class="hljs-string">&#x27;$_BICQ&#x27;</span>]()<br>        , n = i[<span class="hljs-string">&#x27;$_BJCr&#x27;</span>][<span class="hljs-string">&#x27;$_BICQ&#x27;</span>]()<br>        , r = i[<span class="hljs-string">&#x27;$_BDHN&#x27;</span>][<span class="hljs-string">&#x27;$_BIBF&#x27;</span>]()<br>        , o = i[<span class="hljs-string">&#x27;$_EIk&#x27;</span>]<br>        , s = $_GY() - ot;<br>    result = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = [[<span class="hljs-string">&#x27;lang&#x27;</span>, o[<span class="hljs-string">&#x27;lang&#x27;</span>] || <span class="hljs-string">&#x27;zh-cn&#x27;</span>], [<span class="hljs-string">&#x27;type&#x27;</span>, <span class="hljs-string">&#x27;fullpage&#x27;</span>], [<span class="hljs-string">&#x27;tt&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t, n</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!t || !n)<br>            <span class="hljs-keyword">return</span> e;<br>        <span class="hljs-keyword">var</span> r, o = <span class="hljs-number">0</span>, i = e, s = t[<span class="hljs-number">0</span>], a = t[<span class="hljs-number">2</span>], c = t[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">while</span> (r = n[<span class="hljs-string">&#x27;substr&#x27;</span>](o, <span class="hljs-number">2</span>)) &#123;<br>            o += <span class="hljs-number">2</span>;<br>            <span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">parseInt</span>(r, <span class="hljs-number">16</span>)<br>                , l = <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](_)<br>                , u = (s * _ * _ + a * _ + c) % e[<span class="hljs-string">&#x27;length&#x27;</span>];<br>            i = i[<span class="hljs-string">&#x27;substr&#x27;</span>](<span class="hljs-number">0</span>, u) + l + i[<span class="hljs-string">&#x27;substr&#x27;</span>](u);<br>        &#125;<br>        <span class="hljs-keyword">return</span> i;<br>    &#125;(e, o[<span class="hljs-string">&#x27;c&#x27;</span>], o[<span class="hljs-string">&#x27;s&#x27;</span>]) || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;light&#x27;</span>, r || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-title function_">V</span>(p[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](t))], [<span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-title function_">V</span>(p[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](n))], [<span class="hljs-string">&#x27;hh&#x27;</span>, <span class="hljs-title function_">V</span>(n)], [<span class="hljs-string">&#x27;hi&#x27;</span>, <span class="hljs-title function_">V</span>(i[<span class="hljs-string">&#x27;$_CCGM&#x27;</span>])], [<span class="hljs-string">&#x27;vip_order&#x27;</span>, i[<span class="hljs-string">&#x27;vip_order&#x27;</span>] || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;ct&#x27;</span>, i[<span class="hljs-string">&#x27;ct&#x27;</span>] || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;ep&#x27;</span>, i[<span class="hljs-string">&#x27;$_CEHV&#x27;</span>]() || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;passtime&#x27;</span>, s || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;rp&#x27;</span>, <span class="hljs-title function_">V</span>(o[<span class="hljs-string">&#x27;gt&#x27;</span>] + o[<span class="hljs-string">&#x27;challenge&#x27;</span>] + s)]], c = <span class="hljs-number">0</span>; c &lt; a[<span class="hljs-string">&#x27;length&#x27;</span>]; c++)<br>        result += <span class="hljs-string">&#x27;&quot;&#x27;</span> + a[c][<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;&quot;:&#x27;</span> + ge[<span class="hljs-string">&#x27;stringify&#x27;</span>](a[c][<span class="hljs-number">1</span>]) + <span class="hljs-string">&#x27;,&#x27;</span>;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>从上到下，我们先处理前面一大段赋值的操作，先看 <code>i[&#39;$_BJJF&#39;][&#39;$_BIBF&#39;]()</code>，进去打断点，我们先看一下</p><p><code>this[$_CDDIY(34)]</code> 很显然 这是一段轨迹的操作，下一段代码又将其制空，这一步操作没有意义，后面肯定是要对轨迹进行处理的，而这一段轨迹我们可以用算法生成，也可以直接复制，这一段轨迹来自于你对点击生成验证码的操作进行鼠标轨迹检测，这也就是为什么用selenium无法成功的原因</p><p><img src="/images/image-20230530113517383.png" alt="image-20230530113517383"></p><p><img src="/images/image-20230530113555853.png" alt="image-20230530113555853"></p><p>我们往下执行一步，输出一下 <code>this[$_CDDIY(917)](e)</code>,这里传递的值应该是上一步的时间差值，并没有对时时的时间进行计算，所以我们可以直接复制这个轨迹。到了这里，e参数的加密入口就处理好了，现在要解决的是 <code>this[&#39;$_BHIh&#39;](e)</code> 方法</p><p><img src="/images/image-20230530151150040.png" alt="image-20230530151150040"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BIBF_e</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> e = [<br>    [<br>        <span class="hljs-string">&quot;move&quot;</span>,<br>        <span class="hljs-number">1098</span>,<br>        <span class="hljs-number">239</span>,<br>        <span class="hljs-number">1685417642390</span>,<br>        <span class="hljs-string">&quot;pointermove&quot;</span><br>    ],<br> ..... <span class="hljs-comment">// 这里是复制的轨迹</span><br>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BHIh&#x27;</span>](e));<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来就是扣代码的环节，把没必要的给删掉，需要注意的是  <code>ce([&#39;down&#39;, &#39;move&#39;, &#39;up&#39;, &#39;scroll&#39;])[&#39;$_EHc&#39;](p)</code> 这里需要在ce的原型链上添加新的方法，需要注意</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function ce(e) &#123;<br>    this[&#x27;$_BAEJ&#x27;] = e || [];<br>&#125;<br><br>ce.prototype = &#123;<br>    &quot;$_EHc&quot;: function (e) &#123;<br>        var t = this[&#x27;$_BAEJ&#x27;];<br>        if (t[&#x27;indexOf&#x27;])<br>            return t[&#x27;indexOf&#x27;](e);<br>        for (var n = 0, r = t[&#x27;length&#x27;]; n &lt; r; n += 1)<br>            if (t[n] === e)<br>                return n;<br>        return -1;<br>    &#125;<br>&#125;<br><br><br>function $_BHHD(e) &#123;<br>    var t = 32767;<br>    return &#x27;number&#x27; != typeof e ? e : (t &lt; e ? e = t : e &lt; -t &amp;&amp; (e = -t),<br>        Math[&#x27;round&#x27;](e));<br>&#125;<br><br>function $_BHJu(e) &#123;<br>    var t = &#x27;&#x27;<br>        , n = 0;<br>    (e || [])[&#x27;length&#x27;];<br>    while (!t &amp;&amp; e[n])<br>        t = e[n] &amp;&amp; e[n][4],<br>            n++;<br>    if (!t)<br>        return e;<br>    for (var r = &#x27;&#x27;, o = [&#x27;mouse&#x27;, &#x27;touch&#x27;, &#x27;pointer&#x27;, &#x27;MSPointer&#x27;], i = 0, s = o[&#x27;length&#x27;]; i &lt; s; i++)<br>        0 === t[&#x27;indexOf&#x27;](o[i]) &amp;&amp; (r = o[i]);<br>    for (var a = e[&#x27;slice&#x27;](), c = a[&#x27;length&#x27;] - 1; 0 &lt;= c; c--) &#123;<br>        var _ = a[c]<br>            , l = _[0];<br>        if (-1 &lt; new ce([&#x27;move&#x27;, &#x27;down&#x27;, &#x27;up&#x27;])[&#x27;$_EHc&#x27;](l))<br>            0 !== (_[4] || &#x27;&#x27;)[&#x27;indexOf&#x27;](r) &amp;&amp; a[&#x27;splice&#x27;](c, 1);<br>    &#125;<br>    return a;<br>&#125;<br><br>// 处理轨迹<br>function $_BHIh(e) &#123;<br>    var t = 0<br>        , n = 0<br>        , r = []<br>        , i = 0;<br>    if (e[&#x27;length&#x27;] &lt;= 0)<br>        return [];<br>    for (var s = null, a = null, c = $_BHJu(e), _ = c[&#x27;length&#x27;], l = _ &lt; 300 ? 0 : _ - 300; l &lt; _; l += 1) &#123;<br>        var u = c[l]<br>            , p = u[0];<br>        -1 &lt; new ce([&#x27;down&#x27;, &#x27;move&#x27;, &#x27;up&#x27;, &#x27;scroll&#x27;])[&#x27;$_EHc&#x27;](p) ? (s || (s = u),<br>            a = u,<br>            r[&#x27;push&#x27;]([p, [u[1] - t, u[2] - n], $_BHHD(i ? u[3] - i : i)]),<br>            t = u[1],<br>            n = u[2],<br>            i = u[3]) : -1 &lt; new ce([&#x27;blur&#x27;, &#x27;focus&#x27;, &#x27;unload&#x27;])[&#x27;$_EHc&#x27;](p) &amp;&amp; (r[&#x27;push&#x27;]([p, $_BHHD(i ? u[1] - i : i)]),<br>            i = u[1]);<br>    &#125;<br>    // o[aa(922)] = s,o[aa(978)] = a, 两个不不需要，直接删除<br>    return r;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后运行一下 <code>this[&#39;$_BHIh&#39;](e)</code>  控制台输出和我们的运行结果一致，这个方法就解决了，现在要解决的是 <code>this[&#39;$_HDc&#39;]($_BHIh(e))</code> 方法，这个方法比较长，需要扣仔细一点</p><p><img src="/images/image-20230530155302966.png" alt="image-20230530155302966"></p><p>抠出来的代码会精简很多，极验的控制流都是假的，直接把控制流的主体部分拿出来就可以了，抠出来运行一下看一下是否和浏览器的一样,验证结果没有问题，e参数解密完成。那就回到加密入口，去看一下t参数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HDc</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> p = &#123;<br>        <span class="hljs-string">&quot;\u006d\u006f\u0076\u0065&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;\u0064\u006f\u0077\u006e&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;\u0075\u0070&quot;</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;\u0073\u0063\u0072\u006f\u006c\u006c&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;\u0066\u006f\u0063\u0075\u0073&quot;</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&quot;\u0062\u006c\u0075\u0072&quot;</span>: <span class="hljs-number">5</span>,<br>        <span class="hljs-string">&quot;\u0075\u006e\u006c\u006f\u0061\u0064&quot;</span>: <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;\u0075\u006e\u006b\u006e\u006f\u0077\u006e&quot;</span>: <span class="hljs-number">7</span><br>    &#125;;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = e[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">2</span>), r = <span class="hljs-string">&#x27;&#x27;</span>, o = n[<span class="hljs-string">&#x27;length&#x27;</span>] + <span class="hljs-number">1</span>; o &lt;= t; o += <span class="hljs-number">1</span>)<br>            r += <span class="hljs-string">&#x27;0&#x27;</span>;<br><br>        <span class="hljs-keyword">return</span> n = r + n;<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = []<br>            , n = e[<span class="hljs-string">&#x27;length&#x27;</span>]<br>            , r = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (r &lt; n) &#123;<br>            <span class="hljs-keyword">var</span> o = e[r]<br>                , i = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-number">16</span> &lt;= i)<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">var</span> s = r + i + <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span> (n &lt;= s)<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">if</span> (e[s] !== o)<br>                    <span class="hljs-keyword">break</span>;<br>                i += <span class="hljs-number">1</span>;<br>            &#125;<br>            r = r + <span class="hljs-number">1</span> + i;<br>            <span class="hljs-keyword">var</span> a = p[o];<br>            <span class="hljs-number">0</span> != i ? (t[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-number">8</span> | a),<br>                t[<span class="hljs-string">&#x27;push&#x27;</span>](i - <span class="hljs-number">1</span>)) : t[<span class="hljs-string">&#x27;push&#x27;</span>](a);<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-title function_">h</span>(<span class="hljs-number">32768</span> | n, <span class="hljs-number">16</span>), _ = <span class="hljs-string">&#x27;&#x27;</span>, l = <span class="hljs-number">0</span>, u = t[<span class="hljs-string">&#x27;length&#x27;</span>]; l &lt; u; l += <span class="hljs-number">1</span>)<br>            _ += <span class="hljs-title function_">h</span>(t[l], <span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">return</span> c + _;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = e[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            n[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">t</span>(e[r]));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">e, t</span>) &#123;<br>        e = <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">32767</span><br>                , n = (e = <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-keyword">return</span> t &lt; e ? t : e &lt; -t ? -t : e;<br>            &#125;))[<span class="hljs-string">&#x27;length&#x27;</span>]<br>                , r = <span class="hljs-number">0</span><br>                , o = [];<br>            <span class="hljs-keyword">while</span> (r &lt; n) &#123;<br>                <span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span><br>                    , s = e[r]<br>                    , a = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](s);<br>                <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (n &lt;= r + i)<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">if</span> (e[r + i] !== s)<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-number">127</span> &lt;= a || <span class="hljs-number">127</span> &lt;= i)<br>                        <span class="hljs-keyword">break</span>;<br>                    i += <span class="hljs-number">1</span>;<br>                &#125;<br>                <span class="hljs-number">1</span> &lt; i ? o[<span class="hljs-string">&#x27;push&#x27;</span>]((s &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">49152</span> : <span class="hljs-number">32768</span>) | i &lt;&lt; <span class="hljs-number">7</span> | a) : o[<span class="hljs-string">&#x27;push&#x27;</span>](s),<br>                    r += i;<br>            &#125;<br>            <span class="hljs-keyword">return</span> o;<br>        &#125;(e);<br>        <span class="hljs-keyword">var</span> n, r = [], o = [];<br>        <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;ceil&#x27;</span>](<span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e, t</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> === e ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;log&#x27;</span>](e) / <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;log&#x27;</span>](t);<br>            &#125;(<span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](e) + <span class="hljs-number">1</span>, <span class="hljs-number">16</span>));<br>            <span class="hljs-number">0</span> === t &amp;&amp; (t = <span class="hljs-number">1</span>),<br>                r[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">h</span>(t - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)),<br>                o[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">h</span>(<span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](e), <span class="hljs-number">4</span> * t));<br>        &#125;);<br>        <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>)<br>            , s = o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>);<br>        <span class="hljs-keyword">return</span> n = t ? <span class="hljs-title function_">_</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">e, t</span>) &#123;<br>            <span class="hljs-keyword">var</span> n = [];<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-title function_">t</span>(e) &amp;&amp; n[<span class="hljs-string">&#x27;push&#x27;</span>](e);<br>            &#125;),<br>                n;<br>        &#125;(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> != e &amp;&amp; e &gt;&gt; <span class="hljs-number">15</span> != <span class="hljs-number">1</span>;<br>        &#125;), <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> ? <span class="hljs-string">&#x27;1&#x27;</span> : <span class="hljs-string">&#x27;0&#x27;</span>;<br>        &#125;)[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>) : <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-title function_">h</span>(<span class="hljs-number">32768</span> | e[<span class="hljs-string">&#x27;length&#x27;</span>], <span class="hljs-number">16</span>) + i + s + n;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], n = [], r = [], o = [], i = <span class="hljs-number">0</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>]; i &lt; s; i += <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">var</span> a = e[i]<br>                , c = a[<span class="hljs-string">&#x27;length&#x27;</span>];<br>            t[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">0</span>]),<br>                n[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-number">2</span> === c ? a[<span class="hljs-number">1</span>] : a[<span class="hljs-number">2</span>]),<br>            <span class="hljs-number">3</span> === c &amp;&amp; (r[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]),<br>                o[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]));<br>        &#125;<br>        <span class="hljs-keyword">var</span> _ = <span class="hljs-title function_">f</span>(t) + <span class="hljs-title function_">g</span>(n, !<span class="hljs-number">1</span>) + <span class="hljs-title function_">g</span>(r, !<span class="hljs-number">0</span>) + <span class="hljs-title function_">g</span>(o, !<span class="hljs-number">0</span>)<br>            , l = _[<span class="hljs-string">&#x27;length&#x27;</span>];<br>        <span class="hljs-keyword">return</span> l % <span class="hljs-number">6</span> != <span class="hljs-number">0</span> &amp;&amp; (_ += <span class="hljs-title function_">h</span>(<span class="hljs-number">0</span>, <span class="hljs-number">6</span> - l % <span class="hljs-number">6</span>)),<br>            <span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;&#x27;</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>] / <span class="hljs-number">6</span>, r = <span class="hljs-number">0</span>; r &lt; n; r += <span class="hljs-number">1</span>)<br>                    t += <span class="hljs-string">&#x27;()*,-./0123456789:?@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~&#x27;</span>[<span class="hljs-string">&#x27;charAt&#x27;</span>](<span class="hljs-built_in">parseInt</span>(e[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">6</span> * r, <span class="hljs-number">6</span> * (r + <span class="hljs-number">1</span>)), <span class="hljs-number">2</span>));<br>                <span class="hljs-keyword">return</span> t;<br>            &#125;(_);<br>    &#125;(e);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230530161827587.png" alt="image-20230530161827587"></p><p><code>t = i[$_CFJHp(1378)][$_CFJHp(1419)]()</code> 我们看一下这个函数，直接看return <code>this[$_CDEDb(34)]</code> 是一个空数组，<code>this[$_CDEDb(942)]</code> 就在上面，也就是我们上一步做的轨迹加密，但是这一次它传入了一个空数组，所以这个方法我们可以这样写,验证一下，没有问题，这一步其实也可以写死</p><p><img src="/images/image-20230530162730718.png" alt="image-20230530162730718"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 参数t的加密入口</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BICQ_t</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> $_HDc([]);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230530163052621.png" alt="image-20230530163052621"></p><p>接下来看参数n  <code>n = i[$_CFJIy(1313)][$_CFJIy(1419)]()</code>,其中 <code>n[$_CEAIT(34)]</code> 其实就是上一个w里面那两个数组中包含浏览器指纹的那个，而下面的 <code>n[$_CEAHd(1374)]()</code> 就是另一个数组，所以 这两个数组都可以直接复制过来，里面的时间戳改成 <code>new Date().getTime()</code> 就好了</p><p><img src="/images/image-20230530174631647.png" alt="image-20230530174631647"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BICQ_n</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">this</span>,<br>        r = &#123;<br>    <span class="hljs-string">&quot;STYLE&quot;</span>: <span class="hljs-number">2</span>,<br>    <span class="hljs-string">&quot;SCRIPT&quot;</span>: <span class="hljs-number">6</span>,<br>    <span class="hljs-string">&quot;A&quot;</span>: <span class="hljs-number">1</span>,<br>   <br>    <span class="hljs-string">&quot;hardwareConcurrency&quot;</span>: <span class="hljs-number">16</span>,<br>    <span class="hljs-string">&quot;jsFonts&quot;</span>: <span class="hljs-string">&quot;Arial,ArialBlack,ArialNarrow,Calibri,Cambria,CambriaMath,ComicSansMS,Consolas,Courier,CourierNew,Georgia,Helvetica,Impact,LucidaConsole,LucidaSansUnicode,MicrosoftSansSerif,MSGothic,MSPGothic,MSSansSerif,MSSerif,PalatinoLinotype,SegoePrint,SegoeScript,SegoeUI,SegoeUILight,SegoeUISemibold,SegoeUISymbol,Tahoma,Times,TimesNewRoman,TrebuchetMS,Verdana,Wingdings&quot;</span>,<br>    <span class="hljs-string">&quot;mediaDevices&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(),<br>    <span class="hljs-string">&quot;touchEvent&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;performanceTiming&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;internalip&quot;</span>: -<span class="hljs-number">1</span><br>&#125;,  <span class="hljs-comment">// 浏览器指纹</span><br>        o = [];<br>    array1 = [<br>    <span class="hljs-string">&quot;textLength&quot;</span>,<br>    <span class="hljs-string">&quot;HTMLLength&quot;</span>,<br><br>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(array1)[<span class="hljs-string">&#x27;$_EAz&#x27;</span>](<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = r[e];<br>        o[<span class="hljs-string">&#x27;push&#x27;</span>](n[<span class="hljs-string">&#x27;$_BIHL&#x27;</span>](t) ? n[<span class="hljs-string">&#x27;$_BIDi&#x27;</span>] : t);&#125;),<br>        o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;magic data&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们再看一下 <code>new ce(n[$_CEAHd(1374)]())[$_CEAHd(19)]</code> 是个什么东西，ce方法 我们在前面已经扣下来了，现在我们在ce方法的原型方法上再加上一个 $_EAz方法</p><p><img src="/images/image-20230530175301839.png" alt="image-20230530175301839"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;$_EAz&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;$_BAEJ&quot;</span>];<br>        <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&quot;map&quot;</span>])<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&quot;map&quot;</span>](e));<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&quot;length&quot;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            n[r] = <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>    &#125;<br></code></pre></td></tr></table></figure><p>这下n也加密完成了，我们看一下加密结果, 没什么问题</p><p><img src="/images/image-20230530180525444.png" alt="image-20230530180525444"></p><p>接下来就看一下r参数 <code>r = i[&#39;$_BDHN&#39;][&#39;$_BIBF&#39;]()</code> ，看一下这个是什么方法，简化一下</p><p><img src="/images/image-20230530180849252.png" alt="image-20230530180849252"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span>  <span class="hljs-title function_">$_BIBF_r</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGq&#x27;</span>] || [];<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGq&#x27;</span>] = [],<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGIZ&#x27;</span>] = <span class="hljs-number">0</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGJn&#x27;</span>] = [],<br>    (y || b || w) &amp;&amp; (e = e[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)),<br>    e[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;|&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>我们先看一下 <code>this[&#39;$_BGq&#39;]</code> 是什么，这里貌似是一个固定的值, 这里也可以直接写死，</p><p><img src="/images/image-20230530183918615.png" alt="image-20230530183918615"></p><p><img src="/images/image-20230530184002052.png" alt="image-20230530184002052"></p><p>再看一下 <code>o = i[$_CFJIy(336)]</code> 参数o，发现其实是上面两个请求的返回值，所以这边也是可以直接写死的</p><p><img src="/images/image-20230530184253163.png" alt="image-20230530184253163"></p><p><img src="/images/image-20230530184337456.png" alt="image-20230530184337456"></p><p>最后一个参数 s <code>s = $_GY() - ot</code> 参数s应该是两个时间戳相减，这个差值可以随机，也可以写死，这里我们直接写死</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs javascript">, o = &#123;<br>    <span class="hljs-string">&quot;$_CAAU&quot;</span>: <span class="hljs-number">1685443121545</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;https://&quot;</span>,<br>    <span class="hljs-string">&quot;gt&quot;</span>: <span class="hljs-string">&quot;019924a82c70bb123aae90d483087f94&quot;</span>,<br>    <span class="hljs-string">&quot;challenge&quot;</span>: <span class="hljs-string">&quot;cb2ede0a2b0a27d9559714c0ce37dc5b&quot;</span>,<br>    <span class="hljs-string">&quot;offline&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;new_captcha&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;product&quot;</span>: <span class="hljs-string">&quot;popup&quot;</span>,<br>    <span class="hljs-string">&quot;width&quot;</span>: <span class="hljs-string">&quot;300px&quot;</span>,<br>    <span class="hljs-string">&quot;https&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;api_server&quot;</span>: <span class="hljs-string">&quot;api.geetest.com&quot;</span>,<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;fullpage&quot;</span>,<br>    <span class="hljs-string">&quot;static_servers&quot;</span>: [<br>        <span class="hljs-string">&quot;static.geetest.com&quot;</span>,<br>        <span class="hljs-string">&quot;dn-staticdown.qbox.me&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-string">&quot;/static/js/beeline.1.0.1.js&quot;</span>,<br>    <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-string">&quot;/static/js/voice.1.2.3.js&quot;</span>,<br>    <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-string">&quot;/static/js/click.3.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;fullpage&quot;</span>: <span class="hljs-string">&quot;/static/js/fullpage.9.1.4.js&quot;</span>,<br>    <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-string">&quot;/static/js/slide.7.9.0.js&quot;</span>,<br>    <span class="hljs-string">&quot;geetest&quot;</span>: <span class="hljs-string">&quot;/static/js/geetest.6.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;aspect_radio&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-number">103</span>,<br>        <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-number">50</span><br>    &#125;,<br>    <span class="hljs-string">&quot;cc&quot;</span>: <span class="hljs-number">16</span>,<br>    <span class="hljs-string">&quot;supportWorker&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;$_FF_&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;pt&quot;</span>: <span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-string">&quot;aeskey&quot;</span>: <span class="hljs-string">&quot;77266c508c6b7371&quot;</span>,<br>    <span class="hljs-string">&quot;theme&quot;</span>: <span class="hljs-string">&quot;wind&quot;</span>,<br>    <span class="hljs-string">&quot;theme_version&quot;</span>: <span class="hljs-string">&quot;1.5.8&quot;</span>,<br>    <span class="hljs-string">&quot;logo&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;feedback&quot;</span>: <span class="hljs-string">&quot;https://www.geetest.com/contact#report&quot;</span>,<br>    <span class="hljs-string">&quot;c&quot;</span>: [<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">58</span>,<br>        <span class="hljs-number">98</span>,<br>        <span class="hljs-number">36</span>,<br>        <span class="hljs-number">43</span>,<br>        <span class="hljs-number">95</span>,<br>        <span class="hljs-number">62</span>,<br>        <span class="hljs-number">15</span>,<br>        <span class="hljs-number">12</span><br>    ],<br>    <span class="hljs-string">&quot;s&quot;</span>: <span class="hljs-string">&quot;302a3836&quot;</span>,<br>    <span class="hljs-string">&quot;i18n_labels&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;copyright&quot;</span>: <span class="hljs-string">&quot;由极验提供技术支持&quot;</span>,<br>        <span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;网络不给力&quot;</span>,<br>        <span class="hljs-string">&quot;error_content&quot;</span>: <span class="hljs-string">&quot;请点击此处重试&quot;</span>,<br>        <span class="hljs-string">&quot;error_title&quot;</span>: <span class="hljs-string">&quot;网络超时&quot;</span>,<br>        <span class="hljs-string">&quot;fullpage&quot;</span>: <span class="hljs-string">&quot;智能检测中&quot;</span>,<br>        <span class="hljs-string">&quot;goto_cancel&quot;</span>: <span class="hljs-string">&quot;取消&quot;</span>,<br>        <span class="hljs-string">&quot;goto_confirm&quot;</span>: <span class="hljs-string">&quot;前往&quot;</span>,<br>        <span class="hljs-string">&quot;goto_homepage&quot;</span>: <span class="hljs-string">&quot;是否前往验证服务Geetest官网&quot;</span>,<br>        <span class="hljs-string">&quot;loading_content&quot;</span>: <span class="hljs-string">&quot;智能验证检测中&quot;</span>,<br>        <span class="hljs-string">&quot;next&quot;</span>: <span class="hljs-string">&quot;正在加载验证&quot;</span>,<br>        <span class="hljs-string">&quot;next_ready&quot;</span>: <span class="hljs-string">&quot;请完成验证&quot;</span>,<br>        <span class="hljs-string">&quot;read_reversed&quot;</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&quot;ready&quot;</span>: <span class="hljs-string">&quot;点击按钮进行验证&quot;</span>,<br>        <span class="hljs-string">&quot;refresh_page&quot;</span>: <span class="hljs-string">&quot;页面出现错误啦！要继续操作，请刷新此页面&quot;</span>,<br>        <span class="hljs-string">&quot;reset&quot;</span>: <span class="hljs-string">&quot;请点击重试&quot;</span>,<br>        <span class="hljs-string">&quot;success&quot;</span>: <span class="hljs-string">&quot;验证成功&quot;</span>,<br>        <span class="hljs-string">&quot;success_title&quot;</span>: <span class="hljs-string">&quot;通过验证&quot;</span><br>    &#125;<br>&#125;  <span class="hljs-comment">// 先写死</span><br>        , s = <span class="hljs-number">67777</span>; <br></code></pre></td></tr></table></figure><p>然后接着往下面看,中间这一部分就让他自己算，我们直接看下面的，直接看 V和p方法</p><p><img src="/images/image-20230530184734204.png" alt="image-20230530184734204"></p><p><img src="/images/image-20230530184755299.png" alt="image-20230530184755299"></p><p>这是p方法,精简一下, 我们把 <code>this[&#39;$_HCh&#39;]</code> 和 <code>this[&#39;$_GHz&#39;]</code> 补一下，其实这一步的操作和第一个w获取参数i的操作一模一样,正常扣代码就行</p><p><img src="/images/image-20230530195315039.png" alt="image-20230530195315039"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_HCh&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_GHz&#x27;</span>](e));<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HBw</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GJz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&#x27;</span>;<br>    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&#x27;length&#x27;</span>] ? <span class="hljs-string">&#x27;.&#x27;</span> : t[<span class="hljs-string">&#x27;charAt&#x27;</span>](e);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HCh</span>(<span class="hljs-params">e, o</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>;<br>    o || (o = i);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)<br>            <span class="hljs-number">1</span> === $_HBw(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBw(e, r));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> c;<br>        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)<br>            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">235</span>));<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;<br>            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-string">&#x27;.&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;\u0072\u0065\u0073&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0065\u006e\u0064&quot;</span>: r<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GHz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], n = <span class="hljs-number">0</span>, r = e[<span class="hljs-string">&#x27;length&#x27;</span>]; n &lt; r; n += <span class="hljs-number">1</span>)<br>        t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](n));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><p>接着 我们来扣V方法，这个V方法其实是个md5加密，我们可以导包或者直接扣也i选哪个</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">V</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">return</span> e &lt;&lt; t | e &gt;&gt;&gt; <span class="hljs-number">32</span> - t;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">var</span> n, r, o, i, a;<br>        <span class="hljs-keyword">return</span> o = <span class="hljs-number">2147483648</span> &amp; e,<br>        i = <span class="hljs-number">2147483648</span> &amp; t,<br>        a = (<span class="hljs-number">1073741823</span> &amp; e) + (<span class="hljs-number">1073741823</span> &amp; t),<br>        (n = <span class="hljs-number">1073741824</span> &amp; e) &amp; (r = <span class="hljs-number">1073741824</span> &amp; t) ? <span class="hljs-number">2147483648</span> ^ a ^ o ^ i : n | r ? <span class="hljs-number">1073741824</span> &amp; a ? <span class="hljs-number">3221225472</span> ^ a ^ o ^ i : <span class="hljs-number">1073741824</span> ^ a ^ o ^ i : a ^ o ^ i;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">t</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; t | ~e &amp; n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; n | t &amp; ~n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e ^ t ^ n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t ^ (e | ~n);<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">i</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt;= <span class="hljs-number">3</span>; t++)<br>            n += (r = <span class="hljs-string">&#x27;0&#x27;</span> + (e &gt;&gt;&gt; <span class="hljs-number">8</span> * t &amp; <span class="hljs-number">255</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>))[<span class="hljs-string">&#x27;substr&#x27;</span>](r[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;<br>    <span class="hljs-keyword">var</span> a, s, l, _, f, p, h, d, g, v;<br>    <span class="hljs-keyword">for</span> (a = <span class="hljs-keyword">function</span> <span class="hljs-title function_">m</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = n + <span class="hljs-number">8</span>, o = <span class="hljs-number">16</span> * (<span class="hljs-number">1</span> + (r - r % <span class="hljs-number">64</span>) / <span class="hljs-number">64</span>), i = <span class="hljs-title class_">Array</span>(o - <span class="hljs-number">1</span>), a = <span class="hljs-number">0</span>, s = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (s &lt; n)<br>            a = s % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>            i[t = (s - s % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = i[t] | e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](s) &lt;&lt; a,<br>            s++;<br>        <span class="hljs-keyword">return</span> a = s % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>        i[t = (s - s % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = i[t] | <span class="hljs-number">128</span> &lt;&lt; a,<br>        i[o - <span class="hljs-number">2</span>] = n &lt;&lt; <span class="hljs-number">3</span>,<br>        i[o - <span class="hljs-number">1</span>] = n &gt;&gt;&gt; <span class="hljs-number">29</span>,<br>        i;<br>    &#125;(e = <span class="hljs-keyword">function</span> <span class="hljs-title function_">w</span>(<span class="hljs-params">e</span>) &#123;<br>        e = e[<span class="hljs-string">&#x27;replace&#x27;</span>](<span class="hljs-regexp">/\r\n/g</span>, <span class="hljs-string">&#x27;\n&#x27;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;&#x27;</span>, n = <span class="hljs-number">0</span>; n &lt; e[<span class="hljs-string">&#x27;length&#x27;</span>]; n++) &#123;<br>            <span class="hljs-keyword">var</span> r = e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](n);<br>            r &lt; <span class="hljs-number">128</span> ? t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r) : (<span class="hljs-number">127</span> &lt; r &amp;&amp; r &lt; <span class="hljs-number">2048</span> ? t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> | <span class="hljs-number">192</span>) : (t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">12</span> | <span class="hljs-number">224</span>),<br>            t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>)),<br>            t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](<span class="hljs-number">63</span> &amp; r | <span class="hljs-number">128</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> t;<br>    &#125;(e)),<br>    h = <span class="hljs-number">1732584193</span>,<br>    d = <span class="hljs-number">4023233417</span>,<br>    g = <span class="hljs-number">2562383102</span>,<br>    v = <span class="hljs-number">271733878</span>,<br>    s = <span class="hljs-number">0</span>; s &lt; a[<span class="hljs-string">&#x27;length&#x27;</span>]; s += <span class="hljs-number">16</span>)<br>        d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(_ = d, g = <span class="hljs-title function_">t</span>(f = g, v = <span class="hljs-title function_">t</span>(p = v, h = <span class="hljs-title function_">t</span>(l = h, d, g, v, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">3614090360</span>), d, g, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">3905402710</span>), h, d, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>), v, h, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">3250441966</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">4118548399</span>), d, g, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>), h, d, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2821735955</span>), v, h, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">4249261313</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>), d, g, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">2336552879</span>), h, d, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">4294925233</span>), v, h, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">2304563134</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>), d, g, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">4254626195</span>), h, d, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2792965006</span>), v, h, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">4129170786</span>), d, g, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3225465664</span>), h, d, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>), v, h, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3921069994</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">3593408605</span>), d, g, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>), h, d, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">3634488961</span>), v, h, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3889429448</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>), d, g, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3275163606</span>), h, d, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">4107603335</span>), v, h, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">2850285829</span>), d, g, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">4243563512</span>), h, d, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>), v, h, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">2368359562</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">4294588738</span>), d, g, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">2272392833</span>), h, d, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>), v, h, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">4259657740</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">2763975236</span>), d, g, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>), h, d, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">4139469664</span>), v, h, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3200236656</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>), d, g, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3936430074</span>), h, d, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">3572445317</span>), v, h, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">3654602809</span>), d, g, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3873151461</span>), h, d, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>), v, h, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3299628645</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4096336452</span>), d, g, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>), h, d, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2878612391</span>), v, h, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">4237533241</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>), d, g, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">2399980690</span>), h, d, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">4293915773</span>), v, h, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">2240044497</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>), d, g, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">4264355552</span>), h, d, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2734768916</span>), v, h, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4149444226</span>), d, g, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">3174756917</span>), h, d, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>), v, h, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">3951481745</span>),<br>        h = <span class="hljs-title function_">u</span>(h, l),<br>        d = <span class="hljs-title function_">u</span>(d, _),<br>        g = <span class="hljs-title function_">u</span>(g, f),<br>        v = <span class="hljs-title function_">u</span>(v, p);<br>    <span class="hljs-keyword">return</span> (<span class="hljs-title function_">i</span>(h) + <span class="hljs-title function_">i</span>(d) + <span class="hljs-title function_">i</span>(g) + <span class="hljs-title function_">i</span>(v))[<span class="hljs-string">&#x27;toLowerCase&#x27;</span>]();<br><br>&#125;<br></code></pre></td></tr></table></figure><p>接着 我们把后面的一些参数补起来</p><p><img src="/images/image-20230530201940323.png" alt="image-20230530201940323"></p><p><code>i[&#39;$_CCGM&#39;]</code> 是第一个w里面算的指纹，我们直接把它给拿过来，这里可能会有问题，因为如果我们拿第一个w里面指纹生成的方式，就相当于是重新生成的，而这里应该是拿上一次的指纹</p><p><img src="/images/image-20230530202325058.png" alt="image-20230530202325058"></p><p>接着来看 <code>i[&#39;$_CEHV&#39;]()</code>，看一下ren的值，搜一下，这里有可能是GPU的信息，这里应该也是指纹信息,fp和lp这里有两个时间戳，有可能又是检测鼠标移动，我们可以把一个值设定成当前时间，另一个值把这两个值得差值给加上，而下面的tm的值，我们也算和当前时间的时间差，完成是这样的</p><p><img src="/images/image-20230530205438042.png" alt="image-20230530205438042"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();<br>$_CEHV = &#123;<br>    <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;9.1.4&quot;</span>,<br>    <span class="hljs-string">&quot;te&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;$_BBy&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;ven&quot;</span>: <span class="hljs-string">&quot;Google Inc. (Google)&quot;</span>,<br>    <span class="hljs-string">&quot;ren&quot;</span>: <span class="hljs-string">&quot;ANGLE (Google, Vulkan 1.3.0 (SwiftShader Device (Subzero) (0x0000C0DE)), SwiftShader driver)&quot;</span>,<br>    <span class="hljs-string">&quot;fp&quot;</span>: [<br>        <span class="hljs-string">&quot;move&quot;</span>,<br>        <span class="hljs-number">413</span>,<br>        <span class="hljs-number">59</span>,<br>        now,<br>        <span class="hljs-string">&quot;pointermove&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;lp&quot;</span>: [<br>        <span class="hljs-string">&quot;up&quot;</span>,<br>        <span class="hljs-number">224</span>,<br>        <span class="hljs-number">303</span>,<br>        now + <span class="hljs-number">992</span>,<br>        <span class="hljs-string">&quot;pointerup&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;em&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;ph&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;cp&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;ek&quot;</span>: <span class="hljs-string">&quot;11&quot;</span>,<br>        <span class="hljs-string">&quot;wd&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;nt&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;si&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;sc&quot;</span>: <span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-string">&quot;tm&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;a&quot;</span>: now - <span class="hljs-number">2367</span>,<br>        <span class="hljs-string">&quot;b&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;c&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;e&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;f&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span>,<br>        <span class="hljs-string">&quot;g&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&quot;h&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;i&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;j&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;k&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-string">&quot;l&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;m&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span>,<br>        <span class="hljs-string">&quot;n&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;o&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span>,<br>        <span class="hljs-string">&quot;p&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;q&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;r&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span>,<br>        <span class="hljs-string">&quot;s&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;t&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;u&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span><br>    &#125;,<br>    <span class="hljs-string">&quot;dnf&quot;</span>: <span class="hljs-string">&quot;dnf&quot;</span>,<br>    <span class="hljs-string">&quot;by&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure><p>o参数里面没用的参数可以删掉，后面还有个 <code>ge[&#39;stringify&#39;]</code> ，这个和第一个w里面一样，这里就是个json,stringify，然后运行一下，看上去好像没什么问题，我们回到最开始的加密入口,看下r值能不能获取到,这样r也能获取到，接下来就是加密算法的部分了</p><p><img src="/images/image-20230530211649323.png" alt="image-20230530211649323"></p><p><img src="/images/image-20230530212158586.png" alt="image-20230530212158586"></p><p>最后一段 <code>return p[&#39;$_HEf&#39;](_[&#39;encrypt&#39;](r, i[&#39;$_CCIl&#39;]()))</code> 我们将断点打到下面来,然后去看一下 <code>i[$_CGBDY(1361)]</code>  是什么, 点进去之后能很明显的看到 又是判断aeskey是否存在，不存在就生成，如果存在就直接返回，那么我们可以直接用上一次加密的aeskey，而这里应该要的就是上一次生成的aeskey，而不是重新生成，那么我们就需要通过传参获取上一次的aeskey</p><p><img src="/images/image-20230530212500902.png" alt="image-20230530212500902"></p><p><img src="/images/image-20230530212601815.png" alt="image-20230530212601815"></p><p>我们直接把第一次w加密的aes算法拿过来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> key = t;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;0000000000000000&quot;</span>;<br><br>    key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e, key, &#123;<br>        <span class="hljs-attr">iv</span>: iv,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];<br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; i; a++) &#123;<br>        <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>        s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来 <code>p[&#39;$_HEf&#39;]</code> 的操作也是和第一w生成时 <code>$_HEf(o)</code> 的操作一样，所以我们也可以直接拿过来，最后我们将浏览器中的aeskey拿过来，测试一下, 没什么问题，我们再将代码整理一下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">aeskey</span>) &#123;  <span class="hljs-comment">// 通过传参获取上一次加密的aeskey</span><br>    <span class="hljs-comment">// t[&#x27;push&#x27;](e[&#x27;toString&#x27;]());</span><br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var $_CGBHd=VIPVz.$_CG,$_CGBGV=[&#x27;$_CGCAl&#x27;].concat($_CGBHd),$_CGBIC=$_CGBGV[1];$_CGBGV.shift();var $_CGBJu=$_CGBGV[0];function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;100&lt;new Date()[$_CGBIC(256)]()-t[$_CGBIC(256)]()&amp;&amp;(e=$_CGBIC(1474)),r=$_CGBHd(764)+i[$_CGBIC(1448)]+$_CGBIC(1427)+n(o[$_CGBIC(73)]()+n(n[$_CGBHd(73)]())+n(e[$_CGBHd(73)]()))+$_CGBHd(1471);&#125;&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;bbOy&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br><br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + <span class="hljs-title function_">get_i</span>() + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(<span class="hljs-string">&#x27;bbOy&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><br>    <span class="hljs-keyword">return</span> $_HEf(<span class="hljs-title function_">encrypt1</span>(r, aeskey));<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">second_w</span>(<span class="hljs-string">&quot;691f5ba419b5614f&quot;</span>))<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230530214145454.png" alt="image-20230530214145454"></p><p>我们修改一下第一个w生成的结果，将里面的指纹信息和aeskey一起返回出来</p><p><img src="/images/image-20230530215924185.png" alt="image-20230530215924185"></p><p>我们前面的o参数里面，还有一个s的值，该值是从上一个请求结果里面获取的,我们还需要把它给拿过来</p><p><img src="/images/image-20230530220559036.png" alt="image-20230530220559036"></p><p><img src="/images/image-20230530220643792.png" alt="image-20230530220643792"></p><p>这段指纹呢，我们也直接用上一次加密完成的</p><p><img src="/images/image-20230530222043837.png" alt="image-20230530222043837"></p><p>最终的结果也是没有问题,</p><p><img src="/images/image-20230530223855182.png" alt="image-20230530223855182"></p><p>python代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> execjs<br><span class="hljs-keyword">import</span> requests<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1..js&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>first_js = execjs.<span class="hljs-built_in">compile</span>(f.read())<br>f2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;2...js&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>second_js = execjs.<span class="hljs-built_in">compile</span>(f2.read())<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">jsonp_data</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-comment"># jsonp_re = re.compile(r&quot;\((?P&lt;code&gt;.*)\)&quot;, re.S)</span><br>    <span class="hljs-comment"># jsonp_str = jsonp_re.search(text, re.S).group(&quot;code&quot;)</span><br>    <span class="hljs-comment"># return json.loads(jsonp_str)</span><br>    jsonp_re = re.findall(<span class="hljs-string">r&quot;\((.*)\)&quot;</span>, text)<br>    <span class="hljs-keyword">return</span> json.loads(jsonp_re[<span class="hljs-number">0</span>])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_time</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)<br><br><br>session = requests.session()<br>headers = &#123;<br>    <span class="hljs-string">&#x27;authority&#x27;</span>: <span class="hljs-string">&#x27;www.geetest.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept-language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,<br>    <span class="hljs-string">&#x27;cache-control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-comment"># &#x27;cookie&#x27;: &#x27;461cca3146ff093d059dee9439aa6b26=6eee86d2-3925-4a45-9ad3-cf28de229505&#x27;,</span><br>    <span class="hljs-string">&#x27;pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-string">&#x27;referer&#x27;</span>: <span class="hljs-string">&#x27;https://www.geetest.com/demo/slide-popup.html&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua&#x27;</span>: <span class="hljs-string">&#x27;&quot;Microsoft Edge&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not-A.Brand&quot;;v=&quot;24&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="hljs-string">&#x27;?0&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="hljs-string">&#x27;&quot;Windows&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-mode&#x27;</span>: <span class="hljs-string">&#x27;cors&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>    <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.50&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-requested-with&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span>,<br>&#125;<br><br>params = &#123;<br>    <span class="hljs-string">&#x27;t&#x27;</span>: get_time(),<br>&#125;<br><span class="hljs-comment"># 第一个请求，用于注册验证码,获取贯穿始终的gt</span><br>register_res = session.get(<span class="hljs-string">&#x27;https://www.geetest.com/demo/gt/register-slide&#x27;</span>, params=params, headers=headers).json()<br>challenge = register_res[<span class="hljs-string">&#x27;challenge&#x27;</span>]<br>gt = register_res[<span class="hljs-string">&#x27;gt&#x27;</span>]<br><br><span class="hljs-comment"># 第二个请求，用于返回加载验证码的js</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br>load_res = session.get(<span class="hljs-string">&#x27;https://apiv6.geetest.com/gettype.php&#x27;</span>, params=params, headers=headers)<br><br><span class="hljs-comment"># 第三个请求，需要解密第一个w，该请求同样也是为了加载验证码</span><br><br>params_dict = first_js.call(<span class="hljs-string">&#x27;cul_first_w&#x27;</span>, gt, challenge)<br><br>load_res2 = session.get(<br>    <span class="hljs-string">&#x27;https://apiv6.geetest.com/get.php&#x27;</span>, headers=headers, params=params_dict[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>)<br><span class="hljs-comment"># 获取到第一个w里面返回的各种值，然后放到第二个w里面进行参与加密</span><br>aeskey = params_dict[<span class="hljs-string">&#x27;aeskey&#x27;</span>]<br>finger_print = params_dict[<span class="hljs-string">&#x27;finger_print&#x27;</span>]<br>sec = jsonp_data(load_res2.text)[<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-string">&#x27;s&#x27;</span>]<br><br>W = second_js.call(<span class="hljs-string">&#x27;second_w&#x27;</span>, aeskey, gt, challenge, sec, finger_print)<br><span class="hljs-comment"># print(W)</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;challenge&#x27;</span>: challenge,<br>    <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;pt&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;client_type&#x27;</span>: <span class="hljs-string">&#x27;web&#x27;</span>,<br>    <span class="hljs-string">&#x27;w&#x27;</span>: W,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br><span class="hljs-comment"># 第四次请求，需要解密第二个w,同样用于加载验证码</span><br>load_res3 = session.get(<br>    <span class="hljs-string">&#x27;https://api.geetest.com/ajax.php&#x27;</span>, headers=headers, params=params<br>)<br><span class="hljs-built_in">print</span>(load_res3.text)<br></code></pre></td></tr></table></figure><p>js代码太长了，这里只给出入口的js代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">aeskey,gt,challenge,sec,finger_print</span>) &#123;  <span class="hljs-comment">// 通过传参获取上一次加密的aeskey</span><br>    <span class="hljs-comment">// t[&#x27;push&#x27;](e[&#x27;toString&#x27;]());</span><br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var $_CGBHd=VIPVz.$_CG,$_CGBGV=[&#x27;$_CGCAl&#x27;].concat($_CGBHd),$_CGBIC=$_CGBGV[1];$_CGBGV.shift();var $_CGBJu=$_CGBGV[0];function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;100&lt;new Date()[$_CGBIC(256)]()-t[$_CGBIC(256)]()&amp;&amp;(e=$_CGBIC(1474)),r=$_CGBHd(764)+i[$_CGBIC(1448)]+$_CGBIC(1427)+n(o[$_CGBIC(73)]()+n(n[$_CGBHd(73)]())+n(e[$_CGBHd(73)]()))+$_CGBHd(1471);&#125;&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;qwe&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// 100 &lt; new Date()[&#x27;getTime&#x27;]() - t[&#x27;getTime&#x27;]() &amp;&amp; (e = &#x27;qwe&#x27;),</span><br>       r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + <span class="hljs-title function_">get_i</span>(gt,challenge,sec,finger_print) + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(<span class="hljs-string">&#x27;bbOy&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><br>    <span class="hljs-keyword">return</span> $_HEf(<span class="hljs-title function_">encrypt1</span>(r, aeskey));<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 验证码 </tag>
            
            <tag> 极验 </tag>
            
            <tag> 滑块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>极验滑块验证三个W超详细解密(1)</title>
      <link href="/2023/03/04/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-1/"/>
      <url>/2023/03/04/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://www.geetest.com/demo/slide-popup.html">滑动模式 (geetest.com)</a></p></blockquote><h3 id="验证码运行流程"><a href="#验证码运行流程" class="headerlink" title="验证码运行流程"></a>验证码运行流程</h3><ul><li>浏览器向极验服务器索要各项数据，极验服务器返回各种数据完成验证码加载</li><li>用户滑动后，各项滑动的参数也会发送给极验服务器，返回成功或者失败的状态</li><li>然后客户端带着成功或者失败的状态发给商家的服务器，然后商家的服务器会去找极验验证是否是正常</li></ul><h3 id="抓包分析"><a href="#抓包分析" class="headerlink" title="抓包分析"></a>抓包分析</h3><p>刷新页面,第一个html文件不用管</p><p><img src="/images/image-20230527110525991.png" alt="image-20230527110525991"></p><p>gt.js, 因为涉及到跨域的问题，该文件就是用来解决跨域问题</p><p><img src="/images/image-20230526154505161.png" alt="image-20230526154505161"></p><p>第一个包，发送第一个请求,浏览器向极验进行请求注册一个验证码,返回的两个参数将贯穿始终，因为这是用来验证是哪次请求，哪个验证码</p><p><img src="/images/image-20230526154640690.png" alt="image-20230526154640690"></p><p><img src="/images/image-20230526154726592.png" alt="image-20230526154726592"></p><p>第二个包  该请求携带上述返回的两个参数，用于获取验证码类型，返回的数据用于加载浏览器中的验证码</p><p><img src="/images/image-20230526154835093.png" alt="image-20230526154835093"></p><p><img src="/images/image-20230526154906554.png" alt="image-20230526154906554"></p><p>第三个包 接下来该请求携带第一个加密的w，返回的数据没有意义，但是同样用于加载验证码</p><p><img src="/images/image-20230526155044753.png" alt="image-20230526155044753"></p><p><img src="/images/image-20230526155145308.png" alt="image-20230526155145308"></p><p>第四个包 点击验证码后，加载了一大堆东西，该接口同样携带w，有点类似上面的get,该接口返回的数据看上去没有任何意义</p><p><img src="/images/image-20230526155407506.png" alt="image-20230526155407506"></p><p><img src="/images/image-20230526155509500.png" alt="image-20230526155509500"></p><p>第五个包 接下来又有一个请求,该请求携带的参数似乎未加密，该接口返回的数据包含三张图，一张完整背景，一张滑块，一张带缺口的背景图</p><p><img src="/images/image-20230526155607145.png" alt="image-20230526155607145"></p><p><img src="/images/image-20230526155638531.png" alt="image-20230526155638531"></p><p>通过测试，需要发送五次请求才能获得验证码图片,滑动滑块，</p><p>第六个包 最后一个请求，验证验证码是否正确，该参数也是最后一个w,该接口验证成功后会返回一个值，用于确定是否验证正确</p><p><img src="/images/image-20230526155857858.png" alt="image-20230526155857858"></p><p><img src="/images/image-20230526160021683.png" alt="image-20230526160021683"></p><h3 id="第一个w获取流程"><a href="#第一个w获取流程" class="headerlink" title="第一个w获取流程"></a>第一个w获取流程</h3><p>以上就是极验验证码 从加载到验证的全部过程，接下来开始进行代码获取</p><h4 id="1-发送第一个请求，注册验证码，返回gt和challenge"><a href="#1-发送第一个请求，注册验证码，返回gt和challenge" class="headerlink" title="1.发送第一个请求，注册验证码，返回gt和challenge"></a>1.发送第一个请求，注册验证码，返回gt和challenge</h4><p>接口地址:<a href="https://www.geetest.com/demo/gt/register-slide">https://www.geetest.com/demo/gt/register-slide</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_time</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)<br><br>session = requests.session()<br>headers = &#123;<br>    <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.50&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-requested-with&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span>,<br>&#125;<br><br>params = &#123;<br>    <span class="hljs-string">&#x27;t&#x27;</span>: get_time(),<br>&#125;<br><span class="hljs-comment"># 第一个请求，用于注册验证码,获取贯穿始终的gt</span><br>response = session.get(<span class="hljs-string">&#x27;https://www.geetest.com/demo/gt/register-slide&#x27;</span>, params=params, headers=headers).json()<br>challenge = response[<span class="hljs-string">&#x27;challenge&#x27;</span>]<br>gt = response[<span class="hljs-string">&#x27;gt&#x27;</span>]<br></code></pre></td></tr></table></figure><h4 id="2-第二个请求，用于返回加载验证码的js"><a href="#2-第二个请求，用于返回加载验证码的js" class="headerlink" title="2.第二个请求，用于返回加载验证码的js"></a>2.第二个请求，用于返回加载验证码的js</h4><p>接口地址：<a href="https://apiv6.geetest.com/gettype.php">https://apiv6.geetest.com/gettype.php</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 第二个请求，用于返回加载验证码的js</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br>load_res = session.get(<span class="hljs-string">&#x27;https://apiv6.geetest.com/gettype.php&#x27;</span>, params=params, headers=headers)<br><br></code></pre></td></tr></table></figure><h4 id="3-第三个请求，携带解密后的w参数"><a href="#3-第三个请求，携带解密后的w参数" class="headerlink" title="3.第三个请求，携带解密后的w参数"></a>3.第三个请求，携带解密后的w参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">params = first_js.call(<span class="hljs-string">&#x27;cul_first_w&#x27;</span>, gt, challenge)<br><br>load_res2 = requests.get(<br>    <span class="hljs-string">&#x27;https://apiv6.geetest.com/get.php&#x27;</span>, headers=headers, params=params<br>)<br><span class="hljs-built_in">print</span>(load_res2.text)<br></code></pre></td></tr></table></figure><h3 id="第一个w解密流程"><a href="#第一个w解密流程" class="headerlink" title="第一个w解密流程"></a>第一个w解密流程</h3><blockquote><p>第一个w是不参与验证码获取和验证流程的，所以第一个w可以不用解析，但这里还是做了解析</p></blockquote><h4 id="加密入口"><a href="#加密入口" class="headerlink" title="加密入口"></a>加密入口</h4><p>查看js代码，发现所有的js代码，都是进行了Unicode编码，所以，我们搜索”\u0077”,正常只能搜到一个，搜到其他的是因为代码进行了格式化，所以搜到了好多条</p><p><img src="/images/image-20230526161535812.png" alt="image-20230526161535812"></p><p><img src="/images/image-20230526161653804.png" alt="image-20230526161653804"></p><p>点击进去后搜索得到三个w, 对所有w进行打上断点</p><p><img src="/images/image-20230526161913334.png" alt="image-20230526161913334"></p><p><img src="/images/image-20230526162012696.png" alt="image-20230526162012696"></p><p><img src="/images/image-20230526162037113.png" alt="image-20230526162037113"></p><p>刷新页面，断在了7907行，我们将该行代码扣下来解析一下，w是i + r构成</p><p><img src="/images/image-20230526162204617.png" alt="image-20230526162204617"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> r = t[<span class="hljs-string">&quot;$_CCHF&quot;</span>]()<br>, o = $_BFZ()[<span class="hljs-string">&quot;encrypt1&quot;</span>](ge[<span class="hljs-string">&quot;stringify&quot;</span>](t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>]), t[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]())<br>, i = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](o),<br>s = &#123;<br><span class="hljs-string">&#x27;gt&#x27;</span>: t[$_CEIHW(<span class="hljs-number">321</span>)][$_CEIHW(<span class="hljs-number">300</span>)],<br><span class="hljs-string">&#x27;challenge&#x27;</span>: t[$_CEIIU(<span class="hljs-number">321</span>)][$_CEIIU(<span class="hljs-number">377</span>)],<br><span class="hljs-string">&#x27;lang&#x27;</span>: n[$_CEIHW(<span class="hljs-number">250</span>)],<br><span class="hljs-string">&#x27;pt&#x27;</span>: t[$_CEIHW(<span class="hljs-number">1391</span>)],<br><span class="hljs-string">&#x27;client_type&#x27;</span>: t[$_CEIIU(<span class="hljs-number">1352</span>)],<br><span class="hljs-string">&#x27;w&#x27;</span>: i + r<br>&#125;; <br></code></pre></td></tr></table></figure><p>我们往上看一下,这三个参数都是数组，其功能有点类似于数组混淆，第一个参数等于第三个参数，然后第四行代码，将第一个参数去除，然后把第一个参数赋值给第五行，前五行的四个参数全部相同</p><p><img src="/images/image-20230526163240201.png" alt="image-20230526163240201"></p><p>所以 我们在扣取这一段代码的时候，为了方便，可以在控制台将其中一个赋值给window下的一个变量，这样可以快速复制，快速替换</p><p><img src="/images/image-20230526164153081.png" alt="image-20230526164153081"></p><p>这一段处理后最终的结果, 大致的意思是，把一段类似于浏览器指纹一样的数据加密后得到一个数组，然后在进行加密得到最终的w参数，这个跟浏览器指纹一样的东西，其实可以固定写死，只要更改时间戳就好了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span><br>        , n = t[<span class="hljs-string">&#x27;$_EIk&#x27;</span>];<br>    <span class="hljs-comment">// if (!n[&#x27;gt&#x27;] || !n[&#x27;challenge&#x27;]) // 这一段可以注释掉，因为一定有gt</span><br>    <span class="hljs-comment">//     return U(j(&#x27;config_lack&#x27;, t));</span><br>    <span class="hljs-keyword">var</span> e = t[<span class="hljs-string">&#x27;$_BJCr&#x27;</span>][<span class="hljs-string">&#x27;$_BIBF&#x27;</span>]();  <span class="hljs-comment">// 检测浏览器数据，类似于浏览器指纹</span><br>    t[<span class="hljs-string">&#x27;$_CCGM&#x27;</span>] = e,<br>        t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;cc&#x27;</span>] = n[<span class="hljs-string">&#x27;cc&#x27;</span>],<br>        t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;ww&#x27;</span>] = n[<span class="hljs-string">&#x27;supportWorker&#x27;</span>],<br>        t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;i&#x27;</span>] = e;<br>    <span class="hljs-keyword">var</span> r = t[<span class="hljs-string">&quot;$_CCHF&quot;</span>]()<br>        <span class="hljs-comment">// gt是json.stringify , o的结果是一个数组</span><br>        <span class="hljs-comment">// , o = $_BFZ()[&quot;encrypt1&quot;](ge[&quot;stringify&quot;](t[&#x27;$_EJi&#x27;]), t[&#x27;$_CCIl&#x27;]())</span><br>        , o = $_BFZ()[<span class="hljs-string">&quot;encrypt1&quot;</span>](<span class="hljs-title class_">JSON</span>[<span class="hljs-string">&quot;stringify&quot;</span>](t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>]), t[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]())<br>        , i = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](o),<br>        s = &#123;<br>            <span class="hljs-string">&#x27;gt&#x27;</span>: t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;gt&#x27;</span>],<br>            <span class="hljs-string">&#x27;challenge&#x27;</span>: t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;challenge&#x27;</span>],<br>            <span class="hljs-string">&#x27;lang&#x27;</span>: n[<span class="hljs-string">&#x27;lang&#x27;</span>],<br>            <span class="hljs-string">&#x27;pt&#x27;</span>: t[<span class="hljs-string">&#x27;$_BJGr&#x27;</span>],<br>            <span class="hljs-string">&#x27;client_type&#x27;</span>: t[<span class="hljs-string">&#x27;$_BJH_&#x27;</span>],<br>            <span class="hljs-string">&#x27;w&#x27;</span>: i + r<br>        &#125;;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230526170259562.png" alt="image-20230526170259562"></p><h4 id="获取浏览器指纹"><a href="#获取浏览器指纹" class="headerlink" title="获取浏览器指纹"></a>获取浏览器指纹</h4><p>解决第一个  <code>e = t[&#39;$_BJCr&#39;][&#39;$_BIBF&#39;]()</code>,整体扣下来大概是这个样子的，接下来看ce的代码,ce的代码很坑，我们需要先理清逻辑在扣代码，看上去像是一个循环，但实际上经过判断后，只走一次，所以我们可以把循环体拿出来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BIBF</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">this</span><br>      , r = &#123;<br>    <span class="hljs-string">&quot;internalip&quot;</span>: -<span class="hljs-number">1</span><br>&#125;;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">BJAm</span> = [<br>]<br>    r[<span class="hljs-string">&#x27;timestamp&#x27;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>](),<br>    r[<span class="hljs-string">&#x27;touchEvent&#x27;</span>] = -<span class="hljs-number">1</span>,<br>    r[<span class="hljs-string">&#x27;performanceTiming&#x27;</span>] = -<span class="hljs-number">1</span>,<br>    r[<span class="hljs-string">&#x27;internalip&#x27;</span>] = -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> o = [];<br>    <span class="hljs-comment">// 需要先扣取ce方法，然后还要扣取ce的$_EAz方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-title class_">BJAm</span>)[<span class="hljs-string">&#x27;$_EAz&#x27;</span>](<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = r[e];<br>        o[<span class="hljs-string">&#x27;push&#x27;</span>](n[<span class="hljs-string">&#x27;$_BIHL&#x27;</span>](t) ? n[<span class="hljs-string">&#x27;$_BIDi&#x27;</span>] : t);<br>    &#125;),<br>    o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;!!&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ce</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-comment">// var $_DEBCK = VIPVz.$_Ds()[0][14];</span><br>    <span class="hljs-comment">// for (; $_DEBCK !== VIPVz.$_Ds()[0][13]; ) &#123;  // 相当于for (True)</span><br>    <span class="hljs-comment">//     switch ($_DEBCK) &#123;</span><br>    <span class="hljs-comment">//         case VIPVz.$_Ds()[0][14]:  // 这里一定相等</span><br>    <span class="hljs-comment">//         this[$_DAIZ(602)] = e || [];</span><br>    <span class="hljs-comment">//         $_DEBCK = VIPVz.$_Ds()[4][13];  //将这个值复制给上面的循环判断，所以下一个循环一定是false,所以只走一步</span><br>    <span class="hljs-comment">//         break;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>    <span class="hljs-comment">// this[$_DAIZ(602)] = e || [];</span><br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>] = e || [];<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来我们看一下 new ce是个什么东西，这就是我们要找的eaz, 我们在往上面拉, 发现ce实际上是一个构造器，ce的原型方法上，创建了一大堆方法，所以我们可以把这些方法全部都扣下来</p><p><img src="/images/image-20230526175056174.png" alt="image-20230526175056174"></p><p><img src="/images/image-20230526175138519.png" alt="image-20230526175138519"></p><p><img src="/images/image-20230526175426271.png" alt="image-20230526175426271"></p><p>通过删减和替换，其实也就这些</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs javascript">ce[<span class="hljs-string">&quot;prototype&quot;</span>] = &#123;<br><span class="hljs-string">&quot;\u0024\u005f\u0048\u004a\u006d&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][e];<br>&#125;,<br><br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0047\u0078&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>];<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0044\u004a\u0064&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, t</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-title function_">K</span>(t) ? <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](e, t) : <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](e));<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0048\u0055&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;push&#x27;</span>](e),<br>    <span class="hljs-variable language_">this</span>;<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0049\u0054&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, t</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;splice&#x27;</span>](e, t || <span class="hljs-number">1</span>);<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0045\u0042\u0078&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;join&#x27;</span>](e);<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u004a\u0051&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;concat&#x27;</span>](e));<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0045\u0041\u007a&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;map&#x27;</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&#x27;map&#x27;</span>](e));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>        n[r] = <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0042\u0041\u0068&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;filter&#x27;</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&#x27;filter&#x27;</span>](e));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>        <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>) &amp;&amp; n[<span class="hljs-string">&#x27;push&#x27;</span>](t[r]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0045\u0048\u0063&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;indexOf&#x27;</span>])<br>        <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;indexOf&#x27;</span>](e);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = t[<span class="hljs-string">&#x27;length&#x27;</span>]; n &lt; r; n += <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> (t[n] === e)<br>            <span class="hljs-keyword">return</span> n;<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>&#125;,<br><span class="hljs-string">&quot;\u0024\u005f\u0042\u0042\u0042\u0072&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br><br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!t[<span class="hljs-string">&#x27;forEach&#x27;</span>])<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>], r = <span class="hljs-number">0</span>; r &lt; t[<span class="hljs-string">&#x27;length&#x27;</span>]; r++)<br>            r <span class="hljs-keyword">in</span> t &amp;&amp; e[<span class="hljs-string">&#x27;call&#x27;</span>](n, t[r], r, <span class="hljs-variable language_">this</span>);<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;forEach&#x27;</span>](e);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们回到上面，看 <code>n[&#39;$_BIHL&#39;](t)</code> 我们看一下 <code>n[&#39;$_BIHL&#39;]</code>  是一个什么方法, 这一段的代码其实就是判断e是否为空，所以那一段代码就相当于 <code>o[&#39;push&#39;]((void 0 === t) ? -1 : t);</code></p><p><img src="/images/image-20230526180835347.png" alt="image-20230526180835347"></p><p>这一段的最终代码就是这个样子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BIBF</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">this</span><br>      , r = &#123;<br><span class="hljs-number">18</span>,<br>    <span class="hljs-string">&quot;touchEvent&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;performanceTiming&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;internalip&quot;</span>: -<span class="hljs-number">1</span><br>&#125;;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">BJAm</span> = [<br>    <span class="hljs-string">&quot;textLength&quot;</span>,<br><br>]<br>    r[<span class="hljs-string">&#x27;timestamp&#x27;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>](),<br>    r[<span class="hljs-string">&#x27;touchEvent&#x27;</span>] = -<span class="hljs-number">1</span>,<br>    r[<span class="hljs-string">&#x27;performanceTiming&#x27;</span>] = -<span class="hljs-number">1</span>,<br>    r[<span class="hljs-string">&#x27;internalip&#x27;</span>] = -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> o = [];<br>    <span class="hljs-comment">// 需要先扣取ce方法，然后还要扣取ce的$_EAz方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-title class_">BJAm</span>)[<span class="hljs-string">&#x27;$_EAz&#x27;</span>](<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = r[e];<br>        <span class="hljs-comment">// o[&#x27;push&#x27;](n[&#x27;$_BIHL&#x27;](t) ? -1 : t);</span><br>        o[<span class="hljs-string">&#x27;push&#x27;</span>]((<span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === t) ? -<span class="hljs-number">1</span> : t);<br>    &#125;),<br>    <br></code></pre></td></tr></table></figure><p>最终我们就获取到了浏览器指纹</p><p><img src="/images/image-20230526181216516.png" alt="image-20230526181216516"></p><h4 id="做过修改的RSA加密"><a href="#做过修改的RSA加密" class="headerlink" title="做过修改的RSA加密"></a>做过修改的RSA加密</h4><p>接下来 我们把断点打到最开始的地方，看是莱真正获取 r o i 三个参数，先看 <code>t[$_CEIIU(1300)]</code>  方法, 替换以下</p><p><img src="/images/image-20230526181536692.png" alt="image-20230526181536692"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCHF</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title function_">X</span>()[<span class="hljs-string">&#x27;encrypt&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>](e)); <br>    <span class="hljs-keyword">while</span> (!t || <span class="hljs-number">256</span> !== t[<span class="hljs-string">&#x27;length&#x27;</span>])<br>        t = <span class="hljs-keyword">new</span> <span class="hljs-title function_">X</span>()[<span class="hljs-string">&#x27;encrypt&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>](!<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后我们看一下$_CCIl 是个什么东西，就在$_CCHF上面, 这里的逻辑就是如果有 <code>this[&#39;$_EIk&#39;][&#39;aeskey&#39;]</code> 那就返回它，没有就从 te()方法创建一个，我们直接看te方法</p><p><img src="/images/image-20230526182132609.png" alt="image-20230526182132609"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCIl</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] &amp;&amp; !e || (<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] = <span class="hljs-title function_">te</span>()),  <span class="hljs-comment">// 如果aeskey 有 并且 e没有 返回 this[&#x27;$_EIk&#x27;][&#x27;aeskey&#x27;]</span><br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>];  <span class="hljs-comment">// 如果上述是否 那就重新创建一个aeskey，从te()方法创建</span><br>&#125;<br></code></pre></td></tr></table></figure><p>e方法 其实就是返回return处，这里的控制流和上面的其实是一样的，所以我们就可以这样进行改造,其实就是返回的随机字母和数字</p><p><img src="/../../../../imgs/image-20230526182723030.png" alt="image-20230526182723030"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">te</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">e</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">65536</span> * (<span class="hljs-number">1</span> + <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;random&#x27;</span>]()) | <span class="hljs-number">0</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>)[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来我们来看 X() 方法</p><p><img src="/images/image-20230526202353130.png" alt="image-20230526202353130"></p><p>整理一下，去除不必要的逻辑，发现是一个RSA加密，上面的 new X() 应该就是一个 new JSEncrypt,如果要扣代码解决这个RSA加密的话，会非常麻烦</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">X</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;n&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;e&#x27;</span>] = <span class="hljs-number">0</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;d&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;p&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;q&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;dmp1&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;dmq1&#x27;</span>] = <span class="hljs-literal">null</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;coeff&#x27;</span>] = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> public_key = <span class="hljs-string">&quot;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&quot;</span><br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;setPublic&#x27;</span>](public_key, <span class="hljs-string">&#x27;10001&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>我们找一份 JSEncryot 的源码,发现极验的RSA加密，就是用的第三方库，JSEncrypt，但是极验这里稍微做了一点修改，还有一点就是JSEncrypt这个第三方库，他的导出当中，没有导出RSAKey方法，所以我们要修改源码，其实这里有三种解决方法，一种是扣极验的RSA加密代码，一种是修改JSEncrypt的源码，再一种是用python的RSA加密库进行加密</p><p><img src="/images/image-20230526204240294.png" alt="image-20230526204240294"></p><p>JSEncrypt源码</p><p><img src="/images/image-20230526204738139.png" alt="image-20230526204738139"></p><p>修改完成后</p><p><img src="/images/image-20230526204904818.png" alt="image-20230526204904818"></p><p>这样 我们就不用深究 X()方法了, 然后魔改之后的$_CCHF方法就变成了这样，如果使用python的话，会方便非常多</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> &#123;<span class="hljs-title class_">RSAKey</span>&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node-jsencrypt&#x27;</span>)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCHF</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RSAKey</span>();  <span class="hljs-comment">// 因为源码中，没有下面这一步，所以我们得手动补上设置公钥的步骤</span><br>    <span class="hljs-keyword">var</span> public_key = <span class="hljs-string">&quot;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&quot;</span><br>    rsa.<span class="hljs-title function_">setPublic</span>(public_key, <span class="hljs-string">&#x27;10001&#x27;</span>)<br><br>    <span class="hljs-keyword">var</span> t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(e));  <span class="hljs-comment">// 对aeskey进行加密</span><br>    <span class="hljs-keyword">while</span> (!t || <span class="hljs-number">256</span> !== t[<span class="hljs-string">&#x27;length&#x27;</span>])  <span class="hljs-comment">// 如果t的长度不等于256就一直加密</span><br>        t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(!<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用python实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Time : 2023/5/26 21:28</span><br><br><span class="hljs-comment"># @Author : LLi</span><br><span class="hljs-comment"># @Email : 1984145803@qq.com</span><br><span class="hljs-comment"># @File : 11.RSA-3.py</span><br><span class="hljs-keyword">import</span> rsa<br><br>m = <span class="hljs-string">&#x27;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&#x27;</span><br>e = <span class="hljs-string">&#x27;10001&#x27;</span><br><br>message = <span class="hljs-string">&#x27;a7cbc52e0e73919c&#x27;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Encrypt</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, e, m</span>):<br>        self.e = e<br>        self.m = m<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, message</span>):<br>        mm = <span class="hljs-built_in">int</span>(self.m, <span class="hljs-number">16</span>)<br>        ee = <span class="hljs-built_in">int</span>(self.e, <span class="hljs-number">16</span>)<br>        rsa_pubkey = rsa.PublicKey(mm, ee)<br>        crypto = self._encrypt(message.encode(), rsa_pubkey)<br>        <span class="hljs-keyword">return</span> crypto.<span class="hljs-built_in">hex</span>()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_pad_for_encryption</span>(<span class="hljs-params">self, message, target_length</span>):<br>        message = message[::-<span class="hljs-number">1</span>]<br>        max_msglength = target_length - <span class="hljs-number">11</span><br>        msglength = <span class="hljs-built_in">len</span>(message)<br><br>        padding = <span class="hljs-string">b&#x27;&#x27;</span><br>        padding_length = target_length - msglength - <span class="hljs-number">3</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(padding_length):<br>            padding += <span class="hljs-string">b&#x27;\x00&#x27;</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;&#x27;</span>.join([<span class="hljs-string">b&#x27;\x00\x00&#x27;</span>, padding, <span class="hljs-string">b&#x27;\x00&#x27;</span>, message])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_encrypt</span>(<span class="hljs-params">self, message, pub_key</span>):<br>        keylength = rsa.common.byte_size(pub_key.n)<br>        padded = self._pad_for_encryption(message, keylength)<br><br>        payload = rsa.transform.bytes2int(padded)<br>        encrypted = rsa.core.encrypt_int(payload, pub_key.e, pub_key.n)<br>        block = rsa.transform.int2bytes(encrypted, keylength)<br><br>        <span class="hljs-keyword">return</span> block<br><br><br>en = Encrypt(e, m)<br><span class="hljs-built_in">print</span>(en.encrypt(message))<br></code></pre></td></tr></table></figure><h4 id="做过修改的AES加密"><a href="#做过修改的AES加密" class="headerlink" title="做过修改的AES加密"></a>做过修改的AES加密</h4><p>r 参数获取到后，我们接下来看参数o，猜测这里应该是一个AES加密，接下来看 <code>$_BFZ()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">o = $_BFZ()[<span class="hljs-string">&quot;encrypt1&quot;</span>](<span class="hljs-title class_">JSON</span>[<span class="hljs-string">&quot;stringify&quot;</span>](t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>]), $_CCIl())  <span class="hljs-comment">// 这里相当于是 encrypt(浏览器指纹，aeskey)</span><br><br></code></pre></td></tr></table></figure><p><img src="/images/image-20230526213544652.png" alt="image-20230526213544652"></p><p>encrypt1方法是这个,我们开始扣这个代码</p><p><img src="/images/image-20230526213708304.png" alt="image-20230526213708304"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    t = u[<span class="hljs-string">&#x27;parse&#x27;</span>](t);  <span class="hljs-comment">// 如果是AES加密 那应该是 CryptoJS.enc.utf8.parse(t)</span><br>    <span class="hljs-comment">// 这一段其实就是给iv初始化，然后赋值给n</span><br>    <span class="hljs-comment">// n &amp;&amp; n[&#x27;iv&#x27;] || ((n = n || &#123;&#125;)[&#x27;iv&#x27;] = u[&#x27;parse&#x27;](&#x27;0000000000000000&#x27;));</span><br>    iv = u[<span class="hljs-string">&#x27;parse&#x27;</span>](<span class="hljs-string">&#x27;0000000000000000&#x27;</span>)<br>    <span class="hljs-comment">// 开始还原这个for循环,将逗号拆开</span><br>   <span class="hljs-comment">// for (var r = m[&#x27;encrypt&#x27;](_, e, t, n), o = r[&#x27;ciphertext&#x27;][&#x27;words&#x27;], i = r[&#x27;ciphertext&#x27;][&#x27;sigBytes&#x27;], s = [], a = 0; a &lt; i; a++) &#123;</span><br>    <span class="hljs-keyword">var</span> r = m[<span class="hljs-string">&#x27;encrypt&#x27;</span>](_, e, t, n);  <span class="hljs-comment">// 可能是CryptoJS.AES.encrypt(初始化，数据，key,iv)</span><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];<br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = <span class="hljs-number">0</span>; s &lt; i; s++)&#123;<br>            <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>            s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>        &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br></code></pre></td></tr></table></figure><p>我们看他的 <code>m[&#39;encrypt&#39;](_, e, t, n)</code> 我们打印一下,我们用CryptoJS库尝试同样进行加密后，是不是一个结果,可以看到， <code>m[&#39;encrypt&#39;]</code> 的密文结果就是我们用crypto-js的AES加密后的结果</p><p><img src="/../../../../imgs/image-20230526220945520.png" alt="image-20230526220945520"></p><p><img src="/images/image-20230526220928861.png" alt="image-20230526220928861"></p><p>所以 encrpyt1方法 我们就可以改成</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    <span class="hljs-comment">// t = u[&#x27;parse&#x27;](t);  // 如果是AES加密 那应该是 CryptoJS.enc.utf8.parse(t)</span><br>    <span class="hljs-comment">// 这一段其实就是给iv初始化，然后赋值给n</span><br>    <span class="hljs-comment">// n &amp;&amp; n[&#x27;iv&#x27;] || ((n = n || &#123;&#125;)[&#x27;iv&#x27;] = u[&#x27;parse&#x27;](&#x27;0000000000000000&#x27;));</span><br>    <span class="hljs-comment">// iv = u[&#x27;parse&#x27;](&#x27;0000000000000000&#x27;)</span><br>    <span class="hljs-comment">// 开始还原这个for循环,将逗号拆开</span><br>   <span class="hljs-comment">// for (var r = m[&#x27;encrypt&#x27;](_, e, t, n), o = r[&#x27;ciphertext&#x27;][&#x27;words&#x27;], i = r[&#x27;ciphertext&#x27;][&#x27;sigBytes&#x27;], s = [], a = 0; a &lt; i; a++) &#123;</span><br>   <span class="hljs-comment">//  var r = m[&#x27;encrypt&#x27;](_, e, t, n);  // 可能是CryptoJS.AES.encrypt(初始化，数据，key,iv)</span><br>    <span class="hljs-keyword">var</span> key = t;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;0000000000000000&quot;</span>;<br><br>    key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e,key,&#123;<br>        iv : iv,<br>        <span class="hljs-attr">mode</span>:<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];  <br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = <span class="hljs-number">0</span>; s &lt; i; s++)&#123;<br>            <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>            s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>        &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="全局变量与代码补齐"><a href="#全局变量与代码补齐" class="headerlink" title="全局变量与代码补齐"></a>全局变量与代码补齐</h4><p>最后就差 i 参数的 <code>p[&#39;$_HEf&#39;](o)</code> 了， <code>p[&#39;$_HEf&#39;]()</code>方法是这样的，我们整理一下</p><p><img src="/images/image-20230526221857312.png" alt="image-20230526221857312"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HEf</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_HCh&#x27;</span>](e);<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br><br>&#125;<br></code></pre></td></tr></table></figure><p>我们再看 <code>this[&#39;$_HCh&#39;]</code>方法, 扣代码的时候需要把断点打进去，这里涉及到 o和i 是this</p><p><img src="/images/image-20230526222002457.png" alt="image-20230526222002457"></p><p>全部抠出来的代码是这样的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HEf</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = $_HCh(e);<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HCh</span>(<span class="hljs-params">e, o</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>;<br>    o || (o = i);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)<br>            <span class="hljs-number">1</span> === $_HBw(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBw(e, r));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> c;<br>        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)<br>            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">235</span>));<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;<br>            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-string">&#x27;.&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;\u0072\u0065\u0073&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0065\u006e\u0064&quot;</span>: r<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HBw</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GJz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&#x27;</span>;<br>    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&#x27;length&#x27;</span>] ? <span class="hljs-string">&#x27;.&#x27;</span> : t[<span class="hljs-string">&#x27;charAt&#x27;</span>](e);<br>&#125;<br></code></pre></td></tr></table></figure><p>再然后 我们回到最开始加密的起始位置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">o = <span class="hljs-title function_">encrypt1</span>(<span class="hljs-title class_">JSON</span>[<span class="hljs-string">&quot;stringify&quot;</span>](t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>]), $_CCIl())<br></code></pre></td></tr></table></figure><p><code>t[&#39;$_EJi&#39;]</code> 在最开始是有内容的,在进行添加参数前打上断点，然后copy出来</p><p><img src="/images/image-20230526224004408.png" alt="image-20230526224004408"></p><p>我们设置一个全局变量，然后把 <code>t[&#39;$_EJi&#39;]</code>放进去,并在函数体里面将 gt和challenge加进去,把需要的t给补齐来</p><p><img src="/images/image-20230526225922672.png" alt="image-20230526225922672"></p><p><img src="/images/image-20230526225959989.png" alt="image-20230526225959989"></p><p>完整代码如下：实际上第一个w可以省略，不需要也行，不过后续的两个w都跟这里多多少少有些关系</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> &#123;<span class="hljs-title class_">RSAKey</span>&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node-jsencrypt&#x27;</span>)<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;crypto-js&quot;</span>)<br><br><span class="hljs-keyword">var</span> quanjv = &#123;<br>$_EJi :&#123;<br>    <span class="hljs-comment">// &quot;gt&quot;: &quot;019924a82c70bb123aae90d483087f94&quot;,</span><br>    <span class="hljs-comment">// &quot;challenge&quot;: &quot;e6ff4a60ff6c3efe3a363821b193f764&quot;,</span><br>    <span class="hljs-string">&quot;offline&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;new_captcha&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;product&quot;</span>: <span class="hljs-string">&quot;popup&quot;</span>,<br>    <span class="hljs-string">&quot;width&quot;</span>: <span class="hljs-string">&quot;300px&quot;</span>,<br>    <span class="hljs-string">&quot;https&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;api_server&quot;</span>: <span class="hljs-string">&quot;apiv6.geetest.com&quot;</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;https://&quot;</span>,<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;fullpage&quot;</span>,<br>    <span class="hljs-string">&quot;static_servers&quot;</span>: [<br>        <span class="hljs-string">&quot;static.geetest.com/&quot;</span>,<br>        <span class="hljs-string">&quot;dn-staticdown.qbox.me/&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-string">&quot;/static/js/beeline.1.0.1.js&quot;</span>,<br>    <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-string">&quot;/static/js/voice.1.2.3.js&quot;</span>,<br>    <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-string">&quot;/static/js/click.3.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;fullpage&quot;</span>: <span class="hljs-string">&quot;/static/js/fullpage.9.1.4.js&quot;</span>,<br>    <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-string">&quot;/static/js/slide.7.9.0.js&quot;</span>,<br>    <span class="hljs-string">&quot;geetest&quot;</span>: <span class="hljs-string">&quot;/static/js/geetest.6.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;aspect_radio&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-number">103</span>,<br>        <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-number">50</span><br>    &#125;<br>&#125;,<br>    <span class="hljs-attr">$_EIk</span>:&#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cul_first_w</span>(<span class="hljs-params">gt,challenge</span>) &#123;<br>    <span class="hljs-comment">// var t = this</span><br>    <span class="hljs-keyword">var</span> t = quanjv<br>    t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;gt&#x27;</span>] = gt;<br>    t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;challenge&#x27;</span>] = challenge<br>    <span class="hljs-comment">// if (!n[&#x27;gt&#x27;] || !n[&#x27;challenge&#x27;]) // 这一段可以注释掉，因为一定有gt</span><br>    <span class="hljs-comment">//     return U(j(&#x27;config_lack&#x27;, t));</span><br>    <span class="hljs-comment">// var e = t[&#x27;$_BJCr&#x27;][&#x27;$_BIBF&#x27;]();  // 检测浏览器数据，类似于浏览器指纹</span><br>    <span class="hljs-keyword">var</span> e = $_BIBF();  <span class="hljs-comment">// 检测浏览器数据，类似于浏览器指纹</span><br>    <span class="hljs-comment">// t[&#x27;$_CCGM&#x27;] = e,</span><br>    t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;cc&#x27;</span>] = <span class="hljs-number">16</span>,<br>    t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;ww&#x27;</span>] = <span class="hljs-literal">true</span>,<br>    t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;i&#x27;</span>] = e;<br>    <span class="hljs-keyword">var</span> r = $_CCHF()  <span class="hljs-comment">// 生成一个aes可以，然后进行rsa加密,然后拿到加密后的密文</span><br>        <span class="hljs-comment">// gt是json.stringify , o的结果是一个数组</span><br>        <span class="hljs-comment">// , o = $_BFZ()[&quot;encrypt1&quot;](ge[&quot;stringify&quot;](t[&#x27;$_EJi&#x27;]), t[&#x27;$_CCIl&#x27;]())</span><br>        <span class="hljs-comment">// 猜测一下 这里是AES加密</span><br>        , o = <span class="hljs-title function_">encrypt1</span>(<span class="hljs-title class_">JSON</span>[<span class="hljs-string">&quot;stringify&quot;</span>](t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>]), $_CCIl())  <span class="hljs-comment">// 这里相当于是 encrypt(浏览器指纹，aeskey)</span><br>        , i = $_HEf(o),<br>        s = &#123;<br>            <span class="hljs-string">&#x27;gt&#x27;</span>: t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;gt&#x27;</span>],<br>            <span class="hljs-string">&#x27;challenge&#x27;</span>: t[<span class="hljs-string">&#x27;$_EJi&#x27;</span>][<span class="hljs-string">&#x27;challenge&#x27;</span>],<br>            <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&quot;zh-cn&quot;</span>,<br>            <span class="hljs-string">&#x27;pt&#x27;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&#x27;client_type&#x27;</span>: <span class="hljs-string">&#x27;web&#x27;</span>,<br>            <span class="hljs-string">&#x27;w&#x27;</span>: i + r<br>        &#125;;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HEf</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = $_HCh(e);<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HCh</span>(<span class="hljs-params">e, o</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>;<br>    o || (o = i);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)<br>            <span class="hljs-number">1</span> === $_HBw(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBw(e, r));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> c;<br>        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)<br>            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">235</span>));<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;<br>            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-string">&#x27;.&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;\u0072\u0065\u0073&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0065\u006e\u0064&quot;</span>: r<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HBw</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GJz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&#x27;</span>;<br>    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&#x27;length&#x27;</span>] ? <span class="hljs-string">&#x27;.&#x27;</span> : t[<span class="hljs-string">&#x27;charAt&#x27;</span>](e);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    <span class="hljs-comment">// t = u[&#x27;parse&#x27;](t);  // 如果是AES加密 那应该是 CryptoJS.enc.utf8.parse(t)</span><br>    <span class="hljs-comment">// 这一段其实就是给iv初始化，然后赋值给n</span><br>    <span class="hljs-comment">// n &amp;&amp; n[&#x27;iv&#x27;] || ((n = n || &#123;&#125;)[&#x27;iv&#x27;] = u[&#x27;parse&#x27;](&#x27;0000000000000000&#x27;));</span><br>    <span class="hljs-comment">// iv = u[&#x27;parse&#x27;](&#x27;0000000000000000&#x27;)</span><br>    <span class="hljs-comment">// 开始还原这个for循环,将逗号拆开</span><br>    <span class="hljs-comment">// for (var r = m[&#x27;encrypt&#x27;](_, e, t, n), o = r[&#x27;ciphertext&#x27;][&#x27;words&#x27;], i = r[&#x27;ciphertext&#x27;][&#x27;sigBytes&#x27;], s = [], a = 0; a &lt; i; a++) &#123;</span><br>    <span class="hljs-comment">//  var r = m[&#x27;encrypt&#x27;](_, e, t, n);  // 可能是CryptoJS.AES.encrypt(初始化，数据，key,iv)</span><br>    <span class="hljs-keyword">var</span> key = t;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;0000000000000000&quot;</span>;<br><br>    key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e, key, &#123;<br>        <span class="hljs-attr">iv</span>: iv,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];<br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; i; a++) &#123;<br>        <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>        s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCHF</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RSAKey</span>();  <span class="hljs-comment">// 因为源码中，没有下面这一步，所以我们得手动补上设置公钥的步骤</span><br>    <span class="hljs-keyword">var</span> public_key = <span class="hljs-string">&quot;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&quot;</span><br>    rsa.<span class="hljs-title function_">setPublic</span>(public_key, <span class="hljs-string">&#x27;10001&#x27;</span>)<br><br>    <span class="hljs-keyword">var</span> t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(e));  <span class="hljs-comment">// 对aeskey进行加密</span><br>    <span class="hljs-keyword">while</span> (!t || <span class="hljs-number">256</span> !== t[<span class="hljs-string">&#x27;length&#x27;</span>])  <span class="hljs-comment">// 如果t的长度不等于256就一直加密</span><br>        t = rsa[<span class="hljs-string">&#x27;encrypt&#x27;</span>]($_CCIl(!<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br><br><span class="hljs-comment">// 这个X方法就不需要了</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">X</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;n&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;e&#x27;</span>] = <span class="hljs-number">0</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;d&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;p&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;q&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;dmp1&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;dmq1&#x27;</span>] = <span class="hljs-literal">null</span>,<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;coeff&#x27;</span>] = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> public_key = <span class="hljs-string">&quot;00C1E3934D1614465B33053E7F48EE4EC87B14B95EF88947713D25EECBFF7E74C7977D02DC1D9451F79DD5D1C10C29ACB6A9B4D6FB7D0A0279B6719E1772565F09AF627715919221AEF91899CAE08C0D686D748B20A3603BE2318CA6BC2B59706592A9219D0BF05C9F65023A21D2330807252AE0066D59CEEFA5F2748EA80BAB81&quot;</span><br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;setPublic&#x27;</span>](public_key, <span class="hljs-string">&#x27;10001&#x27;</span>);<br>&#125;<br><br><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_CCIl</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">return</span> quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] &amp;&amp; !e || (quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>] = <span class="hljs-title function_">te</span>()),  <span class="hljs-comment">// 如果aeskey 有 并且 e没有 返回 this[&#x27;$_EIk&#x27;][&#x27;aeskey&#x27;]</span><br>        quanjv[<span class="hljs-string">&#x27;$_EIk&#x27;</span>][<span class="hljs-string">&#x27;aeskey&#x27;</span>];  <span class="hljs-comment">// 如果上述是否 那就重新创建一个aeskey，从te()方法创建</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">te</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>() + <span class="hljs-title function_">e</span>();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">e</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">65536</span> * (<span class="hljs-number">1</span> + <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;random&#x27;</span>]()) | <span class="hljs-number">0</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>)[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// 解决 e = t[&#x27;$_BJCr&#x27;][&#x27;$_BIBF&#x27;]()</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BIBF</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">this</span><br>        , r = &#123;<br>        <span class="hljs-string">&quot;STYLE&quot;</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;SCRIPT&quot;</span>: <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;A&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;DIV&quot;</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-string">&quot;LABEL&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;INPUT&quot;</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;textLength&quot;</span>: <span class="hljs-number">7263</span>,<br>        <span class="hljs-string">&quot;HTMLLength&quot;</span>: <span class="hljs-number">8771</span>,<br>        <span class="hljs-string">&quot;documentMode&quot;</span>: <span class="hljs-string">&quot;CSS1Compat&quot;</span>,<br>        <span class="hljs-string">&quot;browserLanguage&quot;</span>: <span class="hljs-string">&quot;zh-CN&quot;</span>,<br>        <span class="hljs-string">&quot;browserLanguages&quot;</span>: <span class="hljs-string">&quot;zh-CN,en,en-GB,en-US&quot;</span>,<br>        <span class="hljs-string">&quot;devicePixelRatio&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;colorDepth&quot;</span>: <span class="hljs-number">24</span>,<br>        <span class="hljs-string">&quot;userAgent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.50&quot;</span>,<br>        <span class="hljs-string">&quot;cookieEnabled&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;netEnabled&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;innerWidth&quot;</span>: <span class="hljs-number">2300</span>,<br>        <span class="hljs-string">&quot;innerHeight&quot;</span>: <span class="hljs-number">646</span>,<br>        <span class="hljs-string">&quot;outerWidth&quot;</span>: <span class="hljs-number">2316</span>,<br>        <span class="hljs-string">&quot;outerHeight&quot;</span>: <span class="hljs-number">1400</span>,<br>        <span class="hljs-string">&quot;screenWidth&quot;</span>: <span class="hljs-number">3440</span>,<br>        <span class="hljs-string">&quot;screenHeight&quot;</span>: <span class="hljs-number">1440</span>,<br>        <span class="hljs-string">&quot;screenAvailWidth&quot;</span>: <span class="hljs-number">3440</span>,<br>        <span class="hljs-string">&quot;screenAvailHeight&quot;</span>: <span class="hljs-number">1400</span>,<br>        <span class="hljs-string">&quot;screenLeft&quot;</span>: <span class="hljs-number">341</span>,<br>        <span class="hljs-string">&quot;screenTop&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;screenAvailLeft&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;screenAvailTop&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;localStorageEnabled&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;sessionStorageEnabled&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;indexedDBEnabled&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;platform&quot;</span>: <span class="hljs-string">&quot;Win32&quot;</span>,<br>        <span class="hljs-string">&quot;doNotTrack&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;timezone&quot;</span>: -<span class="hljs-number">8</span>,<br>        <span class="hljs-string">&quot;canvas2DFP&quot;</span>: <span class="hljs-string">&quot;1ae727458b55454f3bf0563c00f6d443&quot;</span>,<br>        <span class="hljs-string">&quot;canvas3DFP&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;plugins&quot;</span>: <span class="hljs-string">&quot;internal-pdf-viewer,mhjfbmdgcfjbbpaeojofohoefgiehjai,internal-nacl-plugin&quot;</span>,<br>        <span class="hljs-string">&quot;maxTouchPoints&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;flashEnabled&quot;</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;javaEnabled&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;hardwareConcurrency&quot;</span>: <span class="hljs-number">16</span>,<br>        <span class="hljs-string">&quot;jsFonts&quot;</span>: <span class="hljs-string">&quot;Arial,ArialBlack,ArialNarrow,Calibri,Cambria,CambriaMath,ComicSansMS,Consolas,Courier,CourierNew,Georgia,Helvetica,Impact,LucidaConsole,LucidaSansUnicode,MicrosoftSansSerif,MSGothic,MSPGothic,MSSansSerif,MSSerif,PalatinoLinotype,SegoePrint,SegoeScript,SegoeUI,SegoeUILight,SegoeUISemibold,SegoeUISymbol,Tahoma,Times,TimesNewRoman,TrebuchetMS,Verdana,Wingdings&quot;</span>,<br>        <span class="hljs-string">&quot;mediaDevices&quot;</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-number">1685093132118</span>,<br>        <span class="hljs-string">&quot;touchEvent&quot;</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;performanceTiming&quot;</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;internalip&quot;</span>: -<span class="hljs-number">1</span><br>    &#125;;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">BJAm</span> = [<br>        <span class="hljs-string">&quot;textLength&quot;</span>,<br>        <span class="hljs-string">&quot;HTMLLength&quot;</span>,<br>        <span class="hljs-string">&quot;documentMode&quot;</span>,<br>        <span class="hljs-string">&quot;A&quot;</span>,<br>        <span class="hljs-string">&quot;ARTICLE&quot;</span>,<br>        <span class="hljs-string">&quot;ASIDE&quot;</span>,<br>        <span class="hljs-string">&quot;AUDIO&quot;</span>,<br>        <span class="hljs-string">&quot;BASE&quot;</span>,<br>        <span class="hljs-string">&quot;BUTTON&quot;</span>,<br>        <span class="hljs-string">&quot;CANVAS&quot;</span>,<br>        <span class="hljs-string">&quot;CODE&quot;</span>,<br>        <span class="hljs-string">&quot;IFRAME&quot;</span>,<br>        <span class="hljs-string">&quot;IMG&quot;</span>,<br>        <span class="hljs-string">&quot;INPUT&quot;</span>,<br>        <span class="hljs-string">&quot;LABEL&quot;</span>,<br>        <span class="hljs-string">&quot;LINK&quot;</span>,<br>        <span class="hljs-string">&quot;NAV&quot;</span>,<br>        <span class="hljs-string">&quot;OBJECT&quot;</span>,<br>        <span class="hljs-string">&quot;OL&quot;</span>,<br>        <span class="hljs-string">&quot;PICTURE&quot;</span>,<br>        <span class="hljs-string">&quot;PRE&quot;</span>,<br>        <span class="hljs-string">&quot;SECTION&quot;</span>,<br>        <span class="hljs-string">&quot;SELECT&quot;</span>,<br>        <span class="hljs-string">&quot;SOURCE&quot;</span>,<br>        <span class="hljs-string">&quot;SPAN&quot;</span>,<br>        <span class="hljs-string">&quot;STYLE&quot;</span>,<br>        <span class="hljs-string">&quot;TABLE&quot;</span>,<br>        <span class="hljs-string">&quot;TEXTAREA&quot;</span>,<br>        <span class="hljs-string">&quot;VIDEO&quot;</span>,<br>        <span class="hljs-string">&quot;screenLeft&quot;</span>,<br>        <span class="hljs-string">&quot;screenTop&quot;</span>,<br>        <span class="hljs-string">&quot;screenAvailLeft&quot;</span>,<br>        <span class="hljs-string">&quot;screenAvailTop&quot;</span>,<br>        <span class="hljs-string">&quot;innerWidth&quot;</span>,<br>        <span class="hljs-string">&quot;innerHeight&quot;</span>,<br>        <span class="hljs-string">&quot;outerWidth&quot;</span>,<br>        <span class="hljs-string">&quot;outerHeight&quot;</span>,<br>        <span class="hljs-string">&quot;browserLanguage&quot;</span>,<br>        <span class="hljs-string">&quot;browserLanguages&quot;</span>,<br>        <span class="hljs-string">&quot;systemLanguage&quot;</span>,<br>        <span class="hljs-string">&quot;devicePixelRatio&quot;</span>,<br>        <span class="hljs-string">&quot;colorDepth&quot;</span>,<br>        <span class="hljs-string">&quot;userAgent&quot;</span>,<br>        <span class="hljs-string">&quot;cookieEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;netEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;screenWidth&quot;</span>,<br>        <span class="hljs-string">&quot;screenHeight&quot;</span>,<br>        <span class="hljs-string">&quot;screenAvailWidth&quot;</span>,<br>        <span class="hljs-string">&quot;screenAvailHeight&quot;</span>,<br>        <span class="hljs-string">&quot;localStorageEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;sessionStorageEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;indexedDBEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;CPUClass&quot;</span>,<br>        <span class="hljs-string">&quot;platform&quot;</span>,<br>        <span class="hljs-string">&quot;doNotTrack&quot;</span>,<br>        <span class="hljs-string">&quot;timezone&quot;</span>,<br>        <span class="hljs-string">&quot;canvas2DFP&quot;</span>,<br>        <span class="hljs-string">&quot;canvas3DFP&quot;</span>,<br>        <span class="hljs-string">&quot;plugins&quot;</span>,<br>        <span class="hljs-string">&quot;maxTouchPoints&quot;</span>,<br>        <span class="hljs-string">&quot;flashEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;javaEnabled&quot;</span>,<br>        <span class="hljs-string">&quot;hardwareConcurrency&quot;</span>,<br>        <span class="hljs-string">&quot;jsFonts&quot;</span>,<br>        <span class="hljs-string">&quot;timestamp&quot;</span>,<br>        <span class="hljs-string">&quot;performanceTiming&quot;</span>,<br>        <span class="hljs-string">&quot;internalip&quot;</span>,<br>        <span class="hljs-string">&quot;mediaDevices&quot;</span>,<br>        <span class="hljs-string">&quot;DIV&quot;</span>,<br>        <span class="hljs-string">&quot;P&quot;</span>,<br>        <span class="hljs-string">&quot;UL&quot;</span>,<br>        <span class="hljs-string">&quot;LI&quot;</span>,<br>        <span class="hljs-string">&quot;SCRIPT&quot;</span>,<br>        <span class="hljs-string">&quot;touchEvent&quot;</span><br>    ]<br>    r[<span class="hljs-string">&#x27;timestamp&#x27;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>](),<br>        r[<span class="hljs-string">&#x27;touchEvent&#x27;</span>] = -<span class="hljs-number">1</span>,<br>        r[<span class="hljs-string">&#x27;performanceTiming&#x27;</span>] = -<span class="hljs-number">1</span>,<br>        r[<span class="hljs-string">&#x27;internalip&#x27;</span>] = -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> o = [];<br>    <span class="hljs-comment">// 需要先扣取ce方法，然后还要扣取ce的$_EAz方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-title class_">BJAm</span>)[<span class="hljs-string">&#x27;$_EAz&#x27;</span>](<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = r[e];<br>        <span class="hljs-comment">// o[&#x27;push&#x27;](n[&#x27;$_BIHL&#x27;](t) ? -1 : t);</span><br>        o[<span class="hljs-string">&#x27;push&#x27;</span>]((<span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === t) ? -<span class="hljs-number">1</span> : t);<br>    &#125;),<br>        o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;!!&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ce</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-comment">// var $_DEBCK = VIPVz.$_Ds()[0][14];</span><br>    <span class="hljs-comment">// for (; $_DEBCK !== VIPVz.$_Ds()[0][13]; ) &#123;  // 相当于for (True)</span><br>    <span class="hljs-comment">//     switch ($_DEBCK) &#123;</span><br>    <span class="hljs-comment">//         case VIPVz.$_Ds()[0][14]:  // 这里一定相等</span><br>    <span class="hljs-comment">//         this[$_DAIZ(602)] = e || [];</span><br>    <span class="hljs-comment">//         $_DEBCK = VIPVz.$_Ds()[4][13];  //将这个值复制给上面的循环判断，所以下一个循环一定是false,所以只走一步</span><br>    <span class="hljs-comment">//         break;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>    <span class="hljs-comment">// this[$_DAIZ(602)] = e || [];</span><br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>] = e || [];<br>&#125;<br><br>ce[<span class="hljs-string">&quot;prototype&quot;</span>] = &#123;<br>    <span class="hljs-string">&quot;\u0024\u005f\u0048\u004a\u006d&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][e];<br>    &#125;,<br><br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0047\u0078&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>];<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0044\u004a\u0064&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-title function_">K</span>(t) ? <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](e, t) : <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;slice&#x27;</span>](e));<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0048\u0055&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;push&#x27;</span>](e),<br>            <span class="hljs-variable language_">this</span>;<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u0049\u0054&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;splice&#x27;</span>](e, t || <span class="hljs-number">1</span>);<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0045\u0042\u0078&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;join&#x27;</span>](e);<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0041\u004a\u0051&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>][<span class="hljs-string">&#x27;concat&#x27;</span>](e));<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0045\u0041\u007a&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;map&#x27;</span>])<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&#x27;map&#x27;</span>](e));<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            n[r] = <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0042\u0041\u0068&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;filter&#x27;</span>])<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&#x27;filter&#x27;</span>](e));<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>) &amp;&amp; n[<span class="hljs-string">&#x27;push&#x27;</span>](t[r]);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0045\u0048\u0063&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&#x27;indexOf&#x27;</span>])<br>            <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;indexOf&#x27;</span>](e);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = t[<span class="hljs-string">&#x27;length&#x27;</span>]; n &lt; r; n += <span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">if</span> (t[n] === e)<br>                <span class="hljs-keyword">return</span> n;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;,<br>    <span class="hljs-string">&quot;\u0024\u005f\u0042\u0042\u0042\u0072&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br><br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BAEJ&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (!t[<span class="hljs-string">&#x27;forEach&#x27;</span>])<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>], r = <span class="hljs-number">0</span>; r &lt; t[<span class="hljs-string">&#x27;length&#x27;</span>]; r++)<br>                r <span class="hljs-keyword">in</span> t &amp;&amp; e[<span class="hljs-string">&#x27;call&#x27;</span>](n, t[r], r, <span class="hljs-variable language_">this</span>);<br>        <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;forEach&#x27;</span>](e);<br>    &#125;<br>&#125;<br><br>gt = <span class="hljs-string">&quot;019924a82c70bb123aae90d483087f94&quot;</span><br>challenge = <span class="hljs-string">&quot;e6ff4a60ff6c3efe3a363821b193f764&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">cul_first_w</span>(gt,challenge))<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 验证码 </tag>
            
            <tag> 极验 </tag>
            
            <tag> 滑块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>补环境扣代码过瑞数4</title>
      <link href="/2023/03/01/%E8%A1%A5%E7%8E%AF%E5%A2%83%E6%89%A3%E4%BB%A3%E7%A0%81%E8%BF%87%E7%91%9E%E6%95%B04/"/>
      <url>/2023/03/01/%E8%A1%A5%E7%8E%AF%E5%A2%83%E6%89%A3%E4%BB%A3%E7%A0%81%E8%BF%87%E7%91%9E%E6%95%B04/</url>
      
        <content type="html"><![CDATA[<h2 id="补环境扣代码过瑞数4"><a href="#补环境扣代码过瑞数4" class="headerlink" title="补环境扣代码过瑞数4"></a>补环境扣代码过瑞数4</h2><blockquote><p>参考网址：<a href="http://www.fangdi.com.cn/index.html">http://www.fangdi.com.cn/index.html</a></p></blockquote><h3 id="加密入口"><a href="#加密入口" class="headerlink" title="加密入口"></a>加密入口</h3><p>正常F12会有两个debugger,直接永不在此暂停过掉</p><p><img src="/images/image-20230603104101440.png" alt="image-20230603104101440"></p><p><img src="/images/image-20230603104232829.png" alt="image-20230603104232829"></p><p><code>FSSBBIl1UgzbN7N80T</code> 的值是4开头就是瑞数4的标志，我们直接用hook的形式去获取cookie</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// ==UserScript==</span><br><span class="hljs-comment">// @name         获取cookie</span><br><span class="hljs-comment">// @namespace    42</span><br><span class="hljs-comment">// @version      0.1</span><br><span class="hljs-comment">// @description  Hook Crypto</span><br><span class="hljs-comment">// @match        http://www.fangdi.com.cn/*</span><br><span class="hljs-comment">// @grant        none</span><br><span class="hljs-comment">// @run-at       document-start</span><br><span class="hljs-comment">// ==/UserScript==</span><br><br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 严谨模式 检查所有错误</span><br>    <span class="hljs-string">&#x27;use strict&#x27;</span>;<br>    <span class="hljs-comment">// document 为要hook的对象 这里是hook的cookie</span><br> <span class="hljs-keyword">var</span> cookieTemp = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">document</span>, <span class="hljs-string">&#x27;cookie&#x27;</span>, &#123;<br>  <span class="hljs-comment">// hook set方法也就是赋值的方法</span><br>  <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>) &#123;<br>    <span class="hljs-comment">// 这样就可以快速给下面这个代码行下断点</span><br>    <span class="hljs-comment">// 从而快速定位设置cookie的代码</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hook捕获到cookie设置-&gt;&#x27;</span>, val);<br>                <span class="hljs-keyword">debugger</span>;<br>    cookieTemp = val;<br>    <span class="hljs-keyword">return</span> val;<br>  &#125;,<br>  <span class="hljs-comment">// hook get 方法也就是取值的方法</span><br>  <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)<br>  &#123;<br>   <span class="hljs-keyword">return</span> cookieTemp;<br>  &#125;<br>    &#125;);<br>&#125;)();<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230603104637975.png" alt="image-20230603104637975"></p><p>这里是假cookie 真实的cookie是下面的  <code>_$T4(768, 1)</code></p><p><img src="/images/image-20230603104825221.png" alt="image-20230603104825221"></p><p><img src="/images/image-20230603104916069.png" alt="image-20230603104916069"></p><p>真实cookie</p><p><img src="/images/image-20230603105544374.png" alt="image-20230603105544374"></p><p>再下一个堆栈 我们能看到一个自执行的函数，然后再上一层，我们能看到一个eval.call方法 <code>$7S.call(_$qn, _$Ha)</code> ，执行之后就得到一个vm虚拟机的代码，就是上面的自执行代码，执行这里的代码 会生成我们要的80Tcookie</p><p><img src="/images/image-20230603105820731.png" alt="image-20230603105820731"></p><p>当前页面是一个html页面，也就是抓包返回的202页面</p><p><img src="/images/image-20230603110055326.png" alt="image-20230603110055326"></p><p>我们手动修改一下html页面，回到首页，选择html页面，保存以备替代，然后我们就可以再覆盖页面找到index.html</p><p><img src="/images/image-20230603110449688.png" alt="image-20230603110449688"></p><p><img src="/images/image-20230603110958554.png" alt="image-20230603110958554"></p><p>我们搜索一下 call 关键字，因为代码是会混淆，但是关键字不会，搜索出来只有一处，也就是上面的 <code>$7S.call(_$qn, _$Ha)</code>，再拉到最上面，能看到它加载了一个js，上面还有一个meta标签,里面的内容是一段看不懂的代码，每次都是变化的。引用的 <code>js</code>文件 直接打开看是乱码的，而自执行 JS 的主要作用是将这 JS 乱码还原成 VM 里的 1w+ 行的正常代码，并且定义了一个全局变量 <code>window.$_ts</code> 并赋了许多值</p><p><img src="/images/image-20230603111111107.png" alt="image-20230603111111107"></p><p><img src="/images/image-20230603113124060.png" alt="image-20230603113124060"></p><p>我们添加一个脚本断点，刷新页面，多运行几次，最后来到这里，这里也就是202请求后返回的js文件，我们可以把它复制下来，也可以直接从抓包处下载，然后我们再把首页下面的js代码复制下来</p><p><img src="/images/image-20230603113251534.png" alt="image-20230603113251534"></p><p><img src="/images/image-20230603114302640.png" alt="image-20230603114302640"></p><p><img src="/images/image-20230603114523466.png" alt="image-20230603114523466"></p><p>我们可以看到第一行代码有个 <code>$_ts = window[&#39;$_ts&#39;];</code>，这个window.$_ts作用非常大，里面赋值了很多东西，我们可以运行一下，提示没有window，我们追着报错把需要的补上，一个是补window，一个是把eval方法给补上</p><p><img src="/images/image-20230603114855521.png" alt="image-20230603114855521"></p><p><img src="/images/image-20230603125728891.png" alt="image-20230603125728891"></p><p><img src="/images/image-20230603151744596.png" alt="image-20230603151744596"></p><p>这里的目的是为了让加载的js代码以eval的形式执行出来</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> eval_js = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-variable language_">window</span> = &#123;<br>    <span class="hljs-attr">$_ts</span>: &#123;&#125;,<br>    <span class="hljs-attr">eval</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>        eval_js = data;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">toString</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">return</span> eval_js;<br>&#125;&#125;&#125;&#125;<br></code></pre></td></tr></table></figure><p>最后再打印一下，看下结果，和浏览器打印出来的结果一样，eval_js既是vm中的代码</p><p><img src="/images/image-20230603151852209.png" alt="image-20230603151852209"></p><h3 id="扣取流程"><a href="#扣取流程" class="headerlink" title="扣取流程"></a>扣取流程</h3><p>接着，我们回到cookie生成的位置，将这段代码扣下来，我们最终要的cookie是在这里生成的</p><p><img src="/images/image-20230603152520939.png" alt="image-20230603152520939"></p><p>然后我们再看一下vm里面的代码，上面从$ts中取出了很多变量，并进行了赋值，这种赋值操作一直持续到了308行，我们把这些代码扣下来</p><p><img src="/images/image-20230603161439098.png" alt="image-20230603161439098"></p><p><img src="/images/image-20230603161721158.png" alt="image-20230603161721158"></p><p>随后 我们运行一下，报错，我们再网页看一下这个是什么，这里是以单引号的形式将传入的字符串进行分割，返回一个大数组，我们将这个方法扣下来，然后还有上面一个方法也要扣下来，这里每一次扣都需要小心，如果页面刷新了，就会导致代码不一样，所以最好不要刷新页面, </p><p><img src="/images/image-20230603162310820.png" alt="image-20230603162310820"></p><p><img src="/images/image-20230603163537731.png" alt="image-20230603163537731"></p><p><img src="/images/image-20230603163759707.png" alt="image-20230603163759707"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">_$9o</span>(<span class="hljs-params">_$XZ</span>) &#123;<br>        <span class="hljs-keyword">var</span> _$fw = _$XZ.<span class="hljs-property">length</span>;<br>        <span class="hljs-keyword">var</span> _$_B, _$yV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(_$fw - <span class="hljs-number">1</span>), _$Pp = _$XZ.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>) - <span class="hljs-number">97</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _$1C = <span class="hljs-number">0</span>, _$6e = <span class="hljs-number">1</span>; _$6e &lt; _$fw; ++_$6e) &#123;<br>            _$_B = _$XZ.<span class="hljs-title function_">charCodeAt</span>(_$6e);<br>            <span class="hljs-keyword">if</span> (_$_B &gt;= <span class="hljs-number">40</span> &amp;&amp; _$_B &lt; <span class="hljs-number">92</span>) &#123;<br>                _$_B += _$Pp;<br>                <span class="hljs-keyword">if</span> (_$_B &gt;= <span class="hljs-number">92</span>)<br>                    _$_B = _$_B - <span class="hljs-number">52</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_$_B &gt;= <span class="hljs-number">97</span> &amp;&amp; _$_B &lt; <span class="hljs-number">127</span>) &#123;<br>                _$_B += _$Pp;<br>                <span class="hljs-keyword">if</span> (_$_B &gt;= <span class="hljs-number">127</span>)<br>                    _$_B = _$_B - <span class="hljs-number">30</span>;<br>            &#125;<br>            _$yV[_$1C++] = _$_B;<br>        &#125;<br>        <span class="hljs-keyword">return</span> _$li.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, _$yV);<br>&#125;<br><span class="hljs-comment">// 分割函数 返回数组</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_$fw</span>(<span class="hljs-params">_$XZ</span>) &#123;<br>        <span class="hljs-keyword">var</span> _$fw = <span class="hljs-title function_">_$li</span>(<span class="hljs-number">96</span>);<br>        _$AE = <span class="hljs-title function_">_$9o</span>(_$XZ).<span class="hljs-title function_">split</span>(_$fw);<br>&#125;<br></code></pre></td></tr></table></figure><p>接着报错没有 location，我们再浏览器中找到对应代码，断点过来，能发现是window下面的top的location， 我们再控制台打印location并复制过来,然后再window变量下添加location</p><p><img src="/images/image-20230603164337760.png" alt="image-20230603164337760"></p><p><img src="/images/image-20230603164831116.png" alt="image-20230603164831116"></p><p><img src="/images/image-20230603164513643.png" alt="image-20230603164513643"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript">location = &#123;<br>    <span class="hljs-string">&quot;ancestorOrigins&quot;</span>: &#123;&#125;,<br>    <span class="hljs-string">&quot;href&quot;</span>: <span class="hljs-string">&quot;http://www.fangdi.com.cn/&quot;</span>,<br>    <span class="hljs-string">&quot;origin&quot;</span>: <span class="hljs-string">&quot;http://www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;http:&quot;</span>,<br>    <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;hostname&quot;</span>: <span class="hljs-string">&quot;www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;pathname&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>    <span class="hljs-string">&quot;search&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;hash&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>&#125;<br><span class="hljs-variable language_">window</span> = &#123;<br>    <span class="hljs-attr">$_ts</span>: &#123;&#125;,<br>    <span class="hljs-attr">eval</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>        eval_js = data;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">toString</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">return</span> eval_js;<br>            &#125;<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">top</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> location;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>接着运行，补报错</p><p>接下来不在详细演示，这里提供报错的位置和需要注意的地方</p><p><code>190行 _$eB()</code> 需要补充document 的 createElement方法，以及下面的 <code>getElementsByTagName</code></p><p><img src="/images/image-20230603165937269.png" alt="image-20230603165937269"></p><p><code>480行 _$7Q 报错</code> ,这里也是一大段赋值的操作，下面有一个大循环，也是vm生成的地方，所以把3200行以下的代码全部抠出来</p><p><img src="/images/image-20230603171757340.png" alt="image-20230603171757340"></p><p><code>336 _$zk()</code> 报错，需要再document下补characterSet方法 和 “charset”方法</p><p><img src="/images/image-20230603174703707.png" alt="image-20230603174703707"></p><p><code>337、338 _$yH _$kS</code> 补上就行</p><p><code>195 _$6t 196 _$Y2 _$Fn</code> 顺便补上 window 下的addEventListener 和下面的  “attachEvent”</p><p><img src="/images/image-20230603185705753.png" alt="image-20230603185705753"></p><p><code>830 _$iq[_$AE[21]]</code> document 补上 getElementById</p><p><img src="/images/image-20230603190758814.png" alt="image-20230603190758814"></p><p><code>202 _$vn();</code> 补上 localStorage</p><p><img src="/images/image-20230603191210872.png" alt="image-20230603191210872"></p><p><code>203  _$Hj -&gt; 1240  _$B7 _$OA _$4T _$T8</code> 进去之后这些方法都没有，补上就行</p><p><img src="/images/image-20230603205814938.png" alt="image-20230603205814938"></p><p><code>204 _$k7</code> 没有的都补上</p><p><img src="/images/image-20230603210129456.png" alt="image-20230603210129456"></p><p><code>212 _$Lu(); 213 _$FO() 218 _$HD 220 _$FJ  _$Gg</code>  这里需要再document下补上 getElementsByTagName 以及补上5个mate参数，最后一个是html页面meta标签加载的内容，同时还要再补上它的parentNode下的removeChild方法</p><p><img src="/images/image-20230603211744200.png" alt="image-20230603211744200"></p><p><img src="/images/image-20230603211752502.png" alt="image-20230603211752502"></p><p><img src="/images/image-20230603212726610.png" alt="image-20230603212726610"></p><p><code>221 _$aN() 1462 _$kQ 1470 _$1E 1367 _$eL</code> 正常补就行</p><p><code>223 _$Uf</code> 不要将window下面三个属性给补上</p><p><img src="/images/image-20230603214836351.png" alt="image-20230603214836351"></p><p><img src="/images/image-20230603215236521.png" alt="image-20230603215236521"></p><p><img src="/images/image-20230603215434016.png" alt="image-20230603215434016"></p><p>当我们打上断点进入 <strong><code>_$Uf</code></strong> 的 判断逻辑是，我们的代码并没有进入，而浏览器中则进入了if条件中</p><p><img src="/images/image-20230603215736453.png" alt="image-20230603215736453"></p><p><img src="/images/image-20230603215811067.png" alt="image-20230603215811067"></p><p>原因则在于 <code>_$XZ</code> 是window,而我们的window下的top并没有指向window，所以我们要用defineProperty 方法修改它</p><p><img src="/images/image-20230603220030089.png" alt="image-20230603220030089"></p><p><img src="/images/image-20230603220056713.png" alt="image-20230603220056713"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">window</span>, <span class="hljs-string">&quot;location&quot;</span>, &#123;<span class="hljs-attr">value</span>: location, <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>&#125;);<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">window</span>, <span class="hljs-string">&quot;top&quot;</span>, &#123;<span class="hljs-attr">value</span>: <span class="hljs-variable language_">window</span>, <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>&#125;);<br></code></pre></td></tr></table></figure><p>继续往下执行，浏览器中跳过了return，而我们这边则进入了return，原因在于我们上面传入的是个undefine,而实际上这里应该要是一个string，而这里是window.name,所以还需要再window下把name加上</p><p><img src="/images/image-20230603221748147.png" alt="image-20230603221748147"></p><p><img src="/images/image-20230603221755826.png" alt="image-20230603221755826"></p><p><img src="/images/image-20230603222039696.png" alt="image-20230603222039696"></p><p>同样往下执行还有一个 openDatabase 需要补上，还有一个escape</p><p><img src="/images/image-20230603222714307.png" alt="image-20230603222714307"></p><p><img src="/images/image-20230603222953537.png" alt="image-20230603222953537"></p><p>接着 继续</p><p><code>228 _$xZ(); 229 _$nq  _$Yd 236 _$a8</code>  补上</p><p><img src="/images/image-20230603223507482.png" alt="image-20230603223507482"></p><p>接下来 报错 userAgent，说明需要补上 navigator</p><p><img src="/images/image-20230603224018017.png" alt="image-20230603224018017"></p><p>接着 </p><p><code>4891 _$C_  5068 _$0P _$VK  2333 _$ic 2337  _$f0</code> 补上</p><p>然后，这是一个window下的定时器，我们没有，补上</p><p><img src="/images/image-20230603225609120.png" alt="image-20230603225609120"></p><p><img src="/images/image-20230603225617896.png" alt="image-20230603225617896"></p><p>继续</p><p><code>275 _$Mc</code> 这一段代码比较长</p><p>这里是 addEventListener 和 attachEvent ，我们之前补了，但是是再window下，但是这里是再document，所以还需要再document下加上 addEventListener 和 attachEvent</p><p><img src="/images/image-20230603230255517.png" alt="image-20230603230255517"></p><p><img src="/images/image-20230603230313923.png" alt="image-20230603230313923"></p><p>继续，这里的所有方法都要补上</p><p><img src="/images/image-20230603230847682.png" alt="image-20230603230847682"></p><p>继续</p><p><code>3606 _$Ia 3189 _$MT  305 _$MZ();</code> 同时在这里呢 document 下的getElementsByTagName需要再返回script数组，</p><p><img src="/images/image-20230603232600351.png" alt="image-20230603232600351"></p><p><img src="/images/image-20230603232711503.png" alt="image-20230603232711503"></p><p><code>308 _$FG(); 4956 _$3f</code> 一直补，直到报错到这里，这里是window下没有math方法，需要补上</p><p><img src="/images/image-20230603233805785.png" alt="image-20230603233805785"></p><p><img src="/images/image-20230603233840593.png" alt="image-20230603233840593"></p><p>接着 ，这一段直接缺啥补啥就好，比较长，慢慢补，直到没有报错</p><p><code>3533 _$$r 3476 _$jK 4675 _$gp 2025 _$84 4716 _$q2  4047 _$kH  4838 _$Eo 1808 _$Xa  1821 _$kr</code></p><p>补的过程中需要慢慢调试，同时验证再node环境下的值和浏览器中的值是否存在差异</p><p>如果都没有问题，最终我们也是可以拿到cookie的</p><p><img src="/images/image-20230606145625194.png" alt="image-20230606145625194"></p><p>由于代码太长，这里给到补充浏览器环境所需要的各项配置,需要注意的是，document 下 的 content和每次加载的js文件都需要再每次请求的时候进行替换，要不然生成的cookie没用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs javascript">location = &#123;<br>    <span class="hljs-string">&quot;ancestorOrigins&quot;</span>: &#123;&#125;,<br>    <span class="hljs-string">&quot;href&quot;</span>: <span class="hljs-string">&quot;http://www.fangdi.com.cn/&quot;</span>,<br>    <span class="hljs-string">&quot;origin&quot;</span>: <span class="hljs-string">&quot;http://www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;http:&quot;</span>,<br>    <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;hostname&quot;</span>: <span class="hljs-string">&quot;www.fangdi.com.cn&quot;</span>,<br>    <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;pathname&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>    <span class="hljs-string">&quot;search&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;hash&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>&#125;<br>navigator = &#123;<br>    <span class="hljs-attr">appCodeName</span>: <span class="hljs-string">&quot;Mozilla&quot;</span>,<br>    <span class="hljs-attr">appName</span>: <span class="hljs-string">&quot;Netscape&quot;</span>,<br>    <span class="hljs-attr">appVersion</span>: <span class="hljs-string">&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.57&quot;</span>,<br>    <span class="hljs-attr">hardwareConcurrency</span>: <span class="hljs-number">16</span>,<br>    <span class="hljs-attr">language</span>: <span class="hljs-string">&quot;zh-CN&quot;</span>,<br>    <span class="hljs-attr">platform</span>: <span class="hljs-string">&quot;Win32&quot;</span>,<br>    <span class="hljs-attr">product</span>: <span class="hljs-string">&quot;Gecko&quot;</span>,<br>    <span class="hljs-attr">productSub</span>: <span class="hljs-string">&quot;20030107&quot;</span>,<br>    <span class="hljs-attr">userAgent</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.57&quot;</span>,<br>    <span class="hljs-attr">vendor</span>: <span class="hljs-string">&quot;Google Inc.&quot;</span>,<br>&#125;<br><br><span class="hljs-comment">// document 下 的 content也是需要替换</span><br><span class="hljs-variable language_">window</span> = &#123;<br>    <span class="hljs-attr">$_ts</span>: &#123;&#125;,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">eval</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>        eval_js = data;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">toString</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">return</span> eval_js;<br>            &#125;<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">top</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// return location;</span><br>    &#125;,<br>    <span class="hljs-attr">document</span>: &#123;<br>        <span class="hljs-title function_">createElement</span>(<span class="hljs-params">tagName</span>) &#123;<br>            <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">&quot;div&quot;</span>) &#123;<br>                <span class="hljs-keyword">return</span> &#123;<br>                    <span class="hljs-attr">getElementsByTagName</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) &#123;<br>                        <span class="hljs-keyword">if</span> (name == <span class="hljs-string">&quot;i&quot;</span>) &#123;<br>                            <span class="hljs-keyword">return</span> &#123;<br>                                <span class="hljs-attr">length</span>: <span class="hljs-number">0</span>,<br>                            &#125;<br>                        &#125;<br>                    &#125;,<br>                    <span class="hljs-attr">innerHTML</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span><br>                    &#125;,<br>                &#125;<br>            &#125;<br>        &#125;,<br>        <span class="hljs-attr">characterSet</span>: <span class="hljs-string">&quot;UTF-8&quot;</span>,<br>        <span class="hljs-attr">charset</span>: <span class="hljs-string">&quot;UTF-8&quot;</span>,<br>        <span class="hljs-title function_">getElementById</span>(<span class="hljs-params">elementId</span>) &#123;<br>            <span class="hljs-keyword">if</span> (elementId == <span class="hljs-string">&quot;__anchor__&quot;</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>        &#125;,<br>        <span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-params">name</span>) &#123;<br>            <span class="hljs-keyword">if</span> (name == <span class="hljs-string">&quot;meta&quot;</span>) &#123;<br>                <span class="hljs-keyword">return</span> [<br>                    &#123;<span class="hljs-string">&quot;charset&quot;</span>: <span class="hljs-string">&quot;utf-8&quot;</span>&#125;,<br>                    &#123;<span class="hljs-string">&quot;http-equiv&quot;</span>: <span class="hljs-string">&quot;X-UA-Compatible&quot;</span>&#125;,<br>                    &#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;keywords&quot;</span>&#125;,<br>                    &#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;description&quot;</span>&#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;&#123;qr0m26649qqq&#123;EUN27LCj.RHAa_koLHI34Zs.qMxzj9bspieV.ucukQWAdnuMWHNz9bKnKhQg7nuBrQWQ6T1.Fqql3650Ddfe167qqr0c80qqVwcrmm9aVASpmll0AAfTW 0wR7HvJ6IsUC410DntKRngA;QyqA82EGtIB6ePNEeYo9NG;iEm6gdSTTpYiqU10OlvsnG;yMG8gk5okQ97gP4eb.IadA;T8F36FaS9AtR4sXBkRr0iG;RTlM3IYjAzboXbIiNSIFRA;t7_svh3Kc3.VU9jOjAJgdq;.8D9Zx78FrKF.Zn4xbfmIG;IMhCM7gXESIqShs5TNMo9A;pvBPF7OtrK6trS5vZYizwa;9qxqLXuEeDQeAlNfAL_l.A;VNeyFcNDtQZhV2sfCxyHqA;kT4JL2WRSOhvUIEcOjSrva;LpFhLGWYI8eFx_X999MLEq;NqssQaVItFB0TevtNxJrkG;AI3RN3R7lP0BBnYsoCO5KG;xrYRhwM6FYW7zCsPL.iecq;0kOXzZzt1eXLrlPo.QQ4xG;ApKNqLIRoybF5rIxSnabBG;hfgZrtz_KscdFC6a3f1wKA;qqr1QHzat_Gu9kiLWyaMYce3xTGOVre3oqqqqqqq|[tnz1ol251U0AYSSJ8YxMc9NZlGrP3prgpvJQ8bZk1qfGkTe7D07w3frwDvA8JmSSUop08DEfKc2cIVEPKcpcQbeu8STIcCwCIP98JK3Llkx1JKmL3pf1ovl_IkrnW27JArz3o2e2RuJjRVq71GNJrmaJAGYrkYaqlcrgJD9j3GVFH0ap11EQESrF8GTerDLT1pSvxKEUlkSXqVQlAfwQA9fVMAJfrbSEDuGmD062D.QQzaUNKheHjC653IT7BpBHr8yJ4fj_ohGmymP0AQQ3jl4L1Qp4yfcfKwSzZf6nRwV8jmXGIip55f49UezDnpqqqYRM5rqL0xDyPmOGCbasu1_qqqqqqqJ1685761368038lVi2dqqhiSSIxIXI1snKF6Pp3Df75MVnHdkzCHw8hqqqt10747904641mUZ_mvB9QH94_boX8Aqqk162iE9VAIpwSmolp8aq!x7z,aac,amr,asm,avi,bak,bat,bmp,bin,c,cab,css,csv,com,cpp,dat,dll,doc,dot,docx,exe,eot,fla,flc,fon,fot,font,gdb,gif,gz,gho,hlp,hpp,htc,ico,ini,inf,ins,iso,js,jar,jpg,jpeg,json,java,lib,log,mid,mp4,mpa,m4a,mp3,mpg,mkv,mod,mov,mim,mpp,msi,mpeg,obj,ocx,ogg,olb,ole,otf,py,pyc,pas,pgm,ppm,pps,ppt,pdf,pptx,png,pic,pli,psd,qif,qtx,ra,rm,ram,rmvb,reg,res,rtf,rar,so,sbl,sfx,swa,swf,svg,sys,tar,taz,tif,tiff,torrent,txt,ttf,vsd,vss,vsw,vxd,woff,woff2,wmv,wma,wav,wps,xbm,xpm,xls,xlsx,xsl,xml,z,zip,apk,plist,ipahSFsIYTX_uWUkxbWqql4096qqq&quot;</span>,<br>                        <span class="hljs-attr">parentNode</span>: &#123;<br>                            <span class="hljs-attr">removeChild</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) &#123;<br>                            &#125;<br>                        &#125;<br>                    &#125;,<br>                ]<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name == <span class="hljs-string">&quot;script&quot;</span>) &#123;<br>                <span class="hljs-keyword">return</span> [&#123;<br>                    <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&quot;text/javascript&quot;</span>,<br>                    <span class="hljs-string">&#x27;charset&#x27;</span>: <span class="hljs-string">&quot;iso-8859-1&quot;</span>,<br>                    <span class="hljs-string">&#x27;src&#x27;</span>: <span class="hljs-string">&quot;/4QbVtADbnLVIc/d.FxJzG50F.dfe1675.js&quot;</span>,<br>                    <span class="hljs-string">&#x27;r&#x27;</span>: <span class="hljs-string">&quot;m&quot;</span>,<br>                    <span class="hljs-attr">getAttribute</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;m&quot;</span><br><br>                    &#125;,<br>                    <span class="hljs-attr">parentElement</span>: &#123;<br>                        <span class="hljs-attr">removeChild</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                        &#125;<br>                    &#125;,<br><br>                &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&quot;text/javascript&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>: <span class="hljs-string">&quot;m&quot;</span>,<br>                        <span class="hljs-attr">getAttribute</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;m&quot;</span><br><br>                        &#125;, <span class="hljs-attr">parentElement</span>: &#123;<br>                            <span class="hljs-attr">removeChild</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                            &#125;<br>                        &#125;,<br>                    &#125;]<br>            &#125;<br>        &#125;,<br>        <span class="hljs-title function_">addEventListener</span>(<span class="hljs-params">type, listener, options</span>) &#123;<br>            <span class="hljs-comment">// listener();</span><br>            <span class="hljs-built_in">eval</span>(listener);<br>        &#125;,<br>        <span class="hljs-title function_">attachEvent</span>(<span class="hljs-params">type, listener</span>) &#123;<br>            <span class="hljs-built_in">eval</span>(listener);<br>        &#125;,<br>    &#125;,<br>    <span class="hljs-title function_">addEventListener</span>(<span class="hljs-params">type, listener, options</span>) &#123;<br>        <span class="hljs-built_in">eval</span>(listener);<br>    &#125;,<br>    <span class="hljs-title function_">attachEvent</span>(<span class="hljs-params">type, listener</span>) &#123;<br>        <span class="hljs-built_in">eval</span>(listener);<br>    &#125;,<br>    <span class="hljs-attr">localStorage</span>: &#123;<br>        <span class="hljs-string">&quot;__#classType&quot;</span>: <span class="hljs-string">&quot;localStorage&quot;</span>,<br>        <span class="hljs-title function_">getItem</span>(<span class="hljs-params">key</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[key]<br>        &#125;,<br>        <span class="hljs-title function_">setItem</span>(<span class="hljs-params">key, value</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[key] = value;<br>        &#125;,<br>        <span class="hljs-title function_">removeItem</span>(<span class="hljs-params">key</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>[key];<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">sessionStorage</span>: &#123;<br>        <span class="hljs-title function_">getItem</span>(<span class="hljs-params">key</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[key]<br>        &#125;,<br>        <span class="hljs-title function_">setItem</span>(<span class="hljs-params">key, value</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[key] = value;<br>        &#125;,<br>        <span class="hljs-title function_">removeItem</span>(<span class="hljs-params">key</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>[key];<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">indexedDB</span>: &#123;&#125;,<br>    <span class="hljs-attr">openDatabase</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b, c, d</span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">version</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">escape</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">escape</span>(data);<br>    &#125;,<br>    <span class="hljs-attr">navigator</span>: navigator,<br>    <span class="hljs-attr">setInterval</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">func, time</span>) &#123;<br>        <span class="hljs-built_in">eval</span>(func)<br>    &#125;,<br>    <span class="hljs-title class_">Math</span>: <span class="hljs-title class_">Math</span>,<br><br>&#125;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">window</span>, <span class="hljs-string">&quot;location&quot;</span>, &#123;<span class="hljs-attr">value</span>: location, <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>&#125;);<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">window</span>, <span class="hljs-string">&quot;top&quot;</span>, &#123;<span class="hljs-attr">value</span>: <span class="hljs-variable language_">window</span>, <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230606145142133.png" alt="image-20230606145142133"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cookie </tag>
            
            <tag> 瑞数4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓aosp编译刷机过root检测</title>
      <link href="/2023/01/11/%E5%AE%89%E5%8D%93aosp%E7%BC%96%E8%AF%91%E5%88%B7%E6%9C%BA%E8%BF%87root%E6%A3%80%E6%B5%8B/"/>
      <url>/2023/01/11/%E5%AE%89%E5%8D%93aosp%E7%BC%96%E8%AF%91%E5%88%B7%E6%9C%BA%E8%BF%87root%E6%A3%80%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="安卓aosp编译刷机过root检测"><a href="#安卓aosp编译刷机过root检测" class="headerlink" title="安卓aosp编译刷机过root检测"></a>安卓aosp编译刷机过root检测</h1><blockquote><p>前提设备：</p><p>​一部已经解锁oem的手机，我这里用的是pixel3a</p><p>​虚拟机内安装ubuntu系统，版本是 18.04.6，其它版本也没有什么问题</p></blockquote><h2 id="刷机"><a href="#刷机" class="headerlink" title="刷机"></a>刷机</h2><h3 id="1-根据机型确定镜像文件与驱动"><a href="#1-根据机型确定镜像文件与驱动" class="headerlink" title="1.根据机型确定镜像文件与驱动"></a>1.根据机型确定镜像文件与驱动</h3><p>我的手机是pixel3a，准备刷安卓10</p><ul><li><p>官方包 <a href="https://developers.google.cn/android/images%EF%BC%88%E5%AF%B9%E5%BA%94%E7%9A%84%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6%EF%BC%89">https://developers.google.cn/android/images（对应的镜像文件）</a>      QP1A.190711.020<br><img src="/images/image-20230608141805026.png" alt="image-20230608141805026"></p></li><li><p>AOSP版 <a href="https://source.android.com/docs/setup/about/build-numbers">https://source.android.com/docs/setup/about/build-numbers</a>     QP1A.190711.020 android-10.0.0_r2 （这里是用于确定我们的手机适用的安卓10版本）<br><img src="/images/image-20230608142130388.png" alt="image-20230608142130388"></p></li><li><p>Piexl 4驱动 <a href="https://developers.google.cn/android/drivers">https://developers.google.cn/android/drivers</a> （下载对应的驱动文件）    QD1A.190821.011<br><img src="/images/image-20230608142410318.png" alt="image-20230608142410318"></p></li></ul><h3 id="2-系统初始化"><a href="#2-系统初始化" class="headerlink" title="2.系统初始化"></a>2.系统初始化</h3><ul><li><p>Python软连接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo ln -s /usr/bin/python3.6  /usr/bin/python<br></code></pre></td></tr></table></figure></li><li><p>git</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt install git -y<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">git config --global user.name &quot;xxxx&quot;<br>git config --global user.email &quot;xxxx@live.com&quot;<br></code></pre></td></tr></table></figure></li><li><p>curl</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt install curl -y<br></code></pre></td></tr></table></figure></li><li><p>其他（可选）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt install net-tools openssh-server vim -y<br></code></pre></td></tr></table></figure></li></ul><h3 id="3-同步源码"><a href="#3-同步源码" class="headerlink" title="3.同步源码"></a>3.同步源码</h3><p>利用清华源去同步源码，国内主要是：清华源、中科大源（推荐清华）。</p><p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/">https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/</a></p><ul><li><p>下载repo + 环境变量 + 可执行权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">mkdir ~/bin<br>PATH=~/bin:$PATH<br>curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo &gt; ~/bin/repo<br>chmod a+x ~/bin/repo<br></code></pre></td></tr></table></figure></li><li><p>环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">export REPO_URL=&#x27;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo&#x27;<br></code></pre></td></tr></table></figure></li><li><p>创建aosp文件夹目录（以后放在代码）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cd ~/bin<br>mkdir aosp<br>cd aosp<br></code></pre></td></tr></table></figure></li><li><p>指定同步版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b 自己的安卓版本<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b android-10.0.0_r2<br></code></pre></td></tr></table></figure></li><li><p>开始同步代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">repo sync -j4<br></code></pre></td></tr></table></figure><p>这里同步所需要的时间非常长，建议晚上睡觉的视乎再同步，同步完，就会显示如下提示</p><p><strong>建议：打上快照</strong></p></li></ul><p><img src="/images/image-20230607180134980.png" alt="image-20230607180134980"></p><h3 id="4-执行驱动程序"><a href="#4-执行驱动程序" class="headerlink" title="4.执行驱动程序"></a>4.执行驱动程序</h3><p>将下载的驱动程序解压出来放到aosp目录下，执行这两个脚本</p><p><img src="/images/image-20230608142925501.png" alt="image-20230608142925501"></p><p><img src="/images/image-20230607181400554.png" alt="image-20230607181400554"></p><p><img src="/images/image-20230607181449604.png" alt="image-20230607181449604"></p><p>另一个脚本也是相同的操作</p><p><img src="/images/image-20230607181612505.png" alt="image-20230607181612505"></p><h3 id="5-编译aosp源码"><a href="#5-编译aosp源码" class="headerlink" title="5.编译aosp源码"></a>5.编译aosp源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cd ~/bin/aosp<br>source build/envsetup.sh<br>lunch  // 这里会让你选择相对应的版本，我的手机是pexel3a，对应的标识是sargo,其它版本的手机标识不一样<br>选择序号<br></code></pre></td></tr></table></figure><p>userdebug的意思是默认手机已root</p><p><img src="/images/image-20230607183319002.png" alt="image-20230607183319002"></p><p><img src="/images/image-20230607183518705.png" alt="image-20230607183518705"></p><p><strong>然后 make -j16  开始编译，16指的是16个并发</strong></p><p>如果报错的话，根据报错去搜索对应的解决方法</p><p><img src="/images/image-20230607184430488.png" alt="image-20230607184430488"></p><p><img src="/images/image-20230608092209206.png" alt="image-20230608092209206"></p><h3 id="6-刷入系统"><a href="#6-刷入系统" class="headerlink" title="6.刷入系统"></a>6.刷入系统</h3><p>再Ubuntu内安装platform-tools</p><p>需要先将手机连接至虚拟机，将手机usb连接电脑，会弹出下面对话框，选择连接到虚拟机就好</p><p><img src="/images/image-20230608104839198.png" alt="image-20230608104839198"></p><p><strong>安装 platform-tools</strong></p><p>推荐的版本是 <code>platform-tools_r30.0.5</code> 其它版本可能会报错</p><ul><li><p>下载（根据系统选择）<br><a href="https://dl.google.com/android/repository/platform-tools_r30.0.5-linux.zip">https://dl.google.com/android/repository/platform-tools_r30.0.5-linux.zip</a></p></li><li><p>ubuntu配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">第1步：解压platform-tools并放在用户根目录，例如：~/platform-tools/adb<br>第2步：配置环境环境变量 gedit ~/.bashrc <br>第3步：source ~/.bashrc<br>第4步：执行adb或fastboot时，前面记得加sudo<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">export PATH=~/platform-tools:$PATH<br>alias sudo=&quot;sudo env PATH=$PATH&quot;<br></code></pre></td></tr></table></figure></li></ul><p>执行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo adb devices<br>sudo adb reboot bootloader<br><br>sudo fastboot devices<br><br>cd ~/bin/aosp<br>source build/envsetup.sh <br>sudo ANDROID_PRODUCT_OUT=/home/lli/bin/aosp/out/target/product/sargo  fastboot flashall -w  // 这里的路径是编译后生成的路径，需要改成自己的<br><br></code></pre></td></tr></table></figure><p><img src="/images/image-20230608143845802.png" alt="image-20230608143845802"></p><p><img src="/images/image-20230608143857055.png" alt="image-20230608143857055"></p><p><img src="/images/image-20230608140536749.png" alt="image-20230608140536749"></p><p>刷机完成，刷完会会是一个相对古老的界面</p><p><img src="/images/image-20230608144140417.png" alt="image-20230608144140417"></p><h2 id="https证书"><a href="#https证书" class="headerlink" title="https证书"></a>https证书</h2><h3 id="为什么"><a href="#为什么" class="headerlink" title="为什么"></a>为什么</h3><blockquote><p>安卓七及以后的系统想要抓https的包需要将用户层的证书移到系统层，可以在已root的环境下通过magisk的move cert插件将证书移至系统层</p><p>在手机刷入aosp系统后，可以通过修改aosp源码，将证书移入系统，重新编译，再刷入手机</p></blockquote><h3 id="证书下载"><a href="#证书下载" class="headerlink" title="证书下载"></a>证书下载</h3><p><img src="/images/image-20230611141646401.png" alt="image-20230611141646401"></p><p>需要使用openssl工具对证书进行处理</p><h3 id="OpenSSL证书处理"><a href="#OpenSSL证书处理" class="headerlink" title="OpenSSL证书处理"></a>OpenSSL证书处理</h3><p>需要提前在自己电脑上下载并安装 OpenSSL。</p><p><a href="http://slproweb.com/products/Win32OpenSSL.html">http://slproweb.com/products/Win32OpenSSL.html</a></p><p><img src="/images/image-20220428191016704.png" alt="image-20220428191016704"></p><p><img src="/images/image-20230611142546996.png" alt="image-20230611142546996"></p><p>运行 <code>openssl工具  x509 -subject_hash_old -in  证书文件路径</code>，然后将证书重命名为运行后的字符串.0</p><p><img src="/images/image-20230611142609404.png" alt="image-20230611142609404"></p><p>至此，我们就将证书文件处理成了 <code>6f33e75b.0</code> 文件（你的文件名可能跟我的不一样）</p><p>将证书文件放到aosp路径下的  <code>system/ca-certificates/files</code>目录</p><p><img src="/images/image-20230611143048235.png" alt="image-20230611143048235"></p><h2 id="Root检测"><a href="#Root检测" class="headerlink" title="Root检测"></a>Root检测</h2><h3 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h3><blockquote><p>手机已root后，手机系统目录下会有一个su文件，每次获取root权限时，都会调用该文件</p><p>大部分的app进行root检测时，都会去找这个su文件，一旦找到，就认定你是进入root模式</p><p>除此之外，还有一些会检测你手机上有没有magisk之类的软件</p></blockquote><h3 id="绕过："><a href="#绕过：" class="headerlink" title="绕过："></a>绕过：</h3><blockquote><p>hook：去找到触发root检测的代码位置，然后进行修改或者返回为空</p><p>定制aosp：修改源码，隐藏或者不生成su文件，而拥有root权限</p></blockquote><h3 id="编译选项："><a href="#编译选项：" class="headerlink" title="编译选项："></a>编译选项：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">android编译的时候可以选择编译选项 eng、user 和 userdebug。<br><br>1.eng编译选项<br>(1). 系统编译的时候安装标签LOCAL_MODULE_TAGS为 user、debug、eng 的模块<br>(2). 设定属性 ro.secure=0，关闭安全检查功能<br>(3). 设定属性 ro.debuggable=1，启用应用调试功能<br>(4). 默认打开 adb 功能，adb默认拥有root权限<br>(5). 编译完成之后系统会带有eng字眼的文件<br><br>2.userdebug编译选项【默认】<br>(1). 系统编译的时候安装标签LOCAL_MODULE_TAGS为 user、debug 的模块<br>(2). 设定属性 ro.secure=1，打开安全检查功能<br>(3). 设定属性 ro.debuggable=1，启用应用调试功能<br>(4). 默认打开 adb 功能，adb拥有root权限<br>(5). userdebug与“user”类似,但具有root权限和调试功能；是进行调试时的首选编译类型<br><br>3.user编译选项<br>(1). 系统编译的时候安装标签LOCAL_MODULE_TAGS为 user的模块<br>(2). 设定属性 ro.secure=1，打开安全检查功能<br>(3). 设定属性 ro.debuggable=0，关闭应用调试功能<br>(4). 默认关闭 adb 功能，adb无root权限<br>(5). 权限受限,适用于生产环境<br><br>综上总结:<br>eng就是工程师用的开发测试环境，方便开发调试各种软硬件之间的交互、性能等等。<br>userdebug就是user版本发布之前的开发调试版本<br>user就是生产环境用的版本，平时我们正规渠道买的手机都是user版本的。<br><br>目前很多App检测运行环境是否正常的检测点之一就是检测当前运行的系统属于哪个编译选项。eng、userdebug都是属于风险设备考虑范畴。<br><br>最终我们编译时，要选择user版本，通过修改源码，让其默认拥有root权限，且没有eng和su特征<br></code></pre></td></tr></table></figure><h3 id="开启user模式："><a href="#开启user模式：" class="headerlink" title="开启user模式："></a>开启user模式：</h3><blockquote><p>我们再编译选择版本时，默认都只有userdebug的选项，默认是没有user模式的，我们需要修改源码，让其拥有user模式，这里需要知道你手机的代号，pixel3a是sargo，其他不同版本的pixel手机代号不一样</p><p><img src="/images/image-20230607183518705.png" alt="image-20230607183518705"></p></blockquote><p>打开文件 <code>aosp/device/google/sargo/AndroidProducts.mk</code>，我们可以看到，再google目录下没有sargo目录，这里的文件名就代表这不同版本的pixel手机，我们在这个目录下搜索 <code>AndroidProducts.mk</code> 文件</p><p><img src="/images/image-20230611152122985.png" alt="image-20230611152122985"></p><p>location代表文件夹名称，第一个bonito代表的是 pixel 3a xl版本，我们打开文件看一下，可以发现 3a 和 3a xl的配置在同一个文件内,我们在文件最后一行添加一个  <code>aosp_sargo-user \</code>  代表添加sargo的user版本</p><p><img src="/images/image-20230611152244985.png" alt="image-20230611152244985"></p><p><img src="/images/image-20230611152335318.png" alt="image-20230611152335318"></p><p><img src="/images/image-20230611152944242.png" alt="image-20230611152944242"></p><p><img src="/images/image-20230611170101861.png" alt="image-20230611170101861"></p><h3 id="开放root权限："><a href="#开放root权限：" class="headerlink" title="开放root权限："></a>开放root权限：</h3><blockquote><p>手机中有一个进程叫做adbd，我们通过adb shell连接的就是adbd进程，而默认的adbd是没有root权限，我们修改源码就是修改 adbd的权限，让其默认拥有最高权限</p><p>在默认情况下，系统会给adb降级让其不具备root权限，我们只需要在源码中修改让其不降级，就可以拥有最高权限</p></blockquote><p>找到这个文件 <code>aosp/system/core/adb/daemon/main.cpp</code>在代码的这个部分就是判断adbd是否又root权限，我们之间在这里返回fasle，让它不走下面的流程，就可以完成root权限操作</p><p><img src="/images/image-20230611154232194.png" alt="image-20230611154232194"></p><p><img src="/images/image-20230611154401135.png" alt="image-20230611154401135"></p><p>然后重新编译刷入手机，既可以完成默认拥有root权限，且没有su文件和其它特征，可以过掉大部分的root检测</p><h2 id="其它特征检测："><a href="#其它特征检测：" class="headerlink" title="其它特征检测："></a>其它特征检测：</h2><h3 id="tags"><a href="#tags" class="headerlink" title="tags:"></a>tags:</h3><p>在我们使用aosp刷入手机后，会在手机的系统路径下 <code>/system/build.prop</code>  该文件主要展示一些 系统初始化的一些参数属性，比如说这个tags属性，代表的就是手机系统是aosp，正常其它的手机这里显示的应该是 <code>release-keys</code></p><p><img src="/images/image-20230611155134592.png" alt="image-20230611155134592"></p><p><img src="/images/image-20230611155346671.png" alt="image-20230611155346671"></p><p>我们需要修改两个地方的值</p><ul><li><p>aosp&#x2F;build&#x2F;tools&#x2F;buildinfo.sh</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ro.build.tags=release-keys<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230611160018770.png" alt="image-20230611160018770"></p></li><li><p>bin&#x2F;aosp&#x2F;build&#x2F;tools&#x2F;buildinfo_common.sh</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ro.system.build.tags=release-keys<br></code></pre></td></tr></table></figure></li></ul><p><img src="/images/image-20230611155952071.png" alt="image-20230611155952071"></p><h3 id="其它指纹信息："><a href="#其它指纹信息：" class="headerlink" title="其它指纹信息："></a>其它指纹信息：</h3><p>修改的目的是为了让我们的手机像一个正常的手机，有很多地方可以修改，也可以针对不同app检测的点去针对性修改，这里展示几个需要修改的点</p><h4 id="ro-build-display-id-buildinfo-sh-："><a href="#ro-build-display-id-buildinfo-sh-：" class="headerlink" title="ro.build.display.id(buildinfo.sh)："></a>ro.build.display.id(buildinfo.sh)：</h4><blockquote><p>QP1A.191005.007 release-keys</p></blockquote><p><img src="/images/image-20230611161754963.png" alt="image-20230611161754963"></p><h4 id="ro-build-description-buildinfo-sh"><a href="#ro-build-description-buildinfo-sh" class="headerlink" title="ro.build.description(buildinfo.sh):"></a>ro.build.description(buildinfo.sh):</h4><blockquote><p>aosp_srago-user 10 QP1A.191005.007 eng.lli.20221206.080222 release-keys</p></blockquote><p><img src="/images/image-20230611162312221.png" alt="image-20230611162312221"></p><h4 id="ro-system-build-fingerprint-buildinfo-common-sh"><a href="#ro-system-build-fingerprint-buildinfo-common-sh" class="headerlink" title="ro.system.build.fingerprint(buildinfo_common.sh):"></a>ro.system.build.fingerprint(buildinfo_common.sh):</h4><blockquote><p>Android&#x2F;aosp_srago&#x2F;srago:10&#x2F;QP1A.191005.007&#x2F;lli01082102:user&#x2F;release-keys</p></blockquote><p><img src="/images/image-20230611162651375.png" alt="image-20230611162651375"></p><h3 id="PTRACE-TRACEME检测"><a href="#PTRACE-TRACEME检测" class="headerlink" title="PTRACE_TRACEME检测"></a>PTRACE_TRACEME检测</h3><blockquote><p>PTRACE_TRACEME是检测进程附加</p></blockquote><p>打开该文件 <code> /home/lli/bin/aosp/bionic/libc/bionic</code> </p><p>添加如下代码</p><p><img src="/images/image-20230611174006059.png" alt="image-20230611174006059"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-comment">// add start</span><br><span class="hljs-type">int</span> caller_uid = getuid();<br><span class="hljs-keyword">if</span>(caller_uid&gt;<span class="hljs-number">10000</span>)&#123;<br>    <span class="hljs-keyword">if</span>(req==PTRACE_TRACEME)&#123;<br>        <span class="hljs-comment">// ptrace self</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// add end</span><br></code></pre></td></tr></table></figure><h2 id="关闭selinux："><a href="#关闭selinux：" class="headerlink" title="关闭selinux："></a>关闭selinux：</h2><blockquote><p>selinux是linux的安全子系统，在我们做出上述修改时，该系统会进行一些检测，可能会导致root权限无法使用或者adb无法使用，所以我们需要关闭selinux</p></blockquote><p>找到 <code>aosp/system/core/init/selinux.cpp</code> 修改代码，添加一个return false; 保存退出</p><p><img src="/images/image-20230611163341040.png" alt="image-20230611163341040"></p><p><strong>以上所有的步骤都可以单独完成在编译，也可以全部完成在编译刷机，也可以针对某个app进行单独编译刷机</strong></p><h2 id="验证："><a href="#验证：" class="headerlink" title="验证："></a>验证：</h2><p>我们以58同城为例，该app是带root检测的，会直接闪退</p><p>在刷入系统后，在打开该app没有任何问题，且抓包也正常，不需要重新装证书</p><p><img src="/images/image-20230612150702681.png" alt="image-20230612150702681"></p>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> app逆向 </tag>
            
            <tag> aosp </tag>
            
            <tag> 刷机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>万方protobuf协议解析数据获取</title>
      <link href="/2022/12/16/%E4%B8%87%E6%96%B9protobuf%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/"/>
      <url>/2022/12/16/%E4%B8%87%E6%96%B9protobuf%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<p>protobuf是json和xml相识的数据通信协议，提供了高效率的序列化和反序列化机制，序列化就是将数据转换成二进制发送个服务器，反序列化就是将接收到的二进制转换成对应的对象</p><blockquote><p>网站：<a href="https://s.wanfangdata.com.cn/">https://s.wanfangdata.com.cn/</a></p><p>接口：<a href="https://s.wanfangdata.com.cn/SearchService.SearchService/search">https://s.wanfangdata.com.cn/SearchService.SearchService/search</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>我们打开网站进行搜索，网页并没有刷新，说明可能是xhr请求，我们看一下，这个search结尾的接口比较符合</p><p><img src="/images/image-20230616160226891.png" alt="image-20230616160226891"></p><p>我们能看到他这里的响应头带了一个 <code>application/grpc-web+proto</code>  proto是 protobuf协议的简称，我们在看一下请求头和响应数据，看上去好像都是乱码，我们从发起程序处开始跟栈</p><p><img src="/images/image-20230616153751922.png" alt="image-20230616153751922"></p><p><img src="/images/image-20230616160534794.png" alt="image-20230616160534794"></p><p><img src="/images/image-20230616160542642.png" alt="image-20230616160542642"></p><p>我们跟栈要找一下跟我们搜索的关键字有关的代码，这里看上去有点像原始的请求头数据，我们先把它复制下来</p><p><img src="/images/image-20230616161527089.png" alt="image-20230616161527089"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;<br>    <span class="hljs-string">&quot;searchType&quot;</span>: <span class="hljs-string">&quot;paper&quot;</span>,<br>    <span class="hljs-string">&quot;searchWord&quot;</span>: <span class="hljs-string">&quot;python&quot;</span>,<br>    <span class="hljs-string">&quot;currentPage&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;pageSize&quot;</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-string">&quot;searchFilter&quot;</span>: [<br>        <span class="hljs-number">0</span><br>    ],<br>    <span class="hljs-string">&quot;searchSort&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;field&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;order&quot;</span>: <span class="hljs-number">1</span><br>    &#125;,<br>    <span class="hljs-string">&quot;searchScope&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure><p>我们在下面可以看到有个t，这个t就是页面加载的数据，这里看到的是已经反序列化后的数据</p><p><img src="/images/image-20230619114433917.png" alt="image-20230619114433917"></p><p>接下来我们要开始编写proto文件，就是更具请求体数据来编写对应的proto格式</p><p>最上层的 <code>syntax = &quot;proto3&quot;; </code>代表确定proto使用的协议</p><p>下面就是消息体，由message进行标识，数据类型需要转换成proto type类型， 名称就是具体的数据键值对中的键，&#x3D;号后面的数据就是它在数据中的顺序位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">syntax = &#x27;proto3&#x27;;   //固定写法<br>message SearchService&#123;<br>  enum SearchFilter &#123;<br>    A = 0;<br>  &#125;<br>  message CommonRequest &#123;<br>    message SearchSort &#123;<br>      string  B = 1;<br>      int32 C = 2;<br>    &#125;<br>    string searchType = 1;<br>    string searchWord = 2;<br>    int32 currentPage = 3;<br>    int32 pageSize = 4;<br>    repeated SearchFilter  searchFilter = 5;<br>    repeated SearchSort  searchSort = 6;<br>    int32 searchScope = 7;<br>  &#125;<br>  message SearchRequest&#123;<br>    CommonRequest commonRequest = 1;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230616162602008.png" alt="image-20230616162602008"></p><p>然后使用下载下来的protoc.exe程序进行转换，转换命令是 <code>.\protoc.exe --python_out=../params.proto</code></p><p>执行完成后会生成一个后缀是pb2.py的文件，这个文件就是用来进行protobuf数据编译的</p><p><img src="/images/image-20230616163942722.png" alt="image-20230616163942722"></p><p>接下来编写python代码，这一段是用来导入转换后的请求数据，<code>searchRequest</code> 是一个类似字典的东西，就是我们请求头转换后的数据</p><p><img src="/images/image-20230616165338930.png" alt="image-20230616165338930"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">commonRequest &#123;<br>  searchType: <span class="hljs-string">&quot;paper&quot;</span><br>  searchWord: <span class="hljs-string">&quot;python&quot;</span><br>  currentPage: <span class="hljs-number">1</span><br>  pageSize: <span class="hljs-number">20</span><br>  searchFilter: A<br>  searchSort &#123;<br>    B: <span class="hljs-string">&quot; &quot;</span><br>    C: <span class="hljs-number">1</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>接下来编写请求代码，一定要携带 <code>application/grpc-web+proto</code> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">url = <span class="hljs-string">&#x27;https://s.wanfangdata.com.cn/SearchService.SearchService/search?&#x27;</span><br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;origin&#x27;</span>: <span class="hljs-string">&#x27;https://s.wanfangdata.com.cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/grpc-web+proto&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-grpc-web&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-user-agent&#x27;</span>: <span class="hljs-string">&#x27;grpc-web-javascript/0.1&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>接下来这些都是固定写法，需要用到blackboxprotobuf进行序列化转换，值得注意的是 <code>bytes_head</code> 是请求长度，发送数据的时候需要携带，类似于填充长度一样</p><p><img src="/images/image-20230619115217314.png" alt="image-20230619115217314"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> params_pb2 <span class="hljs-keyword">as</span> pb<br><br>searchRequest = pb.SearchService.SearchRequest()<br><span class="hljs-comment"># search_request = searchRequest.SearchService.commonRequest.add()</span><br><span class="hljs-comment"># 编写请求体数据</span><br>searchRequest.commonRequest.searchType = <span class="hljs-string">&quot;paper&quot;</span><br>searchRequest.commonRequest.searchWord = <span class="hljs-string">&quot;python&quot;</span><br>searchRequest.commonRequest.currentPage = <span class="hljs-number">1</span><br>searchRequest.commonRequest.pageSize = <span class="hljs-number">20</span><br>searchRequest.commonRequest.searchFilter.append(<span class="hljs-number">0</span>)<br>searchSort = searchRequest.commonRequest.searchSort.add()<br>searchSort.B = <span class="hljs-string">&quot; &quot;</span><br>searchSort.C = <span class="hljs-number">1</span><br>searchRequest.commonRequest.searchScope = <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> blackboxprotobuf<br><br>url = <span class="hljs-string">&#x27;https://s.wanfangdata.com.cn/SearchService.SearchService/search?&#x27;</span><br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;origin&#x27;</span>: <span class="hljs-string">&#x27;https://s.wanfangdata.com.cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/grpc-web+proto&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-grpc-web&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-user-agent&#x27;</span>: <span class="hljs-string">&#x27;grpc-web-javascript/0.1&#x27;</span><br>&#125;<br><br>bytes_body = searchRequest.SerializeToString()<br>bytes_head = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bytes_body)])<br>resp = requests.post(url=url, data=bytes_head + bytes_body, headers=headers)<br>data_len = struct.unpack(<span class="hljs-string">&quot;&gt;i&quot;</span>, resp.content[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>])[<span class="hljs-number">0</span>]<br>message, typedef = blackboxprotobuf.protobuf_to_json(resp.content[<span class="hljs-number">5</span>:<span class="hljs-number">5</span> + data_len])<br><span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230616171857978.png" alt="image-20230616171857978"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> protobuf </tag>
            
            <tag> websocket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webSocket获取实时数据与AES解密</title>
      <link href="/2022/12/11/webSocket%E8%8E%B7%E5%8F%96%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%E4%B8%8EAES%E8%A7%A3%E5%AF%86/"/>
      <url>/2022/12/11/webSocket%E8%8E%B7%E5%8F%96%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%E4%B8%8EAES%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://599.com/live/">https://599.com/live/</a></p></blockquote><h3 id="解密流程"><a href="#解密流程" class="headerlink" title="解密流程"></a>解密流程</h3><p>打开该网站，可以看到有些数据一直有发生变化，然后我们抓包看一下，虽然数据在变化，但是却没有新的包进来</p><p>有几个xhr响应的数据是经过加密的，这里加密的数据其实是当前网页显示的已加载的数据，但是经过了加密，网页刷新完成后，所有的数据都是通过websocket进行推送。而之前的，就是已经展示出来的数据就是在这几个xhr响应里面</p><p><img src="/images/image-20230616103856487.png" alt="image-20230616103856487"></p><p><img src="/images/image-20230616103954912.png" alt="image-20230616103954912"></p><p>打开ws请求栏，我们能很明显的看到有数据推送，而且返回的数据是经过加密的，发送的数据是 <code>&#123;&quot;device&quot;:&quot;pc&quot;,&quot;topic&quot;:&quot;USER.topic.app.8&quot;&#125;</code></p><p><img src="/images/image-20230616104332341.png" alt="image-20230616104332341"></p><p>我们用 <code>AioWebSocket</code> 模块来编写websocket请求，尝试获取一下数据，可以看到，数据可以正常获取，且没有需要携带其它认证参数，唯一需要解决的是将反回的数据进行解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">async def startup(uri):<br>    # 异步执行websocket事件<br>    async with AioWebSocket(uri) as aws:<br>        converse = aws.manipulator<br>        # 向服务器发送消息<br>        await converse.send(&#x27;&#123;&quot;device&quot;:&quot;pc&quot;,&quot;topic&quot;:&quot;USER.topic.app.8&quot;&#125;&#x27;)<br>        while True:<br>            mes = await converse.receive()<br>            logger.info(f&quot;加密数据====&gt;&#123;mes&#125;&quot;)<br>            print(&quot;================*================&quot;)<br><br><br>if __name__ == &#x27;__main__&#x27;:<br>    remote = &#x27;wss://api.599.com/scorepush/football&#x27;<br>    try:<br>        # 创建一个消息循环<br>        loop = asyncio.new_event_loop()<br>        # 设置消息循环<br>        asyncio.set_event_loop(loop)<br>        # 运行事件循环直到结束<br>        loop.run_until_complete(startup(remote))<br>        # asyncio.get_event_loop().run_until_complete(startup(remote))<br>    except KeyboardInterrupt as exc:<br>        logging.info(&#x27;Quit.&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230616104550483.png" alt="image-20230616104550483"></p><p>返回的数据看上去有点像base64编码，我们通过发起程序，看一下他的加密流程，可以看到打上断点后进入到了这里，这里做了一个判断，数据请求成功后将返回的数据传给了t,然后在下面对t进行了处理，我们将下面的断点打上，看一下数据是否会进来</p><p><img src="/images/image-20230616104952692.png" alt="image-20230616104952692"></p><p>可以看到返回的数据会进入这一段类似加密的方法中去，我们可以看下 <code>h.decrypt</code> 是什么</p><p><img src="/images/image-20230616105226612.png" alt="image-20230616105226612"></p><p>这里有个  _ 方法，就在下面，这里进行数据分发，我们也打上断点看一下</p><p><img src="/images/image-20230616105445709.png" alt="image-20230616105445709"></p><p>数据进来后，这里创建了一个 Promiss，异步执行加密方法，这里是AES加密，且iv和key都给出来了，我们可以拿一段我们前面获取到的加密数据去找个解密网站看一下，可以看到数据可以解密出来，那就好办了</p><p><img src="/images/image-20230616105813274.png" alt="image-20230616105813274"></p><p><img src="/images/image-20230616110025060.png" alt="image-20230616110025060"></p><p>用python或者js写一段aes解密函数即可，加上解密的函数，我们看下它实际返回的数据是啥，这里返回的数据正是网页中实时加载的指数数据，这样就数据获取成功了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 需要补位，str不是16的倍数那就补足为16的倍数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_to_16</span>(<span class="hljs-params">value</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(value) % <span class="hljs-number">16</span> != <span class="hljs-number">0</span>:<br>        value += <span class="hljs-string">&#x27;\0&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>.encode(value)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_decrypt</span>(<span class="hljs-params">text</span>):<br>    secret_key = <span class="hljs-string">&#x27;777db0c19edfaace&#x27;</span>  <span class="hljs-comment"># 密钥</span><br>    iv = <span class="hljs-string">&quot;9876543210599311&quot;</span><br>    aes = AES.new(add_to_16(secret_key), AES.MODE_CBC, add_to_16(iv))  <span class="hljs-comment"># 初始化加密器</span><br>    base64_decrypted = base64.decodebytes(text)  <span class="hljs-comment"># 优先逆向解密 base64 成 bytes</span><br>    decrypted_text = <span class="hljs-built_in">str</span>(aes.decrypt(base64_decrypted), encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>).replace(<span class="hljs-string">&#x27;\0&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment"># 执行解密密并转码返回str</span><br>    <span class="hljs-keyword">return</span> decrypted_text<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230616110230751.png" alt="image-20230616110230751"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webSocket </tag>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>贝壳app请求头Authorization字段解析</title>
      <link href="/2022/12/06/%E8%B4%9D%E5%A3%B3app%E8%AF%B7%E6%B1%82%E5%A4%B4Authorization%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/12/06/%E8%B4%9D%E5%A3%B3app%E8%AF%B7%E6%B1%82%E5%A4%B4Authorization%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:2.66.0</p><p>接口：<a href="https://app.api.ke.com/api/secondhand/resblock/framegroup/list?resblockId=2413600823455693">https://app.api.ke.com/api/secondhand/resblock/framegroup/list?resblockId=2413600823455693</a></p><p>需求：获取贝壳小区里面的户型图数据</p></blockquote><p><img src="/images/image-20230606165229656.png" alt="image-20230606165229656"></p><h3 id="接口分析："><a href="#接口分析：" class="headerlink" title="接口分析："></a>接口分析：</h3><p>通过抓包可以发现，里面有很多的字段都看不太懂，我们可以通过撰写请求来确定哪些字段是需要携带，哪些是不需要携带的，其中 <code>Cookie</code>，<code>Device-id-s</code>，<code>Authorization</code> 字段是一定需要携带的</p><p>cookie可以固定，只需要一个 <code>lianjia_udid</code> 字段就可以了</p><p><code>Device-id-s</code> 跟设备有关，这里也可以写死</p><p><code>wll-kgsa</code> 这个字段在高版本的app中，需要携带，使用低版本就不需要携带，请求头中还需要携带 <code>Lianjia-Version</code> 等跟版本有关的字段才行</p><p><code>Authorization</code> 这个字段必须携带，基本贝壳app所有的接口都必须携带，这个接口应该是跟请求体有关，相同的请求参数该字段相同</p><p><img src="/images/image-20230606165626380.png" alt="image-20230606165626380"></p><p>请求代码：</p><p><img src="/images/image-20230606170451661.png" alt="image-20230606170451661"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python">list_headers = &#123;<br>    <span class="hljs-string">&#x27;x-req-id&#x27;</span>: <span class="hljs-string">&#x27;3726645a-df8c-464b-9341-3ca5d345a820&#x27;</span>,<br>    <span class="hljs-string">&#x27;Page-Schema&#x27;</span>: <span class="hljs-string">&#x27;community%2Fhuxing%2Flist&#x27;</span>,<br>    <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;communitydetail&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;lianjia_udid=0fc0690f43831ba1;&#x27;</span>,<br>    <span class="hljs-string">&#x27;Dynamic-SDK-VERSION&#x27;</span>: <span class="hljs-string">&#x27;1.1.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Lianjia-City-Id&#x27;</span>: <span class="hljs-string">&#x27;440300&#x27;</span>,<br>    <span class="hljs-string">&#x27;parentSceneId&#x27;</span>: <span class="hljs-string">&#x27;6530638482656836097&#x27;</span>,<br>    <span class="hljs-string">&#x27;source-global&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Beike2.89.0;samsung SM-G973N; Android 9&#x27;</span>,<br>    <span class="hljs-string">&#x27;Lianjia-Device-Id&#x27;</span>: <span class="hljs-string">&#x27;0fc0690f43831ba1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Lianjia-Version&#x27;</span>: <span class="hljs-string">&#x27;2.66.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Lianjia-Im-Version&#x27;</span>: <span class="hljs-string">&#x27;2.34.0&#x27;</span>,<br>    <span class="hljs-string">&#x27;Lianjia-Recommend-Allowable&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">&#x27;MjAxODAxMTFfYW5kcm9pZDpiY2YzYTI4ZDE2MWU3Yzc3NTBiYzQ5OGFmZjQyZjNhNGRlYWVlOGQ1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Device-id-s&#x27;</span>: <span class="hljs-string">&#x27;0fc0690f43831ba1;;020102Sl74XvwW/Nx/ybVLmW6etX19zcPY6VWmllYXVAk+iYbWtHbEJNSVm9jF72ngVm1xRYM2JLG7wRzFcludQvy5RA==&#x27;</span>,<br>    <span class="hljs-string">&#x27;Channel-s&#x27;</span>: <span class="hljs-string">&#x27;Android_ke_tencentt&#x27;</span>,<br>    <span class="hljs-string">&#x27;AppInfo-s&#x27;</span>: <span class="hljs-string">&#x27;Beike;2.66.0;2660100&#x27;</span>,<br>    <span class="hljs-string">&#x27;Hardware-s&#x27;</span>: <span class="hljs-string">&#x27;samsung;SM-G973N&#x27;</span>,<br>    <span class="hljs-string">&#x27;SystemInfo-s&#x27;</span>: <span class="hljs-string">&#x27;android;9&#x27;</span>,<br>    <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;app.api.ke.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;Keep-Alive&#x27;</span>,<br>    <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip&#x27;</span>,<br>&#125;<br>list_url = <span class="hljs-string">&#x27;https://app.api.ke.com/api/secondhand/resblock/framegroup/list?resblockId=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(house_id)<br><span class="hljs-built_in">print</span>(list_url)<br>res = requests.get(url=list_url, headers=list_headers, timeout=<span class="hljs-number">8</span>)<br>res.encoding = <span class="hljs-string">&#x27;utf-8&#x27;</span><br>res_json = json.loads(res.text)<br><span class="hljs-built_in">print</span>(res_json)<br>frame_list = res_json[<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-string">&#x27;list&#x27;</span>]<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(frame_list):<br>    <span class="hljs-keyword">for</span> img_list <span class="hljs-keyword">in</span> frame_list:<br>        <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> img_list[<span class="hljs-string">&#x27;list&#x27;</span>]:<br>            item = &#123;&#125;<br>            item[<span class="hljs-string">&#x27;unit&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">0</span>]<br>            item[<span class="hljs-string">&#x27;area&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">1</span>]<br>            item[<span class="hljs-string">&#x27;orientation&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">2</span>]<br>            item[<span class="hljs-string">&#x27;title&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>]<br>            item[<span class="hljs-string">&#x27;img_url&#x27;</span>] = data[<span class="hljs-string">&#x27;picUrl&#x27;</span>]<br>            <span class="hljs-built_in">print</span>(item)<br></code></pre></td></tr></table></figure><h3 id="字段获取："><a href="#字段获取：" class="headerlink" title="字段获取："></a>字段获取：</h3><p>使用jadx进行反编译，搜索关键字 <code>Authorization</code> 或者 <code>&quot;Authorization&quot;</code></p><p>搜出来的结果不算多，可以挨个点进去看一下。我们这里直接看这个拦截器，猜测一下，既然每个接口都会携带，那应该都需要经过某个拦截器才对，我们进来看一下</p><p><img src="/images/image-20230606172137600.png" alt="image-20230606172137600"></p><p>进来之后，我们可以看到这里应该是添加了一个okhttp的的拦截器，我们在业内搜索 <code>signRequest</code> 关键字，最终在下面我们可以看到对应的拦截器方法</p><p><img src="/images/image-20230606172441461.png" alt="image-20230606172441461"></p><p><img src="/images/image-20230606173019938.png" alt="image-20230606173019938"></p><p>我们采用firda hook的形式去看一下这个方法返回什么，结果竟然报错了，猜测是反编译导致方法名的问题，我们换个版本的jadx重新编译一下</p><p><img src="/images/image-20230606181218482.png" alt="image-20230606181218482"></p><p>换了个 1.2.0版本的jadx，这次反编译没有问题, 也是成功的验证了这个方法返回的就是我们要的 <code>&quot;Authorization&quot;</code> 字段</p><p><img src="/images/image-20230606181553850.png" alt="image-20230606181553850"></p><p><img src="/images/image-20230606181712564.png" alt="image-20230606181712564"></p><p>我们来看一下这个方法，第一个判断条件是判断请求url是否是布尔类型，第二个判断条件是请求方式是否为get, 我们可以直接看 <code>com.bk.base.netimpl.a.ji().getSignString(uri, hashMap);</code>  下面为判断是否是post请求，已经还对请求体做了处理，猜测如果是post请求，那么请求体应该也会被参与计算中去</p><p><img src="/images/image-20230606182637305.png" alt="image-20230606182637305"></p><p>我们直接右键 跳到声明</p><p><img src="/images/image-20230606183022468.png" alt="image-20230606183022468"></p><p>我们可以继续hook一下这个方法，看一下传入的两个值是什么</p><p><img src="/images/image-20230606183111227.png" alt="image-20230606183111227"></p><p>接收的就是请求的url链接，第二个参数如果是post请求，则传入的是请求体，我们再看一下这个方法做了什么</p><p><img src="/images/image-20230606183327959.png" alt="image-20230606183327959"></p><p>我们从下往上看 我们最终要 <code>encodeToString</code> <code>encodeToString</code> 是   str2 和 SHA1ToString 组合后加工而成</p><p>str2  是跟前后两个参数有关，一个是 httpAppId 一个是httpAppSecret</p><p>SHA1ToString  是对sb参数做了处理</p><p>sb视乎是跟请求参数有关</p><p>最为重要的是它的数据是经过base64处理后得到的，那我们看一下base64处理之前是什么样子的</p><p><img src="/images/image-20230606185108575.png" alt="image-20230606185108575"></p><p>这下我们可以确定str2就是 20180111_android 这个值固定， 接下来 我们只要知道 <code>DeviceUtil.SHA1ToString(sb.toString())</code> 做了哪些事情 我们就完成了</p><p><img src="/images/image-20230606185928699.png" alt="image-20230606185928699"></p><p><img src="/images/image-20230606200003780.png" alt="image-20230606200003780"></p><p>同样的，hook一下这个方法，可以看到传入的值当中，后面的是请求体，前面一部分看上去也像是md5加密后的结果，他们拼接之后做了sha1加密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">https://app.api.ke.com/api/secondhand/resblock/framegroup/list?resblockId=2411048421652<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230606195954146.png" alt="image-20230606195954146"></p><p><img src="/images/image-20230606201036249.png" alt="image-20230606201036249"></p><p>我们多翻几个页面，看一下这个值会不会发生变化，经过测试之后，我们可以看到，这就是个固定值，即便重启app，这个值也不会发生变化</p><p><img src="/images/image-20230606200648963.png" alt="image-20230606200648963"></p><p>现在 我们可以总结一下， 有两个固定值，一个是  <code>d5e343d453aecca8b14b2dc687c381ca</code> 拼接请求体后进行sha1加密，另一个固定值是 </p><p><code>20180111_android:</code> 加上上面sha1加密后在进行base64编码，就得到了 Authorization字段</p><p>改写一下代码，也是完全没有问题，可以成功获取到我们想要的数据</p><p><img src="/images/image-20230606201228886.png" alt="image-20230606201228886"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding:utf-8</span><br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> urllib<br><br><span class="hljs-keyword">import</span> requests, re, random, json, time<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> pymysql<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode, b64decode<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_img_list</span>():<br>    time_stamp = <span class="hljs-built_in">int</span>(time.time())<br>    house_id = <span class="hljs-string">&#x27;2413600823455693&#x27;</span><br>    secret_str = <span class="hljs-string">&#x27;d5e343d453aecca8b14b2dc687c381caresblockId=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(house_id)<br>    hash_secret = hashlib.sha1(secret_str.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest()<br>    base_secret = <span class="hljs-string">&#x27;20180111_android:&#x27;</span> + hash_secret<br>    base64_secret = b64encode(base_secret.encode()).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(base64_secret)<br>    list_headers = &#123;<br>        <span class="hljs-string">&#x27;x-req-id&#x27;</span>: <span class="hljs-string">&#x27;3726645a-df8c-464b-9341-3ca5d345a820&#x27;</span>,<br>        <span class="hljs-string">&#x27;Page-Schema&#x27;</span>: <span class="hljs-string">&#x27;community%2Fhuxing%2Flist&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;communitydetail&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;lianjia_udid=0fc0690f43831ba1;&#x27;</span>,<br>        <span class="hljs-string">&#x27;Dynamic-SDK-VERSION&#x27;</span>: <span class="hljs-string">&#x27;1.1.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Lianjia-City-Id&#x27;</span>: <span class="hljs-string">&#x27;440300&#x27;</span>,<br>        <span class="hljs-string">&#x27;parentSceneId&#x27;</span>: <span class="hljs-string">&#x27;6530638482656836097&#x27;</span>,<br>        <span class="hljs-string">&#x27;source-global&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span>,<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Beike2.89.0;samsung SM-G973N; Android 9&#x27;</span>,<br>        <span class="hljs-string">&#x27;Lianjia-Device-Id&#x27;</span>: <span class="hljs-string">&#x27;0fc0690f43831ba1&#x27;</span>,<br>        <span class="hljs-string">&#x27;Lianjia-Version&#x27;</span>: <span class="hljs-string">&#x27;2.66.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Lianjia-Im-Version&#x27;</span>: <span class="hljs-string">&#x27;2.34.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Lianjia-Recommend-Allowable&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;Authorization&#x27;</span>: base64_secret,<br>        <span class="hljs-string">&#x27;Device-id-s&#x27;</span>: <span class="hljs-string">&#x27;0fc0690f43831ba1;;020102Sl74XvwW/Nx/ybVLmW6etX19zcPY6VWmllYXVAk+iYbWtHbEJNSVm9jF72ngVm1xRYM2JLG7wRzFcludQvy5RA==&#x27;</span>,<br>        <span class="hljs-string">&#x27;Channel-s&#x27;</span>: <span class="hljs-string">&#x27;Android_ke_tencentt&#x27;</span>,<br>        <span class="hljs-string">&#x27;AppInfo-s&#x27;</span>: <span class="hljs-string">&#x27;Beike;2.66.0;2660100&#x27;</span>,<br>        <span class="hljs-string">&#x27;Hardware-s&#x27;</span>: <span class="hljs-string">&#x27;samsung;SM-G973N&#x27;</span>,<br>        <span class="hljs-string">&#x27;SystemInfo-s&#x27;</span>: <span class="hljs-string">&#x27;android;9&#x27;</span>,<br>        <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;app.api.ke.com&#x27;</span>,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;Keep-Alive&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip&#x27;</span>,<br>    &#125;<br>    list_url = <span class="hljs-string">&#x27;https://app.api.ke.com/api/secondhand/resblock/framegroup/list?resblockId=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(house_id)<br>    <span class="hljs-built_in">print</span>(list_url)<br>    res = requests.get(url=list_url, headers=list_headers, timeout=<span class="hljs-number">8</span>)<br>    res.encoding = <span class="hljs-string">&#x27;utf-8&#x27;</span><br>    res_json = json.loads(res.text)<br>    <span class="hljs-built_in">print</span>(res_json)<br>    frame_list = res_json[<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-string">&#x27;list&#x27;</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(frame_list):<br>        <span class="hljs-keyword">for</span> img_list <span class="hljs-keyword">in</span> frame_list:<br>            <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> img_list[<span class="hljs-string">&#x27;list&#x27;</span>]:<br>                item = &#123;&#125;<br>                item[<span class="hljs-string">&#x27;unit&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">0</span>]<br>                item[<span class="hljs-string">&#x27;area&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">1</span>]<br>                item[<span class="hljs-string">&#x27;orientation&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>].split(<span class="hljs-string">&#x27;/&#x27;</span>)[<span class="hljs-number">2</span>]<br>                item[<span class="hljs-string">&#x27;title&#x27;</span>] = data[<span class="hljs-string">&#x27;title&#x27;</span>]<br>                item[<span class="hljs-string">&#x27;img_url&#x27;</span>] = data[<span class="hljs-string">&#x27;picUrl&#x27;</span>]<br>                <span class="hljs-built_in">print</span>(item)<br><br><br>get_img_list()<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">lianjiabeike://ershou/community/frameList?resblockId=2411049483671&amp;roomKey=l2</span><br><span class="hljs-string">https://apps.api.ke.com/house/resblock/detailpart1v2?id=&#123;&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>得物app社区评论获取newSign和X-Auth-Token参数解析</title>
      <link href="/2022/12/04/%E5%BE%97%E7%89%A9app%E7%A4%BE%E5%8C%BA%E8%AF%84%E8%AE%BA%E8%8E%B7%E5%8F%96newSign%E5%92%8CX-Auth-Token%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/12/04/%E5%BE%97%E7%89%A9app%E7%A4%BE%E5%8C%BA%E8%AF%84%E8%AE%BA%E8%8E%B7%E5%8F%96newSign%E5%92%8CX-Auth-Token%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:4.74.5</p><p>接口：<a href="https://app.dewu.com/sns-itr/v1/reply/content-reply-list">https://app.dewu.com/sns-itr/v1/reply/content-reply-list</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>该app不走系统代理，所以需要sockes转发，而且有frida反调试，需要删除libmsaoaidsec.so文件</p><p>正常抓包，找到接口,发现请求参数有个newSign 和请求头中有个X-Auth-Token需要获取到</p><p><img src="/images/image-20230520181438531.png" alt="image-20230520181438531"></p><p><img src="/images/image-20230520181508545.png" alt="image-20230520181508545"></p><p>直接搜索newSign关键字,发现它进入得是一个拦截器，最终是m37139c方法对newSign参数做了处理，我们看一下m37139c方法</p><p><img src="/images/image-20230520182014047.png" alt="image-20230520182014047"></p><p>看上去好像是一个aes加密，传入了一个map参数，我们可以hook一下，传入了哪些参数</p><p><img src="/images/image-20230520182127326.png" alt="image-20230520182127326"></p><p><img src="/images/image-20230520185602902.png" alt="image-20230520185602902"></p><p>传入得字典也是请求头中得其它参数，我们在回过头来看一下m37139c方法做了哪些处理，传入得map后又添加了下面几个参数，然后字符串拼接，直接hook encode方法就可以得到拼接后的字符串，其它的几个参数都可以固定，但是uuid需要我们去获取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">v=4.84.0<br>timestamp=1660649735904<br>uuid=0d9686a78e2aa975      -&gt; ?<br>platform=android<br>loginToken=<br>最后得参数，直接hook encode方法就可以得到<br>anchorReplyId0contentId85347120contentType0lastIdlimit20loginTokenplatformandroidsourcetimestamp1660649735904uuid0d9686a78e2aa975v4.84.0<br><br></code></pre></td></tr></table></figure><p>发现只有获取，而没有生成uuid，我们可以先不管，先搜索X-Auth-Token</p><p><img src="/images/image-20230520190657162.png" alt="image-20230520190657162"></p><p><img src="/images/image-20230520191051064.png" alt="image-20230520191051064"></p><p>发现在这里出现了uuid的生成，我们进去看一下,发现uuid可能是一个设备id,这个id我们可以直接伪造</p><p><img src="/images/image-20230520191131362.png" alt="image-20230520191131362"></p><p><img src="/images/image-20230520191224375.png" alt="image-20230520191224375"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_android_id</span>():<br>    data_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>):<br>        part = <span class="hljs-string">&quot;&quot;</span>.join(random.sample(<span class="hljs-string">&quot;0123456789ABCDEF&quot;</span>, <span class="hljs-number">2</span>))<br>        data_list.append(part)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(data_list).lower()<br></code></pre></td></tr></table></figure><p>我们再看一下encode方法,发现最终会调用一个叫encodeByte的native方法，并且传入一个字节数组，这个字节数组就是我们上面讲到的sb字符数组转成的字节数组，直接hook这个方法</p><p><img src="/images/image-20230520191434729.png" alt="image-20230520191434729"></p><p><img src="/images/image-20230520191906246.png" alt="image-20230520191906246"></p><p>找到了最终的加密位置，但由于是在native层进行加密，我们还需要获取到对应的so文件,在jadx中也可以看到对应的so文件叫做JNIEncrypt</p><p><img src="/images/image-20230520192113713.png" alt="image-20230520192113713"></p><p>我们用ida打开对应的so文件，去寻找encode方法传入的第一参数，经过确认，第29行的 AES_128_ECB_PKCS5Padding_Encrypt应该就是传入的对应方法,也就是对应的AES加密，那我们直接用frida hook native层的加密</p><p><img src="/images/image-20230520192420758.png" alt="image-20230520192420758"></p><p><img src="/images/image-20230520192656597.png" alt="image-20230520192656597"></p><p><img src="/images/image-20230520192728122.png" alt="image-20230520192728122"></p><p>想要hook native层的方法，需要指定对应so文件和对应的方法，并且需要设置对应的进入和出去方法,发现传入的第一个参数，就是我们上面拼接的参数，第二个参数始终固定</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> addr_func = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libJNIEncrypt.so&quot;</span>, <span class="hljs-string">&quot;AES_128_ECB_PKCS5Padding_Encrypt&quot;</span>);<br><br><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addr_func, &#123;<br><br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;-------------执行函数-------------&quot;</span>);<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;-------------参数 1-------------&quot;</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">0</span>].<span class="hljs-title function_">readUtf8String</span>())<br><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;-------------参数 2-------------&quot;</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">1</span>].<span class="hljs-title function_">readUtf8String</span>());<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">retValue</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;-------------返回-------------&quot;</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(retValue.<span class="hljs-title function_">readUtf8String</span>());<br>        &#125;<br><br>    &#125;)<br><br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230520193033949.png" alt="image-20230520193033949"></p><p>最后剩下一个X-Auth-Token，在我们抓包的时候，可以去看一个包,这个包的响应头就是我们要的X-Auth-Token，而newSign我们已经获取到了，所以我们可以直接获取到newSign后，拼接请求，获取X-Auth-Token，在拼接请求，获取我们想要的评论</p><p><img src="/images/image-20230520193417490.png" alt="image-20230520193417490"></p><p>直接上代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote_plus<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> random<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_android_id</span>():<br>    data_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>):<br>        part = <span class="hljs-string">&quot;&quot;</span>.join(random.sample(<span class="hljs-string">&quot;0123456789ABCDEF&quot;</span>, <span class="hljs-number">2</span>))<br>        data_list.append(part)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(data_list).lower()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">data_bytes</span>):<br>    hash_object = hashlib.md5()<br>    hash_object.update(data_bytes)<br>    <span class="hljs-keyword">return</span> hash_object.hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">data_string</span>):<br>    key = <span class="hljs-string">&quot;d245a0ba8d678a61&quot;</span><br>    aes = AES.new(<br>        key=key.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>        mode=AES.MODE_ECB,<br>    )<br>    raw = pad(data_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">return</span> aes.encrypt(raw)<br><br><br>uid = create_android_id()<br>ctime = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>))<br><br><span class="hljs-comment"># param_dict = &#123;&quot;loginToken&quot;: &quot;&quot;, &quot;platform&quot;: &quot;android&quot;, &quot;timestamp&quot;: ctime, &quot;uuid&quot;: uid, &quot;v&quot;: &quot;4.84.0&quot;&#125;</span><br>param_dict = &#123;<span class="hljs-string">&quot;loginToken&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;platform&quot;</span>: <span class="hljs-string">&quot;android&quot;</span>, <span class="hljs-string">&quot;timestamp&quot;</span>: ctime, <span class="hljs-string">&quot;uuid&quot;</span>: uid, <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;5.0.6&quot;</span>&#125;<br><br>ordered_string = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-string">&quot;&#123;&#125;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key, param_dict[key]) <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(param_dict.keys())])<br>aes_string = aes_encrypt(ordered_string)<br>aes_string = base64.encodebytes(aes_string)<br>aes_string = aes_string.replace(<span class="hljs-string">b&quot;\n&quot;</span>, <span class="hljs-string">b&quot;&quot;</span>)<br>sign = md5(aes_string)<br>param_dict[<span class="hljs-string">&#x27;newSign&#x27;</span>] = sign<br><br>res = requests.post(<br>    url=<span class="hljs-string">&quot;https://app.dewu.com/api/v1/app/user_core/users/getVisitorUserId&quot;</span>,<br>    headers=&#123;<br>        <span class="hljs-string">&quot;duuuid&quot;</span>: uid,<br>        <span class="hljs-string">&quot;duimei&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;duplatform&quot;</span>: <span class="hljs-string">&quot;android&quot;</span>,<br>        <span class="hljs-string">&quot;appId&quot;</span>: <span class="hljs-string">&quot;duapp&quot;</span>,<br>        <span class="hljs-string">&quot;duchannel&quot;</span>: <span class="hljs-string">&quot;pp&quot;</span>,<br>        <span class="hljs-string">&quot;humeChannel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-comment"># &quot;duv&quot;: &quot;4.84.0&quot;,</span><br>        <span class="hljs-string">&quot;duv&quot;</span>: <span class="hljs-string">&quot;5.0.6&quot;</span>,<br>        <span class="hljs-string">&quot;duloginToken&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;dudeviceTrait&quot;</span>: <span class="hljs-string">&quot;MI+6+Plus&quot;</span>,<br>        <span class="hljs-string">&quot;dudeviceBrand&quot;</span>: <span class="hljs-string">&quot;Xiaomi&quot;</span>,<br>        <span class="hljs-string">&quot;timestamp&quot;</span>: ctime,<br>        <span class="hljs-string">&quot;shumeiid&quot;</span>: <span class="hljs-string">&quot;20210807163758afabf6d66401eb2e4f234dbe68af5705014c79067d50b114&quot;</span>,<br>        <span class="hljs-string">&quot;oaid&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;duapp/5.0.6(android;6.0.1)&quot;</span>,<br>        <span class="hljs-string">&quot;X-Auth-Token&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;isRoot&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>        <span class="hljs-string">&quot;emu&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-string">&quot;isProxy&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json; charset=utf-8&quot;</span><br>    &#125;,<br>    json=param_dict,<br>    <span class="hljs-comment"># verify=False</span><br>)<br>x_auth_token = res.headers[<span class="hljs-string">&#x27;X-Auth-Token&#x27;</span>]<br><br>reply_param_dict = &#123;<br>    <span class="hljs-comment"># &quot;contentId&quot;: &quot;83662484&quot;,</span><br>    <span class="hljs-string">&quot;contentId&quot;</span>: <span class="hljs-string">&quot;91820099&quot;</span>,<br>    <span class="hljs-string">&quot;contentType&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>    <span class="hljs-string">&quot;anchorReplyId&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>    <span class="hljs-string">&quot;lastId&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;limit&quot;</span>: <span class="hljs-string">&quot;20&quot;</span>,<br>    <span class="hljs-comment"># &quot;newSign&quot;: &quot;80c378ba571fd250385a4a9d5cb120b6&quot;</span><br>&#125;<br><span class="hljs-keyword">import</span> copy<br><br>new_dict = copy.deepcopy(reply_param_dict)<br>new_dict.update(<br>    <span class="hljs-comment"># &#123;&quot;loginToken&quot;: &quot;&quot;, &quot;platform&quot;: &quot;android&quot;, &quot;timestamp&quot;: str(int(time.time() * 1000)), &quot;uuid&quot;: uid, &quot;v&quot;: &quot;4.84.0&quot;&#125;)</span><br>    &#123;<span class="hljs-string">&quot;loginToken&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;platform&quot;</span>: <span class="hljs-string">&quot;android&quot;</span>, <span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)), <span class="hljs-string">&quot;uuid&quot;</span>: uid, <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;5.0.6&quot;</span>&#125;)<br>ordered_string = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-string">&quot;&#123;&#125;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key, new_dict[key]) <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(new_dict.keys())])<br><br>aes_string = aes_encrypt(ordered_string)<br>aes_string = base64.encodebytes(aes_string)<br>aes_string = aes_string.replace(<span class="hljs-string">b&quot;\n&quot;</span>, <span class="hljs-string">b&quot;&quot;</span>)<br>sign_string = md5(aes_string)<br>reply_param_dict[<span class="hljs-string">&#x27;newSign&#x27;</span>] = sign_string<br><br>res = requests.get(<br>    url=<span class="hljs-string">&quot;https://app.dewu.com/sns-itr/v1/reply/content-reply-list&quot;</span>,<br>    params=reply_param_dict,<br>    headers=&#123;<br>        <span class="hljs-string">&quot;X-Auth-Token&quot;</span>: x_auth_token,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;duapp/5.0.6(android;10)&quot;</span><br>    &#125;,<br>    <span class="hljs-comment"># verify=False</span><br>)<br><span class="hljs-built_in">print</span>(res.text)<br><br></code></pre></td></tr></table></figure><p>返回结果：成功拿到数据</p><p><img src="/images/image-20230520193611365.png" alt="image-20230520193611365"></p>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> Unidbg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第12题Base64请求参数加密</title>
      <link href="/2022/11/25/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC12%E9%A2%98Base64%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86/"/>
      <url>/2022/11/25/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC12%E9%A2%98Base64%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://match.yuanrenxue.cn/match/12">https://match.yuanrenxue.cn/match/12</a></p><p>接口:<a href="https://match.yuanrenxue.cn/api/match/12?page=1">https://match.yuanrenxue.cn/api/match/12?page=1</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>请求参数m加密,</p><p><img src="/images/image-20230524171537575.png" alt="image-20230524171537575"></p><p>追栈到这就结束了, yuanrenxue 加上页数 进行base64编码即可</p><p><img src="/images/image-20230524171614428.png" alt="image-20230524171614428"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">base64.b64encode(<span class="hljs-string">f&#x27;yuanrenxue<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>.encode()).decode()<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> Base64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第五题请求参数和cookie加密OB混淆解析</title>
      <link href="/2022/11/25/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%BA%94%E9%A2%98%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%92%8Ccookie%E5%8A%A0%E5%AF%86OB%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/25/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%BA%94%E9%A2%98%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%92%8Ccookie%E5%8A%A0%E5%AF%86OB%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://match.yuanrenxue.cn/match/5">https://match.yuanrenxue.cn/match/5</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>请求参数mf有点像时间戳，但是却不一样，cookie中m参数可以不用携带，但是RM4hZBv0dDon443M需要携带</p><p><img src="/images/image-20230518212811487.png" alt="image-20230518212811487"></p><p><img src="/images/image-20230518212843882.png" alt="image-20230518212843882"></p><p>老方法，我们用hook的形式去获取cookie，多放行几次，直到获取到正确的目标</p><p><img src="/images/image-20230518213215081.png" alt="image-20230518213215081"></p><p>这个_0x4e96b4[‘_$ss’]就是我们需要的目标了，但是_0x4e96b4竟然是个window对象，我们在尝试用hook获取一下</p><p><img src="/images/image-20230518213320245.png" alt="image-20230518213320245"></p><p>hook之后追栈</p><p><img src="/images/image-20230518213636412.png" alt="image-20230518213636412"></p><p>很明显_0x29dd83[_$UH[0x1f]]就是我们需要的目标</p><p><img src="/images/image-20230518213754797.png" alt="image-20230518213754797"></p><p>抠出来 稍微解一下,是个aes加密，接下来呢就是扣代码</p><p><img src="/images/image-20230518213955895.png" alt="image-20230518213955895"></p><p><code>_$Ww</code> 的值由 <code>_0x4e96b4[&#39;_$pr&#39;]</code> 转换为字符串后经过 utf-8 编码得到，其与 key 值 <code>_0x4e96b4[&#39;_$qF&#39;]</code> 都是数组</p><p><img src="/images/image-20230518214748846.png" alt="image-20230518214748846"></p><p>搜索<code>_0x4e96b4[&#39;_$qF&#39;]</code>会发现他是传入了一个类似时间戳一样的东西进行base64编码后获取前面16位</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">_0x4e96b4[<span class="hljs-string">&#x27;_$qF&#x27;</span>] = <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](_0x4e96b4[<span class="hljs-string">&#x27;btoa&#x27;</span>](_0x4e96b4[<span class="hljs-string">&#x27;_$is&#x27;</span>])[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">16</span>));<br></code></pre></td></tr></table></figure><p>搜索发现后竟然跟请求参数m有关，<code>_$yw</code>是一个时间错，接下来就是一步一步开始扣代码</p><p><img src="/images/image-20230518215306798.png" alt="image-20230518215306798"></p><p>需要注意的是，<code>_0x4e96b4[&#39;_$pr&#39;]</code>数组里面有五个值，前面四个的值会在1717行生成，第五个值会在868行生成,然后一边传入的是字符串数字，一边传入的是数字，请求参数m就是在1717行这里计算并push到数组中，而f参数也是时间戳，两个的差别相差50秒，这也就是为什么网页会提示cookie五十秒过期</p><p><img src="/images/image-20230518215743735.png" alt="image-20230518215743735"></p><p><img src="/images/image-20230518215832862.png" alt="image-20230518215832862"></p><p>全部代码，需要慢慢扣，很需要时间和耐心：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;crypto-js&quot;</span>);  <span class="hljs-comment">// npm install crypto-js</span><br><br><span class="hljs-comment">// 环境</span><br><span class="hljs-variable language_">window</span> = <span class="hljs-variable language_">global</span>;<br><span class="hljs-variable language_">document</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">document</span><br><br><span class="hljs-comment">// 初始化定义</span><br><span class="hljs-keyword">var</span> _0x4e96b4 = <span class="hljs-variable language_">window</span><br>    , _0x30bc70 = <span class="hljs-title class_">String</span>;<br><span class="hljs-keyword">var</span> _0x3912f2 = <span class="hljs-title class_">Error</span><br>    , _0x4d2d2c = <span class="hljs-title class_">Array</span><br>    , _0x109910 = <span class="hljs-title class_">Math</span><br>    , _0xff7e93 = <span class="hljs-built_in">parseInt</span><br>    , _0x35bb1d = <span class="hljs-title class_">Date</span><br>    , _0x3d0f3f = <span class="hljs-variable language_">document</span><br>    , _0x5cd506 = <span class="hljs-title class_">Object</span><br>    , _0x3bdc68 = <span class="hljs-built_in">unescape</span><br>    , _0x1ec3c0 = <span class="hljs-built_in">encodeURIComponent</span><br>    , _0x3b2c8e = <span class="hljs-title class_">Function</span>;<br><br><span class="hljs-keyword">var</span> _0x1171c8 = <span class="hljs-number">0x67452301</span>;<br><span class="hljs-keyword">var</span> _0x4dae05 = -<span class="hljs-number">0x10325477</span>;<br><span class="hljs-keyword">var</span> _0x183a1d = -<span class="hljs-number">0x67452302</span>;<br><span class="hljs-keyword">var</span> _0xcfa373 = <span class="hljs-number">0x10325476</span>;<br>_0x4e96b4 = <span class="hljs-variable language_">window</span><br>_$Tk = <span class="hljs-title class_">CryptoJS</span>;<br>_$yw = <span class="hljs-title function_">_0x2d5f5b</span>()[<span class="hljs-string">&#x27;toString&#x27;</span>]();<br>_0x4e96b4[<span class="hljs-string">&#x27;_$is&#x27;</span>] = _$yw;<br><br><span class="hljs-keyword">var</span> _0xceb4b2 = []<br>    , _0x2b11f1 = <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>];<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xac9d20</span>(<span class="hljs-params">_0x16f6c8</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x7d707d = <span class="hljs-title function_">_0x2b11f1</span>(<span class="hljs-number">0x60</span>);<br>    _0xceb4b2 = <span class="hljs-title function_">_0x48d4b5</span>(_0x16f6c8)[<span class="hljs-string">&#x27;split&#x27;</span>](_0x7d707d);<br>&#125;<br><br><span class="hljs-title function_">_0xac9d20</span>(<span class="hljs-string">&#x27;o~q&#125;u`euf3ffdyrgfu`fkbu`xduv`wuf3ffdyrgfu`qsfya~`sq||`efdy~w`bdafafkbu`e|ysu`$_vb~W`eb|ysu`qbb|k`3sfyhuJArzusf`dueg|f`sxqd5atu3f`rgffa~`eu~t`vad&#125;`ratk`&#125;ageu&#125;ahu`xqeAi~Bdabudfk`xaef~q&#125;u`|asqfya~`abu~`eb|yf`euf;~fudhq|`xffbe,`s|ys&#123;`sa~sqf`&#125;ufxat`faEfdy~w`~atuFkbu`adywy~`v|aad`badf`$_~t`:F?&gt;9u~udys7|u&#125;u~f`fqw@q&#125;u`saa&#123;yu`$_&lt;C~x`exai?atq|6yq|aw`du&#125;ahu5xy|t`&#123;uk5atu`bqdu~f@atu`wufFy&#125;u`duqtkEfqfu`ujus`bqfx~q&#125;u`euqdsx`fuef`yvdq&#125;u`eufFy&#125;uagf`:F?&gt;8ad&#125;7|u&#125;u~f`hyeyry|yfk`qbbu~t5xy|t`qtt7hu~f&gt;yefu~ud`y~tujut64`esdybf`a~duqtkefqfusxq~wu`uhq|`y~~ud:F?&gt;`hq|gu`7&#123;sB`|asq|Efadqwu`a~egr&#125;yf`arzusf`bdafasa|`sa~fu~f`s|a~u@atu`y~tujAv`qeeyw~`idyfu`tasg&#125;u~f`du&#125;ahu7hu~f&gt;yefu~ud`dag~t`efk|u`$_hh5;`dub|qsu`vg~sfya~`?ysda?ueeu~wud`geud3wu~f`ixy|u`a~s|ys&#123;`y~bgf`suy|`?qfx`xyttu~`fqdwuf`|aqt`&#125;rezmkexsv`~g&#125;rud`sduqfu7|u&#125;u~f`wuf7|u&#125;u~fe4kFqw@q&#125;u`wuf7|u&#125;u~f4k;t`qffqsx7hu~f`$_vxV`s|yu~f6qfq`egr&#125;yf`fy&#125;uEfq&#125;b`va~fe`A~|k\x20a~u\x20hqdyqr|u\x20tus|qdqfya~\x20q||aiut\x20y~\x20vadTTy~\x20|aab`fdq~eyu~f`qdyfk`tyeqr|ut`fkbuav`sxqdeuf`egbud`|u~wfx`#v*X`?ej&#125;|XTJ?&gt;:FFBTYTV`fa6qfqGD&gt;`asd_dtkfigDsddqqmujgnh`qbb|ysqfya~5qsxu`&#125;g|fybqdfUvad&#125;Stqfq`hqd\x20wuf3ffdyrgfu/vg~sfya~N~q&#125;uOmdufgd~\x20sgd_u|uTwuf3ffdyrgfuN~q&#125;uO-o-`qffdyrgfue`Marzusf\x203ddqk]`bgex@afyvysqfya~`hayt`F=_EFD;@9`VVVV`qffdHudfuj`bgr|ys`efabBdabqwqfya~`l_,zcze~ld_VQR_+zxfiyzi9_jzcze~ld9xvcc,zcze~ld`$_vV`xqex`su||g|qd`8EE44`qssu|udqfya~`fdq~evud5xq~~u|`~7hdo5od|hu`fdgu`sduqfuArzusfEfadu`?ej&#125;|XTJ?&gt;:FFBT[TV`du&#125;ahu3ffdyrgfu`b|gwy~e`o__vf&#123;jwf_wjs~ishw6__kwtvf&#123;jwf_wjs~ishw6__gw~wb&#123;ia_wjs~ishw6__xlvf&#123;jwf_wjs~ishw6__vf&#123;jwf_ibkfsddwv6__kwtvf&#123;jwf_ibkfsddwv6__gw~wb&#123;ia_ibkfsddwv6__xlvf&#123;jwf_ibkfsddwv6__kwtvf&#123;jwf_guf&#123;dh_xibu6__kwtvf&#123;jwf_guf&#123;dh_xb`fdkmdufgd~\x20Niy~tai\x20y~efq~suav\x20Iy~taiO-osqfsxNuOmo`?ej&#125;|XTEudhudJ?&gt;:FFB`sa|ad6ubfx`fWY/ebisbqf~|N3f&#125;bq|k\x20,|~efkb\x204kfNVllig|wwN5boa|k|N[bisbqf~|\x20-brb\x20+3\x20/ol\x20FH\x203efkNq|elj|N+Z\x202j|oq_[\x20qbpq\x201bdri|oNW(-/ol@ifdeqN[bisbqf~|\x20+3\x20GF\x20+fdeq\x20XuqbkabaN[bisb,_(kaf|N2XV1l&#125;lql+fdeq\x20UliaN.1\x20,le|kqv\x204kf~lab\x201bdri|oNWolfa\x202|kp\x203e|fN*|kk|a|\x202|kd|j\x20,-NWWV\x204~ebkN~il~hECDI_sDADN2|jprkd*|kk|a|1bdri|oN,(\x20+T-3(-Z\x20UliaN2|jprkd2|kp-rjF+\x20+fdeqNsboa|k|N[bisbqf~|-brb3efkN2XVY|ii&#125;|~hN2|jprkdXjlgfN3birdr\x202|kd|j\x20,-NV|oolfp\x20Zlqef~\x202VNYivjb\x20+fdeq\x201l&#125;lql\x20+fdeqN2l,T@Wfdfq\x20+fdeqN2l,V\x202|kp\x201bdri|oN[87f8r|k)NppqNp|jprkd@p|kp@krjG3Ndj_jbkdjbkdN+lefq\x20*|kk|a|Nqfjbp\x20kbt\x20olj|kNp|jprkd@p|kp@krjG+Npbofc@jlklpm|~bN2|jprkd2|kp-rj@F3\x203efkNVlilo.24(@73efkNWolfa\x20-|phe\x202efcq\x20TiqN2|jprkd3birdr1bdri|oNUbkd|if\x20.32N,(\x20+|k3fkd_ZU\x20.rqpfab\x2082NY9,f|l6r_ZUDKCFCNebisb@kbrb@obdri|oN223\x20,bafrjNVlrofbo\x20-btN*ejbo\x20,lkarihfof\x20UliaN[bisbqf~|\x20+3\x20EF\x204iqo|\x20+fdeq\x20XuqbkabaN[bisbqf~|\x20+3\x20EH\x204iqo|\x20+fdeqN1l&#125;lql\x20,bafrjNWolfa\x202|kp\x20UliaNdlravNp|kp@pbofc@~lkabkpba@ifdeqN2YfkaboNklql@p|kp@~gh@jbafrjNjfrfN,1l~hv\x20/1V\x20UliaNTkaolfaVil~h\x201bdri|oN2|jprkd2|kp-rj@G+\x20+fdeqNp|kp@pbofc@qefkNT|/|kd8|boN~|pr|iNU-\x20,le|kqv.3\x20UliaNu@ppqN-lql2|kp,v|kj|o9|tdvfN[bisbqf~|\x20+3\x20FF\x203efk\x20XuqbkabaNTpeibv2~ofmq,3\x20TiqN-lql\x202|kp\x20Wbs|k|d|of\x204(N1l&#125;lql\x20Vlkabkpba\x20UliaN1l&#125;lql\x20,bafrj\x20(q|if~NjfrfbuN-lql\x202|kp\x20Zrojrhef\x204(N223\x205fbqk|jbpb\x20+fdeqN+Z_.ofv|Nev~lccbbNu@ppq@riqo|ifdeqNWY[bfT6J@TNY9967U3.3_4kf~labNWbs|k|d|of\x202|kd|j\x20,-\x20UliaNp|kp@pbofc@jlklpm|~bN/|a|rh\x20Ullh\x20UliaN+Z@Y98fkdUf*|f2er@2DH@5EAEN+Z@Y98fkdUf*|f2er@2DH@5EAFN[bisbqf~|-brb+3\x20/ol\x20FH\x203eN,f~olplcq\x20[fj|i|v|N2|jprkd2|kpY|ii&#125;|~hN223\x20,bafrj\x20(q|if~NTkaolfaXjlgfN2|jprkd2|kp-rj@F1N(3V\x202qlkb\x202bofcNp|kp@pbofc@pj|ii~|mpNu@ppq@jbafrjN+Z_2fke|ibpbN1l&#125;lql\x203efk\x20(q|if~N~bkqrov@dlqef~NVil~hlmf|N+rjfklrp_2|kpNYilofaf|k\x202~ofmq\x20TiqN-lql\x202|kp\x20Zrojrhef\x20UliaN+3[829*\x20UliaNZ2_3e|fN2|jprkd-bl-rj_F3_ENTo|&#125;f~Ne|kp@p|kp@kloj|iN+lefq\x203birdrN[80f[bf@HC2\x20+fdeqN+fkapbv\x20clo\x202|jprkdNT1\x20Vovpq|iebf\x20WUN2|jprkd\x202|kp\x20,bafrjNp|jprkd@p|kp@krjGHNe|kp@p|kp@&#125;liaN+rjfklrp_2~ofmqN223\x20VlkabkpbaN2|jprkdWbs|k|d|of1bdri|oNTkg|i\x20,|i|v|i|j\x20,-N2|jprkd3e|f;qbpq&lt;NY9+|k3fkd[bf@,@ZUDKCFCN[b&#125;obt\x20.32NZ2GH_To|&#125;;Tkaolfa.2&lt;N2|jprkd\x202|kp\x20+fdeqNVel~l\x20~llhvNebisb@kbrb@qefkN/-\x20,le|kqv.3\x20,bafrjN+Z@Y9*|3lkd@,DL@5EAGNWolfa\x202bofcN2|jprkd2fke|i|1bdri|oNebisbqf~|N+Z@Y9*|3lkd@,DL@5EAEN-lql\x202|kp\x20Wbs|k|d|of\x204(\x20UliaN223\x20+fdeqNWY/XjlgfNtb|qeboclkqkbt\x201bdri|oN1l&#125;lql-rjF1NW(-/ol@jbafrjN2|jprkd\x202|kp\x20-rjHHN223\x20[b|sv\x20(q|if~N+Zil~hG\x201bdri|o_CKCHNZblodf|Nklql@p|kp@~ghN3birdr\x202|kd|j\x20,-\x20UliaN,(4(\x20X7\x20-loj|iN[80f[bf@JH2\x20UliaN-lql2|kp,v|kj|o9|tdvf\x20UliaNvrklpmol@&#125;i|~hNebisb@kbrb@kloj|iN+rjfklrp_2bofcN3,\x20,le|kqv.3\x20-loj|iN2|jprkd2|kp-rj@F+s\x20+fdeqN2|jprkd\x202|kp\x20-rjGHN2j|oqZlqef~\x20,bafrjNdblodf|N~|pr|i@clkq@qvmbN2|jprkd\x202|kp\x20UliaNpj|ii@~|mfq|ipN,Yfk|k~b\x20/1V\x20UliaNY9+|k3fkd[bf_ZUDKCFCN2|jprkdTojbkf|kN1l&#125;lql\x20UliaN~bkqrov@dlqef~@&#125;liaNu@ppq@eb|svN223\x20+fdeq\x20(q|if~N3e|o+lkNu@ppq@ifdeqNWfk&#125;li\x201bdri|oN2|jprkdUbkd|if1bdri|oN*-\x20,le|kqv.32j|ii\x20,bafrjNevmrobN2|jprkd3|jfi1bdri|oN,|i|v|i|j\x202|kd|j\x20,-N-lql\x202|kp\x20*|kk|a|\x204(Nebisb@kbrbN[bisbqf~|\x20+3\x20HH\x201lj|kN-lql\x202|kp\x20*|kk|a|\x20UliaN2|kmv|N2|jprkd/rkg|&#125;f1bdri|oNp|jprkd@p|kp@krjG+sN+Z_*|kk|a|N2|jprkd\x202|kp\x201bdri|oN9|tdvf@.kbNWolfa\x202bofc\x20Ulia\x20(q|if~NY9*T3)6N~lrofbo\x20kbtN2|jprkdXjlgf1bdri|oN,(4(\x20X7\x20UliaNTkaolfa\x20XjlgfN-lql\x20-|phe\x20To|&#125;f~\x204(N+VW\x20VljNYrqro|\x20,bafrj\x20U3N5fsl@buqo|~qNU|kdi|\x202|kd|j\x20,-\x20UliaNe|kp@p|kp@obdri|oN2-rj@F1N2-rj@F3Ne|kp@p|kpN223\x204iqo|\x20+fdeqN1l&#125;lql\x201bdri|oN1l&#125;lql\x20+fdeqN[|krj|kNkbtiddlqef~NWY[bfT6H@TNe|kp@p|kp@ifdeqN/i|qb\x20Zlqef~N2-rj@F+N[bisbqf~|\x20+3\x20GH\x20+fdeqN,v|kj|o\x202|kd|j\x209|tdvf\x20UliaNid@p|kp@pbofc@ifdeqN,(4(\x20X7\x20+fdeqN1l&#125;lql\x203efkN2l,T\x20UliaN/|a|rhN2|jprkd\x202|kpN2m|~flrp_2j|iiV|mNp|kp@pbofcNW5\x20,le|kqv.3\x20,bafrjN2q|&#125;ib_2i|mNjlk|~lNYivjb@+fdeqNcwwvp@alpmvN2~obbk2|kpN~il~hECDIN1l&#125;lql\x20Vlkabkpba\x20Ulia\x20(q|if~NTof|iN*-\x20,le|kqv\x20,bafrjN,lqlv|+,|or\x206F\x20jlklN[|kapbq\x20VlkabkpbaN1l&#125;lql\x20(q|if~N[3V\x20[|kaN223\x204iqo|\x20+fdeq\x20(q|if~N223\x205fbqk|jbpb\x201lj|kN-lql\x20-|phe\x20To|&#125;f~\x204(\x20UliaN~ekcwue@jbafrjN2-rjVlka@F3N~bkqrov@dlqef~@obdri|oNabc|riq_ol&#125;lql@ifdeqN-lql\x202|kp\x20,v|kj|oN,v|kj|o\x202|kd|j\x20,-NTmmib\x20Vlilo\x20XjlgfNtb|qeboclkq1bdN2|jprkd,|i|v|i|j1bdri|oN|of|iNWolfa\x202bofc\x20UliaNV/lF\x20/1V\x20UliaN,(\x20+T-3(-ZN2|jprkd*lob|k@1bdri|oNqbpqGH\x201bdri|oNpmfofq_qfjbNWbs|k|d|of\x202|kd|j\x20,-N2~obbk2bofcN1l&#125;lqlN~ropfsb@clkq@qvmbN23[bfqf_sfslN~ekcwueN2|jprkd\x20Vil~hYlkq\x20FTN1l&#125;lql\x20Vlkabkpba\x201bdri|oNp|jprkd@kbl@krjF1NZ)\x20,le|kqv.3\x20,bafrjNVeriel\x20-brb\x20+l~hNol&#125;lql@krjF+Nebisb@kbrb@riqo|+fdeqbuqbkabaN2|jprkd.ofv|1bdri|oN2|jprkd2|kp-rj@G+s\x20+fdeqN,8fkd[bf_DKCFC_VE@UliaNWY/2e|l-s6H@ZUN1l&#125;lql\x20Ui|~hNebisb@kbrb@riqo|ifdeqNdj_ufebfN+Zil~hG\x20+fdeq_CKCHNZrg|o|qf\x202|kd|j\x20,-N,|i|v|i|j\x202|kd|j\x20,-\x20UliaNol&#125;lql@krjF1N237febf_sfslNY99erk8r|k_ZUDKCFCNklql@p|kp@~gh@ifdeqN~lilolpN-lql\x202|kp\x20ZrojrhefN-lql\x202|kp\x202vj&#125;lipN1l&#125;lql\x20+fdeq\x20(q|if~N+lefq\x203|jfiN~ropfsbNabc|riq_ol&#125;lqlNUe|pefq|Vljmibu2|kp\x20UliaN+Z_-rj&#125;bo_1l&#125;lql\x203efkNjlklpm|~ba@tfqelrq@pbofcpN[bisbqf~|\x20+3\x20FH\x203efkNp|jprkd@p|kp@krjF+5NW(-/olN)ljlie|ofNp|kp@pbofc@ifdeqNebisb@kbrb@&#125;i|~hN+lefq\x20Ubkd|ifN,v|kj|o\x202|kd|j\x209|tdvfNWolfa\x202bofc\x20(q|if~N1l&#125;lql\x20Ulia\x20(q|if~N-|krjZlqef~N2lkv\x20,l&#125;fib\x204W\x20Zlqef~\x201bdri|oNZblodf|\x20Ulia\x20(q|if~Np|jprkd@p|kp@krjF+sNvrklp@qefkNp|jprkd@kbl@krjF3@~lkaN-lql\x202|kp\x20,v|kj|o\x204(\x20UliaNidpbofcNY98lr[bf@1@ZUDKCFCN+lefq\x20/rkg|&#125;fN&#125;|phbosfiibNp|jprkd@p|kp@krjG3sNp|jprkd@p|kp@qefkN+Z\x20XjlgfNTkg|if-bt+fmfN2|jprkd2|kp-rj@G3\x203efkN2|jprkd*lob|k@UliaNjfrfbu@ifdeqN-lql\x202|kp\x20*|kk|a|N1l&#125;lql\x20-loj|i\x20(q|if~NZblodf|\x20(q|if~Np|kp@pbofc@jbafrjN2j|oq\x209|tdvfN1l&#125;lql\x20Vlkabkpba\x20(q|if~N-lql\x202|kp\x20*|kk|a|\x204(\x20UliaNWY/\x202~\x202|kp\x20[brbFC_DCFN+Z_-rj&#125;bo_1l&#125;lql\x20UliaN/|a|rh\x20UllhNu@ppq@~lkabkpbaN2rkpefkb@4~ebkN1l&#125;lql\x20Ui|~h\x20(q|if~N1fkdl\x20Vlilo\x20XjlgfNWbs|k|d|of\x20.32N2j|oq\x209|tdvf\x20/olNY9+|k3fkd[bf@,@ZU*NTkaolfaVil~h@+|odb\x201bdri|oNmolmloqflk|iiv@pm|~ba@tfqelrq@pbofcpNVrqfsb\x20,lklNqfjbpN+Z\x202j|oq_[\x20qbpq\x20UliaNW(-/ol@+fdeqNp|kp@pbofc@&#125;i|~hN+lefq\x20Wbs|k|d|ofNmolmloqflk|iiv@pm|~ba@tfqe@pbofcpNp|jprkd@p|kp@krjF+N,8lrkd\x20/1V\x20,bafrjNWYZlqef~/6H@U(ZH[*@2.-8Ne|kp@p|kp@jbafrjN223\x20[b|svN+Z@Y99erk8r|k@,CE@5EAEN,v|kj|o4-bt\x201bdri|oN-lql\x20-|phe\x20To|&#125;f~\x20UliaN2|jprkdZrg|o|qef1bdri|oNc|kq|pvNebisb@kbrb@ifdeqN[bisbqf~|\x20-brb\x20.32\x20UliaNklql@p|kp@~gh@&#125;liaNp|jprkd@p|kp@krjF1N+fkapbv\x202|jprkdNp|jprkd@p|kp@krjF3N2~obbk2bofc,lklNX3orjm\x20,v|kj|o_96Nebisb@kbrb@qefkbuqbkabaN-lql\x20-|phe\x20To|&#125;f~N+Z_Zrg|o|qfN2j|oq_,lklpm|~baN3|jfi\x202|kd|j\x20,-N+Z\x20Xjlgf\x20-lkT,XN1l&#125;lql\x20Vlkabkpba\x20+fdeq\x20(q|if~Ndj_gfkdh|fNY9+|k3fkd*|k[bf_ZUDKCFCNidqo|sbiNm|i|qfklNZblodf|\x20UliaNWolfa\x202|kpN+Z_/rkg|&#125;fN2j|oqZlqef~\x20UliaN2|jprkd\x202|kp\x203efkN223\x20Vlkabkpba\x20UliaNVljf~p_-|ooltN~lrofboN.ofv|\x202|kd|j\x20,-Nebisb@kbrb@ifdeqbuqbkabaNY9+|k3fkd[bf@1@ZUDKCFCNT1\x20Vovpq|iebf[*2V2\x20WUNpbofcN13628rb1lraZlZCsD@1bdri|oN,f|l6r_mobsNY98D*N+Z_-rj&#125;bo_1l&#125;lql\x201bdri|oNTkaolfaVil~hN2l,T\x201bdri|oN[80f[bf@GC2\x20+fdequNid@p|kp@pbofcNW|k~fkd\x202~ofmq\x20UliaNabc|riqNpb~@ol&#125;lql@ifdeqNVlilo.24(@1bdri|oNqbpq\x201bdri|oN3|jfi\x202|kd|j\x20,-\x20UliaNY98fkdUf7fkd2er@2DIN1l&#125;lql-rjF+\x20+fdeqNjlklpm|~ba@tfqe@pbofcpNp|jprkd@p|kp@krjFHNVlli\x20g|wwN2|jprkd-bl-rj@F+N237fkdh|fN2~obbk2|kp,lklNWY/6|6|6H@ZUN2|jprkd2|kp-rj@F+\x20+fdeqNU|kdi|\x202|kd|j\x20,-NZrojrhef\x202|kd|j\x20,-N2XV1l&#125;lql+fdeqNevclkuo|fkN,8fkd[bfZUDKCFCV@UliaNp|jprkd@p|kp@ifdeqN[bisbqf~|\x20+3\x20IH\x20,bafrjNWolfa\x202|kp\x20Y|ii&#125;|~hN1l&#125;lql\x203bpqD\x20UliaN-lql\x202|kp\x20,v|kj|o\x20UliaNp|kp@pbofc@~lkabkpba@~rpqljN2|jprkd-bl-rj@F3N2|jprkd\x202|kp\x20-rjFHNjlklpm|~bN3+\x20,le|kqv\x20,bafrjNebisb@kbrb@jbafrjN+3[829*N1l&#125;lql\x20Vlkabkpba\x20~rpqljb\x20UliaN,v|kj|oFNWolfa\x202|kp\x20Wbs|k|d|ofN2e|l-s_mobsNp|jprkd@kbl@krjF+NY9+|k3fkd[bf@X+@ZU*NvrklpNp|jprkd@kbl@krjF3N3fjbp\x20-bt\x201lj|kNebisb@kbrb@&#125;liaNklql@p|kp@~gh@obdri|oN-lql\x202|kp\x20Zrojrhef\x204(\x20UliaNW(-/ol@&#125;i|~hNY9+|k3fkd[bf@X+@ZUDKCFCN223\x205fbqk|jbpb\x20,bafrjN1l&#125;lql\x20Vlkabkpba\x20+fdeqN223\x205fbqk|jbpb\x20UliaNT1\x20W)@**NWolfa\x202|kp\x202X,VN-lql\x202|kp\x20,v|kj|o\x204(NVljfkd\x202llkN,8rmmv\x20/1V\x20,bafrjN1lpbj|ovN+lefq\x20Zrg|o|qfN1l&#125;lql\x20Vlkabkpba\x20~rpqlj\x20UliaNY9+|k3fkd[bf2@1@ZUN[bisbqf~|\x20-brb\x20.32N*|fqf_mobsN1l&#125;lql@UfdVil~hNY98U*2)6N[|kapbq\x20Vlkabkpba\x20UliaN2|jprkdZblodf|kNW|k~fkd\x202~ofmqNp|kp@pbofc@~lkabkpbaNe|kp@p|kp@qefkN2|jprkd2|kp-rj@G3s\x203efkN+lefq\x20.af|NUe|pefq|Vljmibu2|kp`y~efq~suav`qtt4uxqhyad`9ufAdywy~q|Gd|`sa~~usfya~`y~s|gtu`vdq&#125;u`dufgd~\x20qMr]N`sxy|tdu~`2turgwwud`\x27~g||\x27\x20ye\x20~af\x20q~\x20arzusf`vg~s`$_h&lt;Fb`dvdajhs)hccdm`esduu~K`@g&#125;rud`vq|eu`eds7|u&#125;u~f`d$1qd6XWqnvrdqXk~rrhbA6XWqnvrdq.drr~fdXdmsdq`gd|N#tuvqg|f#geudtqfqO`eufDucguef:uqtud`y&#125;badf`&#125;ageuAhud`&#125;ufq`?ej&#125;|TJ?&gt;:FFB`v@p:zm3tww3z&#125;xAzzwM@zrzb:~p`~qfyhu`wq&#125;&#125;q`wufFy&#125;ula~uAvveuf`tqfqeSfe`__a~|aqt__`g5+.h&#123;uan@-U6`zresxu&#125;u,UUcgugu_xqe_&#125;ueeqwu`eufFy&#125;u`yfu&#125;`?76;G?_8&gt;A3F`_r|q~&#123;`v|aqf`#W)u`ujfu~te`v__dpmo&#125;tcp&#125;_~n&#125;t&#123;a_qy`Ducguef`?ej&#125;|XTEudhudJ?&gt;:FFBTYTV`s|yu~f;~vad&#125;qfya~`fxu~`?EBay~fud7hu~f`B|uqeu\x20u~qr|u\x20saa&#123;yu\x20y~\x20kagd\x20rdaieud\x20ruvadu\x20kag\x20sa~fy~guT`sqbfgduEfqs&#123;Fdqsu`pOrivRtbaSrirRagvewrtv5&#123;vfzba`:F?&gt;Arzusf7|u&#125;u~f`EF3F;5_6D3I`qsae`ujfud~q|`yixxtqki|qwvMbK&#123;pwksai~mKnti&#123;p`dufgd~\x20~ui\x20qN`3~q|keud@atu`&#125;al5a~~usfya~`dqtya`EufDucguef:uqtud`DF5Buud5a~~usfya~`a~gbwdqtu~uutut`bqdeu;~f`sq~hqe`15E/`g~uesqbu`-\x20Eusgdu`w|arq|Efadqwu`?ej&#125;|XTJ?&gt;:FFB`p[vr&#125;+zuvb7[vr&#125;+zuvb1g~2\x20Jtgziv-\x20Lbageb&#125;\x201&lt;;6szg2`?ysdaeavfTJ?&gt;:FFBTWTV`sqfsx`Budvad&#125;q~suAreudhud`wuf5a~fujf`tuvqg|fBduhu~fut`avveufFab`sa~fqy~e`tqfq,`$r_b|qfvad&#125;`xffbe,UU`:;9:_;@F`arzusfEfadu@q&#125;ue`fxye`skw&lt;Q`CC4daieud`Ahuddytu?y&#125;uFkbu`ljzcze~ld`iytfx`&#125;ageu?ahu`sxqd`|&gt;jg?43tl4xl_&lt;508&lt;,_`rweag~t`y7wd+xxmizivkm`baeyfya~`sqeu`b6lzqfE[fufdujpo`fagsxu~t`duvduex`$r&#125;8VqJL|D&#125;|HkG:&lt;`bdab`|qef;~tujAv`sq||rqs&#123;`~g||`G~u~s|aeut\x20efdy~wT`t@dvpxCvzrQ@dvpxCvzr`rD~v~f`wuf3ffdyr&gt;asqfya~`&lt;EA@`~atuHq|gu`9q&#125;ubqt`rufq`__q~sxad__`avveuf&gt;uvf`&#123;c\x5cyF\x5cCtgzo|k\x20iujk\x5c]\x5cyFe`bqdeu`tqfq`$_vd`bqs&#123;qwu`daie`ArzusfT;~zusfutEsdybfTuhq|gqfu`abu~ud`&#125;ageugb`exu~zyq~`turgwwud`ufxud~uf`$_s6da`F7?BAD3DK`mmyvxh&#125;lyh`dub|qsu5xy|t`BAEF`~g&#125;;fu&#125;e`sqbfgdu`tasg&#125;u~fSvdqw&#125;u~f`va~f`vydef5xy|t`vda&#125;5xqd5atu`iur&#123;yf;~tujut64`Bay~fud7hu~f`iur&#123;yfDucguef8y|uEkefu&#125;`sxqd3f`tuesdybfya~`pfcz_ybb|vu5~bmJaz~rgzba(greg)z~v5~bmRauvkvuMK5~bm[vdhvfgJaz~rgzbaOer~v`wuf4qffudk`&#123;;?+zrJ;?+zr`qrea|gfu`dueba~euFujf`saa&#123;yu7~qr|ut`mdyjifuhayh8__di8__diMffydx,ynj8ye/yvNhemiyh`vy~q|`bdu|aqt`=ukraqdt`r|gufaafx`sq~su|4grr|u`ujusEsdybf`fdkmdufgd~\x20__vy|u~q&#125;u-osqfsxNuOmo`hqd\x20sgd_u|u\x20/\x20fxye-`iyfx`x__bnkm&#123;ran&#123;_naju~j&#125;n`efqfge`fa8yjut`tyeb|qk`egrefd`M~g||]\x20ye\x20~af\x20q~\x20arzusf`jPzkh+SU=+SU`L*J:&lt;&lt;KTr&#125;8VqJL|D&#125;|HkG:&lt;NO`euf;fu&#125;`.U$W`|aqtut`Du&#125;ahu7hu~f&gt;yefu~ud`a~qgfasa&#125;b|ufu`$r_sq||:q~t|ud`\x20edv|j\x20`bdafusfut`&#125;qfsx`wafa`tdqi3ddqke`&#125;utyq6uhysue`s|aeu`iurefadu`iur&#123;yfDF5Buud5a~~usfya~`5ag~f`fujfUzqhqesdybf`qrefdqsf`budvad&#125;q~su`Efadqwu`w$ryyu$L$$vyqqo|L$$v&#125;zL$$v&#125;|lL$rnd$L$|okne/yno-v|okne1doma~on5x@rs&#125;2|kwoL$&#125;nd$L$aso$`|q~wgqwue`$_vr`euf&gt;asq|6uesdybfya~`eagdsu`U,geud_va~fe`F=_@G?47D`esda||`$r_vufsxCgugu`.!SSMyv\x20wf\x20;7\x20`zkl&#125;pjlvyplu&#123;h&#123;pvu`bdusyeya~\x20&#125;utyg&#125;b\x20v|aqf-hqdky~w\x20husX\x20hqdky~Fuj5aadty~qfu-hayt\x20&#125;qy~NO\x20mw|_8dqw5a|ad/husZNhqdky~Fuj5aadty~qfuRVRWO-o`sduqfuBdawdq&#125;`p^\x5c$0r6m]ut_`baef`:F?&gt;7|u&#125;u~f`fujfUxf&#125;|`.!SS`arzusfEfadu`v&#125;xzneO?plw=wlfp&#125;\x204S\x200zya&#125;zwOR`|y~&#123;Bdawdq&#125;`bdusyeya~`yu&#123;~q&#123;qjqtq|ckpivom`7~fyfk`p~fLevuvagzr&#125;f`cds&#123;|&#125;6a7jfxI&lt;y:3bWeHK=GYD8?Ci*;9vBA+Xrh&gt;@zT)lJ4qE~gVF5(wk_ZLu[tmonp\x20!#$%NOPQRS-/12M]^`g~yvad&#125;Xv`zqhqesdybf,`p*L,vsNkg5htjvs`dub|qsuEfqfu`ha|qfy|u`sduqfu6qfq5xq~~u|`geu\x20efdysf`adywy~q|Fqdwuf`u__ru~qr&#123;f__N_ru~qr&#123;f_@qmpq~;&#123;pq`zqhqesdybf,\x20haytNVO-`G~ujbusfut\x20sxqdqsfud,\x20`m\x22abfya~q|\x22\x20,\x20M\x20m\x22Dfb6qfq5xq~~u|e\x22\x20,\x20fdguo\x20]o`G~fud&#125;y~qfut\x20&#125;g|fy|y~u\x20sa&#125;&#125;u~f`UF)3kFdjaIj9t`Egr&#125;yf`fy&#125;u`dueba~eu`dq~wu?y~`fdy&#125;`sxus&#123;raj`L*J:z`sa~ef`E7&gt;75F\x20hq|gu\x208DA?\x207&#123;sB_f\x20I:7D7\x20~q&#125;u/1`8|aqfYX3ddqk`9ufDueba~eu:uqtud`avveufJ`s#dP^b#:#d&#123;|d&#123;&#125;d&#123;6d&#123;ad&#123;7d&#123;jd&#123;fd&#123;xd&#123;Id&#123;&lt;d&#123;yd&#123;:d&#123;gd|fdE6`duvuddud`k*RT&lt;*z|Qljd`~atu@q&#125;u`wufDueba~eu:uqtud`.&#125;ufq\x5ceQxffbSucgyh/M\x22\x27]1duvduexM\x22\x27]1\x5ce`ek~sxda~ylut`ujbadf`vy|u~q&#125;u`abu~6qfqrqeu`b__ds:fcC__hZs:fc`u~qr|uHudfuj3ffdyr3ddqk`xffb,UU`xuywxf`eqvqdy`E7@6`zresxu&#125;u,UU`bnp&#123;wjtjcjmjuzdibohf`G~u~s|aeut\x20duwg|qd\x20ujbdueeya~T`iur&#123;yfBudeyefu~fEfadqwu`ww&#125;4snnox`___fe___`s|qee`dg~fy&#125;u`&#125;al;~tujut64`bqdu~f7|u&#125;u~f`?yeey~w\x20sqfsxUvy~q||k\x20r|as&#123;e`sK#d6343E3~3V3F3(WJe.e0HiD-8~8$8%8\x20?c?*?;?9CcCxCIC:C3CbC?CrChC^C&amp;CPihi)ili~igiL*s*&#123;*a*e*H*K*T;c;d;s;|;&#125;;6;?;C;_;Z;L9C9*9;999h9&gt;9S9)9l959(929$vjv^v&amp;vPvNvOvoB&#125;AzASA(AwAnA\x20+w+_+Z+2+$+%+&amp;+P+N+O+,+-X&#125;X6XXXrrGrvr)rlr.r0hZhP&gt;f&gt;x&gt;OzGzvzBSXSrS2S%S&amp;S/S.)g)_)ZlvJlJJJgJ_JZJLJuJ[JtJpJ\x204c4d4s4S4)4l4J44454w4&amp;(p$a$7$h$&gt;%W%B%A%+%k&amp;mN;N9N&gt;N@NzQyQ:/|/&#125;/2/$/%/0/T/1/U/,.e0tT=TGTiT*T+TXTr1j1f1x1z141q1E1~1g,x,I,&lt;,ym6mWmG#!#d&#123;3d&#123;bd&#123;$d&#123;%d&#123;\x20d&#125;gd~&amp;d~P&#125;v!&#125;vT&#125;v1&#125;A3&#125;Ab&#125;rG&#125;r?&#125;r9&#125;rw&#125;rk&#125;r_&#125;rZ&#125;rL&#125;hL&#125;hu&#125;&gt;h&#125;z&#123;&#125;z|&#125;zV&#125;Sx&#125;SI&#125;S&lt;&#125;SW&#125;Se&#125;SH&#125;)J&#125;)4&#125;)q&#125;)E&#125;)~&#125;)g&#125;)V&#125;)F&#125;)2&#125;)/&#125;).&#125;lv&#125;l]&#125;J|&#125;J&#125;&#125;Jx&#125;JI&#125;Jy&#125;EX&#125;Er&#125;Eh&#125;E&gt;&#125;E@&#125;Ez&#125;ES&#125;E)&#125;EJ&#125;E47fC7e37eb7=b`qffdyrgfu\x20husX\x20qffdHudfuj-hqdky~w\x20husX\x20hqdky~Fuj5aadty~qfu-g~yvad&#125;\x20husX\x20g~yvad&#125;Avveuf-hayt\x20&#125;qy~NOmhqdky~Fuj5aadty~qfu/qffdHudfujQg~yvad&#125;Avveuf-w|_Baeyfya~/husZNqffdHudfujRVRWO-o`raa|uq~`bgexEfqfu`du&#125;ahu;fu&#125;`\x00`sxqdqsfudEuf`kk&#123;d&#123;fame;&#123;nwdmwl&#123;`kyu|t`dufgd~`rqffudk`vad7qsx`y&#125;b|u&#125;u~fe`uhq|gqfu`|y~u~a`?ej&#125;|XTJ?&gt;:FFBT(TV`F=_D79_7J`wufEgbbadfut7jfu~eya~e`mxebf|&#125;d8xebf|&#125;d&#125;dze8xebf|&#125;dcyju`dwrqNXZVRWWVR[YRVTZO`?ej&#125;|XTJ?&gt;:FFBTZTV`&#125;al;fu&#125;e`s|uqd;~fudhq|`fxdai`q/sq~tytqfu,`$_s&#123;`3radf`sxus&#123;ut`avveuf:uywxf`9ufHqdyqr|u`avveufIytfx`eu|usfut`|qkudJ`tu|ufu`Nuhq|gqfy~w\x20\x27~g||MV]\x27O`efq~tq|a~u`esduu~`Duw7jb`s|yu~fK`sxqdwy~w`&#125;ueeqwu`Eu~t`&#125;y&#125;uFkbue`wuf;fu&#125;`Yzu3&gt;uEeq(`sxda&#125;u`va~f8q&#125;y|k`tuvqg|f`uhu~f`wufG~yvad&#125;&gt;asqfya~`NfxyeO-`G~ujbusfut\x20fa&#123;u~\x20`fdq~eqsfya~`adyu~fqfya~`wufEagdsue`g~tuvy~ut`M~qfyhu\x20satu]`CFB_7B7_:AA=`vufsx`hytua`:F?&gt;3~sxad7|u&#125;u~f`bdbqudib5fgsftiCdbqudib_sfgsftiCdifdl/phjoCefdszquZbmmcbdl`iur&#123;yf5a~~usfya~`iyvy`.7?476\x20yt/`6A?Bqdeud`;||uwq|\x20~ui|y~u\x20qvfud\x202fxdai`avveufG~yvad&#125;`&#123;uk6ai~`dufgd~Hq|gu`|a~w`sxqdwy~wFy&#125;u`AB7@`etgqg~gjgrwaf&#125;lec`\x5crM^0]P0NM\x5ce\x5cE]P1O.\x5cU`&#125;ageuAgf`_fe_`sa~fy~gu`iurw|`&#125;ageuGb`u~g&#125;udqfu6uhysue`egrefdy~w`esduu~J`g0a&#123;h.h&#123;uan@0a&#123;h.h&#123;uan:pi;\x20S&#125;pera6\x20Ukjpnkh\x20:ED?|ep;`|uhu|`.tyh0;7*.Utyh0`$r_eufgb`vy||Efk|u`sq~tytqfu`-\x20bqfx/U`xffb`eiyfsx`s|yu~fJ`puezive`rkfu`u~qr|utB|gwy~`dq~wu?qj`a~ruvadug~|aqt`u~saty~w`bqdu~f`&#125;ageutai~`\x5c\x5c`efqfys`&#125;ageuagf`wufExqtudBdusyeya~8ad&#125;qf`hudfuj3ffdyrBay~fud`z~likyp&#125;lyJl&#125;hs|h&#123;l`3ttEuqdsxBdahytud`efqfgeFujf`dD#d,s&#123;s77+7rjMj]fIfW:BW)Wle_eQe/emeoHxHC=x=T=1=o8g8&amp;?y?:?)?l?1CdCWC9CvCVCFCmCoiii*i9iviAi+iO*%*^*1;j;D;8;N;O9W9e9i9L9u9,vfv9vvvAvXvrvzvSvnAWAlAJAFA5+kXdX&#123;X|rarzrShJ&gt;Q&gt;/@p@!@$@&amp;@P@O@.zxz&lt;z3zbzYzDzAz)z2z$S&lt;J!4f4y4:4(q.V%Fm%g%w&amp;o1(1w#X#dd:ddbddeds?d|Cd|zd&#125;od6cd6yd6id6;d6vd6PdaAda+d@udS/dExdEIdE!dE2dLgslJsJ9&#125;yq&#125;9M&#125;9]&#125;+-&#125;+m&#125;E26]G7f?7fL7f[7ft7f!7f2`pJxLbageb&#125;7JxLbageb&#125;`?76;G?_;@F`uddad`|rta/niijs`q|bxq`&#123;ukGb`nwxk|vxbdi|dc`exqtudEagdsu`cds&#123;|&#125;6a7jfxI&lt;y:3bWeHK=GYD8?Ci*;9vBA+Xrh&gt;@zS)lJ4qE~gVF5(wk_ZLu[tp!2$%^&amp;PNOQ/.0T1U,-moM]n\x20`bqeeiadt`~ujfEyr|y~w`$_fe`dq~ta&#125;`sduqfuAvvud`3DEueeya~R3gtyaFdqs&#123;&gt;yefR4uvadu;~efq||Bda&#125;bf7hu~fTbdafafkbuT=7KGBR4|ar6ai~|aqt5q||rqs&#123;R563F3Eusfya~TbdafafkbuTdu&#125;ahuR5EE5xqdeufDg|uR5EEBdy&#125;yfyhuHq|guT5EE_H:R5q~hqeDu~tudy~w5a~fujfX6TbdafafkbuTiur&#123;yf9uf;&#125;qwu6qfq:6R5|ys&#123;6qfqR5|aeu7hu~fTbdafafkbuTy~yf5|aeu7hu~fR5a&#125;ba~u~feTy~fudvqsueT;5a&#125;uf?qd&#123;e7jfu~eya~R6uhysuAdyu~fqfya~7hu~fR8g~sfya~TbdafafkbuTry~tR9ufBudvFuefeR:F?&gt;6asg&#125;u~fTbdafafkbuTsduqfuFagsx&gt;yefR:F?&gt;8ad&#125;7|u&#125;u~fTbdafafkbuTducguef3gfasa&#125;b|ufuR:F?&gt;8dq&#125;uEuf7|u&#125;u~fTbdafafkbuTxqeBay~fud5qbfgduR:F?&gt;8dq&#125;uEuf7|u&#125;u~fTbdafafkbuTiur&#123;yfDucguef8g||Esduu~R;~f|R?FF_I=EufFujfEylu;~tujR?utyq5a~fda||udR?utyq7~sdkbfut7hu~fR@afyvysqfya~RArzusfTbdafafkbuT__tuvy~uEuffud__RArzusfTeuq|RArzusfTeufBdafafkbuAvRAvvesduu~5q~hqeDu~tudy~w5a~fujfX6RBqfxX6TbdafafkbuTqttBqfxRBqk&#125;u~fDueba~euRBudvad&#125;q~suBqy~fFy&#125;y~wRBdueu~fqfya~5a~~usfya~5|aeu7hu~fRDuqtud?atu3dfys|uBqwuREH99dqbxyse7|u&#125;u~fTbdafafkbuT&#125;alDucguefBay~fud&gt;as&#123;REH9Bqffud~7|u&#125;u~fTEH9_G@;F_FKB7_A4&lt;75F4AG@6;@94AJREsduu~Adyu~fqfya~REawag&gt;awy~Gfy|eREagdsu4gvvudREagdsu4gvvudTbdafafkbuTsxq~wuFkbuREbuusxEk~fxueyeGffudq~suRFujfFdqs&#123;&gt;yefTbdafafkbuTwufFdqs&#123;4k;tRG5Iur7jfRIur=yf8|qweR_IJ&lt;ER__$_cyxaaY(V_$__R__vyduvaj__R__&#123;eqr5ee5ag~fR__abudqR__eawag_eusgdu_y~bgfR_tagr|uWW_Rsxda&#125;uRsxda&#125;uTqbbT;~efq||EfqfuRsxda&#125;uTseyRsa~ea|uRtuvqg|fEfqfgeRtasg&#125;u~fTratkTa~&#125;ageuu~fudRtasg&#125;u~fTratkTa~bqwuRtasg&#125;u~fTratkTefk|uTrqs&#123;wdag~t4|u~t?atuRtasg&#125;u~fTratkTefk|uT|y~u4duq&#123;Rtasg&#125;u~fTratkTefk|uT&#125;y~IytfxRtasg&#125;u~fTratkTefk|uT&#125;eFujfEylu3tzgefRtasg&#125;u~fTratkTefk|uTfujf3|yw~&gt;qefRtasg&#125;u~fTratkTjS&#125;eSqssu|udqfad&#123;ukRtasg&#125;u~fTtuvqg|f5xqdeufRtasg&#125;u~fTtasg&#125;u~f7|u&#125;u~fTa~dueyluRtasg&#125;u~fTvy|u5duqfut6qfuRtasg&#125;u~fT&#125;e5qbe&gt;as&#123;Iqd~y~wAvvRtasg&#125;u~fTa~&#125;ageu&#125;ahuRtasg&#125;u~fTa~eu|usfya~sxq~wuRtasg&#125;u~fTesda||y~w7|u&#125;u~fTefk|uTva~fHqdyq~f@g&#125;udysRtasg&#125;u~fTeu|usfya~Rtasg&#125;u~fTeu|usfya~Tfkbu6ufqy|Rujfud~q|Rujfud~q|T3tt8qhadyfuRujfud~q|T;eEuqdsxBdahytud;~efq||utRv|kv|ai_iq||bqbud_zeRwuf?qfsxut5EEDg|ueRwduu~fuqRye@atuIxyfuebqsuRzueya~Ra~uddadRa~&#125;ueeqwuRa~abudqtufqsxuthyuisxq~wuRabu~6qfqrqeuRbqeeiadt_&#125;q~qwud_u~qr|utRbudvad&#125;q~suRexai?atq|6yq|awRfqardaieud_7hu~fRiuqfxud4dytwuRiur&#123;yf3gtya5a~fujfTbdafafkbuTs|aeuRiur&#123;yfDucguef8y|uEkefu&#125;`avveufK`vy~q||k`p__~ggLevrgvOer~v5~ggLh~fgb~S(`rqeu`Budvad&#125;q~suAreudhud7~fdk&gt;yef`qffqsxExqtud`u~qr|u/fdgu`a~ysusq~tytqfu`fdkmdufgd~\x20__tyd~q&#125;u-osqfsxNuOmo`;@E7DF\x20AD\x20D7B&gt;357\x20;@FA\x207&#123;sB_f\x20N~q&#125;uR\x20hq|guO\x20H3&gt;G7EN1R\x201O`ye@q@`?ageu`q~tdayt`&#123;ukgb`6uhysuAdyu~fqfya~7hu~f`m\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22ysuEudhude\x22\x20,\x20M\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~VWTeybbxa~uTsa&#125;\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~Tu&#123;ywqT~uf\x22oR\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~Tvit~ufT~uf\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~TytuqeybTsa&#125;\x22oR\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~Tybfu|Tadw\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~Tdyjfu|usa&#125;Teu\x22oR\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~Tesx|g~tTtu\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~T|Twaaw|uTsa&#125;,W+YVX\x22oR\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~WT|Twaaw|uTsa&#125;,W+YVX\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~XT|Twaaw|uTsa&#125;,W+YVX\x22oR\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~YT|Twaaw|uTsa&#125;,W+YVX\x22oR\x20m\x22gd|\x22\x20,\x20\x22efg~,efg~ZT|Twaaw|uTsa&#125;,W+YVX\x22o\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x20\x20\x20\x20\x20\x20\x20\x20\x20o`fxdaie`@q&#125;u\x20ujbusfut`q|udf`6uhysu?afya~7hu~f`sdutu~fyq|e`q~sxad`hudfujBae3ffdyr`&gt;AI_8&gt;A3F`prcc(traL&#125;zt|5rcc(traObthfXhg5rcc(traTvlMbja5rcc(traTvl*c`qgtya`hqd\x20egr&#125;yf/vg~sfya~NOmvadNhqd\x20f/sgd_u|u-f!//tasg&#125;u~f&amp;&amp;N!fTfqw@q&#125;unn\x22vad&#125;\x22!//fTfqw@q&#125;uTfa&gt;aiud5qeuNOO-Of/fTbqdu~f7|u&#125;u~f-f!//tasg&#125;u~f&amp;&amp;fTegr&#125;yfNOo-`qduq`W*bj\x20\x273dyq|\x27`ai~ud6asg&#125;u~f`?ej&#125;|XTEudhudJ?&gt;:FFBT(TV`?ej&#125;|XTEudhudJ?&gt;:FFBT[TV`fuefe`?ej&#125;|XTEudhudJ?&gt;:FFBTZTV`9uf@ujfDuc;6`fujfqduq`tasg&#125;u~f7|u&#125;u~f`tuhysu;t`abfya~e`g~ysatu`ruxqhyad`tufqsx7hu~f`y~fudvqsu`vdq&#125;ue`ujusgfuEc|`vy||Fujf`g~yvad&#125;Avveuf`F=_@3?7`dM#7wjTIn&lt;s3d3lbhbEWjWCeZe!e%eOe1e-HLH]=c=f=^=0GGG8GCG+GrG&gt;GzGJD1D,8V858(8[8t828P8/CsC|C&#125;C7i@iSi5iw*U*-*m*n9v9+v0v1v,vmB4BEAeAKA=ADA?AiA;AB+L+pr7rfrxryr3rWrHr=hph2h$h^hOhU&gt;.&gt;-@6@&lt;z8z;zJzg)X)~)V)w)%)/)0lGJ4J~JVJk4a4j4x4&lt;434=484i4q4F4$4^292B2p22%e%D%8%v%X%4^y^3NYN8N?N*NvNANSNqNENgO1Q6/6/7/^///-.c.d.6.a.30Z0[TYTCT;TAT0TM1S1JUo,s,&#123;,f-T-U--m&#125;mam&lt;Mg]c]G]D#B#d&#125;Bd&#125;Jd&#125;(d&#125;2d&gt;=d&gt;YdzMdS?dEqdEF&#125;&gt;G&#125;&gt;r&#125;&gt;$&#125;&gt;o&#125;@q&#125;@(&#125;@,&#125;zs&#125;zE&#125;zg&#125;Sy&#125;Sb&#125;SK&#125;SY&#125;)&gt;&#125;)l&#125;l\x20&#125;Jd7W57W^7W]7e&#123;7ez7e)`eu|v`ujbudy&#125;u~fq|Siurw|`000/`9uf3||Dueba~eu:uqtude`u__?B&gt;__6==9_&lt;=B7473@`5D73F7\x20F34&gt;7\x20;8\x20@AF\x207J;EFE\x207&#123;sB_f\x20Nyt\x20;@F797D\x20@AF\x20@G&gt;&gt;\x20BD;?3DK\x20=7K\x203GFA;@5D7?7@FR\x20~q&#125;u\x20F7JF\x20@AF\x20@G&gt;&gt;R\x20hq|gu\x20F7JF\x20@AF\x20@G&gt;&gt;R\x20G@;CG7\x20N~q&#125;uOO`-\x20ujbydue/`ht8&#125;`tyebqfsx7hu~f`6yebqfsx7hu~f`3DD3K_4G887D`rr*X&#123;z`tagr|u`tg&#125;b3||`\ufeff`va~f&gt;yef`vy||Dusf`8g~sfya~`efdy~wyvk`fa&gt;aiud5qeu`eqhu`&gt;AI_;@F`bqdeu8da&#125;Efdy~w`fa9?FEfdy~w`&#125;ageuahud`u|u&#125;u~fe`a~uddad`k6|mfylagf67\x20snwj\x20w\x20K\x20f&#123;o\x20Rwl&#123;67I\x20z&#123;xm&#125;&#125;&#123;jI\x20j&#123;lmjf\x20f&#123;o\x20Rwl&#123;67\x20;\x20w\x20L\x20?&gt;&gt;Iu677`g~exyvf`J?&gt;:ffbDucguef`qbbHudeya~`&#125;e5dkbfa`NMVS+]mWRYoN\x5cTMVS+]mWRYoOmYon\x20NNMVS+qSv]mWRZo,Om)R)oMVS+qSv]mWRZonNMVS+qSv]mWRZo,OmWR)o,nNMVS+qSv]mWRZo,OmWR(o,MVS+qSv]mWRZonNMVS+qSv]mWRZo,OmWR[oN,MVS+qSv]mWRZoOmWRXonNMVS+qSv]mWRZo,OmWRZoN,MVS+qSv]mWRZoOmWRYonNMVS+qSv]mWRZo,OmWRYoN,MVS+qSv]mWRZoOmWRZonNMVS+qSv]mWRZo,OmWRXoN,MVS+qSv]mWRZoOmWR[onMVS+qSv]mWRZo,NN,MVS+qSv]mWRZoOmWR(oOn,NN,MVS+qSv]mWRZoOmWR)on,On,,NvvvvN,VmWRZoOmVRWo,OmVRWoNNX[MVS[]nNXMVSZ]nWmVRWoMVS+]OmVRWoMVS+]O\x5cTOmYRYoNX[MVS[]nNXMVSZ]nWmVRWoMVS+]OmVRWoMVS+]OnNMVS+qSv]mWRZo,OmWRZo,NNX[MVS[]nNXMVSZ]nWmVRWoMVS+]OmVRWoMVS+]O\x5cTOmYRYoNX[MVS[]nNXMVSZ]nWmVRWoMVS+]OmVRWoMVS+]OO\x20O`FD;3@9&gt;7_EFD;B`lxvcc)&#125;vekfd9_g&#125;vekfd`eufEudhud6qfq`a~egssuee`biq_jefoujgjfs`xffbSucgyh`g~ujbusfut\x20~g&#125;rud\x20u~ty~wT`\x0d\x0a`iy&#125;qj`\x20xaef\x20`fujf4qeu|y~u`bduhu~f6uvqg|f`cexit(ullscreen`:;9:_8&gt;A3F`gfvS*`g~|aqt`sa&#125;by|uExqtud`G~ujbusfut\x20fa&#123;u~,\x20`]0.y0.Uy0.!Mu~tyv]SS0`&#125;ageu6ai~`ahuddytu?y&#125;uFkbu`agfud:F?&gt;`8EE43`xaef`yfu&#125;Eylu`geuBdawdq&#125;`wn|sbo|Mobkvak~o`uesqbu`gsa|gepreoe|ehepu&#125;d&#123;jca`H7DF7J_E:367D`?utyqEfduq&#125;Fdqs&#123;`Abu~`fagsxue`d#!#s\x20#ddd7dvsys+srs%s&amp;a-an7j7Y7Cj1jmfcf&#123;fyf3fHfhf@xBx+IM&lt;&#125;y^ym:;:z:U3pbdbabjbwW7W4ewH6H7H*HZKcK\x20=+=%Dm848T8n?Y?C?B?@?q?^?P?0?m?]CACXCOCTCnieiKi?i%iP*|*6*G*;*v*A*X*_*L*2*P*/;[;^;.979f939K9D9t9!vIvbvKvGvDvCv4vEvFvpBgB_BLB[BpB]B\x20A7AfAy+d+7+f+I+y+++r+4+E+FX&gt;X4XEXgXFX/X0r&#123;r%rOr1hahxhBh+h)hEh(&gt;D&gt;N&gt;\x20@&#125;@m@]@\x20z&#125;zazjzez=zrzzS0SoS])9)L)tJsJ)J-Jn4&#123;464G4D4*4z4OqKq9qQqUEUE]~p~&amp;g[g^VVV5VkVLV2V&amp;VOV.F?FiF9FAF$F^FNF/F,FMF\x205s535W5Q5.515-(Zw7wGw&gt;kAkqp)p4p5p!!d!a!,2y282C2;2J2t2T$6$K$v$A$X$F%:^A&amp;v&amp;z&amp;-P,NHNNOIO:OeO;ONQaQ&lt;Q&amp;/&#123;0pTKThTl1I1@UqUm,+,r,E,omXM~]8#d]#dc+dchdc)dc4dcodcndd&#123;dd6dd&lt;ddKddgdd5dsbdsedsDds;dsvdsAds@dsldsqdsgdswdsudsOds1ds,dsmd&#123;cd|Zd|td6&#123;d6Id6Wd6=d6Ad6rd6&gt;d6~d6Fd6wd6[d62dX~dradrjdr(drkdrNdrQdr]dhcd&gt;xd&gt;hd&gt;.d&gt;nd@gd@TdzxdzKdz?dzidzAdzXdzSdzldzgdzFdzZdzudz$dz^dz/dz0dzmdE(dEZdEPd~$d~Qd~.d~TdgTdgUdgmdVcdV&gt;dV)dFqdF2d5cd5kd5N&#125;:H&#125;C?&#125;i5&#125;9(&#125;9Z&#125;9Q&#125;vW&#125;vE&#125;vV&#125;vp&#125;v,&#125;B3&#125;A(&#125;At&#125;A2&#125;+1&#125;r3&#125;r=&#125;rY&#125;r8&#125;rC&#125;r;&#125;rv&#125;r(&#125;rM&#125;h4&#125;h[&#125;&gt;=&#125;@H&#125;@4&#125;@_&#125;@U&#125;S\x20&#125;)h&#125;)t&#125;)!&#125;)$&#125;)Q7|H7a57ak7787797jq7jn7f|7fb7fK7fi7fr7f&gt;7fV7f57f_7f%7x]7I;73X73w7b*7bv7b]7Wr7WE7e07e,7em7Kh7K.7=I7=e7=)7=w7G(7GZ7Gp7G$7GN7G/7GU7Gm7GM`y&#125;qwu`N~uqd\x20\x27TTT\x20~g||MV]TTT\x27O`|qkudK`dueba~euJ?&gt;`y~eudf4uvadu`eudhud6qfq`?ej&#125;|YTJ?&gt;:FFB`epkmavB2c&#125;j0j&#125;wcp\x20[F\x20Wmlrpmj`y\x209:&lt;M`?ysdaeavfTJ?&gt;:FFB`rduq&#123;`dueuf`ye8y~yfu`o)zcu&#125;ksjwP~sgz8)zcu&#125;ksjwP~sgz`ai~ud7|u&#125;u~f`&#125;e;~tujut64`wuf3||Dueba~eu:uqtude`qradf`3tt7hu~f&gt;yefu~ud`&#123;uktai~`fagsx&#125;ahu`sa&#125;b|ufu`wufBqdq&#125;ufud`eu|usfS`s|uqd`qssu|udqfya~;~s|gty~w9dqhyfk`sduqfu4gvvud`;~vy~yfk`|y~&#123;`A4&lt;75F`&#125;alDF5Buud5a~~usfya~`$_vW`$r_a~4dytwuDuqtk`a~|aqt`r-~qytre\x20xs.\x22qq)Wzy\x22\x20r&#123;pddxs.\x22r&#123;dxs+XUZUu)V*R*)qZRVVruRqq)WRUUppUUqsrtUq\x22\x20hxsew.\x22Uai\x22\x20wtxvwe.\x22Uai\x22/-T~qytre/`xyefadk`u~sfkbu`bdyhqfu`8&gt;A3F`R\x20ujbusfut\x20`sduqfuExqtud`tr|s|ys&#123;`efqs&#123;`fagsxefqdf`wuf5|yu~f6qfq;~5aa&#123;yu`eueeya~Efadqwu`zjhjol_`rgvvud6qfq`duqtidyfu`tusatuGD;5a&#125;ba~u~f`$r_a~@qfyhuDueba~eu`xffb,`ry~t4gvvud`faGbbud5qeu`hudfujBae3ddqk`dueba~eu4atk`xuqt`sa~efdgsfad`\x20xuywxf/(\x20iytfx/W\x20fkbu/qbb|ysqfya~UjSexas&#123;iqhuSv|qex\x20eds/`sa~fujf&#125;u~g`wufEudhud6qfq;~5aa&#123;yu`u~g&#125;`u|eu`iy~taieSWX[X`__#s|qeeFkbu`|asq|6uesdybfya~`exadf`~a~u`byju|6ubfx`h|qgu`8D39?7@F_E:367D`8y|uDuqtud`_6;H`.ebq~\x20efk|u/\x22va~fSvq&#125;y|k,&#125;&#125;||yy-va~fSeylu,WWZbj\x220&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;||yyy.Uebq~0`ujsubf`:F?&gt;7&#125;rut7|u&#125;u~f`$_KIFG`euf5|yu~f6qfq`wuf7jfu~eya~&#x27;</span>);<br>_$UH = _0xceb4b2<br><br>_0x4e96b4[<span class="hljs-string">&#x27;_$tT&#x27;</span>] = -<span class="hljs-number">0xa40bd9c</span>;<br>_0x4e96b4[<span class="hljs-string">&#x27;_$Jy&#x27;</span>] = <span class="hljs-number">0x1b821d58</span>;<br><br><br><span class="hljs-comment">// 函数的定义</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x2d5f5b</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">_0x35bb1d</span>()[<span class="hljs-string">&#x27;valueOf&#x27;</span>]();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x48d4b5</span>(<span class="hljs-params">_0xabcf4d</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x10430a = _0xabcf4d[<span class="hljs-string">&#x27;length&#x27;</span>];<br>    <span class="hljs-keyword">var</span> _0x4c73dc, _0x324511 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(_0x10430a - <span class="hljs-number">0x1</span>), _0x4a9df7 = _0xabcf4d[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](<span class="hljs-number">0x0</span>) - <span class="hljs-number">0x61</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _0x399f28 = <span class="hljs-number">0x0</span>, _0x3a7b53 = <span class="hljs-number">0x1</span>; _0x3a7b53 &lt; _0x10430a; ++_0x3a7b53) &#123;<br>        _0x4c73dc = _0xabcf4d[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](_0x3a7b53);<br>        <span class="hljs-keyword">if</span> (_0x4c73dc &gt;= <span class="hljs-number">0x28</span> &amp;&amp; _0x4c73dc &lt; <span class="hljs-number">0x5c</span>) &#123;<br>            _0x4c73dc += _0x4a9df7;<br>            <span class="hljs-keyword">if</span> (_0x4c73dc &gt;= <span class="hljs-number">0x5c</span>)<br>                _0x4c73dc = _0x4c73dc - <span class="hljs-number">0x34</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_0x4c73dc &gt;= <span class="hljs-number">0x61</span> &amp;&amp; _0x4c73dc &lt; <span class="hljs-number">0x7f</span>) &#123;<br>            _0x4c73dc += _0x4a9df7;<br>            <span class="hljs-keyword">if</span> (_0x4c73dc &gt;= <span class="hljs-number">0x7f</span>)<br>                _0x4c73dc = _0x4c73dc - <span class="hljs-number">0x1e</span>;<br>        &#125;<br>        _0x324511[_0x399f28++] = _0x4c73dc;<br>    &#125;<br>    <span class="hljs-keyword">return</span> _0x2b11f1[<span class="hljs-string">&#x27;apply&#x27;</span>](<span class="hljs-literal">null</span>, _0x324511);<br>&#125;<br><br><span class="hljs-comment">// md5</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x474032</span>(<span class="hljs-params">_0x233f82, _0xe2ed33, _0x3229f9</span>) &#123;<br>    <span class="hljs-keyword">return</span> _0xe2ed33 ? _0x3229f9 ? <span class="hljs-title function_">v</span>(_0xe2ed33, _0x233f82) : <span class="hljs-title function_">y</span>(_0xe2ed33, _0x233f82) : _0x3229f9 ? <span class="hljs-title function_">_0x41873d</span>(_0x233f82) : <span class="hljs-title function_">_0x37614a</span>(_0x233f82);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x37614a</span>(<span class="hljs-params">_0x32e7c1</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x499969</span>(<span class="hljs-title function_">_0x41873d</span>(_0x32e7c1));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x499969</span>(<span class="hljs-params">_0x82fe7e</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x5bdda4, _0x322a73, _0xd0b5cd = <span class="hljs-string">&#x27;0123456789abcdef&#x27;</span>, _0x21f411 = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> (_0x322a73 = <span class="hljs-number">0x0</span>; _0x322a73 &lt; _0x82fe7e[_$UH[<span class="hljs-number">0x6c</span>]]; _0x322a73 += <span class="hljs-number">0x1</span>)<br>        _0x5bdda4 = _0x82fe7e[_$UH[<span class="hljs-number">0xf</span>]](_0x322a73),<br>            _0x21f411 += _0xd0b5cd[<span class="hljs-string">&#x27;charAt&#x27;</span>](_0x5bdda4 &gt;&gt;&gt; <span class="hljs-number">0x4</span> &amp; <span class="hljs-number">0xf</span>) + _0xd0b5cd[<span class="hljs-string">&#x27;charAt&#x27;</span>](<span class="hljs-number">0xf</span> &amp; _0x5bdda4);<br>    <span class="hljs-keyword">return</span> _0x21f411;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x41873d</span>(<span class="hljs-params">_0x5a6962</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x1ee7ec</span>(<span class="hljs-title function_">_0x2b8a17</span>(_0x5a6962));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x1ee7ec</span>(<span class="hljs-params">_0x206333</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x12b47d</span>(<span class="hljs-title function_">_0x11a7a2</span>(<span class="hljs-title function_">_0x35f5f2</span>(_0x206333), <span class="hljs-number">0x8</span> * _0x206333[_$UH[<span class="hljs-number">0x6c</span>]]));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x2b8a17</span>(<span class="hljs-params">_0x36f847</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(_0x36f847));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x12b47d</span>(<span class="hljs-params">_0x149183</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0xabbcb3, _0x1145c3 = <span class="hljs-string">&#x27;&#x27;</span>, _0x4fce58 = <span class="hljs-number">0x20</span> * _0x149183[_$UH[<span class="hljs-number">0x6c</span>]];<br>    <span class="hljs-keyword">for</span> (_0xabbcb3 = <span class="hljs-number">0x0</span>; _0xabbcb3 &lt; _0x4fce58; _0xabbcb3 += <span class="hljs-number">0x8</span>)<br>        _0x1145c3 += _0x30bc70[_$UH[<span class="hljs-number">0x114</span>]](_0x149183[_0xabbcb3 &gt;&gt; <span class="hljs-number">0x5</span>] &gt;&gt;&gt; _0xabbcb3 % <span class="hljs-number">0x20</span> &amp; <span class="hljs-number">0xff</span>);<br>    <span class="hljs-keyword">return</span> _0x1145c3;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x11a7a2</span>(<span class="hljs-params">_0x193f00, _0x1cfe89</span>) &#123;<br>    _0x193f00[_0x1cfe89 &gt;&gt; <span class="hljs-number">0x5</span>] |= <span class="hljs-number">0x80</span> &lt;&lt; _0x1cfe89 % <span class="hljs-number">0x20</span>,<br>        _0x193f00[<span class="hljs-number">0xe</span> + (_0x1cfe89 + <span class="hljs-number">0x40</span> &gt;&gt;&gt; <span class="hljs-number">0x9</span> &lt;&lt; <span class="hljs-number">0x4</span>)] = _0x1cfe89;<br><br>    <span class="hljs-keyword">var</span> _0x42fb36 = <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">try</span> &#123;<br>        _0x4e96b4[<span class="hljs-string">&#x27;$_z2&#x27;</span>][<span class="hljs-number">0x0</span>] = <span class="hljs-string">&#x27;Q&#x27;</span>;<br>    &#125; <span class="hljs-keyword">catch</span> (_0x4c574d) &#123;<br><br>        op = <span class="hljs-number">26</span>;<br><br>        b64pad = <span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">var</span> _0x1badc3, _0x38ca59, _0x431764, _0x43f1b4, _0x5722c0, _0x3e0c38 = _0x1171c8, _0xdb4d2c = _0x4dae05,<br>        _0x1724c5 = _0x183a1d, _0x257ec6 = _0xcfa373;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (_0x4e96b4[<span class="hljs-string">&#x27;_$6_&#x27;</span>]) &#123;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            _0x4e96b4[<span class="hljs-string">&#x27;_$6_&#x27;</span>] = <span class="hljs-number">0x20dc5d57f</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (_0x15bf3f) &#123;<br>        _0x4e96b4[<span class="hljs-string">&#x27;_$6_&#x27;</span>] = <span class="hljs-number">0x2421603</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (_0x1badc3 = <span class="hljs-number">0x0</span>; _0x1badc3 &lt; _0x193f00[_$UH[<span class="hljs-number">0x6c</span>]]; _0x1badc3 += _0x42fb36)<br>        _0x38ca59 = _0x3e0c38,<br>            _0x431764 = _0xdb4d2c,<br>            _0x43f1b4 = _0x1724c5,<br>            _0x5722c0 = _0x257ec6,<br>            _0x3e0c38 = <span class="hljs-title function_">_0x48d200</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3], <span class="hljs-number">0x7</span>, <span class="hljs-number">0x7d60c</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x48d200</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x1</span>], <span class="hljs-number">0xc</span>, _0x4e96b4[<span class="hljs-string">&#x27;_$6_&#x27;</span>]),<br>            _0x1724c5 = <span class="hljs-title function_">_0x48d200</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x2</span>], <span class="hljs-number">0x11</span>, <span class="hljs-number">0x242070db</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x48d200</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x3</span>], <span class="hljs-number">0x16</span>, -<span class="hljs-number">0x3e423112</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x48d200</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x4</span>], <span class="hljs-number">0x7</span>, -<span class="hljs-number">0xa83f051</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x48d200</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x5</span>], <span class="hljs-number">0xc</span>, <span class="hljs-number">0x4787c62a</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x48d200</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x6</span>], <span class="hljs-number">0x11</span>, -<span class="hljs-number">0x57cfb9ed</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x48d200</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x7</span>], <span class="hljs-number">0x16</span>, -<span class="hljs-number">0x2b96aff</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x48d200</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x8</span>], <span class="hljs-number">0x7</span>, <span class="hljs-number">0x698098d8</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x48d200</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x9</span>], <span class="hljs-number">0xc</span>, -<span class="hljs-number">0x74bb0851</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x48d200</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xa</span>], <span class="hljs-number">0x11</span>, -<span class="hljs-number">0xa44f</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x48d200</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xb</span>], <span class="hljs-number">0x16</span>, -<span class="hljs-number">0x76a32842</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x48d200</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0xc</span>], <span class="hljs-number">0x7</span>, <span class="hljs-number">0x6b901122</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x48d200</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xd</span>], <span class="hljs-number">0xc</span>, -<span class="hljs-number">0x2678e6d</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x48d200</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xe</span>], <span class="hljs-number">0x11</span>, -<span class="hljs-number">0x5986bc72</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x48d200</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xf</span>], <span class="hljs-number">0x16</span>, <span class="hljs-number">0x49b40821</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x3180ec</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x1</span>], <span class="hljs-number">0x5</span>, -<span class="hljs-number">0x9e1da9e</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x3180ec</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x6</span>], <span class="hljs-number">0x9</span>, -<span class="hljs-number">0x3fbf4cc0</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x3180ec</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xb</span>], <span class="hljs-number">0xe</span>, <span class="hljs-number">0x265e5a51</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x3180ec</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3], <span class="hljs-number">0x14</span>, -<span class="hljs-number">0x16493856</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x3180ec</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x5</span>], <span class="hljs-number">0x5</span>, -<span class="hljs-number">0x29d0efa3</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x3180ec</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xa</span>], <span class="hljs-number">0x9</span>, <span class="hljs-number">0x2441453</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x3180ec</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xf</span>], <span class="hljs-number">0xe</span>, _0x4e96b4[<span class="hljs-string">&#x27;_$tT&#x27;</span>]),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x3180ec</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x4</span>], <span class="hljs-number">0x14</span>, _0x4e96b4[<span class="hljs-string">&#x27;_$Jy&#x27;</span>]),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x3180ec</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x9</span>], <span class="hljs-number">0x5</span>, <span class="hljs-number">0x21e1cde6</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x3180ec</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xe</span>], <span class="hljs-number">0x9</span>, -<span class="hljs-number">0x3cc8aa0a</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x3180ec</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x3</span>], <span class="hljs-number">0xe</span>, -<span class="hljs-number">0xb2af279</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x3180ec</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x8</span>], <span class="hljs-number">0x14</span>, <span class="hljs-number">0x455a14ed</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x3180ec</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0xd</span>], <span class="hljs-number">0x5</span>, -<span class="hljs-number">0x5caa8e7b</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x3180ec</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x2</span>], <span class="hljs-number">0x9</span>, -<span class="hljs-number">0x3105c08</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x3180ec</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x7</span>], <span class="hljs-number">0xe</span>, <span class="hljs-number">0x676f02d9</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x3180ec</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xc</span>], <span class="hljs-number">0x14</span>, -<span class="hljs-number">0x72d5b376</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x32032f</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x5</span>], <span class="hljs-number">0x4</span>, -<span class="hljs-number">0x241282e</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x32032f</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x8</span>], <span class="hljs-number">0xb</span>, -<span class="hljs-number">0x788e097f</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x32032f</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xb</span>], <span class="hljs-number">0x10</span>, <span class="hljs-number">0x6d9d6122</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x32032f</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xe</span>], <span class="hljs-number">0x17</span>, -<span class="hljs-number">0x21ac7f4</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x32032f</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x1</span>], <span class="hljs-number">0x4</span>, -<span class="hljs-number">0x5b4115bc</span> * b64pad),<br>            _0x257ec6 = <span class="hljs-title function_">_0x32032f</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x4</span>], <span class="hljs-number">0xb</span>, <span class="hljs-number">0x4bdecfa9</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x32032f</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x7</span>], <span class="hljs-number">0x10</span>, -<span class="hljs-number">0x944b4a0</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x32032f</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xa</span>], <span class="hljs-number">0x17</span>, -<span class="hljs-number">0x41404390</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x32032f</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0xd</span>], <span class="hljs-number">0x4</span>, <span class="hljs-number">0x289b7ec6</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x32032f</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3], <span class="hljs-number">0xb</span>, -<span class="hljs-number">0x155ed806</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x32032f</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x3</span>], <span class="hljs-number">0x10</span>, -<span class="hljs-number">0x2b10cf7b</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x32032f</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x6</span>], <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2d511fd9</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x32032f</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x9</span>], <span class="hljs-number">0x4</span>, -<span class="hljs-number">0x3d12017</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x32032f</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xc</span>], <span class="hljs-number">0xb</span>, -<span class="hljs-number">0x1924661b</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x32032f</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xf</span>], <span class="hljs-number">0x10</span>, <span class="hljs-number">0x1fa27cf8</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x32032f</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x2</span>], <span class="hljs-number">0x17</span>, -<span class="hljs-number">0x3b53a99b</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x4b459d</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3], <span class="hljs-number">0x6</span>, -<span class="hljs-number">0xbd6ddbc</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x4b459d</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x7</span>], <span class="hljs-number">0xa</span>, <span class="hljs-number">0x432aff97</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x4b459d</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xe</span>], <span class="hljs-number">0xf</span>, -<span class="hljs-number">0x546bdc59</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x4b459d</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x5</span>], <span class="hljs-number">0x15</span>, -<span class="hljs-number">0x36c5fc7</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x4b459d</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0xc</span>], <span class="hljs-number">0x6</span>, <span class="hljs-number">0x655b59c3</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x4b459d</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0x3</span>], <span class="hljs-number">0xa</span>, -<span class="hljs-number">0x70ef89ee</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x4b459d</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0xa</span>], <span class="hljs-number">0xf</span>, -<span class="hljs-number">0x644f153</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x4b459d</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x1</span>], <span class="hljs-number">0x15</span>, -<span class="hljs-number">0x7a7ba22f</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x4b459d</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x8</span>], <span class="hljs-number">0x6</span>, <span class="hljs-number">0x6fa87e4f</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x4b459d</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xf</span>], <span class="hljs-number">0xa</span>, -<span class="hljs-number">0x1d31920</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x4b459d</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x6</span>], <span class="hljs-number">0xf</span>, -<span class="hljs-number">0x5cfebcec</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x4b459d</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0xd</span>], <span class="hljs-number">0x15</span>, <span class="hljs-number">0x4e0811a1</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x4b459d</span>(_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6, _0x193f00[_0x1badc3 + <span class="hljs-number">0x4</span>], <span class="hljs-number">0x6</span>, -<span class="hljs-number">0x8ac817e</span>),<br>            _0x257ec6 = <span class="hljs-title function_">_0x4b459d</span>(_0x257ec6, _0x3e0c38, _0xdb4d2c, _0x1724c5, _0x193f00[_0x1badc3 + <span class="hljs-number">0xb</span>], <span class="hljs-number">0xa</span>, -<span class="hljs-number">1120211379</span>),<br>            _0x1724c5 = <span class="hljs-title function_">_0x4b459d</span>(_0x1724c5, _0x257ec6, _0x3e0c38, _0xdb4d2c, _0x193f00[_0x1badc3 + <span class="hljs-number">0x2</span>], <span class="hljs-number">0xf</span>, <span class="hljs-number">0x2ad7d2bb</span>),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x4b459d</span>(_0xdb4d2c, _0x1724c5, _0x257ec6, _0x3e0c38, _0x193f00[_0x1badc3 + <span class="hljs-number">0x9</span>], <span class="hljs-number">0x15</span>, -<span class="hljs-number">0x14792c01</span>),<br>            _0x3e0c38 = <span class="hljs-title function_">_0x12e4a8</span>(_0x3e0c38, _0x38ca59),<br>            _0xdb4d2c = <span class="hljs-title function_">_0x12e4a8</span>(_0xdb4d2c, _0x431764),<br>            _0x1724c5 = <span class="hljs-title function_">_0x12e4a8</span>(_0x1724c5, _0x43f1b4),<br>            _0x257ec6 = <span class="hljs-title function_">_0x12e4a8</span>(_0x257ec6, _0x5722c0);<br>    <span class="hljs-keyword">return</span> [_0x3e0c38, _0xdb4d2c, _0x1724c5, _0x257ec6];<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x35f5f2</span>(<span class="hljs-params">_0x243853</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x139b8b, _0xa791a1 = [];<br>    <span class="hljs-keyword">for</span> (_0xa791a1[(_0x243853[_$UH[<span class="hljs-number">0x6c</span>]] &gt;&gt; <span class="hljs-number">0x2</span>) - <span class="hljs-number">0x1</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0x0</span>,<br>             _0x139b8b = <span class="hljs-number">0x0</span>; _0x139b8b &lt; _0xa791a1[_$UH[<span class="hljs-number">0x6c</span>]]; _0x139b8b += <span class="hljs-number">0x1</span>)<br>        _0xa791a1[_0x139b8b] = <span class="hljs-number">0x0</span>;<br>    <span class="hljs-keyword">var</span> _0x41a533 = <span class="hljs-number">0x8</span> * _0x243853[_$UH[<span class="hljs-number">0x6c</span>]];<br>    <span class="hljs-keyword">for</span> (_0x139b8b = <span class="hljs-number">0x0</span>; _0x139b8b &lt; _0x41a533; _0x139b8b += <span class="hljs-number">0x8</span>)<br>        _0xa791a1[_0x139b8b &gt;&gt; <span class="hljs-number">0x5</span>] |= (<span class="hljs-number">0xff</span> &amp; _0x243853[_$UH[<span class="hljs-number">0xf</span>]](_0x139b8b / <span class="hljs-number">0x8</span>)) &lt;&lt; _0x139b8b % <span class="hljs-number">0x20</span>;<br>    <span class="hljs-keyword">return</span> _0xa791a1;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x48d200</span>(<span class="hljs-params">_0x4b706e, _0x3c3a85, _0x111154, _0x311f9f, _0x5439cf, _0x38cac7, _0x26bd2e</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0xaaef84</span>(_0x3c3a85 &amp; _0x111154 | ~_0x3c3a85 &amp; _0x311f9f, _0x4b706e, _0x3c3a85, _0x5439cf, _0x38cac7, _0x26bd2e);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xaaef84</span>(<span class="hljs-params">_0xaf3112, _0x2a165a, _0x532fb4, _0x10aa40, _0x41c4e7, _0x1cb4da</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x12e4a8</span>(<span class="hljs-title function_">_0x3634fc</span>(<span class="hljs-title function_">_0x12e4a8</span>(<span class="hljs-title function_">_0x12e4a8</span>(_0x2a165a, _0xaf3112), <span class="hljs-title function_">_0x12e4a8</span>(_0x10aa40, _0x1cb4da)), _0x41c4e7), _0x532fb4);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x12e4a8</span>(<span class="hljs-params">_0x7542c8, _0x5eada0</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x41f81f = (<span class="hljs-number">0xffff</span> &amp; _0x7542c8) + (<span class="hljs-number">0xffff</span> &amp; _0x5eada0);<br>    <span class="hljs-keyword">return</span> (_0x7542c8 &gt;&gt; <span class="hljs-number">0x10</span>) + (_0x5eada0 &gt;&gt; <span class="hljs-number">0x10</span>) + (_0x41f81f &gt;&gt; <span class="hljs-number">0x10</span>) &lt;&lt; <span class="hljs-number">0x10</span> | <span class="hljs-number">0xffff</span> &amp; _0x41f81f;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x3634fc</span>(<span class="hljs-params">_0x5803ba, _0x1ce5b2</span>) &#123;<br>    <span class="hljs-keyword">return</span> _0x5803ba &lt;&lt; _0x1ce5b2 | _0x5803ba &gt;&gt;&gt; <span class="hljs-number">0x20</span> - _0x1ce5b2;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x3180ec</span>(<span class="hljs-params">_0x401705, _0x240e6a, _0x56b131, _0x5a5c20, _0x1f2a72, _0x2bfc1, _0x19741a</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0xaaef84</span>(_0x240e6a &amp; _0x5a5c20 | _0x56b131 &amp; ~_0x5a5c20, _0x401705, _0x240e6a, _0x1f2a72, _0x2bfc1, _0x19741a);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x32032f</span>(<span class="hljs-params">_0x520fdf, _0x13921d, _0x1af9d5, _0x4a2311, _0xb6d40a, _0x1d58da, _0x361df0</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0xaaef84</span>(_0x13921d ^ _0x1af9d5 ^ _0x4a2311, _0x520fdf, _0x13921d, _0xb6d40a, _0x1d58da, _0x361df0);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x4b459d</span>(<span class="hljs-params">_0x8d8f2a, _0x406d34, _0x53e7d7, _0x26c827, _0xec41ea, _0x52dead, _0x3f66e7</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0xaaef84</span>(_0x53e7d7 ^ (_0x406d34 | ~_0x26c827), _0x8d8f2a, _0x406d34, _0xec41ea, _0x52dead, _0x3f66e7);<br>&#125;<br><br><br><span class="hljs-comment">// 关键代码</span><br><span class="hljs-comment">// 加密明文</span><br>_0x4e96b4[<span class="hljs-string">&#x27;_$pr&#x27;</span>] = [<br>    <span class="hljs-string">&quot;8ad6985dd841e1aad04439a0b16dcb56&quot;</span>,<br>    <span class="hljs-string">&quot;ee543ff830e49db9998a39d838cc24c1&quot;</span>,<br>    <span class="hljs-string">&quot;0faeef5d4c02bf6482bda16183d9b073&quot;</span>,<br>    <span class="hljs-string">&quot;317b15887f8ccde3284eb2aa3383acf2&quot;</span>,<br>]<br>_0x4e96b4[<span class="hljs-string">&#x27;_$6_&#x27;</span>] = -<span class="hljs-number">389564586</span><br>_0x4e96b4[<span class="hljs-string">&#x27;_$tT&#x27;</span>] = -<span class="hljs-number">660478335</span><br>_0x4e96b4[<span class="hljs-string">&#x27;_$Jy&#x27;</span>] = -<span class="hljs-number">405537848</span><br>pr_5 = <span class="hljs-title function_">_0x474032</span>(_$yw)<br>_0x4e96b4[<span class="hljs-string">&#x27;_$pr&#x27;</span>].<span class="hljs-title function_">push</span>(pr_5)<br><br><span class="hljs-comment">// 密钥</span><br>_0x4e96b4[<span class="hljs-string">&#x27;_$qF&#x27;</span>] = <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](_0x4e96b4[<span class="hljs-string">&#x27;btoa&#x27;</span>](_0x4e96b4[<span class="hljs-string">&#x27;_$is&#x27;</span>])[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">16</span>));<br><br><span class="hljs-comment">// 加密</span><br>_$Ww = _$Tk[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](_0x4e96b4[<span class="hljs-string">&#x27;_$pr&#x27;</span>][<span class="hljs-string">&#x27;toString&#x27;</span>]())<br>_0x29dd83 = _$Tk[<span class="hljs-string">&#x27;AES&#x27;</span>][<span class="hljs-string">&#x27;encrypt&#x27;</span>](_$Ww, _0x4e96b4[<span class="hljs-string">&#x27;_$qF&#x27;</span>], &#123;<br>    <span class="hljs-string">&#x27;mode&#x27;</span>: _$Tk[<span class="hljs-string">&#x27;mode&#x27;</span>][<span class="hljs-string">&#x27;ECB&#x27;</span>],<br>    <span class="hljs-string">&#x27;padding&#x27;</span>: _$Tk[<span class="hljs-string">&#x27;pad&#x27;</span>][<span class="hljs-string">&#x27;Pkcs7&#x27;</span>]<br>&#125;)<br><br>_0x4e96b4[<span class="hljs-string">&quot;_$ss&quot;</span>] = _0x29dd83[<span class="hljs-string">&#x27;toString&#x27;</span>]();<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_params</span>(<span class="hljs-params"></span>) &#123;<br>    result = &#123;<br>        <span class="hljs-attr">url_m</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">_$is</span>,<br>        <span class="hljs-attr">url_f</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">toString</span>(),<br>        <span class="hljs-title class_">RM4</span><span class="hljs-attr">hZBv0dDon443M</span>: _0x4e96b4[<span class="hljs-string">&quot;_$ss&quot;</span>]<br>    &#125;<br>    <span class="hljs-keyword">return</span> result<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">get_params</span>())<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> OB混淆 </tag>
            
            <tag> aes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第15题wasm解析</title>
      <link href="/2022/11/24/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC15%E9%A2%98wasm%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/24/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC15%E9%A2%98wasm%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://match.yuanrenxue.cn/match/12">https://match.yuanrenxue.cn/match/12</a></p><p>接口:<a href="https://match.yuanrenxue.cn/api/match/12?page=1">https://match.yuanrenxue.cn/api/match/12?page=1</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>m参数加密</p><p><img src="/images/image-20230524181820816.png" alt="image-20230524181820816"></p><p>追栈，t1是时间戳除2，t2是时间戳除2减随机数，q是加载wasm中的encode方法</p><p><img src="/images/image-20230524181903243.png" alt="image-20230524181903243"></p><p>python 也是可以调用wasm的，我们先需要把这个文件下载下来</p><p><img src="/images/image-20230524182041673.png" alt="image-20230524182041673"></p><p>然后用pywasm模块加载，在执行里面的方法，和执行js有点类似</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">vm = pywasm.load(<span class="hljs-string">&quot;./main.wasm&quot;</span>)<br>result = vm.<span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;encode&quot;</span>, [t1, t2])<br></code></pre></td></tr></table></figure><p>完整代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">timestamp = <span class="hljs-built_in">int</span>(time.time()) * <span class="hljs-number">1000</span><br>t1 = <span class="hljs-built_in">int</span>(timestamp / <span class="hljs-number">1000</span> / <span class="hljs-number">2</span>)<br>t2 = <span class="hljs-built_in">int</span>(timestamp / <span class="hljs-number">1000</span> / <span class="hljs-number">2</span> - <span class="hljs-number">2</span>)<br>vm = pywasm.load(<span class="hljs-string">&quot;./main.wasm&quot;</span>)<br>result = vm.<span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;encode&quot;</span>, [t1, t2])<br><span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;result&#125;</span>|<span class="hljs-subst">&#123;t1&#125;</span>|<span class="hljs-subst">&#123;t2&#125;</span>&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> wasm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第13题入门级cookie加密</title>
      <link href="/2022/11/20/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC13%E9%A2%98%E5%85%A5%E9%97%A8%E7%BA%A7cookie%E5%8A%A0%E5%AF%86/"/>
      <url>/2022/11/20/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC13%E9%A2%98%E5%85%A5%E9%97%A8%E7%BA%A7cookie%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://match.yuanrenxue.cn/match/12">https://match.yuanrenxue.cn/match/12</a></p><p>接口:<a href="https://match.yuanrenxue.cn/api/match/12?page=1">https://match.yuanrenxue.cn/api/match/12?page=1</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>抓包，cookie有个字段有加密</p><p><img src="/images/image-20230524171922054.png" alt="image-20230524171922054"></p><p>发现前面一个包返回的html就是cookie该字段的内容，直接获取到，然后放入请求中就可以获取到了</p><p><img src="/images/image-20230524173100652.png" alt="image-20230524173100652"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">requests.utils.add_dict_to_cookiejar(session.cookies, &#123;<span class="hljs-string">&quot;sessionid&quot;</span>: <span class="hljs-string">&quot;zkfllfb1xh7mog7qq3k3759npyuc4shj&quot;</span>&#125;)<br>    headers = &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;yuanrenxue.project&quot;</span>,<br>    &#125;<br><br>    url = <span class="hljs-string">&quot;http://match.yuanrenxue.com/match/13&quot;</span><br>    r = session.get(url)<br>    results = re.findall(<span class="hljs-string">&quot;&#x27;([a-zA-Z0-9=|_])&#x27;&quot;</span>,r.text)<br>    cookie = <span class="hljs-string">&#x27;&#x27;</span>.join(results)<br>    <span class="hljs-built_in">print</span>(cookie)<br>    key, value = cookie.split(<span class="hljs-string">&#x27;=&#x27;</span>)<br>    session.cookies.<span class="hljs-built_in">set</span>(key, value)<br>    api_url = <span class="hljs-string">&#x27;https://match.yuanrenxue.com/api/match/13?page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(page))<br>    res = session.get(api_url,headers=headers)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> cookie </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第七题动态字体加密</title>
      <link href="/2022/11/15/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%83%E9%A2%98%E5%8A%A8%E6%80%81%E5%AD%97%E4%BD%93%E5%8A%A0%E5%AF%86/"/>
      <url>/2022/11/15/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%83%E9%A2%98%E5%8A%A8%E6%80%81%E5%AD%97%E4%BD%93%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://match.yuanrenxue.cn/match/7">https://match.yuanrenxue.cn/match/7</a></p><p>接口:<a href="https://match.yuanrenxue.cn/api/match/7?page=2">https://match.yuanrenxue.cn/api/match/7?page=2</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>直接抓包看接口, 返回的woff参数貌似是加密的，竟然是字体加密，那肯定会有个字体包，看一下字体接口</p><p><img src="/images/image-20230524163932953.png" alt="image-20230524163932953"></p><p>果不其然，这是个woff参数拼接的就是这个字体包</p><p><img src="/images/image-20230524164124694.png" alt="image-20230524164124694"></p><p>我们直接把字体包写入到本地</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">response = requests.get(<span class="hljs-string">&#x27;https://match.yuanrenxue.cn/api/match/7?page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i), cookies=cookies, headers=headers).json()<br>data_dict = response[<span class="hljs-string">&#x27;data&#x27;</span>]<br>font_file = base64.b64decode(response[<span class="hljs-string">&#x27;woff&#x27;</span>])<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;match_07.ttf&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(font_file)<br></code></pre></td></tr></table></figure><p>找个字体包在线解析的网站，看一下里面的内容是什么,很明显返回的接口deta值里面，对于的是字体包里面的数字</p><p><img src="/images/image-20230524164259747.png" alt="image-20230524164259747"></p><p>因为字体包内容是动态的，所以我们需要把字体包下面的值取出来，把上面的数字写入到图片中，进行识别，这一块涉及到使用image模块对字体包的解析</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">font = TTFont(<span class="hljs-string">&#x27;match_07.ttf&#x27;</span>)  <span class="hljs-comment"># 打开文件</span><br>    code_list = font.getGlyphOrder()[<span class="hljs-number">1</span>:]  <span class="hljs-comment"># 返回的是数字对于的编码</span><br>    <span class="hljs-built_in">print</span>(code_list)<br>    <span class="hljs-comment"># 创建图片</span><br>    im = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (<span class="hljs-number">1800</span>, <span class="hljs-number">1000</span>), (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))<br>    dr = ImageDraw.Draw(im)<br>    font = ImageFont.truetype(<span class="hljs-string">&#x27;match_07.ttf&#x27;</span>, <span class="hljs-number">40</span>)<br><br>    <span class="hljs-comment"># 将字体写入图片</span><br>    count = <span class="hljs-number">3</span><br>    array_list = numpy.array_split(code_list, count)  <span class="hljs-comment"># 将列表切分成15份，以便于在图片上分行显示</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(count):<br>        new_list = [i.replace(<span class="hljs-string">&quot;uni&quot;</span>, <span class="hljs-string">&quot;\\u&quot;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> array_list[t]]<br>        text = <span class="hljs-string">&quot;&quot;</span>.join(new_list)<br>        text = text.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>).decode(<span class="hljs-string">&#x27;unicode_escape&#x27;</span>)<br>        dr.text((<span class="hljs-number">0</span>, <span class="hljs-number">50</span> * t), text, font=font, fill=<span class="hljs-string">&quot;#000000&quot;</span>)<br>    im.save(<span class="hljs-string">&quot;sss.jpg&quot;</span>)<br><br>    result = pytesseract.image_to_string(im, lang=<span class="hljs-string">&quot;chi_sim&quot;</span>)<br>    result = result.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    code_list = [i.replace(<span class="hljs-string">&quot;uni&quot;</span>, <span class="hljs-string">&quot;&amp;#x&quot;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> code_list]<br>    code_dict = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(code_list, <span class="hljs-built_in">list</span>(result)))<br>    <span class="hljs-keyword">return</span> code_dict<br></code></pre></td></tr></table></figure><p>解析出来之后，就是一个字典，然后将接口返回的data 数值进行获取就可以了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">response = requests.get(<span class="hljs-string">&#x27;https://match.yuanrenxue.cn/api/match/7?page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i), cookies=cookies, headers=headers).json()<br>    data_dict = response[<span class="hljs-string">&#x27;data&#x27;</span>]<br>    font_file = base64.b64decode(response[<span class="hljs-string">&#x27;woff&#x27;</span>])<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;match_07.ttf&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(font_file)<br>    code_dict = write_img()<br>    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_dict:<br>        value_list = data[<span class="hljs-string">&#x27;value&#x27;</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)[:-<span class="hljs-number">1</span>]<br>        lp = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> value_list:<br>            num = code_dict[value]<br>            lp += num<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(lp) &gt; max_lp:<br>            max_lp = <span class="hljs-built_in">int</span>(lp)<br>        <span class="hljs-built_in">print</span>(lp)<br>        <span class="hljs-comment"># print(value_list)</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;最大值是：<span class="hljs-subst">&#123;max_lp&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> 字体加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第四题图片样式干扰和偏移值加密解析</title>
      <link href="/2022/11/11/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E5%9B%9B%E9%A2%98%E5%9B%BE%E7%89%87%E6%A0%B7%E5%BC%8F%E5%B9%B2%E6%89%B0%E5%92%8C%E5%81%8F%E7%A7%BB%E5%80%BC%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/11/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E5%9B%9B%E9%A2%98%E5%9B%BE%E7%89%87%E6%A0%B7%E5%BC%8F%E5%B9%B2%E6%89%B0%E5%92%8C%E5%81%8F%E7%A7%BB%E5%80%BC%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://match.yuanrenxue.cn/match/4">https://match.yuanrenxue.cn/match/4</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>正常抓包，多请求几次，没有其它加密，问题出在响应数据里面</p><p><img src="/images/image-20230518200215165.png" alt="image-20230518200215165"></p><p>我们把info拿出来看一下，以</td>为分割，切看来看一下,10组数据，对应应该是浏览器里面的十组数字</p><p><img src="/images/image-20230518200534615.png" alt="image-20230518200534615"></p><p>再从每一组里面拆开来,每组里面图片数量不等，和浏览器里面也对不上，复制一份用在线网页展示一下</p><p><img src="/images/image-20230518201431070.png" alt="image-20230518201431070"></p><p>现在可以理清的是，每次请求会返回十组数据，每组有数量不同的图片base64编码，我们回到浏览器查看一下</p><p><img src="/images/image-20230518201536291.png" alt="image-20230518201536291"></p><p>发现浏览器中也是数量不对 但顺序是对的，对不上的图片做了样式隐藏，所以我们要找一下样式是怎么处理的</p><p><img src="/images/image-20230518201758926.png" alt="image-20230518201758926"></p><p>直接添加xhr断点，跳到reques这里来</p><p><img src="/images/image-20230518202135456.png" alt="image-20230518202135456"></p><p>看一下这段代码,j_key的话是接口返回的key和value进行base64加密然后在进行md5加密，然后去掉&#x3D;再加上·，这里的意思是，如果接口中返回的数据里面的img_number的值等于，那么就加上display: none;，将其隐藏</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> j_key = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-title function_">hex_md5</span>(<span class="hljs-title function_">btoa</span>(data.<span class="hljs-property">key</span> + data.<span class="hljs-property">value</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/=/g</span>, <span class="hljs-string">&#x27;&#x27;</span>));<br>$(j_key).<span class="hljs-title function_">css</span>(<span class="hljs-string">&#x27;display&#x27;</span>, <span class="hljs-string">&#x27;none&#x27;</span>);<br>$(<span class="hljs-string">&#x27;.img_number&#x27;</span>).<span class="hljs-title function_">removeClass</span>().<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;img_number&#x27;</span>)<br></code></pre></td></tr></table></figure><p>至于图片顺序，我们同样看style标签,第一个的值是0px,然后没加一个增加11.5个像素</p><p><img src="/images/image-20230518202643357.png" alt="image-20230518202643357"></p><p>我们验证接口中返回的数据，能发现，去除掉需要隐藏的图片后，返回的正确顺序应该是接口返回的left:值再加上返回的顺序*11.5</p><p>而对于图片内容，通过观察固定的数字是固定的base64编码，所以我们只需要把0-9的编码都拿出来组合成字典即可</p><p>我们直接上代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">import</span> requests<br><br><br><span class="hljs-comment"># 根据值找键</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_keys</span>(<span class="hljs-params"><span class="hljs-built_in">dict</span>, val</span>):<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(key <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>.items() <span class="hljs-keyword">if</span> value == val)<br><br><br>img_dict = &#123;<span class="hljs-string">&quot;xxx&quot;</span>:<span class="hljs-number">1</span>,<br>           <span class="hljs-string">&quot;xxx2&quot;</span>:<span class="hljs-number">2.</span>...&#125;<br><br>cookies = &#123;<br>    <span class="hljs-string">&#x27;Hm_lvt_c99546cf032aaa5a679230de9a95c7db&#x27;</span>: <span class="hljs-string">&#x27;1684209703&#x27;</span>,<br>    <span class="hljs-string">&#x27;Hm_lpvt_c99546cf032aaa5a679230de9a95c7db&#x27;</span>: <span class="hljs-string">&#x27;1684209703&#x27;</span>,<br>    <span class="hljs-string">&#x27;qpfccr&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>    <span class="hljs-string">&#x27;no-alert3&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>&#125;<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;authority&#x27;</span>: <span class="hljs-string">&#x27;match.yuanrenxue.cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept-language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,<br>    <span class="hljs-string">&#x27;cache-control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-comment"># &#x27;cookie&#x27;: &#x27;Hm_lvt_c99546cf032aaa5a679230de9a95c7db=1684209703; Hm_lpvt_c99546cf032aaa5a679230de9a95c7db=1684209703; qpfccr=true; no-alert3=true&#x27;,</span><br>    <span class="hljs-string">&#x27;pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-string">&#x27;referer&#x27;</span>: <span class="hljs-string">&#x27;https://match.yuanrenxue.cn/match/4&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua&#x27;</span>: <span class="hljs-string">&#x27;&quot;Microsoft Edge&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not-A.Brand&quot;;v=&quot;24&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="hljs-string">&#x27;?0&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="hljs-string">&#x27;&quot;Windows&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-mode&#x27;</span>: <span class="hljs-string">&#x27;cors&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>    <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.42&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-requested-with&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span>,<br>&#125;<br><br><br>all_num = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>):<br>    params = &#123;<br>        <span class="hljs-string">&#x27;page&#x27;</span>: page,<br>    &#125;<br>    response = requests.get(<span class="hljs-string">&#x27;https://match.yuanrenxue.cn/api/match/4&#x27;</span>, params=params, cookies=cookies,<br>                            headers=headers).json()<br>    key = response[<span class="hljs-string">&#x27;key&#x27;</span>]<br>    value = response[<span class="hljs-string">&#x27;value&#x27;</span>]<br>    bs64_value = base64.b64encode((key + value).encode()).decode().replace(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    md_value = hashlib.new(<span class="hljs-string">&#x27;md5&#x27;</span>, bs64_value.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br>    info = response[<span class="hljs-string">&#x27;info&#x27;</span>]<br>    td_list = re.findall(<span class="hljs-string">r&#x27;&lt;td&gt;.*?&lt;/td&gt;&#x27;</span>, info)<br>    page_num = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> td <span class="hljs-keyword">in</span> td_list:<br>        img_urls = re.findall(<span class="hljs-string">r&#x27;src=&quot;(data:.*?)&quot; class=&quot;img_number (.*?)&quot; style=&quot;left:(.*?)&quot;&#x27;</span>, td)<br>        num_list = []<br>        order_list = []<br>        num = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> img <span class="hljs-keyword">in</span> img_urls:<br>            <span class="hljs-keyword">if</span> md_value <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> img[<span class="hljs-number">1</span>]:<br>                order_list.append(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">float</span>(img[<span class="hljs-number">2</span>].replace(<span class="hljs-string">&quot;px&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)) + <span class="hljs-number">11.5</span> * num))<br>                num_list.append(img_dict[img[<span class="hljs-number">0</span>]])<br>                num += <span class="hljs-number">1</span><br>        order_list2 = <span class="hljs-built_in">sorted</span>(order_list)  <span class="hljs-comment"># 将值进行排序</span><br>        true_list = []<br>        <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> order_list2:<br>            index = order_list.index(v)<br>            true_list.append(num_list[index])<br>        true_num = <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> true_list]))<br>        page_num += true_num<br><br>    all_num+= page_num<br><br><span class="hljs-built_in">print</span>(all_num)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> 字体加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第三题headers字段顺序和session解析</title>
      <link href="/2022/11/08/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%89%E9%A2%98headers%E5%AD%97%E6%AE%B5%E9%A1%BA%E5%BA%8F%E5%92%8Csession%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/08/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%89%E9%A2%98headers%E5%AD%97%E6%AE%B5%E9%A1%BA%E5%BA%8F%E5%92%8Csession%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://match.yuanrenxue.cn/match/3">https://match.yuanrenxue.cn/match/3</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>我们直接抓包，发现cookie并不会发生变化，也没有需要解析的请求体，我们直接复制响应再python里面运行一下</p><p><img src="/images/image-20230518192413861.png" alt="image-20230518192413861"></p><p>发现了一大堆类似类似于jsfuck一样的混淆</p><p><img src="/images/image-20230518192650982.png" alt="image-20230518192650982"></p><p>我们用fiddler再试一下,发现fiddler也能正常获取响应</p><p><img src="/images/image-20230518192811296.png" alt="image-20230518192811296"></p><p>我们再fiddler上重新发起响应看一下，发现竟然返回的和我们再pycharm上的一样</p><p><img src="/images/image-20230518193220583.png" alt="image-20230518193220583"></p><p>怀疑可能跟上面的jssm请求有关，我们直接在fiddler上同时发起两个请求试一下</p><p><img src="/images/image-20230518193709460.png" alt="image-20230518193709460"></p><p>这一次正常返回了响应，我们在py里面用session把这两个都请求一下</p><p><img src="/images/image-20230518193917302.png" alt="image-20230518193917302"></p><p>需要注意的是，headers不要跟着session一起请求，百度了一下说是跟着一起请求会打乱headers字段里面的顺序，然后又拿不到正确的响应，需要在请求之前 用session.headers &#x3D; headers设置请求头</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;content-length&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-string">&#x27;cache-control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua&#x27;</span>: <span class="hljs-string">&#x27;&quot;Google Chrome&quot;;v=&quot;111&quot;, &quot;Not(A:Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;111&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-mobile&#x27;</span>:<span class="hljs-string">&#x27;?0&#x27;</span>,<br>    <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="hljs-string">&#x27;&quot;Windows&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept&#x27;</span>: <span class="hljs-string">&#x27;*/*&#x27;</span>,<br>    <span class="hljs-string">&#x27;origin&#x27;</span>: <span class="hljs-string">&#x27;https://match.yuanrenxue.cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-mode&#x27;</span>: <span class="hljs-string">&#x27;cors&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>    <span class="hljs-string">&#x27;referer&#x27;</span>: <span class="hljs-string">&#x27;https://match.yuanrenxue.cn/match/3&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept-encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate, br&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept-language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,<br>&#125;<br>cookies = &#123;<br>    <span class="hljs-string">&quot;sessionid&quot;</span>: <span class="hljs-string">&quot;ucp2jdkyt1atcj21736is4i03haecy3i&quot;</span>,<br>    <span class="hljs-comment"># &quot;tk&quot;: &quot;8049906191893173730&quot;,</span><br>    <span class="hljs-string">&quot;qpfccr&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>    <span class="hljs-string">&quot;no-alert3&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,<br><br>&#125;<br><br><br>session = requests.session()<br>session.headers = headers<br>res = defaultdict(<span class="hljs-built_in">int</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>):<br>    url = <span class="hljs-string">&quot;https://match.yuanrenxue.cn/jssm&quot;</span><br>    response = session.post(url, cookies=cookies)<br><br>    url_p = <span class="hljs-string">&#x27;https://match.yuanrenxue.cn/api/match/3?page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br>    resp = session.get(url=url_p, cookies=cookies)<br>    <span class="hljs-built_in">print</span>(resp.text)<br>    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> resp.json()[<span class="hljs-string">&#x27;data&#x27;</span>]:<br>        value = data[<span class="hljs-string">&#x27;value&#x27;</span>]<br>        res[value] += <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dict</span>(res))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">max</span>(res, key=<span class="hljs-keyword">lambda</span> x: res[x]))<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第二题cookie加密ob混淆内存爆破</title>
      <link href="/2022/11/06/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%BA%8C%E9%A2%98cookie%E5%8A%A0%E5%AF%86ob%E6%B7%B7%E6%B7%86%E5%86%85%E5%AD%98%E7%88%86%E7%A0%B4/"/>
      <url>/2022/11/06/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%BA%8C%E9%A2%98cookie%E5%8A%A0%E5%AF%86ob%E6%B7%B7%E6%B7%86%E5%86%85%E5%AD%98%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<p>网址:<a href="https://match.yuanrenxue.cn/match/2">https://match.yuanrenxue.cn/match/2</a></p><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>直接看cookie,其它正常，这个m参数看上去跟第一题类似</p><p><img src="/images/image-20230518175052934.png" alt="image-20230518175052934"></p><p>cookie我们用hook脚本来获取,断到了 我们跟进去看一下</p><p><img src="/images/image-20230518175503583.png" alt="image-20230518175503583"></p><p>看一下这段代码</p><p><img src="/images/image-20230518180227328.png" alt="image-20230518180227328"></p><p>拆开来是这样的</p><p><img src="/images/image-20230518181119221.png" alt="image-20230518181119221"></p><p>我们再控制台上打印几个关键字,不难看出这两个就是我们想要的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">_0x554467[<span class="hljs-string">&#x27;eNpYK&#x27;</span>](_0x50116b, _0x3f0354)，_0x3f0354<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230518181218669.png" alt="image-20230518181218669"></p><p>我们先看_0x554467[‘eNpYK’]这个方法,这一页的大部门方法都是我们要扣取的</p><p><img src="/images/image-20230518181609177.png" alt="image-20230518181609177"></p><p>调试的时候会出现卡死或者这种报错，就是内存溢出直接报错的情况</p><p><img src="/images/image-20230518181902576.png" alt="image-20230518181902576"></p><p>我们可以把代码拿出来，再浏览器控制台中的源代码-&gt;代码段中，再代码最上面加上debugger；运行调试</p><p><img src="/images/image-20230518182059970.png" alt="image-20230518182059970"></p><p>再这一段代码中会用正则检测上面的代码是否被格式化，如果被格式化就会执行下面的死循环，我们直接将这一块不格式化就行</p><p><img src="/images/image-20230518182245677.png" alt="image-20230518182245677"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;XxpyjG&#x27;</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;newState&#x27;</span>;&#125;,<br></code></pre></td></tr></table></figure><p>同样的还会有两处出现卡死的情况，我们可以直接将一些代码直接找个压缩工具，进行压缩即可</p><p><img src="/images/image-20230518182456564.png" alt="image-20230518182456564"></p><p>还有一个console的报错，代码为了防止调试将console.log给改掉了，我们不用去找在哪里改，我们直接再开头定义myconsole &#x3D; console即可</p><p>最后调试成功</p><p><img src="/images/image-20230518182554429.png" alt="image-20230518182554429"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 猿人学 </tag>
            
            <tag> cookie </tag>
            
            <tag> ob混淆 </tag>
            
            <tag> 内存爆破 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学第一题md5加密js混淆解析</title>
      <link href="/2022/11/04/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%80%E9%A2%98md5%E5%8A%A0%E5%AF%86js%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/04/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%80%E9%A2%98md5%E5%8A%A0%E5%AF%86js%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://match.yuanrenxue.cn/match/1">https://match.yuanrenxue.cn/match/1</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>请求头和cookie都很正常，直接看m参数，一段加密 + 一个|再加一个类似时间戳的东西,直接从发起程序开始追栈</p><p><img src="/images/image-20230518171122504.png" alt="image-20230518171122504"></p><p>这里有个定时器debugger,直接永不暂停过掉他</p><p><img src="/images/image-20230518171337470.png" alt="image-20230518171337470"></p><p>再看到第四个方法时，发现一个html夹杂着一段js代码，我们将其抠出来</p><p><img src="/images/image-20230518171659370.png" alt="image-20230518171659370"></p><p>先找个格式化工具，美化一下代码</p><p><img src="/images/image-20230518172515287.png" alt="image-20230518172515287"></p><p>然后再把eval代码抠出来，找个解混淆工具解一下</p><p><img src="/images/image-20230518172555906.png" alt="image-20230518172555906"></p><p><img src="/images/image-20230518172930141.png" alt="image-20230518172930141"></p><p>补到这里就很明显了</p><p><img src="/images/image-20230518173134570.png" alt="image-20230518173134570"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">_0x2268f9：<span class="hljs-title class_">Date</span>[<span class="hljs-string">&#x27;parse&#x27;</span>](<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + (<span class="hljs-number">16798545</span> + -<span class="hljs-number">72936737</span> + <span class="hljs-number">156138192</span>)<br><span class="hljs-title function_">oo0O0</span>(_0x2268f9)<br></code></pre></td></tr></table></figure><p>接下来我们直接看oo0O0方法</p><p>该方法同样在html页面里面，我们也可以扣下来</p><p><img src="/images/image-20230518173526709.png" alt="image-20230518173526709"></p><p><img src="/images/image-20230518173832210.png" alt="image-20230518173832210"></p><p>接下来就是扣代码补齐，需要注意的是node.js中没有atob,我们需要用md5来实现，可以导包，也可以找一个现成的md5代码来实现</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 提取解密后的真正加密函数</span><br><span class="hljs-keyword">var</span> hexcase = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">var</span> b64pad = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">var</span> chrsz = <span class="hljs-number">16</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hex_md5</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2hex</span>(<span class="hljs-title function_">core_md5</span>(<span class="hljs-title function_">str2binl</span>(a), a.<span class="hljs-property">length</span> * chrsz))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">b64_md5</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2b64</span>(<span class="hljs-title function_">core_md5</span>(<span class="hljs-title function_">str2binl</span>(a), a.<span class="hljs-property">length</span> * chrsz))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">str_md5</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2str</span>(<span class="hljs-title function_">core_md5</span>(<span class="hljs-title function_">str2binl</span>(a), a.<span class="hljs-property">length</span> * chrsz))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hex_hmac_md5</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2hex</span>(<span class="hljs-title function_">core_hmac_md5</span>(a, b))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">b64_hmac_md5</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2b64</span>(<span class="hljs-title function_">core_hmac_md5</span>(a, b))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">str_hmac_md5</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">binl2str</span>(<span class="hljs-title function_">core_hmac_md5</span>(a, b))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_vm_test</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">hex_md5</span>(<span class="hljs-string">&quot;abc&quot;</span>) == <span class="hljs-string">&quot;900150983cd24fb0d6963f7d28e17f72&quot;</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">core_md5</span>(<span class="hljs-params">p, k</span>) &#123;<br>    p[k &gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">128</span> &lt;&lt; ((k) % <span class="hljs-number">32</span>);<br>    p[(((k + <span class="hljs-number">64</span>) &gt;&gt;&gt; <span class="hljs-number">9</span>) &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">14</span>] = k;<br>    <span class="hljs-keyword">var</span> o = <span class="hljs-number">1732584193</span>;<br>    <span class="hljs-keyword">var</span> n = -<span class="hljs-number">271733879</span>;<br>    <span class="hljs-keyword">var</span> m = -<span class="hljs-number">1732584194</span>;<br>    <span class="hljs-keyword">var</span> l = <span class="hljs-number">271733878</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> g = <span class="hljs-number">0</span>; g &lt; p.<span class="hljs-property">length</span>; g += <span class="hljs-number">16</span>) &#123;<br>        <span class="hljs-keyword">var</span> j = o;<br>        <span class="hljs-keyword">var</span> h = n;<br>        <span class="hljs-keyword">var</span> f = m;<br>        <span class="hljs-keyword">var</span> e = l;<br>        o = <span class="hljs-title function_">md5_ff</span>(o, n, m, l, p[g + <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, -<span class="hljs-number">680976936</span>);<br>        l = <span class="hljs-title function_">md5_ff</span>(l, o, n, m, p[g + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">389564586</span>);<br>        m = <span class="hljs-title function_">md5_ff</span>(m, l, o, n, p[g + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>);<br>        n = <span class="hljs-title function_">md5_ff</span>(n, m, l, o, p[g + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1044525330</span>);<br>        o = <span class="hljs-title function_">md5_ff</span>(o, n, m, l, p[g + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, -<span class="hljs-number">176418897</span>);<br>        l = <span class="hljs-title function_">md5_ff</span>(l, o, n, m, p[g + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>);<br>        m = <span class="hljs-title function_">md5_ff</span>(m, l, o, n, p[g + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1473231341</span>);<br>        n = <span class="hljs-title function_">md5_ff</span>(n, m, l, o, p[g + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">45705983</span>);<br>        o = <span class="hljs-title function_">md5_ff</span>(o, n, m, l, p[g + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>);<br>        l = <span class="hljs-title function_">md5_ff</span>(l, o, n, m, p[g + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">1958414417</span>);<br>        m = <span class="hljs-title function_">md5_ff</span>(m, l, o, n, p[g + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">42063</span>);<br>        n = <span class="hljs-title function_">md5_ff</span>(n, m, l, o, p[g + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1990404162</span>);<br>        o = <span class="hljs-title function_">md5_ff</span>(o, n, m, l, p[g + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804660682</span>);<br>        l = <span class="hljs-title function_">md5_ff</span>(l, o, n, m, p[g + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">40341101</span>);<br>        m = <span class="hljs-title function_">md5_ff</span>(m, l, o, n, p[g + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1502002290</span>);<br>        n = <span class="hljs-title function_">md5_ff</span>(n, m, l, o, p[g + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>);<br>        o = <span class="hljs-title function_">md5_gg</span>(o, n, m, l, p[g + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">165796510</span>);<br>        l = <span class="hljs-title function_">md5_gg</span>(l, o, n, m, p[g + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1069501632</span>);<br>        m = <span class="hljs-title function_">md5_gg</span>(m, l, o, n, p[g + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>);<br>        n = <span class="hljs-title function_">md5_gg</span>(n, m, l, o, p[g + <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">373897302</span>);<br>        o = <span class="hljs-title function_">md5_gg</span>(o, n, m, l, p[g + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">701558691</span>);<br>        l = <span class="hljs-title function_">md5_gg</span>(l, o, n, m, p[g + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>);<br>        m = <span class="hljs-title function_">md5_gg</span>(m, l, o, n, p[g + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">660478335</span>);<br>        n = <span class="hljs-title function_">md5_gg</span>(n, m, l, o, p[g + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">405537848</span>);<br>        o = <span class="hljs-title function_">md5_gg</span>(o, n, m, l, p[g + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>);<br>        l = <span class="hljs-title function_">md5_gg</span>(l, o, n, m, p[g + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1019803690</span>);<br>        m = <span class="hljs-title function_">md5_gg</span>(m, l, o, n, p[g + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">187363961</span>);<br>        n = <span class="hljs-title function_">md5_gg</span>(n, m, l, o, p[g + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>);<br>        o = <span class="hljs-title function_">md5_gg</span>(o, n, m, l, p[g + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">1444681467</span>);<br>        l = <span class="hljs-title function_">md5_gg</span>(l, o, n, m, p[g + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">51403784</span>);<br>        m = <span class="hljs-title function_">md5_gg</span>(m, l, o, n, p[g + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>);<br>        n = <span class="hljs-title function_">md5_gg</span>(n, m, l, o, p[g + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">1921207734</span>);<br>        o = <span class="hljs-title function_">md5_hh</span>(o, n, m, l, p[g + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">378558</span>);<br>        l = <span class="hljs-title function_">md5_hh</span>(l, o, n, m, p[g + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">2022574463</span>);<br>        m = <span class="hljs-title function_">md5_hh</span>(m, l, o, n, p[g + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>);<br>        n = <span class="hljs-title function_">md5_hh</span>(n, m, l, o, p[g + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">35309556</span>);<br>        o = <span class="hljs-title function_">md5_hh</span>(o, n, m, l, p[g + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">1530992060</span>);<br>        l = <span class="hljs-title function_">md5_hh</span>(l, o, n, m, p[g + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>);<br>        m = <span class="hljs-title function_">md5_hh</span>(m, l, o, n, p[g + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">155497632</span>);<br>        n = <span class="hljs-title function_">md5_hh</span>(n, m, l, o, p[g + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">1094730640</span>);<br>        o = <span class="hljs-title function_">md5_hh</span>(o, n, m, l, p[g + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>);<br>        l = <span class="hljs-title function_">md5_hh</span>(l, o, n, m, p[g + <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">358537222</span>);<br>        m = <span class="hljs-title function_">md5_hh</span>(m, l, o, n, p[g + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">722881979</span>);<br>        n = <span class="hljs-title function_">md5_hh</span>(n, m, l, o, p[g + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>);<br>        o = <span class="hljs-title function_">md5_hh</span>(o, n, m, l, p[g + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">640364487</span>);<br>        l = <span class="hljs-title function_">md5_hh</span>(l, o, n, m, p[g + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">421815835</span>);<br>        m = <span class="hljs-title function_">md5_hh</span>(m, l, o, n, p[g + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>);<br>        n = <span class="hljs-title function_">md5_hh</span>(n, m, l, o, p[g + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">995338651</span>);<br>        o = <span class="hljs-title function_">md5_ii</span>(o, n, m, l, p[g + <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, -<span class="hljs-number">198630844</span>);<br>        l = <span class="hljs-title function_">md5_ii</span>(l, o, n, m, p[g + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">11261161415</span>);<br>        m = <span class="hljs-title function_">md5_ii</span>(m, l, o, n, p[g + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1416354905</span>);<br>        n = <span class="hljs-title function_">md5_ii</span>(n, m, l, o, p[g + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">57434055</span>);<br>        o = <span class="hljs-title function_">md5_ii</span>(o, n, m, l, p[g + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>);<br>        l = <span class="hljs-title function_">md5_ii</span>(l, o, n, m, p[g + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1894446606</span>);<br>        m = <span class="hljs-title function_">md5_ii</span>(m, l, o, n, p[g + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1051523</span>);<br>        n = <span class="hljs-title function_">md5_ii</span>(n, m, l, o, p[g + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">2054922799</span>);<br>        o = <span class="hljs-title function_">md5_ii</span>(o, n, m, l, p[g + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>);<br>        l = <span class="hljs-title function_">md5_ii</span>(l, o, n, m, p[g + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">30611744</span>);<br>        m = <span class="hljs-title function_">md5_ii</span>(m, l, o, n, p[g + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1560198380</span>);<br>        n = <span class="hljs-title function_">md5_ii</span>(n, m, l, o, p[g + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>);<br>        o = <span class="hljs-title function_">md5_ii</span>(o, n, m, l, p[g + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, -<span class="hljs-number">145523070</span>);<br>        l = <span class="hljs-title function_">md5_ii</span>(l, o, n, m, p[g + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1120210379</span>);<br>        m = <span class="hljs-title function_">md5_ii</span>(m, l, o, n, p[g + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>);<br>        n = <span class="hljs-title function_">md5_ii</span>(n, m, l, o, p[g + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">343485551</span>);<br>        o = <span class="hljs-title function_">safe_add</span>(o, j);<br>        n = <span class="hljs-title function_">safe_add</span>(n, h);<br>        m = <span class="hljs-title function_">safe_add</span>(m, f);<br>        l = <span class="hljs-title function_">safe_add</span>(l, e)<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>(o, n, m, l)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_cmn</span>(<span class="hljs-params">h, e, d, c, g, f</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">safe_add</span>(<span class="hljs-title function_">bit_rol</span>(<span class="hljs-title function_">safe_add</span>(<span class="hljs-title function_">safe_add</span>(e, h), <span class="hljs-title function_">safe_add</span>(c, f)), g), d)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_ff</span>(<span class="hljs-params">g, f, k, j, e, i, h</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">md5_cmn</span>((f &amp; k) | ((~f) &amp; j), g, f, e, i, h)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_gg</span>(<span class="hljs-params">g, f, k, j, e, i, h</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">md5_cmn</span>((f &amp; j) | (k &amp; (~j)), g, f, e, i, h)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_hh</span>(<span class="hljs-params">g, f, k, j, e, i, h</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">md5_cmn</span>(f ^ k ^ j, g, f, e, i, h)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5_ii</span>(<span class="hljs-params">g, f, k, j, e, i, h</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">md5_cmn</span>(k ^ (f | (~j)), g, f, e, i, h)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">core_hmac_md5</span>(<span class="hljs-params">c, f</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-title function_">str2binl</span>(c);<br>    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">length</span> &gt; <span class="hljs-number">16</span>) &#123;<br>        e = <span class="hljs-title function_">core_md5</span>(e, c.<span class="hljs-property">length</span> * chrsz)<br>    &#125;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Array</span>(<span class="hljs-number">16</span>),<br>    d = <span class="hljs-title class_">Array</span>(<span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; <span class="hljs-number">16</span>; b++) &#123;<br>        a[b] = e[b] ^ <span class="hljs-number">909522486</span>;<br>        d[b] = e[b] ^ <span class="hljs-number">1549556828</span><br>    &#125;<br>    <span class="hljs-keyword">var</span> g = <span class="hljs-title function_">core_md5</span>(a.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">str2binl</span>(f)), <span class="hljs-number">512</span> + f.<span class="hljs-property">length</span> * chrsz);<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">core_md5</span>(d.<span class="hljs-title function_">concat</span>(g), <span class="hljs-number">512</span> + <span class="hljs-number">128</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">safe_add</span>(<span class="hljs-params">a, d</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = (a &amp; <span class="hljs-number">65535</span>) + (d &amp; <span class="hljs-number">65535</span>);<br>    <span class="hljs-keyword">var</span> b = (a &gt;&gt; <span class="hljs-number">16</span>) + (d &gt;&gt; <span class="hljs-number">16</span>) + (c &gt;&gt; <span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">return</span> (b &lt;&lt; <span class="hljs-number">16</span>) | (c &amp; <span class="hljs-number">65535</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bit_rol</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> (a &lt;&lt; b) | (a &gt;&gt;&gt; (<span class="hljs-number">32</span> - b))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">str2binl</span>(<span class="hljs-params">d</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-title class_">Array</span>();<br>    <span class="hljs-keyword">var</span> a = (<span class="hljs-number">1</span> &lt;&lt; chrsz) - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; d.<span class="hljs-property">length</span> * chrsz; b += chrsz) &#123;<br>        c[b &gt;&gt; <span class="hljs-number">5</span>] |= (d.<span class="hljs-title function_">charCodeAt</span>(b / chrsz) &amp; a) &lt;&lt; (b % <span class="hljs-number">32</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> c<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">binl2str</span>(<span class="hljs-params">c</span>) &#123;<br>    <span class="hljs-keyword">var</span> d = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">var</span> a = (<span class="hljs-number">1</span> &lt;&lt; chrsz) - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; c.<span class="hljs-property">length</span> * <span class="hljs-number">32</span>; b += chrsz) &#123;<br>        d += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>((c[b &gt;&gt; <span class="hljs-number">5</span>] &gt;&gt;&gt; (b % <span class="hljs-number">32</span>)) &amp; a)<br>    &#125;<br>    <span class="hljs-keyword">return</span> d<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">binl2hex</span>(<span class="hljs-params">c</span>) &#123;<br>    <span class="hljs-keyword">var</span> b = hexcase ? <span class="hljs-string">&quot;0123456789ABCDEF&quot;</span>: <span class="hljs-string">&quot;0123456789abcdef&quot;</span>;<br>    <span class="hljs-keyword">var</span> d = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; c.<span class="hljs-property">length</span> * <span class="hljs-number">4</span>; a++) &#123;<br>        d += b.<span class="hljs-title function_">charAt</span>((c[a &gt;&gt; <span class="hljs-number">2</span>] &gt;&gt; ((a % <span class="hljs-number">4</span>) * <span class="hljs-number">8</span> + <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">15</span>) + b.<span class="hljs-title function_">charAt</span>((c[a &gt;&gt; <span class="hljs-number">2</span>] &gt;&gt; ((a % <span class="hljs-number">4</span>) * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">15</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> d<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">binl2b64</span>(<span class="hljs-params">d</span>) &#123;<br><span class="hljs-keyword">var</span> c = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br><span class="hljs-keyword">var</span> f = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; d.<span class="hljs-property">length</span> * <span class="hljs-number">4</span>; b += <span class="hljs-number">3</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = (((d[b &gt;&gt; <span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">8</span> * (b % <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">16</span>) | (((d[b + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">8</span> * ((b + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">8</span>) | ((d[b + <span class="hljs-number">2</span> &gt;&gt; <span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">8</span> * ((b + <span class="hljs-number">2</span>) % <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">255</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; <span class="hljs-number">4</span>; a++) &#123;<br>        <span class="hljs-keyword">if</span> (b * <span class="hljs-number">8</span> + a * <span class="hljs-number">6</span> &gt; d.<span class="hljs-property">length</span> * <span class="hljs-number">32</span>) &#123;<br>            f += b64pad<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            f += c.<span class="hljs-title function_">charAt</span>((e &gt;&gt; <span class="hljs-number">6</span> * (<span class="hljs-number">3</span> - a)) &amp; <span class="hljs-number">63</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">return</span> f<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params"></span>)&#123;<br>    date = <span class="hljs-title class_">Date</span>[<span class="hljs-string">&#x27;parse&#x27;</span>](<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + (<span class="hljs-number">16798545</span> + -<span class="hljs-number">72936737</span> + <span class="hljs-number">156138192</span>)<br>    <span class="hljs-keyword">var</span> code = <span class="hljs-title function_">hex_md5</span>(date[<span class="hljs-string">&#x27;toStr&#x27;</span> + <span class="hljs-string">&#x27;ing&#x27;</span>]())<br>    <span class="hljs-keyword">return</span> code + <span class="hljs-string">&#x27;丨&#x27;</span> + date / <span class="hljs-number">1000</span><br><br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getData</span>())<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js混淆 </tag>
            
            <tag> 猿人学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>问财搜索hexin-v参数ob混淆解析</title>
      <link href="/2022/11/04/%E9%97%AE%E8%B4%A2%E6%90%9C%E7%B4%A2hexin-v%E5%8F%82%E6%95%B0ob%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/11/04/%E9%97%AE%E8%B4%A2%E6%90%9C%E7%B4%A2hexin-v%E5%8F%82%E6%95%B0ob%E6%B7%B7%E6%B7%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="http://www.iwencai.com/">http://www.iwencai.com/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>使用这个接口获取搜索结果</p><p><img src="/images/image-20230518162802851.png" alt="image-20230518162802851"></p><p>请求头中<strong>hexin-v</strong>参数是我们需要的，经过测试它和cookie中的v参数可以相同，所以我们直接hook cookie</p><p><img src="/images/image-20230518162930827.png" alt="image-20230518162930827"></p><p>找到cookie正确的参数v，我们追栈查看</p><p><img src="/images/image-20230518162410029.png" alt="image-20230518162410029"></p><p>到o方法这里，t参数是我们要的，再往上跟</p><p><img src="/images/image-20230518162536645.png" alt="image-20230518162536645"></p><p>直接看rt.update方法</p><p><img src="/images/image-20230518162552596.png" alt="image-20230518162552596"></p><p>到这基本就找到加密的地方了</p><p><img src="/images/image-20230518162606300.png" alt="image-20230518162606300"></p><p>接下来就是扣代码了，一步一步扣，需要补上window和document，其中serverTimeNow可以是定值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-variable constant_">TOKEN_SERVER_TIME</span> = <span class="hljs-number">1682730000.769</span><br><br><span class="hljs-keyword">var</span> <span class="hljs-variable language_">document</span> = &#123;&#125;<br><span class="hljs-keyword">var</span> <span class="hljs-variable language_">window</span> = &#123;&#125;<br><br><br><span class="hljs-keyword">var</span> duan = [<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">9527</span>, <span class="hljs-title class_">String</span>, <span class="hljs-title class_">Boolean</span>, <span class="hljs-string">&quot;eh&quot;</span>, <span class="hljs-string">&quot;ad&quot;</span>, <span class="hljs-string">&quot;Bu&quot;</span>, <span class="hljs-string">&quot;ileds&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;\b&quot;</span>, <span class="hljs-title class_">Array</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;base&quot;</span>, <span class="hljs-string">&quot;64De&quot;</span>, <span class="hljs-string">&quot;\u2543\u252b&quot;</span>, <span class="hljs-string">&quot;etatS&quot;</span>, <span class="hljs-string">&quot;pa&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;FromUrl&quot;</span>, <span class="hljs-string">&quot;getOrigi&quot;</span>, <span class="hljs-string">&quot;nFromUrl&quot;</span>, <span class="hljs-string">&quot;\u255b\u253e&quot;</span>, <span class="hljs-string">&quot;b?\x18q)&quot;</span>, <span class="hljs-string">&quot;ic&quot;</span>, <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;sted&quot;</span>, <span class="hljs-string">&quot;he&quot;</span>, <span class="hljs-string">&quot;wser&quot;</span>, <span class="hljs-string">&quot;oNo&quot;</span>, <span class="hljs-string">&quot;ckw&quot;</span>, <span class="hljs-string">&quot;ent&quot;</span>, <span class="hljs-string">&quot;hst&quot;</span>, <span class="hljs-string">&quot;^And&quot;</span>, <span class="hljs-string">&quot;RM&quot;</span>, <span class="hljs-string">&quot;systemL&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;\u255f\u0978\u095b\u09f5&quot;</span>, <span class="hljs-string">&quot;TR8&quot;</span>, <span class="hljs-string">&quot;!&#x27;&quot;</span>, <span class="hljs-string">&quot;gth&quot;</span>, <span class="hljs-string">&quot;er&quot;</span>, <span class="hljs-string">&quot;TP&quot;</span>, <span class="hljs-number">83</span>, <span class="hljs-string">&quot;r&quot;</span>, !<span class="hljs-number">0</span>, <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;v-nixeh&quot;</span>, <span class="hljs-title class_">RegExp</span>, <span class="hljs-string">&quot;thsi.cn&quot;</span>, <span class="hljs-string">&#x27;K\x19&quot;]K^xVV&#x27;</span>, <span class="hljs-string">&quot;KXxAPD?\x1b[Y&quot;</span>, <span class="hljs-variable language_">document</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&quot;allow&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;; &quot;</span>, <span class="hljs-string">&quot;length&quot;</span>, <span class="hljs-string">&quot;Init&quot;</span>, <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;; domain=&quot;</span>, <span class="hljs-string">&quot;checkcookie&quot;</span>, !<span class="hljs-number">1</span>, <span class="hljs-string">&quot;eikooCled&quot;</span>, <span class="hljs-string">&quot;tnemucod&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-variable language_">window</span>, <span class="hljs-string">&quot;\u2553\u0972\u0959\u09e4\u09bd\u0938\u0980\u09c5\u09b1\u09d1\u09a7\u09dc\u09dd\u09d3\u09c2&quot;</span>, <span class="hljs-string">&quot;\u2556\u0979\u095e\u09d3\u09b5\u0935\u098f\u09c7\u099d\u09d2\u09b0&quot;</span>, <span class="hljs-number">23</span>, <span class="hljs-string">&quot;l$P$~&quot;</span>, <span class="hljs-string">&quot;frames&quot;</span>, <span class="hljs-string">&quot;ducument&quot;</span>, <span class="hljs-string">&quot;ydob&quot;</span>, <span class="hljs-string">&quot;documentElement&quot;</span>, <span class="hljs-string">&quot;del&quot;</span>, <span class="hljs-string">&quot;@[\\]^`&#123;|&#125;~]&quot;</span>, <span class="hljs-string">&quot;base_fileds&quot;</span>, <span class="hljs-string">&quot;255&quot;</span>, <span class="hljs-number">10</span>, <span class="hljs-string">&quot;10&quot;</span>, <span class="hljs-number">39</span>, <span class="hljs-string">&quot;\u2547\u2535\u255a\u252e\u2541\u2535\u254c\u253c\u2559&quot;</span>, <span class="hljs-number">8</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;de&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;11&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&quot;203&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>, <span class="hljs-string">&quot;111111&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&quot;\x0f&quot;</span>, <span class="hljs-string">&quot;\u2506\u2537\u2507\u2537&quot;</span>, <span class="hljs-string">&quot;11111111&quot;</span>, <span class="hljs-string">&quot;base64Encode&quot;</span>, <span class="hljs-string">&quot;v\x1d&quot;</span>, <span class="hljs-string">&quot;ati&quot;</span>, <span class="hljs-string">&quot;WY&quot;</span>, <span class="hljs-string">&quot;te&quot;</span>, <span class="hljs-string">&quot;bo&quot;</span>, <span class="hljs-string">&quot;rs&quot;</span>, <span class="hljs-string">&quot;getHost&quot;</span>, <span class="hljs-title class_">Date</span>, <span class="hljs-string">&quot;&#123;DF&quot;</span>, <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;^&#123;.*&#125;$&quot;</span>, <span class="hljs-string">&quot;WU&lt;P[C&quot;</span>, <span class="hljs-number">52</span>, <span class="hljs-string">&quot;1001&quot;</span>, <span class="hljs-string">&quot;href&quot;</span>, <span class="hljs-string">&quot;1111101010&quot;</span>, <span class="hljs-string">&quot;redirect_url&quot;</span>, <span class="hljs-string">&quot;^\\s*(?:https?:)?\\/&#123;2,&#125;([^\\/\\?\\#\\\\]+)&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;\u256c\u252c\u2516\u254b&quot;</span>, <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;ready&quot;</span>, <span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-string">&quot;dy&quot;</span>, <span class="hljs-number">7</span>, <span class="hljs-string">&quot;protocol&quot;</span>, <span class="hljs-string">&quot;//s.thsi.cn/js/chameleon/time.1&quot;</span>, <span class="hljs-string">&quot;onerror&quot;</span>, <span class="hljs-string">&quot;2000&quot;</span>, <span class="hljs-string">&quot;readyState&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&quot;^(\\d+\\.)+\\d+$&quot;</span>, <span class="hljs-string">&quot;^\\s*(?:(https?:))?\\/&#123;2,&#125;([^\\/\\?\\#\\\\]+)&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;strToBytes&quot;</span>, <span class="hljs-string">&quot;isIPAddr&quot;</span>, <span class="hljs-string">&quot;serverTimeNow&quot;</span>, <span class="hljs-string">&quot;addEventListener&quot;</span>, <span class="hljs-string">&quot;th&quot;</span>, <span class="hljs-string">&quot;wh&quot;</span>, <span class="hljs-string">&quot;Scro&quot;</span>, <span class="hljs-string">&quot;mousemove&quot;</span>, <span class="hljs-number">55</span>, <span class="hljs-string">&quot;evomhcuot&quot;</span>, <span class="hljs-string">&quot;[[?PVC\x0e&quot;</span>, <span class="hljs-string">&quot;getMouseMove&quot;</span>, <span class="hljs-string">&#x27;_R&quot;xWB%Po_3YT&#x27;</span>, <span class="hljs-string">&quot;getMouseClick&quot;</span>, <span class="hljs-string">&quot;ght&quot;</span>, <span class="hljs-string">&quot;gin&quot;</span>, <span class="hljs-string">&quot;msD&quot;</span>, <span class="hljs-string">&quot;ack&quot;</span>, <span class="hljs-string">&quot;\u2556\u096b\u095f&quot;</span>, <span class="hljs-string">&quot;Nativ&quot;</span>, <span class="hljs-string">&quot;^A&quot;</span>, <span class="hljs-string">&quot;MozSettingsEvent&quot;</span>, <span class="hljs-string">&quot;safari&quot;</span>, <span class="hljs-string">&quot;ActiveXObject&quot;</span>, <span class="hljs-string">&quot;postMessage&quot;</span>, <span class="hljs-string">&quot;Uint8Array&quot;</span>, <span class="hljs-string">&quot;WeakMap&quot;</span>, <span class="hljs-string">&quot;Google Inc.&quot;</span>, <span class="hljs-string">&quot;vendor&quot;</span>, <span class="hljs-string">&quot;chrome&quot;</span>, <span class="hljs-string">&quot;python&quot;</span>, <span class="hljs-string">&quot;sgAppName&quot;</span>, <span class="hljs-string">&quot;JX&quot;</span>, <span class="hljs-number">6</span>, <span class="hljs-string">&quot;me&quot;</span>, <span class="hljs-string">&quot;LBBROWSER&quot;</span>, <span class="hljs-string">&quot;w4&quot;</span>, <span class="hljs-string">&quot;2345Explorer&quot;</span>, <span class="hljs-string">&quot;TheWorld&quot;</span>, <span class="hljs-string">&quot;\u2544&quot;</span>, <span class="hljs-number">40</span>, <span class="hljs-string">&quot;tTr&quot;</span>, <span class="hljs-string">&quot;\u2506&quot;</span>, <span class="hljs-string">&quot;navigator&quot;</span>, <span class="hljs-string">&quot;webdriver&quot;</span>, <span class="hljs-string">&quot;languages&quot;</span>, <span class="hljs-string">&quot;taborcA|FDP&quot;</span>, <span class="hljs-string">&quot;\u2541\u097c\u0949&quot;</span>, <span class="hljs-number">95</span>, <span class="hljs-string">&quot;1e0&quot;</span>, <span class="hljs-string">&quot;e Cli&quot;</span>, <span class="hljs-string">&quot;iso-8859-1&quot;</span>, <span class="hljs-string">&quot;defaultCharset&quot;</span>, <span class="hljs-string">&quot;localStorage&quot;</span>, <span class="hljs-string">&quot;^Win64&quot;</span>, <span class="hljs-string">&quot;^Linux armv|Android&quot;</span>, <span class="hljs-string">&quot;^iPhone&quot;</span>, <span class="hljs-string">&quot;^iPad&quot;</span>, <span class="hljs-string">&quot;B_&#123;VV&quot;</span>, <span class="hljs-string">&quot;getPluginNum&quot;</span>, <span class="hljs-string">&quot;getBrowserFeature&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>, <span class="hljs-string">&quot;sE&quot;</span>, <span class="hljs-string">&quot;10000&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>, <span class="hljs-string">&quot;\u2542\u2532\u2556\u2537\u2543\u2526&quot;</span>, <span class="hljs-string">&quot;\x1cx`R&quot;</span>, <span class="hljs-number">2333</span>, <span class="hljs-string">&quot;XMLH&quot;</span>, <span class="hljs-string">&quot;ers&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;lo&quot;</span>, <span class="hljs-number">57</span>, <span class="hljs-string">&quot;ylppa&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-string">&quot;target&quot;</span>, <span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-string">&quot;unload&quot;</span>, <span class="hljs-string">&quot;HE9AWT9Y&quot;</span>, <span class="hljs-string">&quot;\\.&quot;</span>, <span class="hljs-string">&quot;c?&quot;</span>, <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;fetch&quot;</span>, <span class="hljs-string">&quot;prototype&quot;</span>, <span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-string">&quot;\u2556\u0971\u0956\u09fe\u09a7&quot;</span>, <span class="hljs-string">&quot;headers&quot;</span>, <span class="hljs-string">&quot;\u256b\u2554&quot;</span>, <span class="hljs-number">79</span>, <span class="hljs-string">&quot;?&quot;</span>, <span class="hljs-string">&quot;^(.*?):[ \\t]*([^\\r\\n]*)\\r?$&quot;</span>, <span class="hljs-string">&quot;gm&quot;</span>, <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;analysisRst&quot;</span>, <span class="hljs-string">&quot;\u255e\u0973\u0949\u09f4\u09a2\u0929\u09ac\u09d4\u0992\u09d2\u09b0\u09d4&quot;</span>, <span class="hljs-string">&quot;appendChild&quot;</span>, <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;jsonp_ignore&quot;</span>, <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-number">70</span>, <span class="hljs-string">&quot;421&quot;</span>, <span class="hljs-string">&quot;XH&gt;a&quot;</span>, <span class="hljs-string">&quot;\u2574\u253c\u257d\u2530\u2575\u2539\u257c\u2533\u257d\u2522\u256e\u2521\u2560\u2524\u2561\u2525&quot;</span>, <span class="hljs-string">&quot;CHAMELEON_LOADED&quot;</span>];<br><span class="hljs-keyword">var</span> chang = [<span class="hljs-number">1</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&quot;he&quot;</span>, <span class="hljs-string">&quot;ad&quot;</span>, <span class="hljs-number">29</span>, <span class="hljs-string">&quot;\x180G\x1f&quot;</span>, <span class="hljs-string">&quot;?&gt;=&lt;;:\\\\/,+&quot;</span>, <span class="hljs-string">&quot;ng&quot;</span>, <span class="hljs-string">&quot;to&quot;</span>, <span class="hljs-string">&quot;ff&quot;</span>, <span class="hljs-title class_">Number</span>, <span class="hljs-title class_">Error</span>, <span class="hljs-string">&quot;11&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;er&quot;</span>, <span class="hljs-string">&quot;ro&quot;</span>, <span class="hljs-string">&quot;code&quot;</span>, <span class="hljs-string">&quot;co&quot;</span>, <span class="hljs-string">&quot;_?L&quot;</span>, <span class="hljs-string">&quot;ed&quot;</span>, <span class="hljs-string">&quot;@S\x15D*&quot;</span>, <span class="hljs-title class_">Object</span>, <span class="hljs-string">&quot;len&quot;</span>, <span class="hljs-string">&quot;gth&quot;</span>, <span class="hljs-string">&quot;on&quot;</span>, <span class="hljs-string">&quot;lo&quot;</span>, <span class="hljs-title class_">RegExp</span>, <span class="hljs-string">&quot;ySta&quot;</span>, <span class="hljs-number">13</span>, <span class="hljs-string">&quot;eel&quot;</span>, <span class="hljs-string">&quot;ee&quot;</span>, <span class="hljs-string">&quot;ouse&quot;</span>, <span class="hljs-string">&quot;ll&quot;</span>, <span class="hljs-string">&quot;\u2544\u2530\u2555\u2531&quot;</span>, <span class="hljs-string">&quot;FCm-&quot;</span>, <span class="hljs-string">&quot;isTru&quot;</span>, <span class="hljs-string">&quot;getC&quot;</span>, <span class="hljs-string">&quot;Pos&quot;</span>, <span class="hljs-string">&quot;ve&quot;</span>, <span class="hljs-string">&quot;or&quot;</span>, <span class="hljs-string">&quot;ae&quot;</span>, <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;On&quot;</span>, <span class="hljs-string">&quot;Sho&quot;</span>, <span class="hljs-string">&quot;can&quot;</span>, <span class="hljs-string">&quot;ont&quot;</span>, <span class="hljs-string">&quot;roid&quot;</span>, <span class="hljs-string">&quot;anguage&quot;</span>, <span class="hljs-string">&quot;\u2502&quot;</span>, <span class="hljs-string">&quot;ta&quot;</span>, <span class="hljs-string">&quot;tna&quot;</span>, <span class="hljs-title class_">Date</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;am&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;n+&quot;</span>, <span class="hljs-string">&quot;f80&quot;</span>, <span class="hljs-string">&quot;\x1dD&quot;</span>, <span class="hljs-number">6</span>, <span class="hljs-string">&quot;\u255f\u253a\u2542\u252b\u2545\u2568\u251e&quot;</span>, <span class="hljs-string">&quot;KCABLLAC_NOELEMAHC&quot;</span>, <span class="hljs-string">&quot;X-Antispider-Message&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;.baidu.&quot;</span>, <span class="hljs-title class_">Function</span>, <span class="hljs-variable language_">document</span>, !<span class="hljs-number">0</span>, <span class="hljs-string">&quot;cookie&quot;</span>, <span class="hljs-string">&quot;; &quot;</span>, <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-number">96</span>, <span class="hljs-string">&quot;\u255b\u253e\u2550\u2537\u2543\u252b&quot;</span>, <span class="hljs-string">&quot;\u250c\u252c\u255c\u253d\u2549\u2521\u251c&quot;</span>, <span class="hljs-string">&quot;;O&quot;</span>, <span class="hljs-string">&quot;; expires=&quot;</span>, <span class="hljs-string">&quot;getCookie&quot;</span>, <span class="hljs-string">&quot;Thu, 01 Jan 1970 00:00:00 GMT&quot;</span>, <span class="hljs-string">&quot;setCookie&quot;</span>, <span class="hljs-string">&quot;Z\x18|&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;\u255b\u2534\u2557\u2536\u255a\u2509\u257d\u2512\u2560\u2501\u2566\u2503&quot;</span>, <span class="hljs-number">52</span>, <span class="hljs-variable language_">window</span>, <span class="hljs-number">10</span>, <span class="hljs-string">&quot;Init&quot;</span>, !<span class="hljs-number">1</span>, <span class="hljs-string">&quot;set&quot;</span>, <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;eliflmth&quot;</span>, <span class="hljs-string">&#x27;&lt;script&gt;document.w=window&lt;\/script&gt;&lt;iframe src=&quot;/favicon.icon&quot;&gt;&lt;/iframe&gt;&#x27;</span>, <span class="hljs-string">&quot;iS.p&quot;</span>, <span class="hljs-string">&quot;head&quot;</span>, <span class="hljs-string">&quot;#default#userData&quot;</span>, <span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;[!\&quot;#$%&amp;&#x27;()*&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;^d&quot;</span>, <span class="hljs-string">&quot;$D&quot;</span>, <span class="hljs-string">&quot;\u2568\u2537\u2568\u254c\u256a&quot;</span>, <span class="hljs-string">&quot;]\\P&quot;</span>, <span class="hljs-string">&quot;___&quot;</span>, <span class="hljs-string">&quot;le&quot;</span>, <span class="hljs-string">&quot;th&quot;</span>, <span class="hljs-string">&quot;prototype&quot;</span>, <span class="hljs-string">&quot;base_f&quot;</span>, <span class="hljs-number">8</span>, <span class="hljs-string">&quot;\\R5Z\\R\x14@^Q3G&quot;</span>, <span class="hljs-string">&quot;ZV%PgQ?Y]S%&quot;</span>, <span class="hljs-number">67</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;length&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&quot;12&quot;</span>, <span class="hljs-string">&quot;\u2576\u095f\u0979\u09d5\u0995\u091b\u09a9\u09f9\u09bd\u09f7\u0989\u09fd\u09f5\u09f3\u09f9\u0a41\u0a4d\u098f\u0999\u0905\u0975\u09cb\u09a9\u09a9\u099d\u0927\u0933\u0913\u0a6b\u0999\u09a3\u0937\u098b\u09f5\u0933\u0a7b\u091b\u09b1\u0a63\u095f\u09fb\u094d\u0993\u0943\u092b\u0949\u09a3\u09e7\u09cb\u0925\u0993\u09ab\u09f0\u092c\u092c\u0942\u0950\u09c8\u0944\u09c6\u0990\u0944\u09cb\u098e&quot;</span>, <span class="hljs-string">&quot;i,&quot;</span>, <span class="hljs-string">&quot;\u2505\u092f&quot;</span>, <span class="hljs-number">12</span>, <span class="hljs-number">56</span>, <span class="hljs-string">&quot;20&quot;</span>, <span class="hljs-string">&quot;1000&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;11111111&quot;</span>, <span class="hljs-string">&quot;encode&quot;</span>, <span class="hljs-string">&quot;\u255b\u0972\u0959&quot;</span>, <span class="hljs-string">&quot;\u2519&quot;</span>, <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;WY$PYS&quot;</span>, <span class="hljs-string">&quot;ystate&quot;</span>, <span class="hljs-string">&quot;1111101000&quot;</span>, <span class="hljs-regexp">/ /g</span>, <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;\u250d&quot;</span>, <span class="hljs-string">&#x27;^&quot;.*&quot;$&#x27;</span>, <span class="hljs-string">&quot;edoc_sutats&quot;</span>, <span class="hljs-string">&quot;status_code&quot;</span>, <span class="hljs-string">&quot;location&quot;</span>, <span class="hljs-string">&quot;redirect_url&quot;</span>, <span class="hljs-string">&quot;href&quot;</span>, <span class="hljs-string">&quot;4294967295&quot;</span>, <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;1200000&quot;</span>, <span class="hljs-string">&quot;script&quot;</span>, <span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;onreadystatechange&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>, <span class="hljs-string">&quot;loaded&quot;</span>, <span class="hljs-string">&quot;readyState&quot;</span>, <span class="hljs-string">&quot;complete&quot;</span>, <span class="hljs-string">&quot;interactive&quot;</span>, <span class="hljs-string">&quot;onload&quot;</span>, <span class="hljs-string">&quot;undefined&quot;</span>, <span class="hljs-string">&quot;\\.com\\.cn$|\\.com\\.hk$&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;getServerTime&quot;</span>, <span class="hljs-string">&#x27;YY7YAD?FjD&quot;&#x27;</span>, <span class="hljs-string">&quot;strhash&quot;</span>, <span class="hljs-string">&quot;random&quot;</span>, <span class="hljs-string">&quot;getRootDomain&quot;</span>, <span class="hljs-string">&quot;booleanToDecimal&quot;</span>, <span class="hljs-string">&quot;timeNow&quot;</span>, <span class="hljs-string">&quot;\u2559\u253e&quot;</span>, <span class="hljs-string">&quot;eventBind&quot;</span>, <span class="hljs-string">&quot;onwh&quot;</span>, <span class="hljs-string">&quot;\u255b&quot;</span>, <span class="hljs-number">46</span>, <span class="hljs-string">&quot;DOMM&quot;</span>, <span class="hljs-string">&quot;cl&quot;</span>, <span class="hljs-string">&quot;T^5^&quot;</span>, <span class="hljs-string">&quot;div&quot;</span>, <span class="hljs-string">&quot;onmousewheel&quot;</span>, <span class="hljs-string">&quot;mousewheel&quot;</span>, <span class="hljs-number">51</span>, <span class="hljs-string">&quot;keydown&quot;</span>, <span class="hljs-string">&quot;clientY&quot;</span>, <span class="hljs-string">&quot;getKeyDown&quot;</span>, <span class="hljs-string">&quot;ch&quot;</span>, <span class="hljs-string">&quot;plu&quot;</span>, <span class="hljs-string">&quot;\u2543\u252b&quot;</span>, <span class="hljs-string">&quot;ouc&quot;</span>, <span class="hljs-string">&quot;art&quot;</span>, <span class="hljs-string">&quot;^i&quot;</span>, <span class="hljs-string">&quot;Po&quot;</span>, <span class="hljs-string">&quot;callPhantom&quot;</span>, <span class="hljs-string">&quot;max&quot;</span>, <span class="hljs-string">&quot;Hei&quot;</span>, <span class="hljs-string">&quot;ActiveXObject&quot;</span>, <span class="hljs-string">&quot;nd&quot;</span>, <span class="hljs-string">&quot;yG&amp;Y]\x17\x15ZUG#A]Ez\x15qY5\x1b&quot;</span>, <span class="hljs-string">&quot;\u2576\u097e\u094e\u09f8\u09a6\u0938\u09b6\u09fe\u0996\u09d7\u09a7\u09d2\u09cc&quot;</span>, <span class="hljs-string">&quot;Maxthon&quot;</span>, <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;opr&quot;</span>, <span class="hljs-string">&quot;chrome&quot;</span>, <span class="hljs-string">&quot;BIDUBrowser&quot;</span>, <span class="hljs-string">&quot;QQBro&quot;</span>, <span class="hljs-string">&quot;[_$ZUR&quot;</span>, <span class="hljs-string">&quot;UBrowser&quot;</span>, <span class="hljs-string">&quot;MSGesture&quot;</span>, <span class="hljs-string">&quot;plugins&quot;</span>, <span class="hljs-string">&quot;doNotTrack&quot;</span>, <span class="hljs-string">&quot;ShockwaveFlash.ShockwaveFlash&quot;</span>, <span class="hljs-string">&quot;]C|\x18&quot;</span>, <span class="hljs-string">&quot;webgl2&quot;</span>, <span class="hljs-string">&quot;platform&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;^Win32&quot;</span>, <span class="hljs-string">&quot;^MacIntel&quot;</span>, <span class="hljs-string">&quot;^Linux [ix]\\d+&quot;</span>, <span class="hljs-string">&quot;^BlackBerry&quot;</span>, <span class="hljs-string">&quot;language&quot;</span>, <span class="hljs-string">&quot;getPlatform&quot;</span>, <span class="hljs-string">&quot;getBrowserIndex&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-string">&quot;1100&quot;</span>, <span class="hljs-string">&quot;\t\0&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>, <span class="hljs-number">256</span>, <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;TTP&quot;</span>, <span class="hljs-string">&quot;et&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;al&quot;</span>, <span class="hljs-string">&quot;\u255e&quot;</span>, <span class="hljs-string">&quot;base&quot;</span>, <span class="hljs-string">&quot;\u2569\u0975\u094e\u09e5\u09a0\u092e\u09d1\u09ed\u09ce&quot;</span>, <span class="hljs-string">&quot;target&quot;</span>, <span class="hljs-string">&quot;fh%PTQr&quot;</span>, <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;\u255f\u097c\u0949\u09f9&quot;</span>, <span class="hljs-number">97</span>, <span class="hljs-string">&quot;rg&quot;</span>, <span class="hljs-string">&quot;tnemelEcrs&quot;</span>, <span class="hljs-string">&quot;fn_Ws&quot;</span>, <span class="hljs-string">&quot;parentNode&quot;</span>, <span class="hljs-string">&quot;tagName&quot;</span>, <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;submit&quot;</span>, <span class="hljs-string">&quot;PX%&quot;</span>, <span class="hljs-string">&quot;me&quot;</span>, <span class="hljs-string">&quot;host&quot;</span>, <span class="hljs-string">&quot;\\.?&quot;</span>, <span class="hljs-string">&quot;d\x19&quot;</span>, <span class="hljs-string">&quot;Fri, 01 Feb 2050 00:00:00 GMT&quot;</span>, <span class="hljs-string">&quot;]E%&quot;</span>, <span class="hljs-string">&quot;toString&quot;</span>, <span class="hljs-string">&quot;[object Request]&quot;</span>, <span class="hljs-string">&quot;headers&quot;</span>, <span class="hljs-number">83</span>, <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-built_in">encodeURIComponent</span>, <span class="hljs-string">&quot;open&quot;</span>, <span class="hljs-string">&quot;getAllResponseHeaders&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;tseuqeRpttHLMX&quot;</span>, <span class="hljs-string">&quot;Window&quot;</span>, <span class="hljs-string">&quot;\u2564\u095e&quot;</span>, <span class="hljs-string">&quot;RI&quot;</span>, <span class="hljs-string">&quot;\u2550\u0953&quot;</span>, <span class="hljs-string">&quot;(YaZ&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;_str&quot;</span>, <span class="hljs-string">&quot;V587&quot;</span>];<br><br><br><span class="hljs-keyword">var</span> r, e, a, n;<br>r = e = a = n = duan;<br><span class="hljs-keyword">var</span> u, c, s, t;<br>u = c = s = t = chang;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ot</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n, t, e;<br>    n = t = e = c;<br>    <span class="hljs-keyword">var</span> a, o, i;<br>    a = o = i = r;<br>    <span class="hljs-keyword">var</span> u = <span class="hljs-variable language_">arguments</span>[a[<span class="hljs-number">52</span>]];<br>    <span class="hljs-keyword">if</span> (!u)<br>        <span class="hljs-keyword">return</span> o[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = a[<span class="hljs-number">0</span>], v = n[<span class="hljs-number">267</span>], f = o[<span class="hljs-number">200</span>], l = t[<span class="hljs-number">2</span>]; l &lt; u.<span class="hljs-property">length</span>; l++) &#123;<br>        <span class="hljs-keyword">var</span> p = u.<span class="hljs-title function_">charCodeAt</span>(l);<br>        f = (f + t[<span class="hljs-number">0</span>]) % v.<span class="hljs-property">length</span>,<br>            p ^= v.<span class="hljs-title function_">charCodeAt</span>(f),<br>            s += i[<span class="hljs-number">2</span>].<span class="hljs-title function_">fromCharCode</span>(p)<br>    &#125;<br>    <span class="hljs-keyword">return</span> s<br>&#125;<br><br><span class="hljs-keyword">var</span> qn = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n, t, r;<br>    n = t = r = a;<br>    <span class="hljs-keyword">var</span> e, o, i;<br>    e = o = i = s;<br>    <span class="hljs-keyword">var</span> u = o[<span class="hljs-number">15</span>]<br>        , c = o[<span class="hljs-number">102</span>]<br>        , f = e[<span class="hljs-number">103</span>];<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">r</span>) &#123;<br>        <span class="hljs-keyword">var</span> a = o[<span class="hljs-number">102</span>]<br>            , i = e[<span class="hljs-number">103</span>];<br>        <span class="hljs-variable language_">this</span>[n[<span class="hljs-number">76</span>]] = r;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = t[<span class="hljs-number">52</span>], c = r[<span class="hljs-string">&quot;length&quot;</span>]; u &lt; c; u++)<br>            <span class="hljs-variable language_">this</span>[u] = t[<span class="hljs-number">52</span>]<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> l[<span class="hljs-string">&quot;prototype&quot;</span>][<span class="hljs-string">&quot;toBuffer&quot;</span>] = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = e[<span class="hljs-number">105</span>], u = <span class="hljs-variable language_">this</span>[a + <span class="hljs-string">&quot;ileds&quot;</span>], c = [], s = -e[<span class="hljs-number">0</span>], v = o[<span class="hljs-number">2</span>], f = u[r[<span class="hljs-number">56</span>]]; v &lt; f; v++)<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> l = <span class="hljs-variable language_">this</span>[v], p = u[v], d = s += p; c[d] = l &amp; <span class="hljs-built_in">parseInt</span>(t[<span class="hljs-number">77</span>], n[<span class="hljs-number">78</span>]),<br>            --p != r[<span class="hljs-number">52</span>];)<br>                --d,<br>                    l &gt;&gt;= <span class="hljs-built_in">parseInt</span>(n[<span class="hljs-number">79</span>], i[<span class="hljs-number">106</span>]);<br>        <span class="hljs-keyword">return</span> c<br>    &#125;<br>        ,<br>        l[<span class="hljs-string">&quot;prototype&quot;</span>][<span class="hljs-string">&quot;decodeBuffer&quot;</span>] = <span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = e[<span class="hljs-number">8</span>], a = <span class="hljs-variable language_">this</span>[<span class="hljs-title function_">ot</span>(e[<span class="hljs-number">108</span>], e[<span class="hljs-number">109</span>])], o = t[<span class="hljs-number">52</span>], u = e[<span class="hljs-number">2</span>], s = a[c + r + f]; u &lt; s; u++) &#123;<br>                <span class="hljs-keyword">var</span> v = a[u]<br>                    , l = i[<span class="hljs-number">2</span>];<br>                <span class="hljs-keyword">do</span> &#123;<br>                    l = (l &lt;&lt; t[<span class="hljs-number">82</span>]) + n[o++]<br>                &#125; <span class="hljs-keyword">while</span> (--v &gt; t[<span class="hljs-number">52</span>]);<br>                <span class="hljs-variable language_">this</span>[u] = l &gt;&gt;&gt; i[<span class="hljs-number">2</span>]<br>            &#125;<br>        &#125;<br>        ,<br>        l<br>&#125;()<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">timeNow</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> time = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(), time / <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&#x27;1111101000&#x27;</span>, <span class="hljs-number">2</span>) &gt;&gt;&gt; <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">at</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n, t, r;<br>    n = t = r = u;<br>    <span class="hljs-keyword">var</span> a, o, i;<br>    a = o = i = e;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-variable language_">arguments</span>[o[<span class="hljs-number">52</span>]];<br>    <span class="hljs-keyword">if</span> (!c)<br>        <span class="hljs-keyword">return</span> t[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = o[<span class="hljs-number">0</span>], v = o[<span class="hljs-number">1</span>], f = a[<span class="hljs-number">52</span>]; f &lt; c.<span class="hljs-property">length</span>; f++) &#123;<br>        <span class="hljs-keyword">var</span> l = c.<span class="hljs-title function_">charCodeAt</span>(f)<br>            , p = l ^ v;<br>        v = v * f % n[<span class="hljs-number">222</span>] + o[<span class="hljs-number">200</span>],<br>            s += i[<span class="hljs-number">2</span>].<span class="hljs-title function_">fromCharCode</span>(p)<br>    &#125;<br>    <span class="hljs-keyword">return</span> s<br>&#125;<br><br><span class="hljs-keyword">var</span> zn;<br>!<span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = s[<span class="hljs-number">13</span>]<br>        , o = c[<span class="hljs-number">53</span>]<br>        , i = r[<span class="hljs-number">83</span>]<br>        , f = r[<span class="hljs-number">84</span>]<br>        , l = s[<span class="hljs-number">110</span>]<br>        , d = r[<span class="hljs-number">85</span>]<br>        , h = r[<span class="hljs-number">86</span>];<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">n, a, o, i, u</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = s[<span class="hljs-number">13</span>], v = r[<span class="hljs-number">87</span>], f = n[s[<span class="hljs-number">111</span>]]; a &lt; f;)<br>            o[i++] = n[a++] ^ u &amp; <span class="hljs-built_in">parseInt</span>(c + v + t + <span class="hljs-string">&quot;11&quot;</span>, r[<span class="hljs-number">88</span>]),<br>                u = ~(u * <span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">89</span>], e[<span class="hljs-number">82</span>]))<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">w</span>(<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = c[<span class="hljs-number">112</span>], i = r[<span class="hljs-number">52</span>], v = n[s[<span class="hljs-number">111</span>]], f = []; i &lt; v;) &#123;<br>            <span class="hljs-keyword">var</span> l = n[i++] &lt;&lt; <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;1&quot;</span> + t, c[<span class="hljs-number">113</span>]) | n[i++] &lt;&lt; e[<span class="hljs-number">82</span>] | n[i++];<br>            f.<span class="hljs-title function_">push</span>(m.<span class="hljs-title function_">charAt</span>(l &gt;&gt; <span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">90</span>], e[<span class="hljs-number">82</span>])), m.<span class="hljs-title function_">charAt</span>(l &gt;&gt; <span class="hljs-built_in">parseInt</span>(s[<span class="hljs-number">114</span>], e[<span class="hljs-number">78</span>]) &amp; <span class="hljs-built_in">parseInt</span>(a[<span class="hljs-number">91</span>], r[<span class="hljs-number">88</span>])), m.<span class="hljs-title function_">charAt</span>(l &gt;&gt; u[<span class="hljs-number">59</span>] &amp; <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;6&quot;</span> + o, a[<span class="hljs-number">78</span>])), m.<span class="hljs-title function_">charAt</span>(l &amp; <span class="hljs-built_in">parseInt</span>(a[<span class="hljs-number">92</span>], u[<span class="hljs-number">113</span>])))<br>        &#125;<br>        <span class="hljs-keyword">return</span> f.<span class="hljs-title function_">join</span>(e[<span class="hljs-number">0</span>])<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> m = <span class="hljs-title function_">at</span>(u[<span class="hljs-number">115</span>], s[<span class="hljs-number">116</span>]), I = &#123;&#125;, y = u[<span class="hljs-number">2</span>]; y &lt; <span class="hljs-built_in">parseInt</span>(i + <span class="hljs-string">&quot;0&quot;</span>, e[<span class="hljs-number">93</span>]); y++)<br>        I[m.<span class="hljs-title function_">charAt</span>(y)] = y;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">O</span>(<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, r, e;<br>        t = r = e = s;<br>        <span class="hljs-keyword">var</span> o, i, u;<br>        o = i = u = a;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-title function_">ot</span>(i[<span class="hljs-number">94</span>]), l = e[<span class="hljs-number">2</span>], p = n[o[<span class="hljs-number">56</span>]], d = []; l &lt; p;) &#123;<br>            <span class="hljs-keyword">var</span> h = I[n.<span class="hljs-title function_">charAt</span>(l++)] &lt;&lt; <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">at</span>(t[<span class="hljs-number">117</span>]), u[<span class="hljs-number">82</span>]) | I[n.<span class="hljs-title function_">charAt</span>(l++)] &lt;&lt; <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">v</span>(t[<span class="hljs-number">118</span>], u[<span class="hljs-number">95</span>], e[<span class="hljs-number">119</span>]), o[<span class="hljs-number">88</span>]) | I[n.<span class="hljs-title function_">charAt</span>(l++)] &lt;&lt; t[<span class="hljs-number">59</span>] | I[n.<span class="hljs-title function_">charAt</span>(l++)];<br>            d.<span class="hljs-title function_">push</span>(h &gt;&gt; <span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">120</span>], t[<span class="hljs-number">106</span>]), h &gt;&gt; <span class="hljs-built_in">parseInt</span>(t[<span class="hljs-number">121</span>], r[<span class="hljs-number">122</span>]) &amp; <span class="hljs-built_in">parseInt</span>(f + b + c, t[<span class="hljs-number">106</span>]), h &amp; <span class="hljs-built_in">parseInt</span>(o[<span class="hljs-number">96</span>], u[<span class="hljs-number">88</span>]))<br>        &#125;<br>        <span class="hljs-keyword">return</span> d<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">D</span>(<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = <span class="hljs-title function_">O</span>(n);<br>        <span class="hljs-keyword">if</span> (rn,<br>            p,<br>        t[r[<span class="hljs-number">52</span>]] != h)<br>            <span class="hljs-keyword">return</span> error = T + B + l,<br>                <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">var</span> a = t[c[<span class="hljs-number">0</span>]]<br>            , o = [];<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">g</span>(t, +<span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">79</span>], c[<span class="hljs-number">122</span>]), o, +u[<span class="hljs-number">2</span>], a),<br>            <span class="hljs-title function_">x</span>(o) == a ? o : <span class="hljs-keyword">void</span> <span class="hljs-number">0</span><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">x</span>(<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = c[<span class="hljs-number">2</span>], i = a[<span class="hljs-number">52</span>], u = n[c[<span class="hljs-number">111</span>]]; i &lt; u; i++)<br>            e = (e &lt;&lt; s[<span class="hljs-number">123</span>]) - e + n[i];<br>        <span class="hljs-keyword">return</span> e &amp; <span class="hljs-built_in">parseInt</span>(s[<span class="hljs-number">124</span>], r[<span class="hljs-number">88</span>])<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">N</span>(<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = &#123;&#125;<br>            , r = <span class="hljs-title function_">x</span>(n)<br>            , e = [h, r];<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">g</span>(n, +a[<span class="hljs-number">52</span>], e, +a[<span class="hljs-number">88</span>], r),<br><br>            <span class="hljs-title function_">w</span>(e)<br>    &#125;<br><br>    n[<span class="hljs-string">&quot;base64Encode&quot;</span>] = w,<br>        n[<span class="hljs-string">&quot;base64Decode&quot;</span>] = O,<br>        n[<span class="hljs-string">&quot;encode&quot;</span>] = N,<br>        n[<span class="hljs-string">&quot;decode&quot;</span>] = D<br>&#125;(zn || (zn = &#123;&#125;));<br><br><span class="hljs-comment">// var rt;</span><br><span class="hljs-comment">// !function (n) &#123;</span><br>n = &#123;&#125;;<br><span class="hljs-keyword">var</span> t = e[<span class="hljs-number">87</span>], o = a[<span class="hljs-number">8</span>], i = e[<span class="hljs-number">8</span>], f = s[<span class="hljs-number">215</span>], l = r[<span class="hljs-number">52</span>], p = s[<span class="hljs-number">0</span>], d = <span class="hljs-built_in">parseInt</span>(c[<span class="hljs-number">216</span>], u[<span class="hljs-number">122</span>]), h = e[<span class="hljs-number">86</span>],<br>    g = u[<span class="hljs-number">217</span>], w = u[<span class="hljs-number">123</span>], m = e[<span class="hljs-number">165</span>], I = <span class="hljs-built_in">parseInt</span>(t + <span class="hljs-string">&quot;1&quot;</span>, c[<span class="hljs-number">122</span>]), y = <span class="hljs-built_in">parseInt</span>(a[<span class="hljs-number">79</span>], a[<span class="hljs-number">82</span>]), _ = c[<span class="hljs-number">218</span>],<br>    C = <span class="hljs-built_in">parseInt</span>(a[<span class="hljs-number">193</span>], e[<span class="hljs-number">82</span>]), E = <span class="hljs-built_in">parseInt</span>(o + i, r[<span class="hljs-number">78</span>]), A = <span class="hljs-built_in">parseInt</span>(u[<span class="hljs-number">219</span>], s[<span class="hljs-number">122</span>]),<br>    b = <span class="hljs-built_in">parseInt</span>(f + <span class="hljs-string">&quot;5&quot;</span>, s[<span class="hljs-number">106</span>]), T = <span class="hljs-built_in">parseInt</span>(r[<span class="hljs-number">194</span>], s[<span class="hljs-number">106</span>]), B = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">ot</span>(s[<span class="hljs-number">220</span>], e[<span class="hljs-number">195</span>]), r[<span class="hljs-number">82</span>]),<br>    R = <span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">196</span>], u[<span class="hljs-number">122</span>]), k = <span class="hljs-built_in">parseInt</span>(e[<span class="hljs-number">197</span>], a[<span class="hljs-number">78</span>]), S;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">P</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n = s[<span class="hljs-number">0</span>]<br>        , t = r[<span class="hljs-number">88</span>]<br>        , e = <span class="hljs-built_in">parseInt</span>(u[<span class="hljs-number">13</span>], c[<span class="hljs-number">122</span>])<br>        , a = s[<span class="hljs-number">217</span>];<br>    S = <span class="hljs-keyword">new</span> <span class="hljs-title function_">qn</span>([a, a, a, a, n, n, n, e, t, t, t, t, t, t, t, a, t, n]),<br>        S[p] = <span class="hljs-built_in">parseInt</span>(<span class="hljs-variable constant_">TOKEN_SERVER_TIME</span>),<br>        <span class="hljs-title function_">M</span>(),<br>        S[B] = <span class="hljs-number">0</span>,<br>        S[k] = <span class="hljs-number">3</span>,<br>        S[R] = c[<span class="hljs-number">2</span>],<br>        S[h] = <span class="hljs-number">2628939921</span>,<br>        S[b] = <span class="hljs-number">3748</span>,<br>        S[g] = <span class="hljs-number">1</span>,<br>        S[w] = <span class="hljs-number">10</span>,<br>        S[m] = <span class="hljs-number">5</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">M</span>(<span class="hljs-params"></span>) &#123;<br>    S[l] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-built_in">parseInt</span>(u[<span class="hljs-number">141</span>], r[<span class="hljs-number">78</span>]) &gt;&gt;&gt; r[<span class="hljs-number">52</span>]<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">O</span>(<span class="hljs-params"></span>) &#123;<br>    S[R]++,<br>        S[p] = <span class="hljs-built_in">parseInt</span>(<span class="hljs-variable constant_">TOKEN_SERVER_TIME</span>);<br>    S[d] = <span class="hljs-title function_">timeNow</span>(),<br>        S[B] = <span class="hljs-number">0</span>,<br>        S[I] = <span class="hljs-number">0</span>,<br>        S[y] = <span class="hljs-number">0</span>,<br>        S[_] = <span class="hljs-number">0</span>,<br>        S[C] = <span class="hljs-number">0</span>,<br>        S[E] = <span class="hljs-number">0</span>,<br>        S[A] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">var</span> n = S.<span class="hljs-title function_">toBuffer</span>();<br>    <span class="hljs-keyword">return</span> zn.<span class="hljs-title function_">encode</span>(n)<br>&#125;<br><span class="hljs-comment">// n[e[57]] = P;</span><br><span class="hljs-title function_">P</span>();<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">D</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">O</span>()<br>&#125;<br><br><span class="hljs-comment">// console.log(D())</span><br><br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ob混淆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>识货app免更新过拦截器获取免加密数据</title>
      <link href="/2022/10/04/%E8%AF%86%E8%B4%A7app%E5%85%8D%E6%9B%B4%E6%96%B0%E8%BF%87%E6%8B%A6%E6%88%AA%E5%99%A8%E8%8E%B7%E5%8F%96%E5%85%8D%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE/"/>
      <url>/2022/10/04/%E8%AF%86%E8%B4%A7app%E5%85%8D%E6%9B%B4%E6%96%B0%E8%BF%87%E6%8B%A6%E6%88%AA%E5%99%A8%E8%8E%B7%E5%8F%96%E5%85%8D%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:识货v7.20.1</p><p>接口：<a href="https://sh-api.shihuo.cn/daga/search/goods/v1?minVersion=15670&clientCode=%7Bholder%7D">https://sh-api.shihuo.cn/daga/search/goods/v1?minVersion=15670&amp;clientCode=%7Bholder%7D</a></p><p>&amp;v&#x3D;7.20.1&amp;channel&#x3D;huawei&amp;device&#x3D;Pixel%203a&amp;platform&#x3D;android&amp;timestamp&#x3D;1684553856312&amp;tok</p><p>en&#x3D;c0df5113c555827f6e0c294b227d2b7b</p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>首先打开app,发现需要更新，我们先尝试一下断网进入，先清除缓存，在断网进入，发现可以过更新，但是好像抓不到包</p><p><img src="/images/image-20230520105956191.png" alt="image-20230520105956191"></p><p><img src="/images/image-20230520110351724.png" alt="image-20230520110351724"></p><p>先用jadx打开app进行反编译，看一下源码，先看下能不能过掉强制更新,搜索关键字版本,发现UpdateDialog方法是进行版本更新的主要方法，我们可以直接让这个方法返回为空，就可以过掉更新</p><p><img src="/images/image-20230520110601501.png" alt="image-20230520110601501"></p><p><img src="/images/image-20230520110803831.png" alt="image-20230520110803831"></p><p>使用frida hook UpdateDialog方法，不返回任何数据，可以直接过掉更新，需要注意的是，frida启动需要用spawn注入模式，因为更新是在app刚启动就进行了检测</p><p><img src="/images/image-20230520111044874.png" alt="image-20230520111044874"></p><p>在操作app的时候，也是发现app有提示检测到在root环境下运行，我们可以尝试删除该app下的libmsaoaidsec.so文件，很多app都是基于jni操作c语言来进行root检测，这也是常见的反调试手段,打开mt管理器，找到该app下的lib目录，删除该文件</p><p><img src="/images/image-20230520113141447.png" alt="image-20230520113141447"></p><p>抓包后，发现根本抓不到任何有用的包,有可能是未走系统代理</p><p><img src="/images/image-20230520113359191.png" alt="image-20230520113359191"></p><p>我们用vpn转发的形式进行抓包，先关掉系统代理，打开SocksDroid，设置charles socks代理转发,再添加对应的app</p><p><img src="/images/image-20230520113625741.png" alt="image-20230520113625741"></p><p><img src="/images/image-20230520113720956.png" alt="image-20230520113720956"></p><p>这边就可以正常进行搜索抓包了</p><p><img src="/images/image-20230520113914636.png" alt="image-20230520113914636"></p><p>我们先看下搜索接口，发现有很多参数，我们可以大胆尝试，去掉某些参数看一下是否能正常请求，结果测试，发现只要更改关键字，就可以获取到对应的返回数据，我用上一个包的请求参数，只更改关键字，即可获得对应的返回数据</p><p><img src="/images/image-20230520115344978.png" alt="image-20230520115344978"></p><p>当我们点进商品详情页面是，我们会发现请求参数进行加密，返回参数也进行了加密，我们也可以再jadx里面搜索关键字查找该接口做了怎样的处理，也可以用另一种方法</p><p><img src="/images/image-20230520123007988.png" alt="image-20230520123007988"></p><p>hook拦截器,我们再hook免更新的时候，再hook一下会启动哪些拦截器</p><p><img src="/images/image-20230520123447724.png" alt="image-20230520123447724"></p><p>这有这几个拦截器，我们直接hook我们需要的接口会经过哪个拦截器</p><p><img src="/images/image-20230520123656369.png" alt="image-20230520123656369"></p><p>当我们再第八个拦截器选择不进入当前拦截器的时候,该接口竟然明文发送，再看charles抓包，发现返回数据也是明文，有可能该接口存在两种请求方式，一种未加密也能够返回数据的情况，</p><p><img src="/images/image-20230520124159782.png" alt="image-20230520124159782"></p><p><img src="/images/image-20230520124305891.png" alt="image-20230520124305891"></p><p>我们直接把接口请求复制下来，再python里面尝试一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>res = requests.get(<br>    url=<span class="hljs-string">&quot;https://sh-gateway.shihuo.cn/v4/services/sh-goodsapi/app_swoole_shoe/preload/single&quot;</span>,<br>    params=&#123;<br>        <span class="hljs-string">&quot;devices&quot;</span>: <span class="hljs-string">&quot;M2007J17C&quot;</span>,<br>        <span class="hljs-string">&quot;gender&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,<br>        <span class="hljs-comment"># &quot;goods_id&quot;: &quot;1936942&quot;,</span><br>        <span class="hljs-comment"># &quot;goods_id&quot;: &quot;207340&quot;,</span><br>        <span class="hljs-string">&quot;goods_id&quot;</span>: <span class="hljs-string">&quot;610691&quot;</span>,<br>        <span class="hljs-string">&quot;sourceLocation&quot;</span>: <span class="hljs-string">&quot;oneRowOne%3A%5BN%5D&quot;</span>,<br>        <span class="hljs-string">&quot;tpExtra&quot;</span>: <span class="hljs-string">&quot;%7B%22sourceTp%22%3A%22home%3Asearch%3A%22%2C%22sourceTpName%22%3A%22gy0300%22%2C%22wsf%22%3A%22normal_search_words%22%2C%22ast%22%3A%22gy0300%22%2C%22is_inspire%22%3A0%2C%22fTp%22%3A%22searchList%3Alist%3A2%22%2C%22fTpName%22%3A%22%22%2C%22dgReqId%22%3A%22SHSS_CG-KRSE3HK0KRIM_SPU_1%3A6%22%2C%22sc%22%3A%22MAIN_SEARCH%22%2C%22si%22%3A%228001%22%2C%22skc%22%3A%2241583331%22%2C%22ffTp%22%3A%22home%3Asearch%3A%22%2C%22ffTpName%22%3A%22gy0300%22%2C%22layer%22%3A%222%22%2C%22fReqId%22%3A%224EFBF304E28B1C31128622D39F8C4CE0%22%7D&quot;</span>,<br>        <span class="hljs-string">&quot;minVersion&quot;</span>: <span class="hljs-string">&quot;15670&quot;</span>,<br>        <span class="hljs-string">&quot;clientCode&quot;</span>: <span class="hljs-string">&quot;%7Bholder%7D&quot;</span>,<br>        <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;7.20.1&quot;</span>,<br>        <span class="hljs-string">&quot;channel&quot;</span>: <span class="hljs-string">&quot;huawei&quot;</span>,<br>        <span class="hljs-string">&quot;device&quot;</span>: <span class="hljs-string">&quot;M2007J17C&quot;</span>,<br>        <span class="hljs-string">&quot;platform&quot;</span>: <span class="hljs-string">&quot;android&quot;</span>,<br>        <span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;1668162743193&quot;</span>,<br>    &#125;<br>)<br><br>data_dict = res.json()<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> data_dict[<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-string">&#x27;info&#x27;</span>][<span class="hljs-string">&quot;styles&quot;</span>][<span class="hljs-string">&#x27;list&#x27;</span>]:<br>    <span class="hljs-built_in">print</span>(item[<span class="hljs-string">&#x27;name&#x27;</span>])<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> item[<span class="hljs-string">&#x27;priceAll&#x27;</span>].items():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----&quot;</span>, k, v)<br></code></pre></td></tr></table></figure><p>发现可以正常获取到鞋子的尺码信息,该app的接口都可以用明文的形式进行发送获取</p><p><img src="/images/image-20230520124916954.png" alt="image-20230520124916954"></p><p>我们再去看一下源码，看一下加密参数和返回的加密数据是用什么方式做了加密，关于尺码的那个接口返回的参数里面带有dwlength字段，我们直接去源码里面搜一下,反编译未成功，找了半天，这里可能跟base64有关，我们去看一下Base64.decode方法</p><p><img src="/images/image-20230520153315992.png" alt="image-20230520153315992"></p><p>我们直接hook一下这个方法，发现他的调用栈涉及到native层</p><p><img src="/images/image-20230520153847429.png" alt="image-20230520153847429"></p><p><img src="/images/image-20230520153829309.png" alt="image-20230520153829309"></p><p>我们回到刚刚未编译成功的那里，我们找一下.SwSdk.heracles方法,果然调用了native方法，对应的so文件时dusanwa.so</p><p><img src="/images/image-20230520154232072.png" alt="image-20230520154232072"></p><p><img src="/images/image-20230520154601358.png" alt="image-20230520154601358"></p><p>我们再mt管理器中，找到dusanwa.so，然后带着app用unidbg尝试调用</p><p><img src="/images/image-20230520155542929.png" alt="image-20230520155542929"></p><p>先将基本信息填写好</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java">ShiHuo() &#123;<br>        <span class="hljs-comment">// 1.创建设备（32位或64位模拟器）， 具体看so文件在哪个目录。 在armeabi-v7a就选择32位</span><br>        emulator = AndroidEmulatorBuilder.for32Bit().setProcessName(<span class="hljs-string">&quot;com.che168.autotradercloud&quot;</span>).build();<br><br>        <span class="hljs-comment">// 2.获取内存对象（可以操作内存）</span><br>        memory = emulator.getMemory();<br><br>        <span class="hljs-comment">// 3.设置安卓sdk版本（只支持19、23）</span><br>        memory.setLibraryResolver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AndroidResolver</span>(<span class="hljs-number">23</span>));<br><br>        <span class="hljs-comment">// 4.创建虚拟机（运行安卓代码需要虚拟机，就想运行py代码需要python解释器一样）</span><br>        vm = emulator.createDalvikVM(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;apks/shihuo/v7.20.1.apk&quot;</span>));<br>        vm.setJni(<span class="hljs-built_in">this</span>); <span class="hljs-comment">// 后续so文件，如果没用调用java中的代码；调用java代码</span><br>        <span class="hljs-comment">//vm.setVerbose(true); // 内部so文件调用过程细节</span><br><br>        <span class="hljs-comment">// 5.加载so文件</span><br>        <span class="hljs-type">DalvikModule</span> <span class="hljs-variable">dm</span> <span class="hljs-operator">=</span> vm.loadLibrary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;apks/shihuo/libdusanwa.so&quot;</span>), <span class="hljs-literal">false</span>);<br>        dm.callJNI_OnLoad(emulator);<br><br>        <span class="hljs-comment">// 6.dm代表so文件，dm.getModule()得到module对象，基于module对象可以访问so中的成员。</span><br>        <span class="hljs-keyword">module</span> = dm.getModule();<br><br>    &#125;<br></code></pre></td></tr></table></figure><p>需要注意的是 由于加密的字符串过长，java没法传入这么长的字符串，我们可以可以创建一个<code>StringBuilder</code>，然后对加密的字符串进行切割，在放进去,最后再将对应需要补的环境补进去</p><p><img src="/images/image-20230520160339481.png" alt="image-20230520160339481"></p><p><img src="/images/image-20230520160419748.png" alt="image-20230520160419748"></p><p>运行没有问题，成功返回了结果,我们也可以对这个unidbg项目进行打包，打包出来用python调用</p><p><img src="/images/image-20230520160452427.png" alt="image-20230520160452427"></p><p>打包文件架构：</p><p><img src="/images/image-20230520163254173.png" alt="image-20230520163254173"></p><p>运行结果：</p><p><img src="/images/image-20230520163213435.png" alt="image-20230520163213435"></p>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>车智赢app请求参数解析</title>
      <link href="/2022/08/04/%E8%BD%A6%E6%99%BA%E8%B5%A2app%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/08/04/%E8%BD%A6%E6%99%BA%E8%B5%A2app%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:车智赢-v3.13.0</p><p>接口：<a href="https://dealercloudapi.che168.com/tradercloud/sealed/login/login.ashx">https://dealercloudapi.che168.com/tradercloud/sealed/login/login.ashx</a></p></blockquote><h3 id="解析流程："><a href="#解析流程：" class="headerlink" title="解析流程："></a>解析流程：</h3><p>该app有root检测，但是只检测无对应措施，也无双向验证，可以正常抓包请求,经过请求发现，_sign，udid，pwd三个参数有做加密，同样使用jadx进行反编译</p><p><img src="/images/image-20230519212606790.png" alt="image-20230519212606790"></p><p>直接搜索接口地址,直接进去查看，在本页搜索LOGIN_URL看一下有谁调用,loginByPassword方法创建了一个post请求，视乎直接对密码进行md5加密，我们直接查看一下encodeMD5方法</p><p><img src="/images/image-20230519212802200.png" alt="image-20230519212802200"></p><p><img src="/images/image-20230519212907691.png" alt="image-20230519212907691"></p><p><img src="/images/image-20230519213001843.png" alt="image-20230519213001843"></p><p><img src="/../../../../imgs/image-20230519213200397.png" alt="image-20230519213200397"></p><p>直接手动写个md5加密进行验证，发现和抓包到的加密密码一致</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>obj = hashlib.md5()<br>obj.update(<span class="hljs-string">&quot;123456&quot;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>res = obj.hexdigest()<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-comment"># e10adc3949ba59abbe56e057f20f883e</span><br></code></pre></td></tr></table></figure><p>也可以再hook一下loginByPassword和loginByPassword方法，看一下是否和我们的结果一样,结果一致</p><p><img src="/images/image-20230519213857443.png" alt="image-20230519213857443"></p><p>直接搜索_sign,结果不多，可以都点进去看一下，这里直接进到这个key_sign里面去</p><p><img src="/images/image-20230519214253860.png" alt="image-20230519214253860"></p><p>发现这里定义了请求头里面的一些参数，我们直接搜KEY_SIGN看下有谁调用了,getRequestParams方法这里视乎对sign加密前的参数做了一些处理，我们看一下signByType方法</p><p><img src="/images/image-20230519214408535.png" alt="image-20230519214408535"></p><p><img src="/images/image-20230519214553870.png" alt="image-20230519214553870"></p><p>我们直接hook一下signByType方法看一下，发现加入的参数就是请求体，再看一下signByType的逻辑，就是循环请求体，然后拼接键值对，再开头和结尾加一个KEY_V2，这个参数固定是W@oC!AH_6Ew1f6%8,所以我们得先解决uuid是什么</p><p><img src="/images/image-20230519214715033.png" alt="image-20230519214715033"></p><p><img src="/images/image-20230519215325529.png" alt="image-20230519215325529"></p><p>接下来搜索”udid” 结果不多，我们直接看第二个,再看下getUDID方法，发现好像是一个3des加密，encode3Des方法传入两个参数，一个是Context还未知，一个是sb，我们对sb参数简写一下，REPORT_VAL_SEPARATOR是”|”固定，</p><p><img src="/images/image-20230519215900147.png" alt="image-20230519215900147"></p><p><img src="/images/image-20230519215930693.png" alt="image-20230519215930693"></p><p><img src="/images/image-20230519220006480.png" alt="image-20230519220006480"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sb = getDeviceId(context) + &quot;|&quot; + System.nanoTime()  + &quot;|&quot; + userDeviceId<br></code></pre></td></tr></table></figure><p>我们也可以hook一下encode3Des方法，看一下传入的参数是什么样的，然后我们再去追究一下sb的参数内容是什么</p><p><img src="/images/image-20230519220852460.png" alt="image-20230519220852460"></p><p><img src="/images/image-20230519220908552.png" alt="image-20230519220908552"></p><p>回到getUDID方法处，先看下getDeviceId(context)是什么，进去之后发现getDeviceId反编译未成功，我们重新把app拖进去反编译一下，getUDI方法总体逻辑没变，只是里面的一些参数名称变了getDeviceId方法变成了getIMEI方法，这里不用管，反编译问题，我们进去看getIMEI是什么</p><p><img src="/images/image-20230519224721143.png" alt="image-20230519224721143"></p><p>进去之后发现调用了getIMEIbyAndroidIDandUUID方法，返回的是一个随机uuid，这个可以直接用str(uuid.uuid4())方法生成</p><p><img src="/images%5Cimage-20230519224952693.png" alt="image-20230519224952693"></p><p>第二个参数System.nanoTime()，百度了一下这个方法，有点类似于开机到现在系统的时间差，比如你开机的时间错是11111，现在的时间是11222，那么System.nanoTime()就是两者之差，我们也可以直接用random再两个范围内随机获取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">random.randint(<span class="hljs-number">5136066335773</span>,<span class="hljs-number">7136066335773</span>)<br></code></pre></td></tr></table></figure><p>第三个参数getDeviceId，点进去看一下,发现有一个saveDeviceId和一个getDeviceId方法，我们猜测这个id应该跟系统有关，可能是先存了，在获取，所以我们可以直接hook  saveDeviceId这个方法</p><p><img src="/images/image-20230519225721399.png" alt="image-20230519225721399"></p><p>hook之前需要先清空缓存，毕竟先做了存储,发现这个id跟<a href="https://dealercloudapi.che168.com/tradercloud/v100/push/regdevice.ashx">https://dealercloudapi.che168.com/tradercloud/v100/push/regdevice.ashx</a></p><p>这个接口的返回数据一样，猜测是这个接口对deviceid做了处理，我们可以先将deviceid固定，到后面测试的时候，将其切换成空试试，搜了一圈，这个玩意视乎和一个叫做个推id的东西有关</p><p><img src="/images/image-20230519230711425.png" alt="image-20230519230711425"></p><p>接下来我们看encode3Des方法,明文已知，iv值是固定值appapich，现在就差加密的key，我们直接看getDesKey方法,发现最终调用的是native的方法，对应的so文件名称是native-lib</p><p><img src="/images/image-20230519231803505.png" alt="image-20230519231803505"></p><p><img src="/images/image-20230519232935884.png" alt="image-20230519232935884"></p><p><img src="/images/image-20230519233015996.png" alt="image-20230519233015996"></p><p>我们直接hook  getDesKey方法，看下会返回什么，多请求几次发现值始终是固定的，这下key也知道了<code>appapiche168comappapiche168comap</code></p><p><img src="/images%5Cimage-20230519234840426.png" alt="image-20230519234840426"></p><p>我们再hook一下encode3Des方法，然后加加密参数放到在线网站里面进行加密尝试,发现结果相同，说明是标准的3des加密 我们直接改写python代码</p><p><img src="/images/image-20230519235733987.png" alt="image-20230519235733987"></p><p><img src="/images/image-20230519235813462.png" alt="image-20230519235813462"></p><p>经过测试之后，也是发现deviceid是可以为空的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">des3</span>(<span class="hljs-params">data_string</span>):<br>    <span class="hljs-built_in">print</span>(data_string)<br>    BS = <span class="hljs-number">8</span><br>    pad = <span class="hljs-keyword">lambda</span> s: s + (BS - <span class="hljs-built_in">len</span>(s) % BS) * <span class="hljs-built_in">chr</span>(BS - <span class="hljs-built_in">len</span>(s) % BS)<br>    <span class="hljs-built_in">print</span>(pad)<br>    <span class="hljs-comment"># 3DES的MODE_CBC模式下只有前24位有意义</span><br>    key = <span class="hljs-string">b&#x27;appapiche168comappapiche168comap&#x27;</span>[<span class="hljs-number">0</span>:<span class="hljs-number">24</span>]<br>    iv = <span class="hljs-string">b&#x27;appapich&#x27;</span><br><br>    plaintext = pad(data_string).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-built_in">print</span>(plaintext)<br>    <span class="hljs-comment"># 使用MODE_CBC创建cipher</span><br>    cipher = DES3.new(key, DES3.MODE_CBC, iv)<br>    result = cipher.encrypt(plaintext)<br>    <span class="hljs-keyword">return</span> base64.b64encode(result).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">data_string</span>):<br>    obj = hashlib.md5()<br><br>    obj.update(data_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br>    <span class="hljs-keyword">return</span> obj.hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>    username = <span class="hljs-string">&quot;18877765431&quot;</span><br>    passwrod = <span class="hljs-string">&quot;123456&quot;</span><br><br>    imei = <span class="hljs-built_in">str</span>(uuid.uuid4())<br>    nano_time = random.randint(<span class="hljs-number">5136066335773</span>, <span class="hljs-number">7136066335773</span>)<br>    device_id = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># 290001</span><br>    udid = des3(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;imei&#125;</span>|<span class="hljs-subst">&#123;nano_time&#125;</span>|<span class="hljs-subst">&#123;device_id&#125;</span>&quot;</span>)<br><br>    data = <span class="hljs-string">&quot;W@oC!AH_6Ew1f6%8&quot;</span><br>    data_dict = &#123;<br>        <span class="hljs-string">&quot;_appid&quot;</span>: <span class="hljs-string">&quot;atc.android&quot;</span>,<br>        <span class="hljs-string">&quot;appversion&quot;</span>: <span class="hljs-string">&quot;3.4.0&quot;</span>,<br>        <span class="hljs-string">&quot;channelid&quot;</span>: <span class="hljs-string">&quot;csy&quot;</span>,<br>        <span class="hljs-string">&quot;pwd&quot;</span>: md5(passwrod),<br>        <span class="hljs-string">&quot;udid&quot;</span>: udid,<br>        <span class="hljs-string">&quot;username&quot;</span>: username<br>    &#125;<br><br>    result = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-string">&quot;&#123;&#125;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(key, data_dict[key]) <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(data_dict.keys())])<br>    un_sign_string = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;data&#125;</span><span class="hljs-subst">&#123;result&#125;</span><span class="hljs-subst">&#123;data&#125;</span>&quot;</span><br>    sign = md5(un_sign_string).upper()<br>    data_dict[<span class="hljs-string">&#x27;_sign&#x27;</span>] = sign<br>    <span class="hljs-built_in">print</span>(md5(passwrod))<br>    res = requests.post(<br>        url=<span class="hljs-string">&quot;https://dealercloudapi.che168.com/tradercloud/sealed/login/login.ashx&quot;</span>,<br>        data=data_dict<br>    )<br><br>    <span class="hljs-built_in">print</span>(res.text)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    run()<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> DES3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>艺恩数据ob混淆DES响应体加密解析</title>
      <link href="/2022/04/21/%E8%89%BA%E6%81%A9%E6%95%B0%E6%8D%AEob%E6%B7%B7%E6%B7%86DES%E5%93%8D%E5%BA%94%E4%BD%93%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/04/21/%E8%89%BA%E6%81%A9%E6%95%B0%E6%8D%AEob%E6%B7%B7%E6%B7%86DES%E5%93%8D%E5%BA%94%E4%BD%93%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://www.endata.com.cn/BoxOffice/BO/Year/index.html">https://www.endata.com.cn/BoxOffice/BO/Year/index.html</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>响应体是一堆看不懂的英文加数字，打上xhr断点查看</p><p><img src="/images/image-20230517221341035.png" alt="image-20230517221341035"></p><p>再ajax请求这里，响应成功后对数据进行梳理,这里是一个三元运算，解开来回好看一点</p><p><img src="/images/image-20230517221441214.png" alt="image-20230517221441214"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-number">1</span> == (e = <span class="hljs-string">&quot;&#123;&quot;</span> == e[<span class="hljs-number">0</span>] ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e) : <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(webInstace.<span class="hljs-title function_">shell</span>(e))).<span class="hljs-property">Status</span> || <span class="hljs-number">200</span> == e.<span class="hljs-property">Code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">Data</span>) : <span class="hljs-number">200</span> == e.<span class="hljs-property">code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">data</span>) : <span class="hljs-title function_">a</span>(e.<span class="hljs-property">Msg</span>)<br></code></pre></td></tr></table></figure><p>这里可以这样拆解：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-number">1</span> == (<br><br>e = <span class="hljs-string">&quot;&#123;&quot;</span> == e[<span class="hljs-number">0</span>] ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e) : <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(webInstace.<span class="hljs-title function_">shell</span>(e))<br><br>).<span class="hljs-property">Status</span> || <span class="hljs-number">200</span> == e.<span class="hljs-property">Code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">Data</span>) : <span class="hljs-number">200</span> == e.<span class="hljs-property">code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">data</span>) : <span class="hljs-title function_">a</span>(e.<span class="hljs-property">Msg</span>)<br></code></pre></td></tr></table></figure><p>再拆,先走e里面的条件，因为e是响应体，所有一定要走JSON.parse(webInstace.shell(e))</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">e = (<br>    <span class="hljs-comment">// &quot;&#123;&quot; == e[0] ? JSON.parse(e) : JSON.parse(webInstace.shell(e))</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;&#123;&quot;</span> == e[<span class="hljs-number">0</span>])&#123;<br>        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(webInstace.<span class="hljs-title function_">shell</span>(e))<br>    &#125;<br><br>)<br><span class="hljs-number">1</span> == e.<span class="hljs-property">status</span> || <span class="hljs-number">200</span> == e.<span class="hljs-property">Code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">Data</span>) : <span class="hljs-number">200</span> == e.<span class="hljs-property">code</span> ? <span class="hljs-title function_">r</span>(e.<span class="hljs-property">data</span>) : <span class="hljs-title function_">a</span>(e.<span class="hljs-property">Msg</span>)<br></code></pre></td></tr></table></figure><p>查看 webInstace.shell发现是ob混淆</p><p><img src="/images/image-20230517222847207.png" alt="image-20230517222847207"></p><p>需要先将下面的控制流给解出来，**_0x492a62**代表着控制流的走向，通过去掉不必要的代码进行还原</p><p><img src="/images/image-20230517223127101.png" alt="image-20230517223127101"></p><p>解出来其实就二十来行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto-js&#x27;</span>)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">datas</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x9843d3 = <span class="hljs-keyword">function</span> (<span class="hljs-params">data1, data2, data3</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == data2)<br>            <span class="hljs-keyword">return</span> data1[<span class="hljs-string">&#x27;substr&#x27;</span>](data3);<br>        <span class="hljs-keyword">var</span> _0x48914b;<br>        _0x48914b = <span class="hljs-string">&#x27;&#x27;</span> + data1[<span class="hljs-string">&#x27;substr&#x27;</span>](<span class="hljs-number">0</span>, data2);<br>        <span class="hljs-keyword">return</span> _0x48914b += data1[<span class="hljs-string">&#x27;substr&#x27;</span>](data2 + data3);<br>    &#125;;<br><br>    <span class="hljs-keyword">var</span> _0x554c90 = <span class="hljs-built_in">parseInt</span>(datas[datas[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">1</span>], <span class="hljs-number">16</span>) + <span class="hljs-number">9</span><br>        , _0x2cf8ae = <span class="hljs-built_in">parseInt</span>(datas[_0x554c90], <span class="hljs-number">16</span>);<br>    datas = <span class="hljs-title function_">_0x9843d3</span>(datas, _0x554c90, <span class="hljs-number">1</span>);<br>    _0x554c90 = datas[<span class="hljs-string">&#x27;substr&#x27;</span>](_0x2cf8ae, <span class="hljs-number">8</span>);<br>    datas = <span class="hljs-title function_">_0x9843d3</span>(datas, _0x2cf8ae, <span class="hljs-number">8</span>);<br>    _0x2cf8ae = <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](_0x554c90);<br>    _0x554c90 = <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](_0x554c90);<br><br>    _0x554c90 = <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;DES&#x27;</span>][<span class="hljs-string">&#x27;decrypt&#x27;</span>](&#123;<br>        <span class="hljs-string">&#x27;ciphertext&#x27;</span>: <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Hex&#x27;</span>][<span class="hljs-string">&#x27;parse&#x27;</span>](datas)<br>    &#125;, _0x2cf8ae, &#123;<br>        <span class="hljs-string">&#x27;iv&#x27;</span>: _0x554c90,<br>        <span class="hljs-string">&#x27;mode&#x27;</span>: <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;mode&#x27;</span>][<span class="hljs-string">&#x27;ECB&#x27;</span>],<br>        <span class="hljs-string">&#x27;padding&#x27;</span>: <span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;pad&#x27;</span>][<span class="hljs-string">&#x27;Pkcs7&#x27;</span>]<br>    &#125;)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-title class_">CryptoJS</span>[<span class="hljs-string">&#x27;enc&#x27;</span>][<span class="hljs-string">&#x27;Utf8&#x27;</span>]);<br><br><br>    <span class="hljs-keyword">return</span> _0x554c90[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">0</span>, _0x554c90[<span class="hljs-string">&#x27;lastIndexOf&#x27;</span>](<span class="hljs-string">&#x27;&#125;&#x27;</span>) + <span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">var</span> data = <span class="hljs-title function_">decrypt</span>(<span class="hljs-string">&quot;AAA1C52DF84D2ECBDF175E5DA7A1E3F2072xxxxxxxxxxxxxxxxxxx&quot;</span>)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br><br><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ob混淆 </tag>
            
            <tag> DES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安居客滑块验证码AES加密解析</title>
      <link href="/2022/04/08/%E5%AE%89%E5%B1%85%E5%AE%A2%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E7%A0%81AES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/04/08/%E5%AE%89%E5%B1%85%E5%AE%A2%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E7%A0%81AES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网页链接：<a href="https://www.anjuke.com/captcha-verify/?callback=shield&from=antispam">https://www.anjuke.com/captcha-verify/?callback=shield&amp;from=antispam</a></p><p>请求接口：1.<a href="https://anjuke.com/captcha/getInfoTp">https://anjuke.com/captcha/getInfoTp</a></p><p>​   2.<a href="https://anjuke.com/captcha/checkInfoTp">https://anjuke.com/captcha/checkInfoTp</a></p><p>加密参数：请求参数dInfo，响应参数info，请求参数data</p></blockquote><h3 id="请求接口分析"><a href="#请求接口分析" class="headerlink" title="请求接口分析"></a>请求接口分析</h3><p>请求参数：</p><p><img src="/images/image-20230410193002735.png" alt="image-20230410193002735"></p><p>响应体：</p><p><img src="/images/image-20230410192946459.png" alt="image-20230410192946459"></p><ol><li><p>sessionId通过搜索可以发现是隐藏在html里面</p><p><img src="/images/image-20230410193118239.png" alt="image-20230410193118239"></p></li><li><p>dinfo字段通过搜索，可以找到对应的加密方式</p><p><img src="/images/image-20230410193518519.png" alt="image-20230410193518519"></p><p>两个参数和对应的加密函数，一个是请求头信息，一个是sessionid，加密方式是AES的cbc模式，iv偏移值是获取sessionid的奇数位字符</p><p><img src="/images/image-20230410193636328.png" alt="image-20230410193636328"></p><p><img src="/images/image-20230410193748534.png" alt="image-20230410193748534"></p></li><li><p>使用python的Crypto模块进行加密获取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote_plus<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><br>session_id = html.xpath(<span class="hljs-string">&#x27;//*[@id=&quot;sessionId&quot;]/@value&#x27;</span>)[<span class="hljs-number">0</span>]<br>iv = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>():<br><span class="hljs-keyword">if</span> k % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>        iv += v<br>text = &#123;<br>     <span class="hljs-string">&quot;sdkv&quot;</span>: <span class="hljs-string">&quot;3.0.1&quot;</span>,<br>        <span class="hljs-string">&quot;busurl&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;useragent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;clienttype&quot;</span>: <span class="hljs-number">1</span><br>    &#125;<br>cipher = AES.new(key=<span class="hljs-built_in">bytes</span>(aes_key_iv, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>), mode=AES.MODE_CBC,      iv=<span class="hljs-built_in">bytes</span>(aes_key_iv, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>result = base64.b64encode(cipher.encrypt(pad(text.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), <span class="hljs-number">16</span>))).decode(<span class="hljs-string">&#x27;utf-  8&#x27;</span>)<br>result = quote_plus(result)<br></code></pre></td></tr></table></figure></li><li><p>对获取的响应体进行解析，猜测也是aes加密，打上断点查看，果然如此，传入的_jzC正是响应体，同样使用Crypto模块进行解密,这样我们就拿到了responseId和两张验证码的图片链接</p><p><img src="/images/image-20230411105440574.png" alt="image-20230411105440574"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = _AES.new(<br>    key=<span class="hljs-built_in">bytes</span>(aes_key, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>    mode=_AES.MODE_CBC,<br>    iv=<span class="hljs-built_in">bytes</span>(aes_key, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>)<br>result = unpad(cipher.decrypt(base64.b64decode(ciphertext)), <span class="hljs-number">16</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br></code></pre></td></tr></table></figure></li></ol><h3 id="验证码缺口位置解析"><a href="#验证码缺口位置解析" class="headerlink" title="验证码缺口位置解析"></a>验证码缺口位置解析</h3><p>1.可以使用opencv和ddddocr模块进行解析，这里使用cv2对验证码图片进行处理，找出缺口位置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_slice</span>():<br>    <span class="hljs-comment"># 读取图片</span><br>    bg = cv2.imread(<span class="hljs-string">&quot;./imgs/ajk_bg.png&quot;</span>)  <span class="hljs-comment"># 获取带缺口的背景图片</span><br>    <span class="hljs-built_in">slice</span> = cv2.imread(<span class="hljs-string">&quot;./imgs/ajk_sl.png&quot;</span>)  <span class="hljs-comment"># 滑块图片</span><br><br>    <span class="hljs-comment"># 灰度处理，将rgb三原色全部改成灰色，这样便于图片亮度处理</span><br>    bg = cv2.cvtColor(bg, cv2.COLOR_BGR2GRAY)  <span class="hljs-comment"># 蓝绿红改灰色</span><br>    <span class="hljs-built_in">slice</span> = cv2.cvtColor(<span class="hljs-built_in">slice</span>, cv2.COLOR_BGR2GRAY)<br><br>    <span class="hljs-comment"># 边缘检测,图片边缘处理</span><br>    bg_cam = cv2.Canny(bg, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-built_in">slice</span> = cv2.Canny(<span class="hljs-built_in">slice</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br><br>    <span class="hljs-comment"># 将两张图片进行匹配，会对每一个像素点进行匹配</span><br>    r = cv2.matchTemplate(bg_cam, <span class="hljs-built_in">slice</span>, cv2.TM_CCOEFF_NORMED)<br>    <span class="hljs-comment"># print(r)</span><br><br>    <span class="hljs-comment"># 获取最佳匹配多，返回四个结果</span><br>    <span class="hljs-comment"># 第一个是最不匹配的值，第三个是最不匹配的坐标</span><br>    <span class="hljs-comment"># 第二个是最匹配的值，第四个是最匹配的坐标</span><br>    minVal, maxVal, minLoc, maxLoc = cv2.minMaxLoc(r)<br>    <span class="hljs-built_in">print</span>(minVal, maxVal, minLoc, maxLoc)<br>    distance = maxLoc[<span class="hljs-number">0</span>]  <span class="hljs-comment"># maxLoc是最匹配的坐标，第一个值就代表着横向的距离</span><br>    <span class="hljs-built_in">print</span>(distance)<br></code></pre></td></tr></table></figure><h3 id="轨迹处理"><a href="#轨迹处理" class="headerlink" title="轨迹处理"></a>轨迹处理</h3><p>1.直接搜索<code>track</code>定位到轨迹加密的地方,_Ug0 由三个参数组成，x 是水平滑动的距离，track 是轨迹，p 是定值，_crv是轨迹信息，同样使用aes加密</p><p><img src="/images/image-20230411152329663.png" alt="image-20230411152329663"></p><p><img src="/images/image-20230411152830153.png" alt="image-20230411152830153"></p><p>2.轨迹生成可以采集一条正常的，手动滑出来的轨迹，然后根据识别出的实际距离和样本轨迹中的距离相比，得到一个比值，然后将样本中的 x 值和时间值都做一个对应的缩放，生成新的轨迹，将之前的缺口位置加入参与计算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_track</span>(<span class="hljs-params">self, distance</span>):<br>    ratio = distance / <span class="hljs-number">126</span><br>    new_track = <span class="hljs-string">&quot;&quot;</span><br>    base_track = <span class="hljs-string">&quot;29,11,0|29,11,11|29,11,26|33,11,56|34,11,66|36,11,67|39,11,76|41,11,83|43,11,86|46,11,92|49,11,98|50,11,102|52,11,106|53,11,111|55,11,116|57,11,118|59,11,123|60,11,126|62,11,132|64,12,134|65,12,138|66,12,142|68,12,148|69,12,151|70,13,155|71,13,158|72,13,164|74,13,166|75,13,170|76,14,174|77,14,180|79,14,182|81,14,186|82,14,196|84,14,198|86,14,207|87,15,212|89,15,219|90,15,223|92,15,230|93,15,234|94,15,239|95,15,243|98,15,246|100,15,250|102,15,260|105,15,262|106,15,266|108,15,270|109,16,276|111,16,278|113,16,283|115,16,286|117,16,291|118,16,294|119,16,298|121,16,302|123,16,309|124,16,311|125,16,315|126,16,319|129,16,324|130,16,327|131,16,331|132,16,334|132,16,388|132,16,522|133,16,566|134,16,574|135,16,575|136,16,594|137,16,620|138,16,625|139,16,652|140,16,657|141,17,676|141,18,680|142,18,684|143,18,688|144,18,716|145,18,724|146,18,796|147,19,828|148,19,860|149,19,888|149,19,890|150,19,916|151,20,932|152,20,936|152,20,1021|153,20,1150|154,20,1152|155,20,1236|155,20,1388|155,20,1522|155,20,1717|&quot;</span><br>    base_track = base_track.split(<span class="hljs-string">&quot;|&quot;</span>)[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> base_track:<br>        t = track.split(<span class="hljs-string">&quot;,&quot;</span>)<br>        new_track += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">int</span>(t[<span class="hljs-number">0</span>]) * ratio)) + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-built_in">str</span>(t[<span class="hljs-number">1</span>]) + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">int</span>(t[<span class="hljs-number">2</span>]) * ratio)) + <span class="hljs-string">&quot;|&quot;</span><br>        <span class="hljs-comment"># logger.info(f&quot;new_track ==&gt; &#123;new_track&#125;&quot;)</span><br>    <span class="hljs-keyword">return</span> new_track<br></code></pre></td></tr></table></figure><p>3.最后生成轨迹和缺口位置以及上诉的iv值进行aes加密，就得到checkInfoTp接口的请求参数data</p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AES </tag>
            
            <tag> 验证码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>贝壳登录webpack打包&amp;RSA加密</title>
      <link href="/2022/03/12/%E8%B4%9D%E5%A3%B3%E7%99%BB%E5%BD%95webpack%E6%89%93%E5%8C%85RSA%E5%8A%A0%E5%AF%86/"/>
      <url>/2022/03/12/%E8%B4%9D%E5%A3%B3%E7%99%BB%E5%BD%95webpack%E6%89%93%E5%8C%85RSA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<p><code>网址：https://sz.ke.com/</code></p><p><code>接口：https://clogin.ke.com/authentication/authenticate</code></p><h3 id="抓包分析："><a href="#抓包分析：" class="headerlink" title="抓包分析："></a>抓包分析：</h3><p>请求体中看上去有三个字段做了加密，dataId和loginTicketId貌似是固定，password肯定是我们首要解决的目标</p><p><img src="/images%5Cimage-20230604101641469.png" alt="image-20230604101641469"></p><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>我们从发起程序处开始跟栈，直接去看一下这个方法，来到这里后 上面有很明显的加密方法，我们打上断点进来</p><p><img src="/images/image-20230604102342423.png" alt="image-20230604102342423"></p><p><img src="/images/image-20230604102412293.png" alt="image-20230604102412293"></p><p>在这里发现 010001 publickey等关键字，猜测应该是rsa加密，我们进去看一下这个方法</p><p><img src="/images/image-20230604102552853.png" alt="image-20230604102552853"></p><p>进来 来到这里,我们看一下 getkey方法,发现断点不会进来，说明key已经生成了，我们看一下 nt方法，我们刷新页面，点击登录，能发现公钥已经获取到了</p><p><img src="/images/image-20230604104756670.png" alt="image-20230604104756670"></p><p><img src="/images/image-20230604104905781.png" alt="image-20230604104905781"></p><p><img src="/images/image-20230604105351460.png" alt="image-20230604105351460"></p><p>这里的rsa加密也没有做什么骚操作，直接拿着公钥加密就好了</p><p><img src="/images/image-20230604105851505.png" alt="image-20230604105851505"></p><p>剩下的两个参数 loginTicketId dataId  都由服务器返回</p><p><img src="/images/image-20230604112209058.png" alt="image-20230604112209058"></p><p><img src="/images%5Cimage-20230604113117996.png" alt="image-20230604113117996"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>七麦数据analysis参数js混淆拦截器解析</title>
      <link href="/2021/11/09/%E4%B8%83%E9%BA%A6%E6%95%B0%E6%8D%AEanalysis%E5%8F%82%E6%95%B0js%E6%B7%B7%E6%B7%86%E6%8B%A6%E6%88%AA%E5%99%A8%E8%A7%A3%E6%9E%90/"/>
      <url>/2021/11/09/%E4%B8%83%E9%BA%A6%E6%95%B0%E6%8D%AEanalysis%E5%8F%82%E6%95%B0js%E6%B7%B7%E6%B7%86%E6%8B%A6%E6%88%AA%E5%99%A8%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://www.qimai.cn/rank">https://www.qimai.cn/rank</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>不难看出哪个参数需要解密，关键字搜索不到，直接打上xhr断点尝试</p><p><img src="/images/image-20230517214052870.png" alt="image-20230517214052870"></p><p>再reques堆栈中发现axios拦截器,同时这个堆栈也是参数加密前的最后一个堆栈</p><p><img src="/images/image-20230517214553799.png" alt="image-20230517214553799"></p><p>t当中有六个拦截器，两个为一组，猜测第一个拦截器是再请求之前做了处理，点进去查看一下</p><p><img src="/images/image-20230517215259785.png" alt="image-20230517215259785"></p><p>这个拦截器中会进来很多个请求，找到我们需要的那个接口</p><p><img src="/images/image-20230517215214028.png" alt="image-20230517215214028"></p><p>这一段代码重点是a和e,a是将请求体中的参数进行组合拼接，如：36cnfreeiphone，然后再进行base64加密，然后再加上请求体中的数据, e参数是先进行处理转字节组合，然后再进行base64加密，d参数固定</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">e = (<span class="hljs-number">0</span>,i[jt])((<span class="hljs-number">0</span>,i[qt])(a, d))<br><span class="hljs-comment">// 改写一下e</span><br>e = <span class="hljs-title function_">cv</span>(<span class="hljs-title function_">oZ</span>(a, <span class="hljs-string">&quot;xyz517cda96abcd&quot;</span>));<br></code></pre></td></tr></table></figure><p>直接扣代码处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-variable language_">window</span> = <span class="hljs-variable language_">global</span>; <span class="hljs-comment">// node的全局 -&gt;  浏览器里面的window;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-comment">// t = &quot;&quot;,</span><br>    <span class="hljs-comment">// [&#x27;66&#x27;, &#x27;72&#x27;, &#x27;6f&#x27;, &#x27;6d&#x27;, &#x27;43&#x27;, &#x27;68&#x27;, &#x27;61&#x27;, &#x27;72&#x27;, &#x27;43&#x27;, &#x27;6f&#x27;, &#x27;64&#x27;, &#x27;65&#x27;][&#x27;forEach&#x27;](function(n) &#123;</span><br>    <span class="hljs-comment">//     t += window[&#x27;unescape&#x27;](&quot;%u00&quot; + n)</span><br>    <span class="hljs-comment">// &#125;);</span><br>    <span class="hljs-comment">// // 上面这一坨运行完. t里面是fromCharCode</span><br>    <span class="hljs-comment">// var t, e = t;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](n)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cv</span>(<span class="hljs-params">t</span>) &#123;<br>    t = <span class="hljs-variable language_">window</span>[<span class="hljs-string">&#x27;encodeURIComponent&#x27;</span>](t)[<span class="hljs-string">&quot;replace&quot;</span>](<span class="hljs-regexp">/%([0-9A-F]&#123;2&#125;)/g</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">n, t</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">o</span>(<span class="hljs-string">&quot;0x&quot;</span> + t) <span class="hljs-comment">// 把百分号. 换成了0x</span><br>    &#125;);<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// base64, 浏览器自带的btoa功能</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">btoa</span>(t)<br>    &#125; <span class="hljs-keyword">catch</span> (n) &#123;<br>        <span class="hljs-comment">// base64, nodejs的base64</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>[<span class="hljs-string">&#x27;Buffer&#x27;</span>][<span class="hljs-string">&quot;from&quot;</span>](t)[<span class="hljs-string">&quot;toString&quot;</span>](<span class="hljs-string">&quot;base64&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">oZ</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-comment">// t = t || u();</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = (n = n[<span class="hljs-string">&quot;split&quot;</span>](<span class="hljs-string">&quot;&quot;</span>))[<span class="hljs-string">&#x27;length&#x27;</span>], r = t[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-string">&#x27;charCodeAt&#x27;</span>, i = <span class="hljs-number">0</span>; i &lt; e; i++)<br>        n[i] = <span class="hljs-title function_">o</span>(n[i][a](<span class="hljs-number">0</span>) ^ t[(i + <span class="hljs-number">10</span>) % r][a](<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> n[<span class="hljs-string">&quot;join&quot;</span>](<span class="hljs-string">&quot;&quot;</span>);<br><br>&#125;<br><br><br><span class="hljs-comment">// 规定:</span><br><span class="hljs-comment">// &#123; url: &quot;完整的url&quot;, &#125;</span><br><span class="hljs-comment">//</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_mm</span>(<span class="hljs-params">url, params</span>) &#123;<br>    <span class="hljs-comment">// 加一点我自己的代码. 处理成它需要的那个样子</span><br>    <span class="hljs-comment">// 分离出. baseurl, url</span><br>    <span class="hljs-comment">// 借助URL的功能.</span><br>    <span class="hljs-keyword">var</span> t = &#123;&#125;;<br>    <span class="hljs-comment">// var u = new URL(url);</span><br>    <span class="hljs-comment">// t[&#x27;baseURL&#x27;] = u[&#x27;origin&#x27;]; // t里面就有的baseURL了</span><br>    t[<span class="hljs-string">&#x27;baseURL&#x27;</span>] = <span class="hljs-string">&#x27;https://api.qimai.cn&#x27;</span>; <span class="hljs-comment">// t里面就有的baseURL了</span><br>    t[<span class="hljs-string">&#x27;url&#x27;</span>] = url<br>    t[<span class="hljs-string">&#x27;params&#x27;</span>] = params<br><br>    s = -<span class="hljs-number">1228</span>;<br>    <span class="hljs-keyword">var</span> e, r = +<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span> - (s || <span class="hljs-number">0</span>) - <span class="hljs-number">1661224081041</span>, a = [];<br><br>    <span class="hljs-comment">// void 0 === t[Zt] &amp;&amp; (t[Zt] = &#123;&#125;)</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === t[<span class="hljs-string">&#x27;params&#x27;</span>]) &#123;<br>        t[<span class="hljs-string">&#x27;params&#x27;</span>] = &#123;&#125;<br>    &#125;<br><br>    <span class="hljs-title class_">Object</span>[<span class="hljs-string">&#x27;keys&#x27;</span>](t[<span class="hljs-string">&quot;params&quot;</span>])[<span class="hljs-string">&quot;forEach&quot;</span>](<span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) &#123;<br>        <span class="hljs-keyword">if</span> (n == <span class="hljs-string">&quot;analysis&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        t[<span class="hljs-string">&#x27;params&#x27;</span>][<span class="hljs-string">&#x27;hasOwnProperty&#x27;</span>](n) &amp;&amp; a[<span class="hljs-string">&#x27;push&#x27;</span>](t[<span class="hljs-string">&#x27;params&#x27;</span>][n])<br>    &#125;);<span class="hljs-comment">// 把params里面的所有的值. 组装到a列表</span><br><br><br>        a = a[<span class="hljs-string">&#x27;sort&#x27;</span>]()[<span class="hljs-string">&quot;join&quot;</span>](<span class="hljs-string">&quot;&quot;</span>); <span class="hljs-comment">// 排序. 拼接 结果就是一个字符串. 装着所有的数据</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)<br>        a = <span class="hljs-title function_">cv</span>(a); <span class="hljs-comment">// 计算了一个base64, &quot;MjIwMjItMTItMDIzNmFsbGNuaXBob25l@#/xxxx/xxxx@#时间@#3&quot;</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)<br>        a = (a += <span class="hljs-string">&quot;@#&quot;</span> + t[<span class="hljs-string">&quot;url&quot;</span>][<span class="hljs-string">&quot;replace&quot;</span>](t[<span class="hljs-string">&quot;baseURL&quot;</span>], <span class="hljs-string">&quot;&quot;</span>)) + (<span class="hljs-string">&quot;@#&quot;</span> + r) + (<span class="hljs-string">&quot;@#&quot;</span> + <span class="hljs-number">3</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">oZ</span>(a, <span class="hljs-string">&quot;xyz517cda96abcd&quot;</span>))<br>        e = <span class="hljs-title function_">cv</span>(<span class="hljs-title function_">oZ</span>(a, <span class="hljs-string">&quot;xyz517cda96abcd&quot;</span>));<br>        <span class="hljs-keyword">return</span> e<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">get_mm</span>(<span class="hljs-string">&#x27;https://api.qimai.cn/rank/index&#x27;</span>, &#123;<br>    <span class="hljs-string">&#x27;brand&#x27;</span>: <span class="hljs-string">&#x27;free&#x27;</span>,<br>    <span class="hljs-string">&#x27;device&#x27;</span>: <span class="hljs-string">&#x27;iphone&#x27;</span>,<br>    <span class="hljs-string">&#x27;country&#x27;</span>: <span class="hljs-string">&#x27;cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;genre&#x27;</span>: <span class="hljs-string">&#x27;36&#x27;</span><br>&#125;))<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">n, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = (n = n[<span class="hljs-string">&quot;split&quot;</span>](<span class="hljs-string">&quot;&quot;</span>))[<span class="hljs-string">&#x27;length&#x27;</span>], r = t[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-string">&#x27;charCodeAt&#x27;</span>, i = <span class="hljs-number">0</span>; i &lt; e; i++)<br>        n[i] = <span class="hljs-title function_">o</span>(n[i][a](<span class="hljs-number">0</span>) ^ t[(i) % r][a](<span class="hljs-number">0</span>));<br>    <span class="hljs-keyword">return</span> n[<span class="hljs-string">&quot;join&quot;</span>](<span class="hljs-string">&quot;&quot;</span>);<br><br>    &#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_qm_check</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> n = &#123;<br>        <span class="hljs-string">&quot;gpu&quot;</span>: <span class="hljs-string">&quot;ANGLE (Intel, Intel(R) UHD Graphics 770 Direct3D11 vs_5_0 ps_5_0, D3D11)&quot;</span>,<br>        <span class="hljs-string">&quot;check&quot;</span>: <span class="hljs-string">&quot;0,0,0,0,0&quot;</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">cv</span>(<span class="hljs-title function_">p</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(n), <span class="hljs-string">&#x27;xyz57209048abcd&#x27;</span>))<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">get_qm_check</span>())<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js混淆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网易云m4a音频链接获取请求头RSA加密</title>
      <link href="/2021/07/03/%E7%BD%91%E6%98%93%E4%BA%91m4a%E9%9F%B3%E9%A2%91%E9%93%BE%E6%8E%A5%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%A4%B4RSA%E5%8A%A0%E5%AF%86/"/>
      <url>/2021/07/03/%E7%BD%91%E6%98%93%E4%BA%91m4a%E9%9F%B3%E9%A2%91%E9%93%BE%E6%8E%A5%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%A4%B4RSA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://music.163.com/#/song?id=186453">https://music.163.com/#/song?id=186453</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>通过歌曲的id获取歌曲的原链接</p><p><img src="/images/image-20230517210007505.png" alt="image-20230517210007505"></p><p>这是请求接口，很显然<strong>params</strong>和<strong>encSecKey</strong>是我们需要获取的，复制链接打上xhr断点，跟栈</p><p><img src="/images/image-20230517210027094.png" alt="image-20230517210027094"></p><p>断点打到这里，查看bMs8k是怎么一回事</p><p><img src="/images/image-20230517211202102.png" alt="image-20230517211202102"></p><p>控制台将几个参数都打印出来,一眼rsa加密</p><p><img src="/images/image-20230517211804914.png" alt="image-20230517211804914"></p><p>查看window.asrsea()方法，发现果然是rsa加密，直接扣代码，补全即可</p><p><img src="/images/image-20230517212014284.png" alt="image-20230517212014284"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto-js&#x27;</span>)<br><br><span class="hljs-keyword">var</span> d = <span class="hljs-string">&#x27;&#123;&quot;ids&quot;:&quot;[3950292]&quot;,&quot;level&quot;:&quot;standard&quot;,&quot;encodeType&quot;:&quot;aac&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span>,<br>    e = <span class="hljs-string">&#x27;010001&#x27;</span>,<br>    f = <span class="hljs-string">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span>,<br>    g = <span class="hljs-string">&#x27;0CoJUm6Qyw8W8jud&#x27;</span><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, e, b = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>, c = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (d = <span class="hljs-number">0</span>; a &gt; d; d += <span class="hljs-number">1</span>)<br>        e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * b.<span class="hljs-property">length</span>,<br>            e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(e),<br>            c += b.<span class="hljs-title function_">charAt</span>(e);<br>    <span class="hljs-keyword">return</span> c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(b)<br>        , d = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;0102030405060708&quot;</span>)<br>        , e = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(a)<br>        , f = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e, c, &#123;<br>        <span class="hljs-attr">iv</span>: d,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br>    <span class="hljs-keyword">return</span> f.<span class="hljs-title function_">toString</span>()<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">charToHex</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> h, b = <span class="hljs-number">48</span>, c = b + <span class="hljs-number">9</span>, d = <span class="hljs-number">97</span>, e = d + <span class="hljs-number">25</span>, f = <span class="hljs-number">65</span>, g = <span class="hljs-number">90</span>;<br>    <span class="hljs-keyword">return</span> h = a &gt;= b &amp;&amp; c &gt;= a ? a - b : a &gt;= f &amp;&amp; g &gt;= a ? <span class="hljs-number">10</span> + a - f : a &gt;= d &amp;&amp; e &gt;= a ? <span class="hljs-number">10</span> + a - d : <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span> = <span class="hljs-title function_">biCopy</span>(a),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> = <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    b.<span class="hljs-property">digits</span>[<span class="hljs-number">2</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span>] = <span class="hljs-number">1</span>,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mu</span> = <span class="hljs-title function_">biDivide</span>(b, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span>.<span class="hljs-property">digits</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulo</span> = <span class="hljs-title class_">BarrettMu</span>_modulo,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">multiplyMod</span> = <span class="hljs-title class_">BarrettMu</span>_multiplyMod,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">powMod</span> = <span class="hljs-title class_">BarrettMu</span>_powMod<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biCopy</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>(!<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> b.<span class="hljs-property">digits</span> = a.<span class="hljs-property">digits</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>),<br>        b.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span>,<br>        b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivide</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biDivideModulo</span>(a, b)[<span class="hljs-number">0</span>]<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biModulo</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biDivideModulo</span>(a, b)[<span class="hljs-number">1</span>]<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyMod</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biModulo</span>(<span class="hljs-title function_">biMultiply</span>(a, b), c)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivideModulo</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> f, g, h, i, j, k, l, m, n, o, p, q, r, s, c = <span class="hljs-title function_">biNumBits</span>(a), d = <span class="hljs-title function_">biNumBits</span>(b), e = b.<span class="hljs-property">isNeg</span>;<br>    <span class="hljs-keyword">if</span> (d &gt; c)<br>        <span class="hljs-keyword">return</span> a.<span class="hljs-property">isNeg</span> ? (f = <span class="hljs-title function_">biCopy</span>(bigOne),<br>            f.<span class="hljs-property">isNeg</span> = !b.<span class="hljs-property">isNeg</span>,<br>            a.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>,<br>            b.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>,<br>            g = <span class="hljs-title function_">biSubtract</span>(b, a),<br>            a.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">0</span>,<br>            b.<span class="hljs-property">isNeg</span> = e) : (f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>            g = <span class="hljs-title function_">biCopy</span>(a)),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(f, g);<br>    <span class="hljs-keyword">for</span> (f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>             g = a,<br>             h = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(d / bitsPerDigit) - <span class="hljs-number">1</span>,<br>             i = <span class="hljs-number">0</span>; b.<span class="hljs-property">digits</span>[h] &lt; biHalfRadix;)<br>        b = <span class="hljs-title function_">biShiftLeft</span>(b, <span class="hljs-number">1</span>),<br>            ++i,<br>            ++d,<br>            h = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(d / bitsPerDigit) - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (g = <span class="hljs-title function_">biShiftLeft</span>(g, i),<br>             c += i,<br>             j = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(c / bitsPerDigit) - <span class="hljs-number">1</span>,<br>             k = <span class="hljs-title function_">biMultiplyByRadixPower</span>(b, j - h); -<span class="hljs-number">1</span> != <span class="hljs-title function_">biCompare</span>(g, k);)<br>        ++f.<span class="hljs-property">digits</span>[j - h],<br>            g = <span class="hljs-title function_">biSubtract</span>(g, k);<br>    <span class="hljs-keyword">for</span> (l = j; l &gt; h; --l) &#123;<br>        <span class="hljs-keyword">for</span> (m = l &gt;= g.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : g.<span class="hljs-property">digits</span>[l],<br>                 n = l - <span class="hljs-number">1</span> &gt;= g.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : g.<span class="hljs-property">digits</span>[l - <span class="hljs-number">1</span>],<br>                 o = l - <span class="hljs-number">2</span> &gt;= g.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : g.<span class="hljs-property">digits</span>[l - <span class="hljs-number">2</span>],<br>                 p = h &gt;= b.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : b.<span class="hljs-property">digits</span>[h],<br>                 q = h - <span class="hljs-number">1</span> &gt;= b.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : b.<span class="hljs-property">digits</span>[h - <span class="hljs-number">1</span>],<br>                 f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>] = m == p ? maxDigitVal : <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((m * biRadix + n) / p),<br>                 r = f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>] * (p * biRadix + q),<br>                 s = m * biRadixSquared + (n * biRadix + o); r &gt; s;)<br>            --f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>],<br>                r = f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>] * (p * biRadix | q),<br>                s = m * biRadix * biRadix + (n * biRadix + o);<br>        k = <span class="hljs-title function_">biMultiplyByRadixPower</span>(b, l - h - <span class="hljs-number">1</span>),<br>            g = <span class="hljs-title function_">biSubtract</span>(g, <span class="hljs-title function_">biMultiplyDigit</span>(k, f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>])),<br>        g.<span class="hljs-property">isNeg</span> &amp;&amp; (g = <span class="hljs-title function_">biAdd</span>(g, k),<br>            --f.<span class="hljs-property">digits</span>[l - h - <span class="hljs-number">1</span>])<br>    &#125;<br>    <span class="hljs-keyword">return</span> g = <span class="hljs-title function_">biShiftRight</span>(g, i),<br>        f.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span> != e,<br>    a.<span class="hljs-property">isNeg</span> &amp;&amp; (f = e ? <span class="hljs-title function_">biAdd</span>(f, bigOne) : <span class="hljs-title function_">biSubtract</span>(f, bigOne),<br>        b = <span class="hljs-title function_">biShiftRight</span>(b, i),<br>        g = <span class="hljs-title function_">biSubtract</span>(b, g)),<br>    <span class="hljs-number">0</span> == g.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-number">0</span> == <span class="hljs-title function_">biHighIndex</span>(g) &amp;&amp; (g.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(f, g)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biShiftLeft</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> e, f, g, h, c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(b / bitsPerDigit), d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-title function_">arrayCopy</span>(a.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, d.<span class="hljs-property">digits</span>, c, d.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - c),<br>             e = b % bitsPerDigit,<br>             f = bitsPerDigit - e,<br>             g = d.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>,<br>             h = g - <span class="hljs-number">1</span>; g &gt; <span class="hljs-number">0</span>; --g,<br>             --h)<br>        d.<span class="hljs-property">digits</span>[g] = d.<span class="hljs-property">digits</span>[g] &lt;&lt; e &amp; maxDigitVal | (d.<span class="hljs-property">digits</span>[h] &amp; highBitMasks[e]) &gt;&gt;&gt; f;<br>    <span class="hljs-keyword">return</span> d.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = d.<span class="hljs-property">digits</span>[g] &lt;&lt; e &amp; maxDigitVal,<br>        d.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span>,<br>        d<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayCopy</span>(<span class="hljs-params">a, b, c, d, e</span>) &#123;<br>    <span class="hljs-keyword">var</span> g, h, f = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(b + e, a.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">for</span> (g = b,<br>             h = d; f &gt; g; ++g,<br>             ++h)<br>        c[h] = a[g]<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyDigit</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c, d, e, f;<br>    <span class="hljs-keyword">for</span> (result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>             c = <span class="hljs-title function_">biHighIndex</span>(a),<br>             d = <span class="hljs-number">0</span>,<br>             f = <span class="hljs-number">0</span>; c &gt;= f; ++f)<br>        e = result.<span class="hljs-property">digits</span>[f] + a.<span class="hljs-property">digits</span>[f] * b + d,<br>            result.<span class="hljs-property">digits</span>[f] = e &amp; maxDigitVal,<br>            d = e &gt;&gt;&gt; biRadixBits;<br>    <span class="hljs-keyword">return</span> result.<span class="hljs-property">digits</span>[<span class="hljs-number">1</span> + c] = d,<br>        result<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biShiftRight</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> e, f, g, h, c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(b / bitsPerDigit), d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-title function_">arrayCopy</span>(a.<span class="hljs-property">digits</span>, c, d.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, a.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - c),<br>             e = b % bitsPerDigit,<br>             f = bitsPerDigit - e,<br>             g = <span class="hljs-number">0</span>,<br>             h = g + <span class="hljs-number">1</span>; g &lt; d.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; ++g,<br>             ++h)<br>        d.<span class="hljs-property">digits</span>[g] = d.<span class="hljs-property">digits</span>[g] &gt;&gt;&gt; e | (d.<span class="hljs-property">digits</span>[h] &amp; lowBitMasks[e]) &lt;&lt; f;<br>    <span class="hljs-keyword">return</span> d.<span class="hljs-property">digits</span>[d.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] &gt;&gt;&gt;= e,<br>        d.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span>,<br>        d<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_modulo</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> i, b = <span class="hljs-title function_">biDivideByRadixPower</span>(a, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> - <span class="hljs-number">1</span>), c = <span class="hljs-title function_">biMultiply</span>(b, <span class="hljs-variable language_">this</span>.<span class="hljs-property">mu</span>), d = <span class="hljs-title function_">biDivideByRadixPower</span>(c, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>),<br>        e = <span class="hljs-title function_">biModuloByRadixPower</span>(a, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>), f = <span class="hljs-title function_">biMultiply</span>(d, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>),<br>        g = <span class="hljs-title function_">biModuloByRadixPower</span>(f, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>), h = <span class="hljs-title function_">biSubtract</span>(e, g);<br>    <span class="hljs-keyword">for</span> (h.<span class="hljs-property">isNeg</span> &amp;&amp; (h = <span class="hljs-title function_">biAdd</span>(h, <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span>)),<br>             i = <span class="hljs-title function_">biCompare</span>(h, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) &gt;= <span class="hljs-number">0</span>; i;)<br>        h = <span class="hljs-title function_">biSubtract</span>(h, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>),<br>            i = <span class="hljs-title function_">biCompare</span>(h, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) &gt;= <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">return</span> h<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_multiplyMod</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-title function_">biMultiply</span>(a, b);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">modulo</span>(c)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_powMod</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, e, c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">for</span> (c.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>,<br>             d = a,<br>             e = b; ;) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> != (<span class="hljs-number">1</span> &amp; e.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>]) &amp;&amp; (c = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMod</span>(c, d)),<br>            e = <span class="hljs-title function_">biShiftRight</span>(e, <span class="hljs-number">1</span>),<br>        <span class="hljs-number">0</span> == e.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-number">0</span> == <span class="hljs-title function_">biHighIndex</span>(e))<br>            <span class="hljs-keyword">break</span>;<br>        d = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMod</span>(d, d)<br>    &#125;<br>    <span class="hljs-keyword">return</span> c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiply</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, h, i, k, c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, e = <span class="hljs-title function_">biHighIndex</span>(a), f = <span class="hljs-title function_">biHighIndex</span>(b);<br>    <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; f &gt;= k; ++k) &#123;<br>        <span class="hljs-keyword">for</span> (d = <span class="hljs-number">0</span>,<br>                 i = k,<br>                 j = <span class="hljs-number">0</span>; e &gt;= j; ++j,<br>                 ++i)<br>            h = c.<span class="hljs-property">digits</span>[i] + a.<span class="hljs-property">digits</span>[j] * b.<span class="hljs-property">digits</span>[k] + d,<br>                c.<span class="hljs-property">digits</span>[i] = h &amp; maxDigitVal,<br>                d = h &gt;&gt;&gt; biRadixBits;<br>        c.<span class="hljs-property">digits</span>[k + e + <span class="hljs-number">1</span>] = d<br>    &#125;<br>    <span class="hljs-keyword">return</span> c.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span> != b.<span class="hljs-property">isNeg</span>,<br>        c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivideByRadixPower</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(a.<span class="hljs-property">digits</span>, b, c.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, c.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - b),<br>        c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biModuloByRadixPower</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(a.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, c.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, b),<br>        c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biToHex</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, b = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-title function_">biHighIndex</span>(a),<br>             d = <span class="hljs-title function_">biHighIndex</span>(a); d &gt; -<span class="hljs-number">1</span>; --d)<br>        b += <span class="hljs-title function_">digitToHex</span>(a.<span class="hljs-property">digits</span>[d]);<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">reverseStr</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> c, b = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (c = a.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; c &gt; -<span class="hljs-number">1</span>; --c)<br>        b += a.<span class="hljs-title function_">charAt</span>(c);<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">digitToHex</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">15</span><br>        , c = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; <span class="hljs-number">4</span> &gt; i; ++i)<br>        c += hexToChar[a &amp; b],<br>            a &gt;&gt;&gt;= <span class="hljs-number">4</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">reverseStr</span>(c)<br>&#125;<br><br><span class="hljs-keyword">var</span> maxDigits, <span class="hljs-variable constant_">ZERO_ARRAY</span>, bigZero, bigOne, dpl10, lr10, hexatrigesimalToChar, hexToChar, highBitMasks, lowBitMasks,<br>    biRadixBase = <span class="hljs-number">2</span>, biRadixBits = <span class="hljs-number">16</span>, bitsPerDigit = biRadixBits, biRadix = <span class="hljs-number">65536</span>, biHalfRadix = biRadix &gt;&gt;&gt; <span class="hljs-number">1</span>,<br>    biRadixSquared = biRadix * biRadix, maxDigitVal = biRadix - <span class="hljs-number">1</span>, maxInteger = <span class="hljs-number">9999999999999998</span>;<br><span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-number">20</span>),<br>    dpl10 = <span class="hljs-number">15</span>,<br>    lr10 = <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-number">1e15</span>),<br>    hexatrigesimalToChar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;z&quot;</span>),<br>    hexToChar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>),<br>    highBitMasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>, <span class="hljs-number">32768</span>, <span class="hljs-number">49152</span>, <span class="hljs-number">57344</span>, <span class="hljs-number">61440</span>, <span class="hljs-number">63488</span>, <span class="hljs-number">64512</span>, <span class="hljs-number">65024</span>, <span class="hljs-number">65280</span>, <span class="hljs-number">65408</span>, <span class="hljs-number">65472</span>, <span class="hljs-number">65504</span>, <span class="hljs-number">65520</span>, <span class="hljs-number">65528</span>, <span class="hljs-number">65532</span>, <span class="hljs-number">65534</span>, <span class="hljs-number">65535</span>),<br>    lowBitMasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">31</span>, <span class="hljs-number">63</span>, <span class="hljs-number">127</span>, <span class="hljs-number">255</span>, <span class="hljs-number">511</span>, <span class="hljs-number">1023</span>, <span class="hljs-number">2047</span>, <span class="hljs-number">4095</span>, <span class="hljs-number">8191</span>, <span class="hljs-number">16383</span>, <span class="hljs-number">32767</span>, <span class="hljs-number">65535</span>);<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biCompare</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">if</span> (a.<span class="hljs-property">isNeg</span> != b.<span class="hljs-property">isNeg</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(a.<span class="hljs-property">isNeg</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = a.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; c &gt;= <span class="hljs-number">0</span>; --c)<br>        <span class="hljs-keyword">if</span> (a.<span class="hljs-property">digits</span>[c] != b.<span class="hljs-property">digits</span>[c])<br>            <span class="hljs-keyword">return</span> a.<span class="hljs-property">isNeg</span> ? <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(a.<span class="hljs-property">digits</span>[c] &gt; b.<span class="hljs-property">digits</span>[c]) : <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(a.<span class="hljs-property">digits</span>[c] &lt; b.<span class="hljs-property">digits</span>[c]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biSubtract</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c, d, e, f;<br>    <span class="hljs-keyword">if</span> (a.<span class="hljs-property">isNeg</span> != b.<span class="hljs-property">isNeg</span>)<br>        b.<span class="hljs-property">isNeg</span> = !b.<span class="hljs-property">isNeg</span>,<br>            c = <span class="hljs-title function_">biAdd</span>(a, b),<br>            b.<span class="hljs-property">isNeg</span> = !b.<span class="hljs-property">isNeg</span>;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>                 e = <span class="hljs-number">0</span>,<br>                 f = <span class="hljs-number">0</span>; f &lt; a.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span>; ++f)<br>            d = a.<span class="hljs-property">digits</span>[f] - b.<span class="hljs-property">digits</span>[f] + e,<br>                c.<span class="hljs-property">digits</span>[f] = <span class="hljs-number">65535</span> &amp; d,<br>            c.<span class="hljs-property">digits</span>[f] &lt; <span class="hljs-number">0</span> &amp;&amp; (c.<span class="hljs-property">digits</span>[f] += biRadix),<br>                e = <span class="hljs-number">0</span> - <span class="hljs-title class_">Number</span>(<span class="hljs-number">0</span> &gt; d);<br>        <span class="hljs-keyword">if</span> (-<span class="hljs-number">1</span> == e) &#123;<br>            <span class="hljs-keyword">for</span> (e = <span class="hljs-number">0</span>,<br>                     f = <span class="hljs-number">0</span>; f &lt; a.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span>; ++f)<br>                d = <span class="hljs-number">0</span> - c.<span class="hljs-property">digits</span>[f] + e,<br>                    c.<span class="hljs-property">digits</span>[f] = <span class="hljs-number">65535</span> &amp; d,<br>                c.<span class="hljs-property">digits</span>[f] &lt; <span class="hljs-number">0</span> &amp;&amp; (c.<span class="hljs-property">digits</span>[f] += biRadix),<br>                    e = <span class="hljs-number">0</span> - <span class="hljs-title class_">Number</span>(<span class="hljs-number">0</span> &gt; d);<br>            c.<span class="hljs-property">isNeg</span> = !a.<span class="hljs-property">isNeg</span><br>        &#125; <span class="hljs-keyword">else</span><br>            c.<span class="hljs-property">isNeg</span> = a.<span class="hljs-property">isNeg</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyByRadixPower</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(a.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, c.<span class="hljs-property">digits</span>, b, c.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - b),<br>        c<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> c, b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">for</span> (b.<span class="hljs-property">isNeg</span> = <span class="hljs-number">0</span> &gt; a,<br>             a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(a),<br>             c = <span class="hljs-number">0</span>; a &gt; <span class="hljs-number">0</span>;)<br>        b.<span class="hljs-property">digits</span>[c++] = a &amp; maxDigitVal,<br>            a &gt;&gt;= biRadixBits;<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biNumBits</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> e, b = <span class="hljs-title function_">biHighIndex</span>(a), c = a.<span class="hljs-property">digits</span>[b], d = (b + <span class="hljs-number">1</span>) * bitsPerDigit;<br>    <span class="hljs-keyword">for</span> (e = d; e &gt; d - bitsPerDigit &amp;&amp; <span class="hljs-number">0</span> == (<span class="hljs-number">32768</span> &amp; c); --e)<br>        c &lt;&lt;= <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">return</span> e<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = a.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; b &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-number">0</span> == a.<span class="hljs-property">digits</span>[b];)<br>        --b;<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hexToDigit</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, b = <span class="hljs-number">0</span>, c = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(a.<span class="hljs-property">length</span>, <span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">for</span> (d = <span class="hljs-number">0</span>; c &gt; d; ++d)<br>        b &lt;&lt;= <span class="hljs-number">4</span>,<br>            b |= <span class="hljs-title function_">charToHex</span>(a.<span class="hljs-title function_">charCodeAt</span>(d));<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromHex</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, e, b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, c = a.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">for</span> (d = c,<br>             e = <span class="hljs-number">0</span>; d &gt; <span class="hljs-number">0</span>; d -= <span class="hljs-number">4</span>,<br>             ++e)<br>        b.<span class="hljs-property">digits</span>[e] = <span class="hljs-title function_">hexToDigit</span>(a.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(d - <span class="hljs-number">4</span>, <span class="hljs-number">0</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(d, <span class="hljs-number">4</span>)));<br>    <span class="hljs-keyword">return</span> b<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BigInt</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">digits</span> = <span class="hljs-string">&quot;boolean&quot;</span> == <span class="hljs-keyword">typeof</span> a &amp;&amp; <span class="hljs-number">1</span> == a ? <span class="hljs-literal">null</span> : <span class="hljs-variable constant_">ZERO_ARRAY</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-params">a</span>) &#123;<br>    maxDigits = a,<br>        <span class="hljs-variable constant_">ZERO_ARRAY</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(maxDigits);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>; b &lt; <span class="hljs-variable constant_">ZERO_ARRAY</span>.<span class="hljs-property">length</span>; b++)<br>        <span class="hljs-variable constant_">ZERO_ARRAY</span>[b] = <span class="hljs-number">0</span>;<br>    bigZero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        bigOne = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        bigOne.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">RSAKeyPair</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">e</span> = <span class="hljs-title function_">biFromHex</span>(a),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">d</span> = <span class="hljs-title function_">biFromHex</span>(b),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span> = <span class="hljs-title function_">biFromHex</span>(c),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chunkSize</span> = <span class="hljs-number">2</span> * <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span>),<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">radix</span> = <span class="hljs-number">16</span>,<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">barrett</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BarrettMu</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">encryptedString</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f, g, h, i, j, k, l, c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>, d = b.<span class="hljs-property">length</span>, e = <span class="hljs-number">0</span>; d &gt; e;)<br>        c[e] = b.<span class="hljs-title function_">charCodeAt</span>(e),<br>            e++;<br>    <span class="hljs-keyword">for</span> (; <span class="hljs-number">0</span> != c.<span class="hljs-property">length</span> % a.<span class="hljs-property">chunkSize</span>;)<br>        c[e++] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (f = c.<span class="hljs-property">length</span>,<br>             g = <span class="hljs-string">&quot;&quot;</span>,<br>             e = <span class="hljs-number">0</span>; f &gt; e; e += a.<span class="hljs-property">chunkSize</span>) &#123;<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>                 h = <span class="hljs-number">0</span>,<br>                 i = e; i &lt; e + a.<span class="hljs-property">chunkSize</span>; ++h)<br>            j.<span class="hljs-property">digits</span>[h] = c[i++],<br>                j.<span class="hljs-property">digits</span>[h] += c[i++] &lt;&lt; <span class="hljs-number">8</span>;<br>        k = a.<span class="hljs-property">barrett</span>.<span class="hljs-title function_">powMod</span>(j, a.<span class="hljs-property">e</span>),<br>            l = <span class="hljs-number">16</span> == a.<span class="hljs-property">radix</span> ? <span class="hljs-title function_">biToHex</span>(k) : <span class="hljs-title function_">biToString</span>(k, a.<span class="hljs-property">radix</span>),<br>            g += l + <span class="hljs-string">&quot; &quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> g.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, g.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-keyword">var</span> d, e;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-number">131</span>),<br>        d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RSAKeyPair</span>(b, <span class="hljs-string">&quot;&quot;</span>, c),<br>        e = <span class="hljs-title function_">encryptedString</span>(d, a)<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">d</span>) &#123;<br>    <span class="hljs-keyword">var</span><br>    e = <span class="hljs-string">&#x27;010001&#x27;</span>,<br>    f = <span class="hljs-string">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span>,<br>    g = <span class="hljs-string">&#x27;0CoJUm6Qyw8W8jud&#x27;</span><br>    <span class="hljs-keyword">var</span> h = &#123;&#125;<br>        , i = <span class="hljs-title function_">a</span>(<span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">return</span> h.<span class="hljs-property">encText</span> = <span class="hljs-title function_">b</span>(d, g),<br>        h.<span class="hljs-property">encText</span> = <span class="hljs-title function_">b</span>(h.<span class="hljs-property">encText</span>, i),<br>        h.<span class="hljs-property">encSecKey</span> = <span class="hljs-title function_">c</span>(i, e, f), h<br>&#125;<br><br><span class="hljs-comment">// var num1 = 3950292</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// var result = encrypt(num1)</span><br><span class="hljs-comment">// console.log(result)</span><br><span class="hljs-comment">// var num1 = 3950292</span><br><span class="hljs-comment">// var d = &#x27;&#123;&quot;ids&quot;:&quot;[$&#123;num1&#125;]&quot;,&quot;level&quot;:&quot;standard&quot;,&quot;encodeType&quot;:&quot;aac&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// console.log(d)</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>油联合伙人appfrida获取X-Sign参数</title>
      <link href="/2021/06/21/%E6%B2%B9%E8%81%94%E5%90%88%E4%BC%99%E4%BA%BAappfrida%E8%8E%B7%E5%8F%96X-Sign%E5%8F%82%E6%95%B0/"/>
      <url>/2021/06/21/%E6%B2%B9%E8%81%94%E5%90%88%E4%BC%99%E4%BA%BAappfrida%E8%8E%B7%E5%8F%96X-Sign%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:油联合伙人v1.4</p><p>接口：<a href="https://chinayltx.com/app/api/v1/partnerLogin/login">https://chinayltx.com/app/api/v1/partnerLogin/login</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>该app未作双向认证，所以可以直接正常抓包，通过抓包分析，可以看得出来，密码是做了加密，请求头中的X-Sign参数也做了相应加密</p><p><img src="/images/image-20230519180333662.png" alt="image-20230519180333662"></p><p><img src="/images/image-20230519182620674.png" alt="image-20230519182620674"></p><p>在此使用jadx进行反编译，搜索关键字“password”,都可以点进去看一下，我们直接看第三个,第三个进去发现是路由，也正好是我们接口的路径，我们再查找用例，看一下是谁调用了</p><p><img src="/images/image-20230519181624810.png" alt="image-20230519181624810"></p><p><img src="/images/image-20230519181721037.png" alt="image-20230519181721037"></p><p><img src="/images/image-20230519181825011.png" alt="image-20230519181825011"></p><p>这里应该是发起请求，查找用例找不到，我们直接搜索loginWithToken，很明显最后一个更符合一点</p><p><img src="/images/image-20230519181857745.png" alt="image-20230519181857745"></p><p><img src="/images/image-20230519182010675.png" alt="image-20230519182010675"></p><p>进去后发现这里是一个构造方法，我们再看下谁调用了setPwd方法，直接查找用例，只有一个，我们直接进去看一下是什么</p><p><img src="/images/image-20230519182108884.png" alt="image-20230519182108884"></p><p><img src="/images/image-20230519182200625.png" alt="image-20230519182200625"></p><p>setPwd方法传入了一个经过md5加密后的参数，我们直接看md5方法,直接hook他，看下传入了什么参数</p><p><img src="/images/image-20230519182220228.png" alt="image-20230519182220228"></p><p><img src="/images/image-20230519182313041.png" alt="image-20230519182313041"></p><p>对照一下，应该就是对密码进行了md5加密,对应的X-Sign参数也获取到了，经过测试后，应该是拼接了时间戳和密码的第二位往后的字符串以及加密后的密码</p><p><img src="/images/image-20230519182437355.png" alt="image-20230519182437355"></p><p><img src="/images/image-20230519182802102.png" alt="image-20230519182802102"></p><p>将逻辑改写成py代码获取参数即可请求登录接口</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><br>md5 = hashlib.md5()<br>pwd = <span class="hljs-string">&quot;1234567&quot;</span><br>encrypt_pwd = hashlib.new(<span class="hljs-string">&#x27;md5&#x27;</span>, <span class="hljs-string">&#x27;1234567&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br><span class="hljs-built_in">print</span>(encrypt_pwd)<br><br>token = <span class="hljs-string">&quot;&quot;</span><br>reqTime = <span class="hljs-string">&quot;15797717652&quot;</span><br>nonce_str = <span class="hljs-string">&quot;123456&quot;</span><br>nonce_str_sub_2 = nonce_str[<span class="hljs-number">2</span>:]<br>body_string = <span class="hljs-string">&quot;phone=15797717652&amp;password=4297f44b13955235245b2497399d7a93&quot;</span><br><br>encrypt_string = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;token&#125;</span><span class="hljs-subst">&#123;reqTime&#125;</span><span class="hljs-subst">&#123;nonce_str_sub_2&#125;</span><span class="hljs-subst">&#123;body_string&#125;</span>&quot;</span><br><br>obj = hashlib.md5()<br>obj.update(encrypt_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>res = obj.hexdigest()<br><span class="hljs-built_in">print</span>(res)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金华市国土局二手房字体加密和字段加密</title>
      <link href="/2020/09/12/%E9%87%91%E5%8D%8E%E5%B8%82%E5%9B%BD%E5%9C%9F%E5%B1%80%E4%BA%8C%E6%89%8B%E6%88%BF%E5%AD%97%E4%BD%93%E5%8A%A0%E5%AF%86%E5%92%8C%E5%AD%97%E6%AE%B5%E5%8A%A0%E5%AF%86/"/>
      <url>/2020/09/12/%E9%87%91%E5%8D%8E%E5%B8%82%E5%9B%BD%E5%9C%9F%E5%B1%80%E4%BA%8C%E6%89%8B%E6%88%BF%E5%AD%97%E4%BD%93%E5%8A%A0%E5%AF%86%E5%92%8C%E5%AD%97%E6%AE%B5%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网页链接：<a href="https://www.jhtmsf.com/">https://www.jhtmsf.com</a></p><p>接口地址：<a href="https://www.jhtmsf.com/House/GetPageForRoom">https://www.jhtmsf.com/House/GetPageForRoom</a></p><p>加密字段：请求头X-Sign和字体</p></blockquote><h3 id="请求头X-Sign字段解析"><a href="#请求头X-Sign字段解析" class="headerlink" title="请求头X-Sign字段解析"></a>请求头X-Sign字段解析</h3><ol><li><p>搜索x-sign字段，查找加密函数</p><p><img src="/images/image-20230410182339598.png" alt="image-20230410182339598"></p><p><img src="/images/image-20230410182400602.png" alt="image-20230410182400602"></p></li><li><p>genSign方法传入url和请求体，一个很简单的随机凭借字符串加密，将其扣取或者改写成python代码即可</p><p><img src="/images/image-20230410182640001.png" alt="image-20230410182640001"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sign</span>(<span class="hljs-params">url, data</span>):<br>    pn = url<br>    key = [<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>,<br>           <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>,<br>           <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;J&#x27;</span>, <span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;W&#x27;</span>, <span class="hljs-string">&#x27;X&#x27;</span>,<br>           <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;Z&#x27;</span>]<br>    sign = <span class="hljs-string">&#x27;&#x27;</span><br>    pn = pn.replace(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">if</span> data:<br>        ks = [<span class="hljs-string">&#x27;pagenumber&#x27;</span>, <span class="hljs-string">&#x27;pagesize&#x27;</span>, <span class="hljs-string">&#x27;sortname&#x27;</span>, <span class="hljs-string">&#x27;sortorder&#x27;</span>]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> data.keys():<br>                <span class="hljs-keyword">if</span> k.lower() == ks[i]:<br>                    pn += <span class="hljs-built_in">str</span>(data[k])<br>    num = random.randint(<span class="hljs-number">1000</span>, <span class="hljs-number">9999</span>)<br>    <span class="hljs-keyword">if</span> num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        tmp = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(pn))[::-<span class="hljs-number">1</span>]:<br>            tmp += pn[n]<br>        pn = tmp<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(pn)):<br>        k = pn[x]<br>        ki = key.index(k)<br>        sign += <span class="hljs-built_in">str</span>(ki)<br>    api = <span class="hljs-built_in">str</span>(num) + sign + <span class="hljs-built_in">str</span>(random.randint(<span class="hljs-number">1000</span>, <span class="hljs-number">9999</span>))<br>    <span class="hljs-keyword">return</span> api<br></code></pre></td></tr></table></figure></li></ol><h3 id="字体包加密"><a href="#字体包加密" class="headerlink" title="字体包加密"></a>字体包加密</h3><blockquote><p>html源码字体看上去像乱码一样，实际上是使用了字体包加密，python字体包解析需要用到fontTools模块</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><br><span class="hljs-comment"># 将字体包下载下来交给fontTools模块解析，如果不是ttf格式的，需要转成ttf格式</span><br>world = TTFont(<span class="hljs-string">&#x27;222.ttf&#x27;</span>)<br>woff_dict = world.getBestCmap()  <span class="hljs-comment"># 根据解析出来的字体包选择对应的获取方式，通常使用字典形式获取</span><br>keys = woff_dict[<span class="hljs-built_in">int</span>(str1)]<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字体加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>福建省公共资源交易中心请求参数AES加密解析</title>
      <link href="/2020/08/09/%E7%A6%8F%E5%BB%BA%E7%9C%81%E5%85%AC%E5%85%B1%E8%B5%84%E6%BA%90%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0AES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/08/09/%E7%A6%8F%E5%BB%BA%E7%9C%81%E5%85%AC%E5%85%B1%E8%B5%84%E6%BA%90%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0AES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># 网页链接 https://ggzyfw.fj.gov.cn/business/list<br># 数据接口 https://ggzyfw.fj.gov.cn/FwPortalApi/Trade/TradeInfo<br># 加密字段 请求头中的portal-sign 和 响应数据中的 Data<br></code></pre></td></tr></table></figure></blockquote><h3 id="portal-sign字段解析"><a href="#portal-sign字段解析" class="headerlink" title="portal-sign字段解析"></a>portal-sign字段解析</h3><ol><li><p>搜索加密字段portal-sign，找到对应的加密函数，打断点查看加密流程</p><p><img src="/images/image-20230410174027382.png" alt="image-20230410174027382"></p><p><img src="/images/image-20230410174140719.png" alt="image-20230410174140719"></p></li><li><p>将请求体放入f.getSign()函数中进行加密，查看该函数</p><p><img src="/images/image-20230410174351992.png" alt="image-20230410174351992"></p></li><li><p>该函数是将固定字符串和请求体中的部分键值对拼接，然后使用md5加密成32位字符串，可以将该函数扣取出来，补全既可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">t, e</span>) &#123;<br>    <span class="hljs-keyword">return</span> t.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">toUpperCase</span>() &gt; e.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">toUpperCase</span>() ? <span class="hljs-number">1</span> : t.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">toUpperCase</span>() == e.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">toUpperCase</span>() ? <span class="hljs-number">0</span> : -<span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">t</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(t).<span class="hljs-title function_">sort</span>(u), n = <span class="hljs-string">&quot;&quot;</span>, a = <span class="hljs-number">0</span>; a &lt; e.<span class="hljs-property">length</span>; a++)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">void</span> <span class="hljs-number">0</span> !== t[e[a]])<br>            <span class="hljs-keyword">if</span> (t[e[a]] &amp;&amp; t[e[a]] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> || t[e[a]] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>) &#123;<br>                <span class="hljs-keyword">var</span> i = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(t[e[a]]);<br>                n += e[a] + i<br>            &#125; <span class="hljs-keyword">else</span><br>                n += e[a] + t[e[a]];<br>    <span class="hljs-keyword">return</span> n<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">t</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e <span class="hljs-keyword">in</span> t)<br>        <span class="hljs-string">&quot;&quot;</span> !== t[e] &amp;&amp; <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> !== t[e] || <span class="hljs-keyword">delete</span> t[e];<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-string">&#x27;3637CB36B2E54A72A7002978D0506CDF&#x27;</span> + <span class="hljs-title function_">l</span>(t);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n)<br>    <span class="hljs-keyword">return</span> n.<span class="hljs-title class_">MD5</span>(<span class="hljs-number">32</span>).<span class="hljs-title function_">toLocaleLowerCase</span>()<br>&#125;<br><br>e = &#123;<br>    <span class="hljs-string">&quot;pageNo&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;pageSize&quot;</span>: <span class="hljs-number">20</span>, <span class="hljs-string">&quot;total&quot;</span>: <span class="hljs-number">4153</span>, <span class="hljs-string">&quot;AREACODE&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;M_PROJECT_TYPE&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;KIND&quot;</span>: <span class="hljs-string">&quot;GCJS&quot;</span>,<br>    <span class="hljs-string">&quot;GGTYPE&quot;</span>: <span class="hljs-string">&quot;2,3,7&quot;</span>, <span class="hljs-string">&quot;PROTYPE&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;timeType&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;BeginTime&quot;</span>: <span class="hljs-string">&quot;2022-10-06 00:00:00&quot;</span>,<br>    <span class="hljs-string">&quot;EndTime&quot;</span>: <span class="hljs-string">&quot;2023-04-06 23:59:59&quot;</span>, <span class="hljs-string">&quot;createTime&quot;</span>: [], <span class="hljs-string">&quot;ts&quot;</span>: <span class="hljs-string">&#x27;1680765912258&#x27;</span><br>&#125;<br><span class="hljs-keyword">var</span> sign = <span class="hljs-title function_">d</span>(e)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sign)<br></code></pre></td></tr></table></figure></li><li><p>得到portal-sign 加入请求头，即可获得响应体</p><p><img src="/images/image-20230410174927171.png" alt="image-20230410174927171"></p></li></ol><h3 id="响应体Data解析"><a href="#响应体Data解析" class="headerlink" title="响应体Data解析"></a>响应体Data解析</h3><ol><li><p>通过搜索response关键字，可以找到js中接收响应数据是怎么进行处理的</p><p><img src="/images/image-20230410180125354.png" alt="image-20230410180125354"></p></li><li><p>b(e.Data) b函数是对Data数据进行解密，点击查看解密流程</p><p><img src="/images/image-20230410180221572.png" alt="image-20230410180221572"></p></li><li><p>是经典的AES CBC加密方式，填充方法是pkcs7，加密的key和偏移值iv都是固定的，直接拿过来扣代码或者直接导包都可以</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto-js&#x27;</span>)<br><br><span class="hljs-comment">// 解密</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data, key, iv</span>) &#123; <span class="hljs-comment">//key,iv：16位的字符串</span><br>    <span class="hljs-keyword">var</span> key1 = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    <span class="hljs-keyword">var</span> iv1 = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> decrypted = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">decrypt</span>(data, key1, &#123;<br>        <span class="hljs-attr">iv</span>: iv1,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span>,<br>        <span class="hljs-attr">padding</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">pad</span>.<span class="hljs-property">Pkcs7</span><br>    &#125;);<br>    <span class="hljs-keyword">return</span> decrypted.<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">var</span> key = <span class="hljs-string">&quot;BE45D593014E4A4EB4449737660876CE&quot;</span>;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;A8909931867B0425&quot;</span>;<br>    <span class="hljs-keyword">var</span> pazzword = data<br>    pazzword = <span class="hljs-title function_">decrypt</span>(pazzword, key, iv);<br>    <span class="hljs-keyword">return</span> pazzword<br>&#125;<br><br></code></pre></td></tr></table></figure></li></ol><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猿人学app第一题fridaRPC远程调用</title>
      <link href="/2020/07/04/%E7%8C%BF%E4%BA%BA%E5%AD%A6app%E7%AC%AC%E4%B8%80%E9%A2%98fridaRPC%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/"/>
      <url>/2020/07/04/%E7%8C%BF%E4%BA%BA%E5%AD%A6app%E7%AC%AC%E4%B8%80%E9%A2%98fridaRPC%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:yuanrenxuem109.apk</p><p>接口：<a href="https://appmatch.yuanrenxue.cn/app1">https://appmatch.yuanrenxue.cn/app1</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程:"></a>解析流程:</h3><p>第一题未作双向认证，所以可以正常抓包，多次抓包发现，需要解决的参数只有sign,page是页数，t是时间戳</p><p><img src="/images/image-20230519171947102.png" alt="image-20230519171947102"></p><p>正常使用jadx打开，app未加壳，直接搜索“sign”,点进第一个看一下，发现一个类似路由一样的东西,也指明了路由app1，应该就是i这里了，看一下OooO00o方法是什么，点击右键，查找用例,再点进去看一下</p><p><img src="/images/image-20230519172730114.png" alt="image-20230519172730114"></p><p><img src="/images/image-20230519172821634.png" alt="image-20230519172821634"></p><p><img src="/images/image-20230519172937232.png" alt="image-20230519172937232"></p><p>在这里可以看到sb是一个字符串，然后sign方法中传入的是sb转字节数组，我们再看一下sign方法什么</p><p><img src="/images/image-20230519173146117.png" alt="image-20230519173146117"></p><p>sign方法传入一个字节数组后，进行了一系列操作，我们直接用frida看一下传入的参数是什么，再看下返回了什么</p><p><img src="/images/image-20230519173452868.png" alt="image-20230519173452868"></p><p>由于传入的是一个字节数组，所以我们需要先转换成字符串才知道传入的参数是什么</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">bin2String</span>(<span class="hljs-params">array</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>.<span class="hljs-property">fromCharCode</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-title class_">String</span>, array)<br>&#125;<br><br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.yuanrenxue.match2022.security.Sign&quot;</span>).<span class="hljs-property">sign</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">bArr</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">bin2String</span>(bArr));<br>        <span class="hljs-keyword">let</span> res = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sign</span>(bArr);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>经过frida调试，我们可以看到,传入的参数是 page + t 就是页数加时间戳</p><p><img src="/images/image-20230519175231586.png" alt="image-20230519175231586"></p><p>我们这里直接使用frida rpc调用sign方法，来获取返回值，因为我们传入的是字符串，所以需要将数据转成字节数组才行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">StringToByte</span>(<span class="hljs-params">str</span>) &#123;<br>    <span class="hljs-keyword">var</span> re = [], idx;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-property">length</span>; i++) &#123;<br>        idx = str.<span class="hljs-title function_">charCodeAt</span>(i);<br>        <span class="hljs-keyword">if</span> (idx &amp; <span class="hljs-number">0xff00</span>) &#123;<br>            re.<span class="hljs-title function_">push</span>(idx &gt;&gt; <span class="hljs-number">8</span>);<br>            re.<span class="hljs-title function_">push</span>(idx &amp; <span class="hljs-number">0xff</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            re.<span class="hljs-title function_">push</span>(idx)<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> re;<br>&#125;<br><span class="hljs-comment">//主动调用</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">invokesign</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-keyword">var</span> result = <span class="hljs-literal">null</span>;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// Java.choose(className, callback)，在内存中扫描java堆</span><br>        <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.yuanrenxue.match2022.security.Sign&quot;</span>,&#123;<br>            <span class="hljs-comment">// 找到匹配对象</span><br>            <span class="hljs-attr">onMatch</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>)&#123;<br>                <span class="hljs-comment">// console.log(instance);</span><br>                result = instance.<span class="hljs-title function_">sign</span>(<span class="hljs-title class_">StringToByte</span>(data));<br>                <span class="hljs-comment">// 扫描完成调用</span><br>            &#125;,<span class="hljs-attr">onComplete</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;&#125;<br>        &#125;)<br>    &#125;);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// 将对象暴露出来</span><br>rpc.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">invokesig</span>:invokesign,<br>&#125;<br></code></pre></td></tr></table></figure><p>在使用python来调用frida参与请求</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">session = frida.get_remote_device().attach(<span class="hljs-string">&quot;猿人学2022&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./1..js&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    script = session.create_script(f.read())<br><br>script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_message)<br>script.load()<br><span class="hljs-comment"># print(script.exports.invokesig(&quot;page=11684157134&quot;))</span><br><span class="hljs-comment"># sys.stdin.read()  # 标准化输出？？</span><br><br>total = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">101</span>):<br>    headers = &#123;<br>        <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;appmatch.yuanrenxue.cn&#x27;</span>,<br>        <span class="hljs-string">&#x27;accept-language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8&#x27;</span>,<br>        <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Linux; U; Android 12; zh-cn; Pixel 3a Build/SP2A.220505.008) AppleWebKit/533.1 (KHTML, like Gecko) Version/5.0 Mobile Safari/533.1&#x27;</span>,<br>        <span class="hljs-string">&#x27;content-type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;cache-control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    &#125;<br>    data = &#123;<br>        <span class="hljs-string">&#x27;page&#x27;</span>: i,<br>        <span class="hljs-string">&#x27;t&#x27;</span>: <span class="hljs-built_in">int</span>(time.time()),<br>    &#125;<br>    data[<span class="hljs-string">&#x27;sign&#x27;</span>] = script.exports.invokesig(<span class="hljs-string">f&quot;page=<span class="hljs-subst">&#123;data[<span class="hljs-string">&#x27;page&#x27;</span>]&#125;</span><span class="hljs-subst">&#123;data[<span class="hljs-string">&#x27;t&#x27;</span>]&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(data[<span class="hljs-string">&#x27;sign&#x27;</span>])<br>    response = requests.post(<span class="hljs-string">&#x27;https://appmatch.yuanrenxue.cn/app1&#x27;</span>, headers=headers, data=data).json()<br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> response[<span class="hljs-string">&#x27;data&#x27;</span>]:<br>        total += <span class="hljs-built_in">int</span>(num[<span class="hljs-string">&#x27;value&#x27;</span>])<br><br><span class="hljs-built_in">print</span>(total)<br></code></pre></td></tr></table></figure><p>最后请求成功，获取到了100页的数据之和</p><p><img src="/images/image-20230519175805552.png" alt="image-20230519175805552"></p>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> 猿人学 </tag>
            
            <tag> RPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>房天下登录密码RSA加密解析</title>
      <link href="/2020/06/02/%E6%88%BF%E5%A4%A9%E4%B8%8B%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/06/02/%E6%88%BF%E5%A4%A9%E4%B8%8B%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网站地址：<a href="https://cs.esf.fang.com/?backurl=https://cs.esf.fang.com/">https://cs.esf.fang.com/?backurl=https://cs.esf.fang.com/</a></p><p>登录接口：<a href="https://cs.esf.fang.com/login.api">https://cs.esf.fang.com/login.api</a></p><p>加密字段：pwd</p><p><img src="/images/image-20230411173525101.png" alt="image-20230411173525101"></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>1.直接搜索关键字pwd，找到对应的加密函数,发现是RSA加密，key_to_encode是公钥，可以再html页面里面找到，第二个参数是我们输入的密码</p><p><img src="/images/image-20230411174008260.png" alt="image-20230411174008260"></p><p><img src="/images/image-20230411175148466.png" alt="image-20230411175148466"></p><p>2.扣取代码或者导包即可完成加密</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br></pre></td><td class="code"><pre><code class="hljs javascript">navigator = <span class="hljs-variable language_">this</span>;<br><span class="hljs-variable language_">window</span> = <span class="hljs-variable language_">this</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-params">n</span>) &#123;<br>    maxDigits = n;<br>    <span class="hljs-variable constant_">ZERO_ARRAY</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(maxDigits);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>; t &lt; <span class="hljs-variable constant_">ZERO_ARRAY</span>.<span class="hljs-property">length</span>; t++)<br>        <span class="hljs-variable constant_">ZERO_ARRAY</span>[t] = <span class="hljs-number">0</span>;<br>    bigZero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    bigOne = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    bigOne.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BigInt</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">digits</span> = <span class="hljs-keyword">typeof</span> n == <span class="hljs-string">&quot;boolean&quot;</span> &amp;&amp; n == !<span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : <span class="hljs-variable constant_">ZERO_ARRAY</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromDecimal</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = n.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>) == <span class="hljs-string">&quot;-&quot;</span>, t = u ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>, i, f, r; t &lt; n.<span class="hljs-property">length</span> &amp;&amp; n.<span class="hljs-title function_">charAt</span>(t) == <span class="hljs-string">&quot;0&quot;</span>; )<br>        ++t;<br>    <span class="hljs-keyword">if</span> (t == n.<span class="hljs-property">length</span>)<br>        i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (f = n.<span class="hljs-property">length</span> - t,<br>        r = f % dpl10,<br>        r == <span class="hljs-number">0</span> &amp;&amp; (r = dpl10),<br>        i = <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-title class_">Number</span>(n.<span class="hljs-title function_">substr</span>(t, r))),<br>        t += r; t &lt; n.<span class="hljs-property">length</span>; )<br>            i = <span class="hljs-title function_">biAdd</span>(<span class="hljs-title function_">biMultiply</span>(i, lr10), <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-title class_">Number</span>(n.<span class="hljs-title function_">substr</span>(t, dpl10)))),<br>            t += dpl10;<br>        i.<span class="hljs-property">isNeg</span> = u<br>    &#125;<br>    <span class="hljs-keyword">return</span> i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biCopy</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>(!<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> t.<span class="hljs-property">digits</span> = n.<span class="hljs-property">digits</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>),<br>    t.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span>,<br>    t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, i;<br>    <span class="hljs-keyword">for</span> (t.<span class="hljs-property">isNeg</span> = n &lt; <span class="hljs-number">0</span>,<br>    n = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(n),<br>    i = <span class="hljs-number">0</span>; n &gt; <span class="hljs-number">0</span>; )<br>        t.<span class="hljs-property">digits</span>[i++] = n &amp; maxDigitVal,<br>        n = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(n / biRadix);<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">reverseStr</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-string">&quot;&quot;</span>, t = n.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; t &gt; -<span class="hljs-number">1</span>; --t)<br>        i += n.<span class="hljs-title function_">charAt</span>(t);<br>    <span class="hljs-keyword">return</span> i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biToString</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, i, u;<br>    <span class="hljs-keyword">for</span> (r.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = t,<br>    i = <span class="hljs-title function_">biDivideModulo</span>(n, r),<br>    u = hexatrigesimalToChar[i[<span class="hljs-number">1</span>].<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>]]; <span class="hljs-title function_">biCompare</span>(i[<span class="hljs-number">0</span>], bigZero) == <span class="hljs-number">1</span>; )<br>        i = <span class="hljs-title function_">biDivideModulo</span>(i[<span class="hljs-number">0</span>], r),<br>        digit = i[<span class="hljs-number">1</span>].<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>],<br>        u += hexatrigesimalToChar[i[<span class="hljs-number">1</span>].<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>]];<br>    <span class="hljs-keyword">return</span> (n.<span class="hljs-property">isNeg</span> ? <span class="hljs-string">&quot;-&quot;</span> : <span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-title function_">reverseStr</span>(u)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biToDecimal</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, t, r;<br>    <span class="hljs-keyword">for</span> (i.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>,<br>    t = <span class="hljs-title function_">biDivideModulo</span>(n, i),<br>    r = <span class="hljs-title class_">String</span>(t[<span class="hljs-number">1</span>].<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>]); <span class="hljs-title function_">biCompare</span>(t[<span class="hljs-number">0</span>], bigZero) == <span class="hljs-number">1</span>; )<br>        t = <span class="hljs-title function_">biDivideModulo</span>(t[<span class="hljs-number">0</span>], i),<br>        r += <span class="hljs-title class_">String</span>(t[<span class="hljs-number">1</span>].<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>]);<br>    <span class="hljs-keyword">return</span> (n.<span class="hljs-property">isNeg</span> ? <span class="hljs-string">&quot;-&quot;</span> : <span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-title function_">reverseStr</span>(r)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">digitToHex</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i)<br>        t += hexToChar[n &amp; <span class="hljs-number">15</span>],<br>        n &gt;&gt;&gt;= <span class="hljs-number">4</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">reverseStr</span>(t)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biToHex</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-string">&quot;&quot;</span>, r = <span class="hljs-title function_">biHighIndex</span>(n), t = <span class="hljs-title function_">biHighIndex</span>(n); t &gt; -<span class="hljs-number">1</span>; --t)<br>        i += <span class="hljs-title function_">digitToHex</span>(n.<span class="hljs-property">digits</span>[t]);<br>    <span class="hljs-keyword">return</span> i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">charToHex</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-number">48</span><br>      , u = t + <span class="hljs-number">9</span><br>      , i = <span class="hljs-number">97</span><br>      , f = i + <span class="hljs-number">25</span><br>      , r = <span class="hljs-number">65</span>;<br>    <span class="hljs-keyword">return</span> n &gt;= t &amp;&amp; n &lt;= u ? n - t : n &gt;= r &amp;&amp; n &lt;= <span class="hljs-number">90</span> ? <span class="hljs-number">10</span> + n - r : n &gt;= i &amp;&amp; n &lt;= f ? <span class="hljs-number">10</span> + n - i : <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hexToDigit</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>, r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(n.<span class="hljs-property">length</span>, <span class="hljs-number">4</span>), i = <span class="hljs-number">0</span>; i &lt; r; ++i)<br>        t &lt;&lt;= <span class="hljs-number">4</span>,<br>        t |= <span class="hljs-title function_">charToHex</span>(n.<span class="hljs-title function_">charCodeAt</span>(i));<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromHex</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, u = n.<span class="hljs-property">length</span>, t = u, r = <span class="hljs-number">0</span>; t &gt; <span class="hljs-number">0</span>; t -= <span class="hljs-number">4</span>,<br>    ++r)<br>        i.<span class="hljs-property">digits</span>[r] = <span class="hljs-title function_">hexToDigit</span>(n.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(t - <span class="hljs-number">4</span>, <span class="hljs-number">0</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(t, <span class="hljs-number">4</span>)));<br>    <span class="hljs-keyword">return</span> i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biFromString</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> f = n.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>) == <span class="hljs-string">&quot;-&quot;</span>, e = f ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>, i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, u;<br>    <span class="hljs-keyword">for</span> (r.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>,<br>    u = n.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; u &gt;= e; u--) &#123;<br>        <span class="hljs-keyword">var</span> o = n.<span class="hljs-title function_">charCodeAt</span>(u)<br>          , s = <span class="hljs-title function_">charToHex</span>(o)<br>          , h = <span class="hljs-title function_">biMultiplyDigit</span>(r, s);<br>        i = <span class="hljs-title function_">biAdd</span>(i, h);<br>        r = <span class="hljs-title function_">biMultiplyDigit</span>(r, t)<br>    &#125;<br>    <span class="hljs-keyword">return</span> i.<span class="hljs-property">isNeg</span> = f,<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDump</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">return</span> (n.<span class="hljs-property">isNeg</span> ? <span class="hljs-string">&quot;-&quot;</span> : <span class="hljs-string">&quot;&quot;</span>) + n.<span class="hljs-property">digits</span>.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot; &quot;</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biAdd</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> r, u, f, i;<br>    <span class="hljs-keyword">if</span> (n.<span class="hljs-property">isNeg</span> != t.<span class="hljs-property">isNeg</span>)<br>        t.<span class="hljs-property">isNeg</span> = !t.<span class="hljs-property">isNeg</span>,<br>        r = <span class="hljs-title function_">biSubtract</span>(n, t),<br>        t.<span class="hljs-property">isNeg</span> = !t.<span class="hljs-property">isNeg</span>;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        u = <span class="hljs-number">0</span>,<br>        i = <span class="hljs-number">0</span>; i &lt; n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span>; ++i)<br>            f = n.<span class="hljs-property">digits</span>[i] + t.<span class="hljs-property">digits</span>[i] + u,<br>            r.<span class="hljs-property">digits</span>[i] = f % biRadix,<br>            u = <span class="hljs-title class_">Number</span>(f &gt;= biRadix);<br>        r.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> r<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biSubtract</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> r, f, u, i;<br>    <span class="hljs-keyword">if</span> (n.<span class="hljs-property">isNeg</span> != t.<span class="hljs-property">isNeg</span>)<br>        t.<span class="hljs-property">isNeg</span> = !t.<span class="hljs-property">isNeg</span>,<br>        r = <span class="hljs-title function_">biAdd</span>(n, t),<br>        t.<span class="hljs-property">isNeg</span> = !t.<span class="hljs-property">isNeg</span>;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        u = <span class="hljs-number">0</span>,<br>        i = <span class="hljs-number">0</span>; i &lt; n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span>; ++i)<br>            f = n.<span class="hljs-property">digits</span>[i] - t.<span class="hljs-property">digits</span>[i] + u,<br>            r.<span class="hljs-property">digits</span>[i] = f % biRadix,<br>            r.<span class="hljs-property">digits</span>[i] &lt; <span class="hljs-number">0</span> &amp;&amp; (r.<span class="hljs-property">digits</span>[i] += biRadix),<br>            u = <span class="hljs-number">0</span> - <span class="hljs-title class_">Number</span>(f &lt; <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span> (u == -<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">for</span> (u = <span class="hljs-number">0</span>,<br>            i = <span class="hljs-number">0</span>; i &lt; n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span>; ++i)<br>                f = <span class="hljs-number">0</span> - r.<span class="hljs-property">digits</span>[i] + u,<br>                r.<span class="hljs-property">digits</span>[i] = f % biRadix,<br>                r.<span class="hljs-property">digits</span>[i] &lt; <span class="hljs-number">0</span> &amp;&amp; (r.<span class="hljs-property">digits</span>[i] += biRadix),<br>                u = <span class="hljs-number">0</span> - <span class="hljs-title class_">Number</span>(f &lt; <span class="hljs-number">0</span>);<br>            r.<span class="hljs-property">isNeg</span> = !n.<span class="hljs-property">isNeg</span><br>        &#125; <span class="hljs-keyword">else</span><br>            r.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> r<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; t &gt; <span class="hljs-number">0</span> &amp;&amp; n.<span class="hljs-property">digits</span>[t] == <span class="hljs-number">0</span>; )<br>        --t;<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biNumBits</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-title function_">biHighIndex</span>(n), r = n.<span class="hljs-property">digits</span>[i], u = (i + <span class="hljs-number">1</span>) * bitsPerDigit, t = u; t &gt; u - bitsPerDigit; --t) &#123;<br>        <span class="hljs-keyword">if</span> ((r &amp; <span class="hljs-number">32768</span>) != <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>;<br>        r &lt;&lt;= <span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiply</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, u, o = <span class="hljs-title function_">biHighIndex</span>(n), s = <span class="hljs-title function_">biHighIndex</span>(t), e, f, r = <span class="hljs-number">0</span>; r &lt;= s; ++r) &#123;<br>        <span class="hljs-keyword">for</span> (u = <span class="hljs-number">0</span>,<br>        f = r,<br>        j = <span class="hljs-number">0</span>; j &lt;= o; ++j,<br>        ++f)<br>            e = i.<span class="hljs-property">digits</span>[f] + n.<span class="hljs-property">digits</span>[j] * t.<span class="hljs-property">digits</span>[r] + u,<br>            i.<span class="hljs-property">digits</span>[f] = e &amp; maxDigitVal,<br>            u = e &gt;&gt;&gt; biRadixBits;<br>        i.<span class="hljs-property">digits</span>[r + o + <span class="hljs-number">1</span>] = u<br>    &#125;<br>    <span class="hljs-keyword">return</span> i.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span> != t.<span class="hljs-property">isNeg</span>,<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyDigit</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> u, r, f, i;<br>    <span class="hljs-keyword">for</span> (result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>    u = <span class="hljs-title function_">biHighIndex</span>(n),<br>    r = <span class="hljs-number">0</span>,<br>    i = <span class="hljs-number">0</span>; i &lt;= u; ++i)<br>        f = result.<span class="hljs-property">digits</span>[i] + n.<span class="hljs-property">digits</span>[i] * t + r,<br>        result.<span class="hljs-property">digits</span>[i] = f &amp; maxDigitVal,<br>        r = f &gt;&gt;&gt; biRadixBits;<br>    <span class="hljs-keyword">return</span> result.<span class="hljs-property">digits</span>[<span class="hljs-number">1</span> + u] = r,<br>    result<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayCopy</span>(<span class="hljs-params">n, t, i, r, u</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> o = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(t + u, n.<span class="hljs-property">length</span>), f = t, e = r; f &lt; o; ++f,<br>    ++e)<br>        i[e] = n[f]<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biShiftLeft</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(t / bitsPerDigit), i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, u, o, r, f;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-title function_">arrayCopy</span>(n.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, i.<span class="hljs-property">digits</span>, e, i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - e),<br>    u = t % bitsPerDigit,<br>    o = bitsPerDigit - u,<br>    r = i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>,<br>    f = r - <span class="hljs-number">1</span>; r &gt; <span class="hljs-number">0</span>; --r,<br>    --f)<br>        i.<span class="hljs-property">digits</span>[r] = i.<span class="hljs-property">digits</span>[r] &lt;&lt; u &amp; maxDigitVal | (i.<span class="hljs-property">digits</span>[f] &amp; highBitMasks[u]) &gt;&gt;&gt; o;<br>    <span class="hljs-keyword">return</span> i.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = i.<span class="hljs-property">digits</span>[r] &lt;&lt; u &amp; maxDigitVal,<br>    i.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span>,<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biShiftRight</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(t / bitsPerDigit), i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, u, o, r, f;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-title function_">arrayCopy</span>(n.<span class="hljs-property">digits</span>, e, i.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - e),<br>    u = t % bitsPerDigit,<br>    o = bitsPerDigit - u,<br>    r = <span class="hljs-number">0</span>,<br>    f = r + <span class="hljs-number">1</span>; r &lt; i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; ++r,<br>    ++f)<br>        i.<span class="hljs-property">digits</span>[r] = i.<span class="hljs-property">digits</span>[r] &gt;&gt;&gt; u | (i.<span class="hljs-property">digits</span>[f] &amp; lowBitMasks[u]) &lt;&lt; o;<br>    <span class="hljs-keyword">return</span> i.<span class="hljs-property">digits</span>[i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] &gt;&gt;&gt;= u,<br>    i.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span>,<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyByRadixPower</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(n.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, i.<span class="hljs-property">digits</span>, t, i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - t),<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivideByRadixPower</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(n.<span class="hljs-property">digits</span>, t, i.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - t),<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biModuloByRadixPower</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">arrayCopy</span>(n.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, i.<span class="hljs-property">digits</span>, <span class="hljs-number">0</span>, t),<br>    i<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biCompare</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">if</span> (n.<span class="hljs-property">isNeg</span> != t.<span class="hljs-property">isNeg</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(n.<span class="hljs-property">isNeg</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = n.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i)<br>        <span class="hljs-keyword">if</span> (n.<span class="hljs-property">digits</span>[i] != t.<span class="hljs-property">digits</span>[i])<br>            <span class="hljs-keyword">return</span> n.<span class="hljs-property">isNeg</span> ? <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(n.<span class="hljs-property">digits</span>[i] &gt; t.<span class="hljs-property">digits</span>[i]) : <span class="hljs-number">1</span> - <span class="hljs-number">2</span> * <span class="hljs-title class_">Number</span>(n.<span class="hljs-property">digits</span>[i] &lt; t.<span class="hljs-property">digits</span>[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivideModulo</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-title function_">biNumBits</span>(n), s = <span class="hljs-title function_">biNumBits</span>(t), v = t.<span class="hljs-property">isNeg</span>, r, i, u, e, h, o, f, y, p;<br>    <span class="hljs-keyword">if</span> (a &lt; s)<br>        <span class="hljs-keyword">return</span> n.<span class="hljs-property">isNeg</span> ? (r = <span class="hljs-title function_">biCopy</span>(bigOne),<br>        r.<span class="hljs-property">isNeg</span> = !t.<span class="hljs-property">isNeg</span>,<br>        n.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>,<br>        t.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>,<br>        i = <span class="hljs-title function_">biSubtract</span>(t, n),<br>        n.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">0</span>,<br>        t.<span class="hljs-property">isNeg</span> = v) : (r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        i = <span class="hljs-title function_">biCopy</span>(n)),<br>        [r, i];<br>    <span class="hljs-keyword">for</span> (r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>    i = n,<br>    u = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(s / bitsPerDigit) - <span class="hljs-number">1</span>,<br>    e = <span class="hljs-number">0</span>; t.<span class="hljs-property">digits</span>[u] &lt; biHalfRadix; )<br>        t = <span class="hljs-title function_">biShiftLeft</span>(t, <span class="hljs-number">1</span>),<br>        ++e,<br>        ++s,<br>        u = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(s / bitsPerDigit) - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-title function_">biShiftLeft</span>(i, e),<br>    a += e,<br>    h = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(a / bitsPerDigit) - <span class="hljs-number">1</span>,<br>    o = <span class="hljs-title function_">biMultiplyByRadixPower</span>(t, h - u); <span class="hljs-title function_">biCompare</span>(i, o) != -<span class="hljs-number">1</span>; )<br>        ++r.<span class="hljs-property">digits</span>[h - u],<br>        i = <span class="hljs-title function_">biSubtract</span>(i, o);<br>    <span class="hljs-keyword">for</span> (f = h; f &gt; u; --f) &#123;<br>        <span class="hljs-keyword">var</span> c = f &gt;= i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : i.<span class="hljs-property">digits</span>[f]<br>          , w = f - <span class="hljs-number">1</span> &gt;= i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : i.<span class="hljs-property">digits</span>[f - <span class="hljs-number">1</span>]<br>          , b = f - <span class="hljs-number">2</span> &gt;= i.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : i.<span class="hljs-property">digits</span>[f - <span class="hljs-number">2</span>]<br>          , l = u &gt;= t.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : t.<span class="hljs-property">digits</span>[u]<br>          , k = u - <span class="hljs-number">1</span> &gt;= t.<span class="hljs-property">digits</span>.<span class="hljs-property">length</span> ? <span class="hljs-number">0</span> : t.<span class="hljs-property">digits</span>[u - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>] = c == l ? maxDigitVal : <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((c * biRadix + w) / l),<br>        y = r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>] * (l * biRadix + k),<br>        p = c * biRadixSquared + (w * biRadix + b); y &gt; p; )<br>            --r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>],<br>            y = r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>] * (l * biRadix | k),<br>            p = c * biRadix * biRadix + (w * biRadix + b);<br>        o = <span class="hljs-title function_">biMultiplyByRadixPower</span>(t, f - u - <span class="hljs-number">1</span>);<br>        i = <span class="hljs-title function_">biSubtract</span>(i, <span class="hljs-title function_">biMultiplyDigit</span>(o, r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>]));<br>        i.<span class="hljs-property">isNeg</span> &amp;&amp; (i = <span class="hljs-title function_">biAdd</span>(i, o),<br>        --r.<span class="hljs-property">digits</span>[f - u - <span class="hljs-number">1</span>])<br>    &#125;<br>    <span class="hljs-keyword">return</span> i = <span class="hljs-title function_">biShiftRight</span>(i, e),<br>    r.<span class="hljs-property">isNeg</span> = n.<span class="hljs-property">isNeg</span> != v,<br>    n.<span class="hljs-property">isNeg</span> &amp;&amp; (r = v ? <span class="hljs-title function_">biAdd</span>(r, bigOne) : <span class="hljs-title function_">biSubtract</span>(r, bigOne),<br>    t = <span class="hljs-title function_">biShiftRight</span>(t, e),<br>    i = <span class="hljs-title function_">biSubtract</span>(t, i)),<br>    i.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title function_">biHighIndex</span>(i) == <span class="hljs-number">0</span> &amp;&amp; (i.<span class="hljs-property">isNeg</span> = !<span class="hljs-number">1</span>),<br>    [r, i]<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biDivide</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biDivideModulo</span>(n, t)[<span class="hljs-number">0</span>]<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biModulo</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biDivideModulo</span>(n, t)[<span class="hljs-number">1</span>]<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biMultiplyMod</span>(<span class="hljs-params">n, t, i</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">biModulo</span>(<span class="hljs-title function_">biMultiply</span>(n, t), i)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biPow</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = bigOne, i = n; ; ) &#123;<br>        <span class="hljs-keyword">if</span> ((t &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; (r = <span class="hljs-title function_">biMultiply</span>(r, i)),<br>        t &gt;&gt;= <span class="hljs-number">1</span>,<br>        t == <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>;<br>        i = <span class="hljs-title function_">biMultiply</span>(i, i)<br>    &#125;<br>    <span class="hljs-keyword">return</span> r<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">biPowMod</span>(<span class="hljs-params">n, t, i</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f = bigOne, u = n, r = t; ; ) &#123;<br>        <span class="hljs-keyword">if</span> ((r.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; (f = <span class="hljs-title function_">biMultiplyMod</span>(f, u, i)),<br>        r = <span class="hljs-title function_">biShiftRight</span>(r, <span class="hljs-number">1</span>),<br>        r.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title function_">biHighIndex</span>(r) == <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>;<br>        u = <span class="hljs-title function_">biMultiplyMod</span>(u, u, i)<br>    &#125;<br>    <span class="hljs-keyword">return</span> f<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span> = <span class="hljs-title function_">biCopy</span>(n);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> = <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    t.<span class="hljs-property">digits</span>[<span class="hljs-number">2</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mu</span> = <span class="hljs-title function_">biDivide</span>(t, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span>.<span class="hljs-property">digits</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulo</span> = <span class="hljs-title class_">BarrettMu</span>_modulo;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">multiplyMod</span> = <span class="hljs-title class_">BarrettMu</span>_multiplyMod;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">powMod</span> = <span class="hljs-title class_">BarrettMu</span>_powMod<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_modulo</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title function_">biDivideByRadixPower</span>(n, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> - <span class="hljs-number">1</span>), u = <span class="hljs-title function_">biMultiply</span>(r, <span class="hljs-variable language_">this</span>.<span class="hljs-property">mu</span>), f = <span class="hljs-title function_">biDivideByRadixPower</span>(u, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>), e = <span class="hljs-title function_">biModuloByRadixPower</span>(n, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>), o = <span class="hljs-title function_">biMultiply</span>(f, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>), s = <span class="hljs-title function_">biModuloByRadixPower</span>(o, <span class="hljs-variable language_">this</span>.<span class="hljs-property">k</span> + <span class="hljs-number">1</span>), t = <span class="hljs-title function_">biSubtract</span>(e, s), i;<br>    <span class="hljs-keyword">for</span> (t.<span class="hljs-property">isNeg</span> &amp;&amp; (t = <span class="hljs-title function_">biAdd</span>(t, <span class="hljs-variable language_">this</span>.<span class="hljs-property">bkplus1</span>)),<br>    i = <span class="hljs-title function_">biCompare</span>(t, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) &gt;= <span class="hljs-number">0</span>; i; )<br>        t = <span class="hljs-title function_">biSubtract</span>(t, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>),<br>        i = <span class="hljs-title function_">biCompare</span>(t, <span class="hljs-variable language_">this</span>.<span class="hljs-property">modulus</span>) &gt;= <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_multiplyMod</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-title function_">biMultiply</span>(n, t);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">modulo</span>(i)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">BarrettMu_powMod</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> u = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>, r, i;<br>    <span class="hljs-keyword">for</span> (u.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>,<br>    r = n,<br>    i = t; ; ) &#123;<br>        <span class="hljs-keyword">if</span> ((i.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> &amp;&amp; (u = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMod</span>(u, r)),<br>        i = <span class="hljs-title function_">biShiftRight</span>(i, <span class="hljs-number">1</span>),<br>        i.<span class="hljs-property">digits</span>[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title function_">biHighIndex</span>(i) == <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>;<br>        r = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplyMod</span>(r, r)<br>    &#125;<br>    <span class="hljs-keyword">return</span> u<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">RSAKeyPair</span>(<span class="hljs-params">n, t, i</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">e</span> = <span class="hljs-title function_">biFromHex</span>(n);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">d</span> = <span class="hljs-title function_">biFromHex</span>(t);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span> = <span class="hljs-title function_">biFromHex</span>(i);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">digitSize</span> = <span class="hljs-number">2</span> * <span class="hljs-title function_">biHighIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span>) + <span class="hljs-number">2</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chunkSize</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">digitSize</span> - <span class="hljs-number">11</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">radix</span> = <span class="hljs-number">16</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">barrett</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BarrettMu</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">m</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">twoDigit</span>(<span class="hljs-params">n</span>) &#123;<br>    <span class="hljs-keyword">return</span> (n &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&quot;0&quot;</span> : <span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-title class_">String</span>(n)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">encryptedString</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> e, o, s, h, c, i, f, u, v, l, y;<br>    <span class="hljs-keyword">if</span> (n.<span class="hljs-property">chunkSize</span> &gt; n.<span class="hljs-property">digitSize</span> - <span class="hljs-number">11</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = [], p = t.<span class="hljs-property">length</span>, r = <span class="hljs-number">0</span>; r &lt; p; )<br>        a[r] = t.<span class="hljs-title function_">charCodeAt</span>(r),<br>        r++;<br>    <span class="hljs-keyword">for</span> (e = a.<span class="hljs-property">length</span>,<br>    o = <span class="hljs-string">&quot;&quot;</span>,<br>    r = <span class="hljs-number">0</span>; r &lt; e; r += n.<span class="hljs-property">chunkSize</span>) &#123;<br>        <span class="hljs-keyword">for</span> (c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInt</span>,<br>        s = <span class="hljs-number">0</span>,<br>        f = r + n.<span class="hljs-property">chunkSize</span> &gt; e ? e % n.<span class="hljs-property">chunkSize</span> : n.<span class="hljs-property">chunkSize</span>,<br>        u = [],<br>        i = <span class="hljs-number">0</span>; i &lt; f; i++)<br>            u[i] = a[r + f - <span class="hljs-number">1</span> - i];<br>        <span class="hljs-keyword">for</span> (u[f] = <span class="hljs-number">0</span>,<br>        v = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">8</span>, n.<span class="hljs-property">digitSize</span> - <span class="hljs-number">3</span> - f),<br>        i = <span class="hljs-number">0</span>; i &lt; v; i++)<br>            u[f + <span class="hljs-number">1</span> + i] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">254</span>) + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (u[n.<span class="hljs-property">digitSize</span> - <span class="hljs-number">2</span>] = <span class="hljs-number">2</span>,<br>        u[n.<span class="hljs-property">digitSize</span> - <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>,<br>        h = <span class="hljs-number">0</span>; h &lt; n.<span class="hljs-property">digitSize</span>; ++s)<br>            c.<span class="hljs-property">digits</span>[s] = u[h++],<br>            c.<span class="hljs-property">digits</span>[s] += u[h++] &lt;&lt; <span class="hljs-number">8</span>;<br>        l = n.<span class="hljs-property">barrett</span>.<span class="hljs-title function_">powMod</span>(c, n.<span class="hljs-property">e</span>);<br>        y = n.<span class="hljs-property">radix</span> == <span class="hljs-number">16</span> ? <span class="hljs-title function_">biToHex</span>(l) : <span class="hljs-title function_">biToString</span>(l, n.<span class="hljs-property">radix</span>);<br>        o += y + <span class="hljs-string">&quot; &quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> o.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, o.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">decryptedString</span>(<span class="hljs-params">n, t</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = t.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot; &quot;</span>), i = <span class="hljs-string">&quot;&quot;</span>, r, u, o, f = <span class="hljs-number">0</span>; f &lt; e.<span class="hljs-property">length</span>; ++f)<br>        <span class="hljs-keyword">for</span> (o = n.<span class="hljs-property">radix</span> == <span class="hljs-number">16</span> ? <span class="hljs-title function_">biFromHex</span>(e[f]) : <span class="hljs-title function_">biFromString</span>(e[f], n.<span class="hljs-property">radix</span>),<br>        u = n.<span class="hljs-property">barrett</span>.<span class="hljs-title function_">powMod</span>(o, n.<span class="hljs-property">d</span>),<br>        r = <span class="hljs-number">0</span>; r &lt;= <span class="hljs-title function_">biHighIndex</span>(u); ++r)<br>            i += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(u.<span class="hljs-property">digits</span>[r] &amp; <span class="hljs-number">255</span>, u.<span class="hljs-property">digits</span>[r] &gt;&gt; <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">return</span> i.<span class="hljs-title function_">charCodeAt</span>(i.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> &amp;&amp; (i = i.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, i.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)),<br>    i<br>&#125;<br><span class="hljs-keyword">var</span> biRadixBase = <span class="hljs-number">2</span>, biRadixBits = <span class="hljs-number">16</span>, bitsPerDigit = biRadixBits, biRadix = <span class="hljs-number">65536</span>, biHalfRadix = biRadix &gt;&gt;&gt; <span class="hljs-number">1</span>, biRadixSquared = biRadix * biRadix, maxDigitVal = biRadix - <span class="hljs-number">1</span>, maxInteger = <span class="hljs-number">9999999999999998</span>, maxDigits, <span class="hljs-variable constant_">ZERO_ARRAY</span>, bigZero, bigOne, dpl10, lr10, hexatrigesimalToChar, hexToChar, highBitMasks, lowBitMasks;<br><span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-number">20</span>);<br>dpl10 = <span class="hljs-number">15</span>;<br>lr10 = <span class="hljs-title function_">biFromNumber</span>(<span class="hljs-number">1e15</span>);<br>hexatrigesimalToChar = [<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;z&quot;</span>];<br>hexToChar = [<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>];<br>highBitMasks = [<span class="hljs-number">0</span>, <span class="hljs-number">32768</span>, <span class="hljs-number">49152</span>, <span class="hljs-number">57344</span>, <span class="hljs-number">61440</span>, <span class="hljs-number">63488</span>, <span class="hljs-number">64512</span>, <span class="hljs-number">65024</span>, <span class="hljs-number">65280</span>, <span class="hljs-number">65408</span>, <span class="hljs-number">65472</span>, <span class="hljs-number">65504</span>, <span class="hljs-number">65520</span>, <span class="hljs-number">65528</span>, <span class="hljs-number">65532</span>, <span class="hljs-number">65534</span>, <span class="hljs-number">65535</span>];<br>lowBitMasks = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">31</span>, <span class="hljs-number">63</span>, <span class="hljs-number">127</span>, <span class="hljs-number">255</span>, <span class="hljs-number">511</span>, <span class="hljs-number">1023</span>, <span class="hljs-number">2047</span>, <span class="hljs-number">4095</span>, <span class="hljs-number">8191</span>, <span class="hljs-number">16383</span>, <span class="hljs-number">32767</span>, <span class="hljs-number">65535</span>];<br><span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-number">129</span>);<br><br><span class="hljs-keyword">var</span> key_to_encode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RSAKeyPair</span>(<span class="hljs-string">&quot;010001&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>);<br><br><span class="hljs-keyword">var</span> pw = <span class="hljs-title function_">encryptedString</span>(key_to_encode, <span class="hljs-string">&#x27;123456&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pw)<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金昌市公共资源交易中心详情页链接DES加密</title>
      <link href="/2020/05/11/%E9%87%91%E6%98%8C%E5%B8%82%E5%85%AC%E5%85%B1%E8%B5%84%E6%BA%90%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83%E8%AF%A6%E6%83%85%E9%A1%B5%E9%93%BE%E6%8E%A5DES%E5%8A%A0%E5%AF%86/"/>
      <url>/2020/05/11/%E9%87%91%E6%98%8C%E5%B8%82%E5%85%AC%E5%85%B1%E8%B5%84%E6%BA%90%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83%E8%AF%A6%E6%83%85%E9%A1%B5%E9%93%BE%E6%8E%A5DES%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>通过抓包发现列表页正常无加密，但是详情页链接有两个字段是通过加密获取的</p><blockquote><p>网站链接：<a href="https://ggzy.jcs.gov.cn/website/transaction/index">https://ggzy.jcs.gov.cn/website/transaction/index</a></p></blockquote><p><img src="/images/image-20230517104134027.png" alt="image-20230517104134027"></p><p>详情页链接：</p><p><a href="https://ggzy.jcs.gov.cn/website/anno/index?projectId=9f37db7a30fb6259&projectInfo=ff15d186c4d5fa7a">https://ggzy.jcs.gov.cn/website/anno/index?projectId=9f37db7a30fb6259&amp;projectInfo=ff15d186c4d5fa7a</a></p><p>直接搜索关键字定位：</p><p><img src="/images/image-20230517104704348.png" alt="image-20230517104704348"></p><p>进去打上断点发现是在请求发送之前做了加密，跟进去查看</p><p><img src="/images/image-20230517105252178.png" alt="image-20230517105252178"></p><p>发现是C方法对jquery传过来的projectId 和 ZBGG两个参数进行加密进行加密</p><p><img src="/images/image-20230517105449875.png" alt="image-20230517105449875"></p><p>跟进c方法，发现是一个正常的DES加密，直接导包或者改写都行，iv参数固定</p><p><img src="/images/image-20230517105648486.png" alt="image-20230517105648486"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">des_encrypt</span>(<span class="hljs-params">text</span>):<br>    key = iv = <span class="hljs-string">&#x27;54367819&#x27;</span><br>    k = des(key, CBC, iv, pad=<span class="hljs-literal">None</span>, padmode=PAD_PKCS5)<br>    en = k.encrypt(<span class="hljs-built_in">str</span>(text), padmode=PAD_PKCS5)<br>    <span class="hljs-keyword">return</span> binascii.b2a_hex(en)<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>驾培创业教练app请求参数frida</title>
      <link href="/2020/03/04/%E9%A9%BE%E5%9F%B9%E5%88%9B%E4%B8%9A%E6%95%99%E7%BB%83app%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0frida/"/>
      <url>/2020/03/04/%E9%A9%BE%E5%9F%B9%E5%88%9B%E4%B8%9A%E6%95%99%E7%BB%83app%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0frida/</url>
      
        <content type="html"><![CDATA[<blockquote><p>app:驾培创业教练v2.9.6</p><p>目标接口：<a href="http://weixin.jx885.com/Appapi/Common/getSmscode">http://weixin.jx885.com/Appapi/Common/getSmscode</a></p></blockquote><h3 id="解析流程："><a href="#解析流程：" class="headerlink" title="解析流程："></a>解析流程：</h3><p>该app未作双向认证所以正常抓包获取目标url,结果测试后 请求头都很正常，唯独需要获取请求参数sign</p><p><img src="/images/image-20230519164441993.png" alt="image-20230519164441993"></p><p>将app拖进jadx,反编译成功，搜索”sign”关键字查看,这一块比较符合 我们点进去看一下</p><p><img src="/images/image-20230519165545848.png" alt="image-20230519165545848"></p><p>发现sign &#x3D; stringMD5toUpperCase ,stringMD5toUpperCase是getStringMD5toUpperCase方法传入sb数组，我们点进getStringMD5toUpperCase方法看一下</p><p><img src="/images/image-20230519165639132.png" alt="image-20230519165639132"></p><p>这边应该是做了一个md加密，这个时候我们需要看一下getSmscode方法传入的三个参数是什么东西</p><p><img src="/images/image-20230519170025974.png" alt="image-20230519170025974"></p><p>我们使用frida attach模式获取com.jx885.library.http.CommAction下面的getSmscode方法传入的参数，可以看得出来，这么开发老哥并不是很友善，前面一个参数是年月日时分秒类似202305180210，中间两个参数固定，后面一个参数是手机号码，最后进行md5加密</p><p><img src="/images/image-20230519170233678.png" alt="image-20230519170233678"></p>]]></content>
      
      
      <categories>
          
          <category> app逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>企查查随机请求头Hmac算法加密解析</title>
      <link href="/2020/02/05/%E4%BC%81%E6%9F%A5%E6%9F%A5%E9%9A%8F%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%A4%B4Hmac%E7%AE%97%E6%B3%95%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/02/05/%E4%BC%81%E6%9F%A5%E6%9F%A5%E9%9A%8F%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%A4%B4Hmac%E7%AE%97%E6%B3%95%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://www.qcc.com/firm/5dffb644394922f9073544a08f38be9f.html">https://www.qcc.com/firm/5dffb644394922f9073544a08f38be9f.html</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>以查看公司财务数据为例，通过多次请求发现请求参数固定，如果是请求同一类数据请求头也固定，但请求头中有个参数会跟着不同的请求体进行变更，可以查看一下，直接通过发起程序追栈</p><p><img src="/images/image-20230517114041452.png" alt="image-20230517114041452"><a href=""></a></p><p>代码量有点多，我们直接全局搜索headers[ ,通过查看，发现第二条更符合，打上断点查看</p><p><img src="/images/image-20230517115511582.png" alt="image-20230517115511582"></p><p><img src="/images/image-20230517115421711.png" alt="image-20230517115421711"></p><p>这一段就是我们想要的结果了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> i = (<span class="hljs-number">0</span>,a.<span class="hljs-property">default</span>)(t, e.<span class="hljs-property">data</span>), l = (<span class="hljs-number">0</span>,r.<span class="hljs-property">default</span>)(t, e.<span class="hljs-property">data</span>, (<span class="hljs-number">0</span>,s.<span class="hljs-property">default</span>)());<br>e.<span class="hljs-property">headers</span>[i] = l<br><span class="hljs-comment">//改写一下</span><br><span class="hljs-keyword">var</span> i = a.<span class="hljs-title function_">default</span>(t, e.<span class="hljs-property">data</span>), l = r.<span class="hljs-title function_">default</span>(t, e.<span class="hljs-property">data</span>, s.<span class="hljs-title function_">default</span>());<br>e.<span class="hljs-property">headers</span>[i] = l<br></code></pre></td></tr></table></figure><p><img src="/images/image-20230517115921628.png" alt="image-20230517115921628"></p><p>t是请求url，e.data是请求体</p><p>分别查看一下r.default，a.default，s.defaul</p><p>首先，s.default是一个固定值,c5c144235c8441642f9af0413f60588e</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">eval</span>(list.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>))<br><span class="hljs-string">&#x27;c5c144235c8441642f9af0413f60588e&#x27;</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-property">tid</span><br><span class="hljs-string">&#x27;c5c144235c8441642f9af0413f60588e&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/images/image-20230517125902519.png" alt="image-20230517125902519"></p><p>a.default返回的结果 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>,o.<span class="hljs-property">default</span>)(t + n, (<span class="hljs-number">0</span>,a.<span class="hljs-property">default</span>)(t)).<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">substr</span>(<span class="hljs-number">8</span>, <span class="hljs-number">20</span>)<br><span class="hljs-comment">// 改写一下</span><br>o.<span class="hljs-title function_">default</span>(t + n,a.<span class="hljs-title function_">default</span>(t)).<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">substr</span>(<span class="hljs-number">8</span>, <span class="hljs-number">20</span>)<br><span class="hljs-comment">// t + n = &#x27;/api/datalist/financiallist&#123;&quot;keyno&quot;:&quot;5dffb644394922f9073544a08f38be9f&quot;,&quot;type&quot;:&quot;hk&quot;,&quot;reporttype&quot;:1,&quot;currency&quot;:&quot;usd&quot;,&quot;rate&quot;:1&#125;&#x27;</span><br><br></code></pre></td></tr></table></figure><p><img src="/images/image-20230517130548190.png" alt="image-20230517130548190"></p><p>这个里面的a.default是这样的</p><p><img src="/images/image-20230517130918246.png" alt="image-20230517130918246"></p><p>o.default是一个固定值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    <span class="hljs-string">&quot;n&quot;</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-string">&quot;codes&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,<br>        <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>,<br>        <span class="hljs-string">&quot;2&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<br>        <span class="hljs-string">&quot;3&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>,<br>        <span class="hljs-string">&quot;4&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>,<br>        <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>,<br>        <span class="hljs-string">&quot;6&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>,<br>        <span class="hljs-string">&quot;7&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>        <span class="hljs-string">&quot;8&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>        <span class="hljs-string">&quot;9&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>        <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>,<br>        <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,<br>        <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,<br>        <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>,<br>        <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>,<br>        <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<br>        <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,<br>        <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>,<br>        <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;8&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>再查看a.default返回的o.default</p><p><img src="/images/image-20230517132308217.png" alt="image-20230517132308217"></p><p>然后再查看这个o.default</p><p><img src="/images/image-20230517132247427.png" alt="image-20230517132247427"></p><p>好的 一切都明了了，hmac算法，用到请求体和请求url,并没有加入随机参数和时间，所以相同的请求体请求头相同，用py改写一下，不用扣代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python">req_url = <span class="hljs-string">&#x27;/api/datalist/financiallist&#x27;</span><br>req_data = &#123;<br>    <span class="hljs-string">&quot;keyNo&quot;</span>: <span class="hljs-string">&quot;5dffb644394922f9073544a08f38be9f&quot;</span>,<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;hk&quot;</span>,<br>    <span class="hljs-string">&quot;reportType&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;currency&quot;</span>: <span class="hljs-string">&quot;CAD&quot;</span>,<br>    <span class="hljs-string">&quot;rate&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br>win_tid = <span class="hljs-string">&#x27;c5c144235c8441642f9af0413f60588e&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">seeds_generator</span>(<span class="hljs-params">s</span>):<br>    seeds = &#123;<br>        <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,<br>        <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>,<br>        <span class="hljs-string">&quot;2&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<br>        <span class="hljs-string">&quot;3&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>,<br>        <span class="hljs-string">&quot;4&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>,<br>        <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>,<br>        <span class="hljs-string">&quot;6&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>,<br>        <span class="hljs-string">&quot;7&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>        <span class="hljs-string">&quot;8&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>        <span class="hljs-string">&quot;9&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>        <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>,<br>        <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,<br>        <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,<br>        <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>,<br>        <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>,<br>        <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<br>        <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,<br>        <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>,<br>        <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;8&quot;</span><br>    &#125;<br>    seeds_n = <span class="hljs-number">20</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> s:<br>        s = <span class="hljs-string">&quot;/&quot;</span><br>    s = s.lower()<br>    s = s + s<br><br>    res = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        res += seeds[<span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(i) % seeds_n)]<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">a_default</span>(<span class="hljs-params">url: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;/&#x27;</span>, data: <span class="hljs-built_in">object</span> = &#123;&#125;</span>):<br>    url = url.lower()<br>    dataJson = json.dumps(data, ensure_ascii=<span class="hljs-literal">False</span>, separators=(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>)).lower()<br><br>    <span class="hljs-built_in">hash</span> = hmac.new(<br>        <span class="hljs-built_in">bytes</span>(seeds_generator(url), encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>        <span class="hljs-built_in">bytes</span>(url + dataJson, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>        hashlib.sha512<br>    ).hexdigest()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>.lower()[<span class="hljs-number">8</span>:<span class="hljs-number">28</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r_default</span>(<span class="hljs-params">url: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;/&#x27;</span>, data: <span class="hljs-built_in">object</span> = &#123;&#125;, tid: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span></span>):<br>    url = url.lower()<br>    dataJson = json.dumps(data, ensure_ascii=<span class="hljs-literal">False</span>, separators=(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>)).lower()<br><br>    payload = url + <span class="hljs-string">&#x27;pathString&#x27;</span> + dataJson + tid<br>    key = seeds_generator(url)<br><br>    <span class="hljs-built_in">hash</span> = hmac.new(<br>        <span class="hljs-built_in">bytes</span>(key, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>        <span class="hljs-built_in">bytes</span>(payload, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>        hashlib.sha512<br>    ).hexdigest()<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>.lower()<br><br><br><span class="hljs-comment"># 输出</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;key: &#x27;</span> + a_default(req_url, req_data))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;val: &#x27;</span> + r_default(req_url, req_data, win_tid))<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hmac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>企知道网站cookie、uuid字段加密解析</title>
      <link href="/2020/01/04/%E4%BC%81%E7%9F%A5%E9%81%93%E7%BD%91%E7%AB%99cookie%E3%80%81uuid%E5%AD%97%E6%AE%B5%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/01/04/%E4%BC%81%E7%9F%A5%E9%81%93%E7%BD%91%E7%AB%99cookie%E3%80%81uuid%E5%AD%97%E6%AE%B5%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://www.qizhidao.com/">https://www.qizhidao.com/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>首先抓包发现有反调试无限debug，先使用永不在此暂停先过掉它</p><p><img src="/images/image-20230517145648758.png" alt="image-20230517145648758"></p><p>多次请求发现请求头中有个user-agent-web字段需要携带，这个字段好像和user-agent没啥关系，且可以固定</p><p><img src="/images/image-20230517150538440.png" alt="image-20230517150538440"></p><p>然后是cookie,有些时候全部不带都行，如果不用随机代理的话，多请求几次就会出现疯狂滑块页面</p><p><img src="/images/image-20230517151335064.png" alt="image-20230517151335064"></p><p><strong>wz_uuid 应该是游客id，用ua + 时间戳 + 随机字符串生成</strong></p><p><img src="/images/image-20230517151621379.png" alt="image-20230517151621379"></p><p><img src="/images/image-20230517151828185.png" alt="image-20230517151828185"></p><p>z.i 和 a.m</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">O</span>(<span class="hljs-params">t</span>) &#123;<br>   <span class="hljs-keyword">var</span> e = (t || <span class="hljs-variable language_">window</span>.<span class="hljs-property">navigator</span>.<span class="hljs-property">userAgent</span> || <span class="hljs-title class_">Object</span>(a.<span class="hljs-property">m</span>)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)) + (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>).<span class="hljs-title function_">getTime</span>() + <span class="hljs-title class_">Object</span>(a.<span class="hljs-property">m</span>)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>);<br>   <span class="hljs-keyword">return</span> <span class="hljs-title function_">s</span>()(e)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a_m</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> r, o = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === t &amp;&amp; (t = <span class="hljs-number">6</span>),<br>    <span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> e &amp;&amp; (n = e),<br>    r = e &amp;&amp; <span class="hljs-string">&quot;number&quot;</span> == <span class="hljs-keyword">typeof</span> e ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (e - t)) + t : t,<br>    n = n || <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; r; i++) &#123;<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (n.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>));<br>        o += n.<span class="hljs-title function_">substring</span>(a, a + <span class="hljs-number">1</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> o<br>&#125;<br></code></pre></td></tr></table></figure><p>s()(e)：</p><p><img src="/images/image-20230517152038492.png" alt="image-20230517152038492"></p><p>使用js完整生成, 随机代理加上这个游客id，一般都没有什么问题：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);<br><br><span class="hljs-variable language_">window</span> = &#123;&#125;<br><span class="hljs-variable language_">window</span>.<span class="hljs-property">navigator</span> =&#123;<br>    <span class="hljs-attr">userAgent</span>:<span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-keyword">return</span> crypto.<span class="hljs-title function_">createHash</span>(<span class="hljs-string">&#x27;md5&#x27;</span>).<span class="hljs-title function_">update</span>(<span class="hljs-title class_">String</span>(data)).<span class="hljs-title function_">digest</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">z_i</span>(<span class="hljs-params">t</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = (t || <span class="hljs-variable language_">window</span>.<span class="hljs-property">navigator</span>.<span class="hljs-property">userAgent</span> || <span class="hljs-title class_">Object</span>(a_m)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)) + (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>).<span class="hljs-title function_">getTime</span>() + <span class="hljs-title class_">Object</span>(a_m)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;X/&#x27;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">md5</span>(e))<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a_m</span>(<span class="hljs-params">t, e, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> r, o = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === t &amp;&amp; (t = <span class="hljs-number">6</span>),<br>    <span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> e &amp;&amp; (n = e),<br>    r = e &amp;&amp; <span class="hljs-string">&quot;number&quot;</span> == <span class="hljs-keyword">typeof</span> e ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (e - t)) + t : t,<br>    n = n || <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; r; i++) &#123;<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (n.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>));<br>        o += n.<span class="hljs-title function_">substring</span>(a, a + <span class="hljs-number">1</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> o    <br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">z_i</span>(<span class="hljs-literal">undefined</span>))<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uuid </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>全国招标公告公示响应des解密</title>
      <link href="/2019/11/24/%E5%85%A8%E5%9B%BD%E6%8B%9B%E6%A0%87%E5%85%AC%E5%91%8A%E5%85%AC%E7%A4%BA%E5%93%8D%E5%BA%94des%E8%A7%A3%E5%AF%86/"/>
      <url>/2019/11/24/%E5%85%A8%E5%9B%BD%E6%8B%9B%E6%A0%87%E5%85%AC%E5%91%8A%E5%85%AC%E7%A4%BA%E5%93%8D%E5%BA%94des%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="http://ctbpsp.com/#/">http://ctbpsp.com/#/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>网站请求头和cookie都没有加密，唯一的加密是响应体加密</p><p><img src="/images/image-20230517155601531.png" alt="image-20230517155601531"></p><p>抓包发现promise，我们在找一下interceptors拦截器</p><p><img src="/images/image-20230517160449379.png" alt="image-20230517160449379"></p><p>这个一眼看上去就比较符合，而且数据进来，应该是用这个拦截器进行解析的</p><p><img src="/images/image-20230517161003094.png" alt="image-20230517161003094"></p><p>这也是个普通的des解密，直接导包使用就好了</p><p><img src="/images/image-20230517161138285.png" alt="image-20230517161138285"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;crypto-js&quot;</span>);<br><span class="hljs-keyword">var</span> C = <span class="hljs-title class_">CryptoJS</span>;<br><span class="hljs-keyword">var</span> C_lib = C.<span class="hljs-property">lib</span>;<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">WordArray</span> = C_lib.<span class="hljs-property">WordArray</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">parse1</span>(<span class="hljs-params">latin1Str</span>) &#123;<br>    <span class="hljs-comment">// Shortcut</span><br>    <span class="hljs-keyword">var</span> latin1StrLength = latin1Str.<span class="hljs-property">length</span>;<br>    <span class="hljs-comment">// Convert</span><br>    <span class="hljs-keyword">var</span> words = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; latin1StrLength; i++) &#123;<br>        words[i &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (latin1Str.<span class="hljs-title function_">charCodeAt</span>(i) &amp; <span class="hljs-number">0xff</span>) &lt;&lt; (<span class="hljs-number">24</span> - (i % <span class="hljs-number">4</span>) * <span class="hljs-number">8</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WordArray</span>.<span class="hljs-title function_">init</span>(words, latin1StrLength);<br>&#125;<br><br><span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;要解密的字符串&#x27;</span><br><span class="hljs-keyword">var</span> keyHex = <span class="hljs-title function_">parse1</span>(<span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-string">&quot;ctpstp@custominfo!@#qweASD&quot;</span>)))<br><span class="hljs-keyword">var</span> ciphertext = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Base64</span>.<span class="hljs-title function_">parse</span>(t)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">decryptDES</span> = (<span class="hljs-params">ciphertext</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (ciphertext) &#123;<br>      <span class="hljs-keyword">let</span> decrypted = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">DES</span>.<span class="hljs-title function_">decrypt</span>(ciphertext, keyHex, &#123;<br>      <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">ECB</span>,<br>      <span class="hljs-attr">padding</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">pad</span>.<span class="hljs-property">Pkcs7</span><br>    &#125;);<br>    <span class="hljs-keyword">return</span> decrypted.<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;<br>  &#125;<br>&#125;;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">decryptDES</span>(t))<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> des </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oklink区块链交易网请求头参数解析</title>
      <link href="/2019/11/23/oklink%E5%8C%BA%E5%9D%97%E9%93%BE%E4%BA%A4%E6%98%93%E7%BD%91%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/11/23/oklink%E5%8C%BA%E5%9D%97%E9%93%BE%E4%BA%A4%E6%98%93%E7%BD%91%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>通过全局搜索apikey可以发现x-apikey全在一个地方</p><p><img src="/images/image-20230517162338730.png" alt="image-20230517162338730"></p><p><img src="/images/image-20230517162439386.png" alt="image-20230517162439386"></p><p>大致的流程就是对api_key转成列表，然后转字符串在拼接上后后八位，然后又加入时间戳和和一些随机的数字，最后生成x-apikey</p><p><img src="/images/image-20230517162853880.png" alt="image-20230517162853880"></p><p>使用python生成：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_api</span>():<br>    key = <span class="hljs-string">&quot;a2c903cc-b31e-4547-9299-b6d07b7631ab&quot;</span><br>    key_list = <span class="hljs-built_in">list</span>(key)<br>    n = key_list[:<span class="hljs-number">8</span>]<br>    result_list = key_list[<span class="hljs-number">8</span>:] + n<br>    result_key = <span class="hljs-string">&quot;&quot;</span>.join(result_list)<br>    times = <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)<br>    e = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">str</span>(times + <span class="hljs-number">1111111111111</span>))<br>    e.append(<span class="hljs-built_in">str</span>(random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)))<br>    e.append(<span class="hljs-built_in">str</span>(random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)))<br>    e.append(<span class="hljs-built_in">str</span>(random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)))<br>    result_key2 = <span class="hljs-string">&quot;&quot;</span>.join(e)<br>    end_key = result_key + <span class="hljs-string">&quot;|&quot;</span> + result_key2<br>    <span class="hljs-built_in">print</span>(end_key)<br>    api = base64.b64encode(end_key.encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    <span class="hljs-built_in">print</span>(api)<br>    <span class="hljs-keyword">return</span> api<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> random </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百度翻译sign和token参数加密解析</title>
      <link href="/2019/11/04/%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91sign%E5%92%8Ctoken%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/11/04/%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91sign%E5%92%8Ctoken%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>网址：<a href="https://fanyi.baidu.com/v2transapi?from=zh&to=en">https://fanyi.baidu.com/v2transapi?from=zh&amp;to=en</a></p><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>一个token和sign是我们需要解决的</p><p><img src="/images/image-20230517191509192.png" alt="image-20230517191509192"></p><p>搜索sign:发现有好多个，都打上断点尝试一下</p><p><img src="/images/image-20230517192518225.png" alt="image-20230517192518225"></p><p>断点到了这里</p><p><img src="/images/image-20230517192600112.png" alt="image-20230517192600112"></p><p>直接把这个函数扣下来</p><p><img src="/images/image-20230517192756298.png" alt="image-20230517192756298"></p><p>然后把根据报错把需要的给补上</p><p>另外token参数发现是固定可以不用解析，只要把sign解析出来即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">t, e</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>; n &lt; e.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>; n += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> r = e.<span class="hljs-title function_">charAt</span>(n + <span class="hljs-number">2</span>);<br>        r = <span class="hljs-string">&quot;a&quot;</span> &lt;= r ? r.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>) - <span class="hljs-number">87</span> : <span class="hljs-title class_">Number</span>(r),<br>        r = <span class="hljs-string">&quot;+&quot;</span> === e.<span class="hljs-title function_">charAt</span>(n + <span class="hljs-number">1</span>) ? t &gt;&gt;&gt; r : t &lt;&lt; r,<br>        t = <span class="hljs-string">&quot;+&quot;</span> === e.<span class="hljs-title function_">charAt</span>(n) ? t + r &amp; <span class="hljs-number">4294967295</span> : t ^ r<br>    &#125;<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><span class="hljs-keyword">var</span> r = <span class="hljs-number">320305.131321201</span><br><br>get_sign = <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>    <span class="hljs-keyword">var</span> o, i = t.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/[\uD800-\uDBFF][\uDC00-\uDFFF]/g</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> === i) &#123;<br>        <span class="hljs-keyword">var</span> a = t.<span class="hljs-property">length</span>;<br>        a &gt; <span class="hljs-number">30</span> &amp;&amp; (t = <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(t.<span class="hljs-title function_">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)).<span class="hljs-title function_">concat</span>(t.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(a / <span class="hljs-number">2</span>) - <span class="hljs-number">5</span>, <span class="hljs-number">10</span>)).<span class="hljs-title function_">concat</span>(t.<span class="hljs-title function_">substr</span>(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)))<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = t.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/[\uD800-\uDBFF][\uDC00-\uDFFF]/</span>), c = <span class="hljs-number">0</span>, u = s.<span class="hljs-property">length</span>, l = []; c &lt; u; c++)<br>            <span class="hljs-string">&quot;&quot;</span> !== s[c] &amp;&amp; l.<span class="hljs-property">push</span>.<span class="hljs-title function_">apply</span>(l, <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(t))<br>                    <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>(t)<br>            &#125;(o = s[c].<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;&quot;</span>)) || <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;undefined&quot;</span> != <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span> &amp;&amp; <span class="hljs-literal">null</span> != t[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] || <span class="hljs-literal">null</span> != t[<span class="hljs-string">&quot;@@iterator&quot;</span>])<br>                    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(t)<br>            &#125;(o) || <span class="hljs-keyword">function</span>(<span class="hljs-params">t, n</span>) &#123;<br>                <span class="hljs-keyword">if</span> (t) &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> t)<br>                        <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>(t, n);<br>                    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(t).<span class="hljs-title function_">slice</span>(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>);<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Object&quot;</span> === r &amp;&amp; t.<span class="hljs-property">constructor</span> &amp;&amp; (r = t.<span class="hljs-property">constructor</span>.<span class="hljs-property">name</span>),<br>                    <span class="hljs-string">&quot;Map&quot;</span> === r || <span class="hljs-string">&quot;Set&quot;</span> === r ? <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(t) : <span class="hljs-string">&quot;Arguments&quot;</span> === r || <span class="hljs-regexp">/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/</span>.<span class="hljs-title function_">test</span>(r) ? <span class="hljs-title function_">e</span>(t, n) : <span class="hljs-keyword">void</span> <span class="hljs-number">0</span><br>                &#125;<br>            &#125;(o) || <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.&quot;</span>)<br>            &#125;()),<br>            c !== u - <span class="hljs-number">1</span> &amp;&amp; l.<span class="hljs-title function_">push</span>(i[c]);<br>        <span class="hljs-keyword">var</span> d = l.<span class="hljs-property">length</span>;<br>        d &gt; <span class="hljs-number">30</span> &amp;&amp; (t = l.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>) + l.<span class="hljs-title function_">slice</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(d / <span class="hljs-number">2</span>) - <span class="hljs-number">5</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(d / <span class="hljs-number">2</span>) + <span class="hljs-number">5</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>) + l.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">10</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>))<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p = <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">103</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">116</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">107</span>)), f = [<span class="hljs-string">&quot;320305&quot;</span>,<span class="hljs-string">&quot;131321201&quot;</span>], h = <span class="hljs-title class_">Number</span>(f[<span class="hljs-number">0</span>]) || <span class="hljs-number">0</span>, m = <span class="hljs-title class_">Number</span>(f[<span class="hljs-number">1</span>]) || <span class="hljs-number">0</span>, g = [], v = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>; y &lt; t.<span class="hljs-property">length</span>; y++) &#123;<br>        <span class="hljs-keyword">var</span> w = t.<span class="hljs-title function_">charCodeAt</span>(y);<br>        w &lt; <span class="hljs-number">128</span> ? g[v++] = w : (w &lt; <span class="hljs-number">2048</span> ? g[v++] = w &gt;&gt; <span class="hljs-number">6</span> | <span class="hljs-number">192</span> : (<span class="hljs-number">55296</span> == (<span class="hljs-number">64512</span> &amp; w) &amp;&amp; y + <span class="hljs-number">1</span> &lt; t.<span class="hljs-property">length</span> &amp;&amp; <span class="hljs-number">56320</span> == (<span class="hljs-number">64512</span> &amp; t.<span class="hljs-title function_">charCodeAt</span>(y + <span class="hljs-number">1</span>)) ? (w = <span class="hljs-number">65536</span> + ((<span class="hljs-number">1023</span> &amp; w) &lt;&lt; <span class="hljs-number">10</span>) + (<span class="hljs-number">1023</span> &amp; t.<span class="hljs-title function_">charCodeAt</span>(++y)),<br>        g[v++] = w &gt;&gt; <span class="hljs-number">18</span> | <span class="hljs-number">240</span>,<br>        g[v++] = w &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>) : g[v++] = w &gt;&gt; <span class="hljs-number">12</span> | <span class="hljs-number">224</span>,<br>        g[v++] = w &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>),<br>        g[v++] = <span class="hljs-number">63</span> &amp; w | <span class="hljs-number">128</span>)<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = h, x = <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">43</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">45</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">97</span>)) + <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">94</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">43</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">54</span>)), k = <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">43</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">45</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">51</span>)) + <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">94</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">43</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">98</span>)) + <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">43</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">45</span>)).<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">102</span>)), _ = <span class="hljs-number">0</span>; _ &lt; g.<span class="hljs-property">length</span>; _++)<br>        b = <span class="hljs-title function_">n</span>(b += g[_], x);<br>    <span class="hljs-keyword">return</span> b = <span class="hljs-title function_">n</span>(b, k),<br>    (b ^= m) &lt; <span class="hljs-number">0</span> &amp;&amp; (b = <span class="hljs-number">2147483648</span> + (<span class="hljs-number">2147483647</span> &amp; b)),<br>    <span class="hljs-string">&quot;&quot;</span>.<span class="hljs-title function_">concat</span>((b %= <span class="hljs-number">1e6</span>).<span class="hljs-title function_">toString</span>(), <span class="hljs-string">&quot;.&quot;</span>).<span class="hljs-title function_">concat</span>(b ^ h)<br>&#125;<br><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> execjs<br><br>word = <span class="hljs-string">&quot;时间&quot;</span><br>url = <span class="hljs-string">&#x27;https://fanyi.baidu.com/v2transapi?from=zh&amp;to=en&#x27;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;13.百度翻译2.js&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> js:<br>    js_content = js.read()<br>    <span class="hljs-built_in">compile</span> = execjs.<span class="hljs-built_in">compile</span>(js_content)<br>    sign = <span class="hljs-built_in">compile</span>.call(<span class="hljs-string">&#x27;get_sign&#x27;</span>, word)<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;补上&#x27;</span>,<br>    <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;https://fanyi.baidu.com/?aldtype=16047&#x27;</span>,<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36 Edg/103.0.1264.71&#x27;</span>,<br>&#125;<br><br>data = &#123;<br>    <span class="hljs-string">&#x27;from&#x27;</span>: <span class="hljs-string">&#x27;zh&#x27;</span>,<br>    <span class="hljs-string">&#x27;to&#x27;</span>: <span class="hljs-string">&#x27;en&#x27;</span>,<br>    <span class="hljs-string">&#x27;query&#x27;</span>: word,<br>    <span class="hljs-string">&#x27;simple_means_flag&#x27;</span>: <span class="hljs-string">&#x27;3&#x27;</span>,<br>    <span class="hljs-string">&#x27;sign&#x27;</span>: sign,<br>    <span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;f84f349ac4e1f7d82418c6922ccf5b1e&#x27;</span>,<br>    <span class="hljs-string">&#x27;domain&#x27;</span>: <span class="hljs-string">&#x27;common&#x27;</span>,<br>&#125;<br><br>response = requests.post(url, headers=headers, data=data)<br>dst = response.json()[<span class="hljs-string">&#x27;trans_result&#x27;</span>][<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;dst&#x27;</span>]<br><span class="hljs-built_in">print</span>(dst)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sign </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有道词典请求体和响应体加密解析</title>
      <link href="/2019/10/13/%E6%9C%89%E9%81%93%E8%AF%8D%E5%85%B8%E8%AF%B7%E6%B1%82%E4%BD%93%E5%92%8C%E5%93%8D%E5%BA%94%E4%BD%93%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/10/13/%E6%9C%89%E9%81%93%E8%AF%8D%E5%85%B8%E8%AF%B7%E6%B1%82%E4%BD%93%E5%92%8C%E5%93%8D%E5%BA%94%E4%BD%93%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://fanyi.youdao.com/index.html#/">https://fanyi.youdao.com/index.html#/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>可以很明显的看到sign 和 响应都做了加密处理</p><p><img src="/images/image-20230517184506461.png" alt="image-20230517184506461"></p><p><img src="/images/image-20230517184511837.png" alt="image-20230517184511837"></p><p>然后再控制台发现 它竟然把解密的结果给打印出来了</p><p><img src="/images/image-20230517184821697.png" alt="image-20230517184821697"></p><p>那我们直接搜索console.log定位到这里</p><p><img src="/images/image-20230517184902260.png" alt="image-20230517184902260"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> n = an[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-title function_">decodeData</span>(o, sn[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-property">state</span>.<span class="hljs-property">text</span>.<span class="hljs-property">decodeKey</span>, sn[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-property">state</span>.<span class="hljs-property">text</span>.<span class="hljs-property">decodeIv</span>), a = n ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(n) : &#123;&#125;;<br><br>sn[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-property">state</span>.<span class="hljs-property">text</span>.<span class="hljs-property">decodeKey</span> 和 sn[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-property">state</span>.<span class="hljs-property">text</span>.<span class="hljs-property">decodeIv</span>都是固定值<br><br></code></pre></td></tr></table></figure><p>查看一下 an[“a”].decodeData()方法,t是响应体</p><p><img src="/images/image-20230517185235102.png" alt="image-20230517185235102"></p><p>crypto.createDecipheriv()是内置的加密算法，o和n使用md5加密后转换成数组，这里直接copy下面，补一下环境即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> crypto=<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>)<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">gerT</span>(<span class="hljs-params">t</span>)&#123;<br>    <span class="hljs-keyword">const</span> o = <span class="hljs-string">&#x27;ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl&#x27;</span>;<br>    <span class="hljs-keyword">const</span> n = <span class="hljs-string">&#x27;ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4&#x27;</span>;<br><br>    <span class="hljs-keyword">const</span> a = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">16</span>, crypto.<span class="hljs-title function_">createHash</span>(<span class="hljs-string">&quot;md5&quot;</span>).<span class="hljs-title function_">update</span>(o).<span class="hljs-title function_">digest</span>())<br>        , r = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">16</span>, crypto.<span class="hljs-title function_">createHash</span>(<span class="hljs-string">&quot;md5&quot;</span>).<span class="hljs-title function_">update</span>(n).<span class="hljs-title function_">digest</span>())<br>        , i = crypto.<span class="hljs-title function_">createDecipheriv</span>(<span class="hljs-string">&quot;aes-128-cbc&quot;</span>, a, r);<br>    <span class="hljs-keyword">let</span> s = i.<span class="hljs-title function_">update</span>(t, <span class="hljs-string">&quot;base64&quot;</span>, <span class="hljs-string">&quot;utf-8&quot;</span>);<br>    <span class="hljs-keyword">return</span> s += i.<span class="hljs-title function_">final</span>(<span class="hljs-string">&quot;utf-8&quot;</span>), s<br>&#125;<br></code></pre></td></tr></table></figure><p>关键字搜索sign,点进去看一下，看到合适的打上断点查看</p><p><img src="/images/image-20230517185907424.png" alt="image-20230517185907424"></p><p>h方法传进两个参数，一个是时间戳，一个是e，这个e固定, 然后拼接几个参数，交给v方法，v方法也是md5，直接copy补全即可</p><p><img src="/images/image-20230517190140624.png" alt="image-20230517190140624"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>)<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">x</span>) &#123;<br>        <span class="hljs-keyword">return</span> crypto.<span class="hljs-title function_">createHash</span>(<span class="hljs-string">&quot;md5&quot;</span>).<span class="hljs-title function_">update</span>(x.<span class="hljs-title function_">toString</span>()).<span class="hljs-title function_">digest</span>(<span class="hljs-string">&quot;hex&quot;</span>)<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">e, time</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">p</span>(<span class="hljs-string">`client=<span class="hljs-subst">$&#123;<span class="hljs-string">&quot;fanyideskweb&quot;</span>&#125;</span>&amp;mysticTime=<span class="hljs-subst">$&#123;time&#125;</span>&amp;product=<span class="hljs-subst">$&#123;<span class="hljs-string">&quot;webfanyi&quot;</span>&#125;</span>&amp;key=<span class="hljs-subst">$&#123;<span class="hljs-string">&quot;fsdsogkndfokasodnaso&quot;</span>&#125;</span>`</span>)<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding:utf-8</span><br><span class="hljs-keyword">import</span> requests, re, random, json, time<br><span class="hljs-keyword">from</span> user_agents <span class="hljs-keyword">import</span> user_agents<br><span class="hljs-keyword">import</span> re, execjs<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1.正常的md5加密都可以通过上下两种方式进行解析，hex的参数意味着（md5加密32位小写）</span><br><span class="hljs-string">2.require(&#x27;crypto&#x27;) 导包，导入node的crypto包</span><br><span class="hljs-string">3.当看到不常见的js代码的时候，可以查一下是不是js的内置代码， 特别是当处于js混淆的时候，有时候百度比找js代码更合适</span><br><span class="hljs-string">    例如 e.alloc 它就是js的内置代码Buffer.alloc()</span><br><span class="hljs-string">4.这次出现一个编码的问题，来自于execjs的内置方法buffer.append(fh.read())，可以通过改变里面的编码格式来解决问题</span><br><span class="hljs-string">    代码在subprocess.py的738行，修改编码格式使之为&quot;utf-8&quot;</span><br><span class="hljs-string">5.请求不成功的时候不一定是加密的参数解析失败，有可能是请求头的问题，拆解请求头以尝试获取请求成功</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exec_js</span>(<span class="hljs-params">str1, time_stamp</span>):<br>    ctx = execjs.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    const crypto = require(&#x27;crypto&#x27;)</span><br><span class="hljs-string">    function p(x) &#123;</span><br><span class="hljs-string">        return crypto.createHash(&quot;md5&quot;).update(x.toString()).digest(&quot;hex&quot;)</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    function sign(e, time) &#123;</span><br><span class="hljs-string">        return p(`client=$&#123;&quot;fanyideskweb&quot;&#125;&amp;mysticTime=$&#123;time&#125;&amp;product=$&#123;&quot;webfanyi&quot;&#125;&amp;key=$&#123;&quot;fsdsogkndfokasodnaso&quot;&#125;`)</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span>)<br>    result_str = ctx.call(<span class="hljs-string">&quot;sign&quot;</span>, str1, time_stamp)<br>    <span class="hljs-keyword">return</span> result_str<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exec_js2</span>(<span class="hljs-params">str1</span>):<br>    ctx = execjs.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    const crypto=require(&#x27;crypto&#x27;)</span><br><span class="hljs-string">    function gerT(t)&#123;</span><br><span class="hljs-string">    const o = &#x27;ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl&#x27;;</span><br><span class="hljs-string">    const n = &#x27;ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4&#x27;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    const a = Buffer.alloc(16, crypto.createHash(&quot;md5&quot;).update(o).digest())</span><br><span class="hljs-string">        , r = Buffer.alloc(16, crypto.createHash(&quot;md5&quot;).update(n).digest())</span><br><span class="hljs-string">        , i = crypto.createDecipheriv(&quot;aes-128-cbc&quot;, a, r);</span><br><span class="hljs-string">    let s = i.update(t, &quot;base64&quot;, &quot;utf-8&quot;);</span><br><span class="hljs-string">    return s += i.final(&quot;utf-8&quot;), s</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span>)<br>    result_str = json.loads(ctx.call(<span class="hljs-string">&quot;gerT&quot;</span>, str1))<br>    <span class="hljs-keyword">return</span> result_str<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_translate</span>(<span class="hljs-params">str1</span>):<br>    list_url = <span class="hljs-string">&#x27;https://dict.youdao.com/webtranslate&#x27;</span><br>    <span class="hljs-built_in">print</span>(list_url)<br>    user_agent = random.choice(user_agents)<br>    time_stamp = <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)<br>    <span class="hljs-built_in">print</span>(time_stamp)<br>    sign = exec_js(<span class="hljs-string">&quot;fsdsogkndfokasodnaso&quot;</span>, <span class="hljs-built_in">str</span>(time_stamp))<br>    <span class="hljs-built_in">print</span>(sign)<br>    post_data = &#123;<br>        <span class="hljs-string">&#x27;i&#x27;</span>: str1,<br>        <span class="hljs-string">&#x27;from&#x27;</span>: <span class="hljs-string">&#x27;auto&#x27;</span>,<br>        <span class="hljs-string">&#x27;to&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;domain&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;dictResult&#x27;</span>: <span class="hljs-string">&#x27;true&#x27;</span>,<br>        <span class="hljs-string">&#x27;keyid&#x27;</span>: <span class="hljs-string">&#x27;webfanyi&#x27;</span>,<br>        <span class="hljs-string">&#x27;sign&#x27;</span>: sign,<br>        <span class="hljs-string">&#x27;client&#x27;</span>: <span class="hljs-string">&#x27;fanyideskweb&#x27;</span>,<br>        <span class="hljs-string">&#x27;product&#x27;</span>: <span class="hljs-string">&#x27;webfanyi&#x27;</span>,<br>        <span class="hljs-string">&#x27;appVersion&#x27;</span>: <span class="hljs-string">&#x27;1.0.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;vendor&#x27;</span>: <span class="hljs-string">&#x27;web&#x27;</span>,<br>        <span class="hljs-string">&#x27;pointParam&#x27;</span>: <span class="hljs-string">&#x27;client,mysticTime,product&#x27;</span>,<br>        <span class="hljs-string">&#x27;mysticTime&#x27;</span>: time_stamp,<br>        <span class="hljs-string">&#x27;keyfrom&#x27;</span>: <span class="hljs-string">&#x27;fanyi.web&#x27;</span>,<br><br>    &#125;<br>    list_headers = &#123;<br>        <span class="hljs-string">&#x27;accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/plain, */*&#x27;</span>,<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: user_agent,<br>        <span class="hljs-string">&#x27;Host&#x27;</span>: <span class="hljs-string">&#x27;dict.youdao.com&#x27;</span>,<br>        <span class="hljs-string">&#x27;Origin&#x27;</span>: <span class="hljs-string">&#x27;https://fanyi.youdao.com&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;https://fanyi.youdao.com/&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;OUTFOX_SEARCH_USER_ID=-1512055292@10.108.162.133; OUTFOX_SEARCH_USER_ID_NCOO=51976831.82152718&#x27;</span>,<br>    &#125;<br>    res = requests.post(url=list_url, headers=list_headers, timeout=<span class="hljs-number">5</span>, data=post_data)<br>    encode_str = res.text<br>    <span class="hljs-built_in">print</span>(encode_str)<br>    res_txt = exec_js2(encode_str)<br>    <span class="hljs-built_in">print</span>(res_txt)<br><br><br>get_translate(<span class="hljs-string">&quot;时间&quot;</span>)<br><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> md5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>试客联盟登录密码加密解析</title>
      <link href="/2019/09/11/%E8%AF%95%E5%AE%A2%E8%81%94%E7%9B%9F%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/09/11/%E8%AF%95%E5%AE%A2%E8%81%94%E7%9B%9F%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://login.shikee.com/">https://login.shikee.com/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>正常抓包发现只有密码进行了加密</p><p><img src="/images/image-20230517175106241.png" alt="image-20230517175106241"></p><p>直接从发起程序中进行跟栈，发现是个RSA加密，公钥在一个js文件中</p><p><img src="/images/image-20230517175834172.png" alt="image-20230517175834172"></p><p><img src="/images/image-20230517175926232.png" alt="image-20230517175926232"></p><p>这里是RSA加密的入口，直接将代码扣下来补齐就好</p><p><img src="/images/image-20230517175954664.png" alt="image-20230517175954664"></p><p><img src="/images/image-20230517180011047.png" alt="image-20230517180011047"></p>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>凡科网登录密码md5加密解析</title>
      <link href="/2019/08/03/%E5%87%A1%E7%A7%91%E7%BD%91%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81md5%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/08/03/%E5%87%A1%E7%A7%91%E7%BD%91%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81md5%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://i.fkw.com/?_ta=207">https://i.fkw.com/?_ta=207</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>除了密码加密以外，其它正常</p><p><img src="/images/image-20230517173230765.png" alt="image-20230517173230765"></p><p>直接从发起程序处跟栈，找到这里</p><p><img src="/images/image-20230517173445257.png" alt="image-20230517173445257"></p><p>这里就是md5加密的位置</p><p><img src="/images/image-20230517173504939.png" alt="image-20230517173504939"></p><p>直接扣代码就好了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function o(u, z) &#123;<br>        var w = (u &amp; 65535) + (z &amp; 65535)<br>          , v = (u &gt;&gt; 16) + (z &gt;&gt; 16) + (w &gt;&gt; 16);<br>        return (v &lt;&lt; 16) | (w &amp; 65535)<br>    &#125;<br>    function s(u, v) &#123;<br>        return (u &lt;&lt; v) | (u &gt;&gt;&gt; (32 - v))<br>    &#125;<br>    function c(A, w, v, u, z, y) &#123;<br>        return o(s(o(o(w, A), o(u, y)), z), v)<br>    &#125;<br>    function b(w, v, B, A, u, z, y) &#123;<br>        return c((v &amp; B) | ((~v) &amp; A), w, v, u, z, y)<br>    &#125;<br>    function i(w, v, B, A, u, z, y) &#123;<br>        return c((v &amp; A) | (B &amp; (~A)), w, v, u, z, y)<br>    &#125;<br>    function n(w, v, B, A, u, z, y) &#123;<br>        return c(v ^ B ^ A, w, v, u, z, y)<br>    &#125;<br>    function a(w, v, B, A, u, z, y) &#123;<br>        return c(B ^ (v | (~A)), w, v, u, z, y)<br>    &#125;<br>    function d(F, A) &#123;<br>        F[A &gt;&gt; 5] |= 128 &lt;&lt; ((A) % 32);<br>        F[(((A + 64) &gt;&gt;&gt; 9) &lt;&lt; 4) + 14] = A;<br>        var w, z, y, v, u, E = 1732584193, D = -271733879, C = -1732584194, B = 271733878;<br>        for (w = 0; w &lt; F.length; w += 16) &#123;<br>            z = E;<br>            y = D;<br>            v = C;<br>            u = B;<br>            E = b(E, D, C, B, F[w], 7, -680876936);<br>            B = b(B, E, D, C, F[w + 1], 12, -389564586);<br>            C = b(C, B, E, D, F[w + 2], 17, 606105819);<br>            D = b(D, C, B, E, F[w + 3], 22, -1044525330);<br>            E = b(E, D, C, B, F[w + 4], 7, -176418897);<br>            B = b(B, E, D, C, F[w + 5], 12, 1200080426);<br>            C = b(C, B, E, D, F[w + 6], 17, -1473231341);<br>            D = b(D, C, B, E, F[w + 7], 22, -45705983);<br>            E = b(E, D, C, B, F[w + 8], 7, 1770035416);<br>            B = b(B, E, D, C, F[w + 9], 12, -1958414417);<br>            C = b(C, B, E, D, F[w + 10], 17, -42063);<br>            D = b(D, C, B, E, F[w + 11], 22, -1990404162);<br>            E = b(E, D, C, B, F[w + 12], 7, 1804603682);<br>            B = b(B, E, D, C, F[w + 13], 12, -40341101);<br>            C = b(C, B, E, D, F[w + 14], 17, -1502002290);<br>            D = b(D, C, B, E, F[w + 15], 22, 1236535329);<br>            E = i(E, D, C, B, F[w + 1], 5, -165796510);<br>            B = i(B, E, D, C, F[w + 6], 9, -1069501632);<br>            C = i(C, B, E, D, F[w + 11], 14, 643717713);<br>            D = i(D, C, B, E, F[w], 20, -373897302);<br>            E = i(E, D, C, B, F[w + 5], 5, -701558691);<br>            B = i(B, E, D, C, F[w + 10], 9, 38016083);<br>            C = i(C, B, E, D, F[w + 15], 14, -660478335);<br>            D = i(D, C, B, E, F[w + 4], 20, -405537848);<br>            E = i(E, D, C, B, F[w + 9], 5, 568446438);<br>            B = i(B, E, D, C, F[w + 14], 9, -1019803690);<br>            C = i(C, B, E, D, F[w + 3], 14, -187363961);<br>            D = i(D, C, B, E, F[w + 8], 20, 1163531501);<br>            E = i(E, D, C, B, F[w + 13], 5, -1444681467);<br>            B = i(B, E, D, C, F[w + 2], 9, -51403784);<br>            C = i(C, B, E, D, F[w + 7], 14, 1735328473);<br>            D = i(D, C, B, E, F[w + 12], 20, -1926607734);<br>            E = n(E, D, C, B, F[w + 5], 4, -378558);<br>            B = n(B, E, D, C, F[w + 8], 11, -2022574463);<br>            C = n(C, B, E, D, F[w + 11], 16, 1839030562);<br>            D = n(D, C, B, E, F[w + 14], 23, -35309556);<br>            E = n(E, D, C, B, F[w + 1], 4, -1530992060);<br>            B = n(B, E, D, C, F[w + 4], 11, 1272893353);<br>            C = n(C, B, E, D, F[w + 7], 16, -155497632);<br>            D = n(D, C, B, E, F[w + 10], 23, -1094730640);<br>            E = n(E, D, C, B, F[w + 13], 4, 681279174);<br>            B = n(B, E, D, C, F[w], 11, -358537222);<br>            C = n(C, B, E, D, F[w + 3], 16, -722521979);<br>            D = n(D, C, B, E, F[w + 6], 23, 76029189);<br>            E = n(E, D, C, B, F[w + 9], 4, -640364487);<br>            B = n(B, E, D, C, F[w + 12], 11, -421815835);<br>            C = n(C, B, E, D, F[w + 15], 16, 530742520);<br>            D = n(D, C, B, E, F[w + 2], 23, -995338651);<br>            E = a(E, D, C, B, F[w], 6, -198630844);<br>            B = a(B, E, D, C, F[w + 7], 10, 1126891415);<br>            C = a(C, B, E, D, F[w + 14], 15, -1416354905);<br>            D = a(D, C, B, E, F[w + 5], 21, -57434055);<br>            E = a(E, D, C, B, F[w + 12], 6, 1700485571);<br>            B = a(B, E, D, C, F[w + 3], 10, -1894986606);<br>            C = a(C, B, E, D, F[w + 10], 15, -1051523);<br>            D = a(D, C, B, E, F[w + 1], 21, -2054922799);<br>            E = a(E, D, C, B, F[w + 8], 6, 1873313359);<br>            B = a(B, E, D, C, F[w + 15], 10, -30611744);<br>            C = a(C, B, E, D, F[w + 6], 15, -1560198380);<br>            D = a(D, C, B, E, F[w + 13], 21, 1309151649);<br>            E = a(E, D, C, B, F[w + 4], 6, -145523070);<br>            B = a(B, E, D, C, F[w + 11], 10, -1120210379);<br>            C = a(C, B, E, D, F[w + 2], 15, 718787259);<br>            D = a(D, C, B, E, F[w + 9], 21, -343485551);<br>            E = o(E, z);<br>            D = o(D, y);<br>            C = o(C, v);<br>            B = o(B, u)<br>        &#125;<br>        return [E, D, C, B]<br>    &#125;<br>    function p(v) &#123;<br>        var w, u = &quot;&quot;;<br>        for (w = 0; w &lt; v.length * 32; w += 8) &#123;<br>            u += String.fromCharCode((v[w &gt;&gt; 5] &gt;&gt;&gt; (w % 32)) &amp; 255)<br>        &#125;<br>        return u<br>    &#125;<br>    function j(v) &#123;<br>        var w, u = [];<br>        u[(v.length &gt;&gt; 2) - 1] = undefined;<br>        for (w = 0; w &lt; u.length; w += 1) &#123;<br>            u[w] = 0<br>        &#125;<br>        for (w = 0; w &lt; v.length * 8; w += 8) &#123;<br>            u[w &gt;&gt; 5] |= (v.charCodeAt(w / 8) &amp; 255) &lt;&lt; (w % 32)<br>        &#125;<br>        return u<br>    &#125;<br>    function k(u) &#123;<br>        return p(d(j(u), u.length * 8))<br>    &#125;<br>    function f(w, z) &#123;<br>        var v, y = j(w), u = [], x = [], A;<br>        u[15] = x[15] = undefined;<br>        if (y.length &gt; 16) &#123;<br>            y = d(y, w.length * 8)<br>        &#125;<br>        for (v = 0; v &lt; 16; v += 1) &#123;<br>            u[v] = y[v] ^ 909522486;<br>            x[v] = y[v] ^ 1549556828<br>        &#125;<br>        A = d(u.concat(j(z)), 512 + z.length * 8);<br>        return p(d(x.concat(A), 512 + 128))<br>    &#125;<br>    function t(w) &#123;<br>        var z = &quot;0123456789abcdef&quot;, v = &quot;&quot;, u, y;<br>        for (y = 0; y &lt; w.length; y += 1) &#123;<br>            u = w.charCodeAt(y);<br>            v += z.charAt((u &gt;&gt;&gt; 4) &amp; 15) + z.charAt(u &amp; 15)<br>        &#125;<br>        return v<br>    &#125;<br>    function m(u) &#123;<br>        return unescape(encodeURIComponent(u))<br>    &#125;<br>    function q(u) &#123;<br>        return k(m(u))<br>    &#125;<br>    function l(u) &#123;<br>        return t(q(u))<br>    &#125;<br>    function h(u, v) &#123;<br>        return f(m(u), m(v))<br>    &#125;<br>    function r(u, v) &#123;<br>        return t(h(u, v))<br>    &#125;<br>    function getpwd(v, w, u) &#123;<br>        if (!w) &#123;<br>            if (!u) &#123;<br>                return l(v)<br>            &#125; else &#123;<br>                return q(v)<br>            &#125;<br>        &#125;<br>        if (!u) &#123;<br>            return r(w, v)<br>        &#125; else &#123;<br>            return h(w, v)<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> md5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信公众平台登录密码加密解析</title>
      <link href="/2019/06/12/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%B9%B3%E5%8F%B0%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/06/12/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%B9%B3%E5%8F%B0%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址：<a href="https://mp.weixin.qq.com/">https://mp.weixin.qq.com</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>请求体中就pwd参数有进行加密，全局搜索pwd</p><p><img src="/images/image-20230517170958420.png" alt="image-20230517170958420"></p><p>全局搜索完后发现这里比较符合，打上断点，发现是m方法对密码进行了加密</p><p><img src="/images/image-20230517171052056.png" alt="image-20230517171052056"></p><p>m方法是个三元运算，t 和 n都是undefined，所以直接看最后面的o(r(e))</p><p><img src="/images/image-20230517171755953.png" alt="image-20230517171755953"></p><p>所有的方法都在这里，直接扣代码补全即可</p><p><img src="/images/image-20230517171923504.png" alt="image-20230517171923504"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> n = &#123;&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">t, e</span>) &#123;<br><span class="hljs-keyword">var</span> n = (<span class="hljs-number">65535</span> &amp; t) + (<span class="hljs-number">65535</span> &amp; e);<br><span class="hljs-keyword">return</span> (t &gt;&gt; <span class="hljs-number">16</span>) + (e &gt;&gt; <span class="hljs-number">16</span>) + (n &gt;&gt; <span class="hljs-number">16</span>) &lt;&lt; <span class="hljs-number">16</span> | <span class="hljs-number">65535</span> &amp; n<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">t, e, n, i, o, r</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">p</span>((s = <span class="hljs-title function_">p</span>(<span class="hljs-title function_">p</span>(e, t), <span class="hljs-title function_">p</span>(i, r))) &lt;&lt; (a = o) | s &gt;&gt;&gt; <span class="hljs-number">32</span> - a, n);<br><span class="hljs-keyword">var</span> s, a<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">t, e, n, i, o, r, s</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">a</span>(e &amp; n | ~e &amp; i, t, e, o, r, s)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">m</span>(<span class="hljs-params">t, e, n, i, o, r, s</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">a</span>(e &amp; i | n &amp; ~i, t, e, o, r, s)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">t, e, n, i, o, r, s</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">a</span>(e ^ n ^ i, t, e, o, r, s)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">t, e, n, i, o, r, s</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">a</span>(n ^ (e | ~i), t, e, o, r, s)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">t, e</span>) &#123;<br>t[e &gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">128</span> &lt;&lt; e % <span class="hljs-number">32</span>,<br>t[<span class="hljs-number">14</span> + (e + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>)] = e;<br><span class="hljs-keyword">var</span> n, i, o, r, s, a = <span class="hljs-number">1732584193</span>,<br>c = -<span class="hljs-number">271733879</span>,<br>u = -<span class="hljs-number">1732584194</span>,<br>d = <span class="hljs-number">271733878</span>;<br><span class="hljs-keyword">for</span> (n = <span class="hljs-number">0</span>; n &lt; t.<span class="hljs-property">length</span>; n += <span class="hljs-number">16</span>) a = <span class="hljs-title function_">h</span>(i = a, o = c, r = u, s = d, t[n], <span class="hljs-number">7</span>, -<span class="hljs-number">680876936</span>),<br>d = <span class="hljs-title function_">h</span>(d, a, c, u, t[n + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">389564586</span>),<br>u = <span class="hljs-title function_">h</span>(u, d, a, c, t[n + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>),<br>c = <span class="hljs-title function_">h</span>(c, u, d, a, t[n + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1044525330</span>),<br>a = <span class="hljs-title function_">h</span>(a, c, u, d, t[n + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, -<span class="hljs-number">176418897</span>),<br>d = <span class="hljs-title function_">h</span>(d, a, c, u, t[n + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>),<br>u = <span class="hljs-title function_">h</span>(u, d, a, c, t[n + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1473231341</span>),<br>c = <span class="hljs-title function_">h</span>(c, u, d, a, t[n + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">45705983</span>),<br>a = <span class="hljs-title function_">h</span>(a, c, u, d, t[n + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>),<br>d = <span class="hljs-title function_">h</span>(d, a, c, u, t[n + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">1958414417</span>),<br>u = <span class="hljs-title function_">h</span>(u, d, a, c, t[n + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">42063</span>),<br>c = <span class="hljs-title function_">h</span>(c, u, d, a, t[n + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, -<span class="hljs-number">1990404162</span>),<br>a = <span class="hljs-title function_">h</span>(a, c, u, d, t[n + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>),<br>d = <span class="hljs-title function_">h</span>(d, a, c, u, t[n + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, -<span class="hljs-number">40341101</span>),<br>u = <span class="hljs-title function_">h</span>(u, d, a, c, t[n + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, -<span class="hljs-number">1502002290</span>),<br>a = <span class="hljs-title function_">m</span>(a, c = <span class="hljs-title function_">h</span>(c, u, d, a, t[n + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>), u, d, t[n + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">165796510</span>),<br>d = <span class="hljs-title function_">m</span>(d, a, c, u, t[n + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1069501632</span>),<br>u = <span class="hljs-title function_">m</span>(u, d, a, c, t[n + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>),<br>c = <span class="hljs-title function_">m</span>(c, u, d, a, t[n], <span class="hljs-number">20</span>, -<span class="hljs-number">373897302</span>),<br>a = <span class="hljs-title function_">m</span>(a, c, u, d, t[n + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">701558691</span>),<br>d = <span class="hljs-title function_">m</span>(d, a, c, u, t[n + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>),<br>u = <span class="hljs-title function_">m</span>(u, d, a, c, t[n + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">660478335</span>),<br>c = <span class="hljs-title function_">m</span>(c, u, d, a, t[n + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">405537848</span>),<br>a = <span class="hljs-title function_">m</span>(a, c, u, d, t[n + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>),<br>d = <span class="hljs-title function_">m</span>(d, a, c, u, t[n + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">1019803690</span>),<br>u = <span class="hljs-title function_">m</span>(u, d, a, c, t[n + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, -<span class="hljs-number">187363961</span>),<br>c = <span class="hljs-title function_">m</span>(c, u, d, a, t[n + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>),<br>a = <span class="hljs-title function_">m</span>(a, c, u, d, t[n + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, -<span class="hljs-number">1444681467</span>),<br>d = <span class="hljs-title function_">m</span>(d, a, c, u, t[n + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, -<span class="hljs-number">51403784</span>),<br>u = <span class="hljs-title function_">m</span>(u, d, a, c, t[n + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>),<br>a = <span class="hljs-title function_">l</span>(a, c = <span class="hljs-title function_">m</span>(c, u, d, a, t[n + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, -<span class="hljs-number">1926607734</span>), u, d, t[n + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">378558</span>),<br>d = <span class="hljs-title function_">l</span>(d, a, c, u, t[n + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">2022574463</span>),<br>u = <span class="hljs-title function_">l</span>(u, d, a, c, t[n + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>),<br>c = <span class="hljs-title function_">l</span>(c, u, d, a, t[n + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">35309556</span>),<br>a = <span class="hljs-title function_">l</span>(a, c, u, d, t[n + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">1530992060</span>),<br>d = <span class="hljs-title function_">l</span>(d, a, c, u, t[n + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>),<br>u = <span class="hljs-title function_">l</span>(u, d, a, c, t[n + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">155497632</span>),<br>c = <span class="hljs-title function_">l</span>(c, u, d, a, t[n + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">1094730640</span>),<br>a = <span class="hljs-title function_">l</span>(a, c, u, d, t[n + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>),<br>d = <span class="hljs-title function_">l</span>(d, a, c, u, t[n], <span class="hljs-number">11</span>, -<span class="hljs-number">358537222</span>),<br>u = <span class="hljs-title function_">l</span>(u, d, a, c, t[n + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, -<span class="hljs-number">722521979</span>),<br>c = <span class="hljs-title function_">l</span>(c, u, d, a, t[n + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>),<br>a = <span class="hljs-title function_">l</span>(a, c, u, d, t[n + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, -<span class="hljs-number">640364487</span>),<br>d = <span class="hljs-title function_">l</span>(d, a, c, u, t[n + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, -<span class="hljs-number">421815835</span>),<br>u = <span class="hljs-title function_">l</span>(u, d, a, c, t[n + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>),<br>a = <span class="hljs-title function_">f</span>(a, c = <span class="hljs-title function_">l</span>(c, u, d, a, t[n + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, -<span class="hljs-number">995338651</span>), u, d, t[n], <span class="hljs-number">6</span>, -<span class="hljs-number">198630844</span>),<br>d = <span class="hljs-title function_">f</span>(d, a, c, u, t[n + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>),<br>u = <span class="hljs-title function_">f</span>(u, d, a, c, t[n + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1416354905</span>),<br>c = <span class="hljs-title function_">f</span>(c, u, d, a, t[n + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">57434055</span>),<br>a = <span class="hljs-title function_">f</span>(a, c, u, d, t[n + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>),<br>d = <span class="hljs-title function_">f</span>(d, a, c, u, t[n + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1894986606</span>),<br>u = <span class="hljs-title function_">f</span>(u, d, a, c, t[n + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1051523</span>),<br>c = <span class="hljs-title function_">f</span>(c, u, d, a, t[n + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">2054922799</span>),<br>a = <span class="hljs-title function_">f</span>(a, c, u, d, t[n + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>),<br>d = <span class="hljs-title function_">f</span>(d, a, c, u, t[n + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">30611744</span>),<br>u = <span class="hljs-title function_">f</span>(u, d, a, c, t[n + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, -<span class="hljs-number">1560198380</span>),<br>c = <span class="hljs-title function_">f</span>(c, u, d, a, t[n + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>),<br>a = <span class="hljs-title function_">f</span>(a, c, u, d, t[n + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, -<span class="hljs-number">145523070</span>),<br>d = <span class="hljs-title function_">f</span>(d, a, c, u, t[n + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, -<span class="hljs-number">1120210379</span>),<br>u = <span class="hljs-title function_">f</span>(u, d, a, c, t[n + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>),<br>c = <span class="hljs-title function_">f</span>(c, u, d, a, t[n + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, -<span class="hljs-number">343485551</span>),<br>a = <span class="hljs-title function_">p</span>(a, i),<br>c = <span class="hljs-title function_">p</span>(c, o),<br>u = <span class="hljs-title function_">p</span>(u, r),<br>d = <span class="hljs-title function_">p</span>(d, s);<br><span class="hljs-keyword">return</span> [a, c, u, d]<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">t</span>) &#123;<br><span class="hljs-keyword">var</span> e, n = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (e = <span class="hljs-number">0</span>; e &lt; <span class="hljs-number">32</span> * t.<span class="hljs-property">length</span>; e += <span class="hljs-number">8</span>) n += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(t[e &gt;&gt; <span class="hljs-number">5</span>] &gt;&gt;&gt; e % <span class="hljs-number">32</span> &amp; <span class="hljs-number">255</span>);<br><span class="hljs-keyword">return</span> n<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">t</span>) &#123;<br><span class="hljs-keyword">var</span> e, n = [];<br><span class="hljs-keyword">for</span> (n[(t.<span class="hljs-property">length</span> &gt;&gt; <span class="hljs-number">2</span>) - <span class="hljs-number">1</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>, e = <span class="hljs-number">0</span>; e &lt; n.<span class="hljs-property">length</span>; e += <span class="hljs-number">1</span>) n[e] = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (e = <span class="hljs-number">0</span>; e &lt; <span class="hljs-number">8</span> * t.<span class="hljs-property">length</span>; e += <span class="hljs-number">8</span>) n[e &gt;&gt; <span class="hljs-number">5</span>] |= (<span class="hljs-number">255</span> &amp; t.<span class="hljs-title function_">charCodeAt</span>(e / <span class="hljs-number">8</span>)) &lt;&lt; e % <span class="hljs-number">32</span>;<br><span class="hljs-keyword">return</span> n<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">i</span>(<span class="hljs-params">t</span>) &#123;<br><span class="hljs-keyword">var</span> e, n, i = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>,<br>o = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (n = <span class="hljs-number">0</span>; n &lt; t.<span class="hljs-property">length</span>; n += <span class="hljs-number">1</span>) e = t.<span class="hljs-title function_">charCodeAt</span>(n),<br>o += i.<span class="hljs-title function_">charAt</span>(e &gt;&gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>) + i.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">15</span> &amp; e);<br><span class="hljs-keyword">return</span> o<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">t</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(t))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">t</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(<span class="hljs-title function_">d</span>(e = <span class="hljs-title function_">o</span>(t)), <span class="hljs-number">8</span> * e.<span class="hljs-property">length</span>));<br><span class="hljs-keyword">var</span> e<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">t, e</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;<br>    <span class="hljs-keyword">var</span> n, i, o = <span class="hljs-title function_">d</span>(t),<br>    r = [],<br>    s = [];<br>    <span class="hljs-keyword">for</span> (r[<span class="hljs-number">15</span>] = s[<span class="hljs-number">15</span>] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>, <span class="hljs-number">16</span> &lt; o.<span class="hljs-property">length</span> &amp;&amp; (o = <span class="hljs-title function_">c</span>(o, <span class="hljs-number">8</span> * t.<span class="hljs-property">length</span>)), n = <span class="hljs-number">0</span>; n &lt; <span class="hljs-number">16</span>; n += <span class="hljs-number">1</span>) r[n] = <span class="hljs-number">909522486</span> ^ o[n],<br>    s[n] = <span class="hljs-number">1549556828</span> ^ o[n];<br>    <span class="hljs-keyword">return</span> i = <span class="hljs-title function_">c</span>(r.<span class="hljs-title function_">concat</span>(<span class="hljs-title function_">d</span>(e)), <span class="hljs-number">512</span> + <span class="hljs-number">8</span> * e.<span class="hljs-property">length</span>),<br>    <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(s.<span class="hljs-title function_">concat</span>(i), <span class="hljs-number">640</span>))<br>&#125; (<span class="hljs-title function_">o</span>(t), <span class="hljs-title function_">o</span>(e))<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getpwd</span>(<span class="hljs-params">t, e, n</span>) &#123;<br><span class="hljs-keyword">return</span> e ? n ? <span class="hljs-title function_">s</span>(e, t) : <span class="hljs-title function_">i</span>(<span class="hljs-title function_">s</span>(e, t)) : n ? <span class="hljs-title function_">r</span>(t) : <span class="hljs-title function_">i</span>(<span class="hljs-title function_">r</span>(t))<br>&#125;<br><br><span class="hljs-comment">// console.log(getpwd(&quot;123456&quot;))</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 混淆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vivo社区请求体加密参数解析</title>
      <link href="/2019/05/11/vivo%E7%A4%BE%E5%8C%BA%E8%AF%B7%E6%B1%82%E4%BD%93%E5%8A%A0%E5%AF%86%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/05/11/vivo%E7%A4%BE%E5%8C%BA%E8%AF%B7%E6%B1%82%E4%BD%93%E5%8A%A0%E5%AF%86%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网址:<a href="https://bbs.vivo.com.cn/newbbs/">https://bbs.vivo.com.cn/newbbs/</a></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>imgSpecs 应该是跟页面宽度有关，不过参数固定，不用管</p><p>lastId 是上一篇文章的tid，可从html里面拿,也可以为空</p><p>nonce 加密，需要解析</p><p><img src="/images/image-20230517165408196.png" alt="image-20230517165408196"></p><p>全局搜索nonce，找到这里，打上断点看一下</p><p><img src="/images/image-20230517170036456.png" alt="image-20230517170036456"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">n + <span class="hljs-string">&quot;&quot;</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-number">1e7</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>(), <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>  <span class="hljs-comment">//时间戳加上一个随机七位数，然后再加1</span><br><span class="hljs-title class_">Object</span>(<span class="hljs-title class_">Le</span>.<span class="hljs-property">md5</span>)(n + <span class="hljs-string">&quot;&quot;</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-number">1e7</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>(), <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>, <span class="hljs-number">32</span>) base64加密 <span class="hljs-number">32</span>位小写<br></code></pre></td></tr></table></figure><p>直接把Le.md5扣下来就好了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">xxx</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">return</span> e &lt;&lt; t | e &gt;&gt;&gt; <span class="hljs-number">32</span> - t<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">var</span> n, r, u, o, l;<br>        <span class="hljs-keyword">return</span> u = <span class="hljs-number">2147483648</span> &amp; e,<br>        o = <span class="hljs-number">2147483648</span> &amp; t,<br>        l = (<span class="hljs-number">1073741823</span> &amp; e) + (<span class="hljs-number">1073741823</span> &amp; t),<br>        (n = <span class="hljs-number">1073741824</span> &amp; e) &amp; (r = <span class="hljs-number">1073741824</span> &amp; t) ? <span class="hljs-number">2147483648</span> ^ l ^ u ^ o : n | r ? <span class="hljs-number">1073741824</span> &amp; l ? <span class="hljs-number">3221225472</span> ^ l ^ u ^ o : <span class="hljs-number">1073741824</span> ^ l ^ u ^ o : l ^ u ^ o<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e, t, u, o, l, i, c</span>) &#123;<br>        <span class="hljs-keyword">return</span> e = <span class="hljs-title function_">r</span>(e, <span class="hljs-title function_">r</span>(<span class="hljs-title function_">r</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; t | ~e &amp; n<br>        &#125;(t, u, o), l), c)),<br>        <span class="hljs-title function_">r</span>(<span class="hljs-title function_">n</span>(e, i), t)<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t, u, o, l, i, c</span>) &#123;<br>        <span class="hljs-keyword">return</span> e = <span class="hljs-title function_">r</span>(e, <span class="hljs-title function_">r</span>(<span class="hljs-title function_">r</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; n | t &amp; ~n<br>        &#125;(t, u, o), l), c)),<br>        <span class="hljs-title function_">r</span>(<span class="hljs-title function_">n</span>(e, i), t)<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">e, t, u, o, l, i, c</span>) &#123;<br>        <span class="hljs-keyword">return</span> e = <span class="hljs-title function_">r</span>(e, <span class="hljs-title function_">r</span>(<span class="hljs-title function_">r</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e ^ t ^ n<br>        &#125;(t, u, o), l), c)),<br>        <span class="hljs-title function_">r</span>(<span class="hljs-title function_">n</span>(e, i), t)<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">i</span>(<span class="hljs-params">e, t, u, o, l, i, c</span>) &#123;<br>        <span class="hljs-keyword">return</span> e = <span class="hljs-title function_">r</span>(e, <span class="hljs-title function_">r</span>(<span class="hljs-title function_">r</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t ^ (e | ~n)<br>        &#125;(t, u, o), l), c)),<br>        <span class="hljs-title function_">r</span>(<span class="hljs-title function_">n</span>(e, i), t)<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, n = <span class="hljs-string">&quot;&quot;</span>, r = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt;= <span class="hljs-number">3</span>; t++)<br>            n += (r = <span class="hljs-string">&quot;0&quot;</span> + (e &gt;&gt;&gt; <span class="hljs-number">8</span> * t &amp; <span class="hljs-number">255</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)).<span class="hljs-title function_">substr</span>(r.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">return</span> n<br>    &#125;<br>    <span class="hljs-keyword">var</span> d, a, s, p, h, f, m, v, g, y = e, b = <span class="hljs-title class_">Array</span>();<br>    <span class="hljs-keyword">for</span> (b = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t, n = e.<span class="hljs-property">length</span>, r = n + <span class="hljs-number">8</span>, u = <span class="hljs-number">16</span> * ((r - r % <span class="hljs-number">64</span>) / <span class="hljs-number">64</span> + <span class="hljs-number">1</span>), o = <span class="hljs-title class_">Array</span>(u - <span class="hljs-number">1</span>), l = <span class="hljs-number">0</span>, i = <span class="hljs-number">0</span>; i &lt; n; )<br>            l = i % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>            o[t = (i - i % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = o[t] | e.<span class="hljs-title function_">charCodeAt</span>(i) &lt;&lt; l,<br>            i++;<br>        <span class="hljs-keyword">return</span> l = i % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>        o[t = (i - i % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = o[t] | <span class="hljs-number">128</span> &lt;&lt; l,<br>        o[u - <span class="hljs-number">2</span>] = n &lt;&lt; <span class="hljs-number">3</span>,<br>        o[u - <span class="hljs-number">1</span>] = n &gt;&gt;&gt; <span class="hljs-number">29</span>,<br>        o<br>    &#125;(y),<br>    f = <span class="hljs-number">1732584193</span>,<br>    m = <span class="hljs-number">4023233417</span>,<br>    v = <span class="hljs-number">2562383102</span>,<br>    g = <span class="hljs-number">271733878</span>,<br>    d = <span class="hljs-number">0</span>; d &lt; b.<span class="hljs-property">length</span>; d += <span class="hljs-number">16</span>)<br>        a = f,<br>        s = m,<br>        p = v,<br>        h = g,<br>        m = <span class="hljs-title function_">i</span>(m = <span class="hljs-title function_">i</span>(m = <span class="hljs-title function_">i</span>(m = <span class="hljs-title function_">i</span>(m = <span class="hljs-title function_">l</span>(m = <span class="hljs-title function_">l</span>(m = <span class="hljs-title function_">l</span>(m = <span class="hljs-title function_">l</span>(m = <span class="hljs-title function_">o</span>(m = <span class="hljs-title function_">o</span>(m = <span class="hljs-title function_">o</span>(m = <span class="hljs-title function_">o</span>(m = <span class="hljs-title function_">u</span>(m = <span class="hljs-title function_">u</span>(m = <span class="hljs-title function_">u</span>(m = <span class="hljs-title function_">u</span>(m, v = <span class="hljs-title function_">u</span>(v, g = <span class="hljs-title function_">u</span>(g, f = <span class="hljs-title function_">u</span>(f, m, v, g, b[d + <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">3614090360</span>), m, v, b[d + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">3905402710</span>), f, m, b[d + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>), g, f, b[d + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">3250441966</span>), v = <span class="hljs-title function_">u</span>(v, g = <span class="hljs-title function_">u</span>(g, f = <span class="hljs-title function_">u</span>(f, m, v, g, b[d + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">4118548399</span>), m, v, b[d + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>), f, m, b[d + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2821735955</span>), g, f, b[d + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">4249261313</span>), v = <span class="hljs-title function_">u</span>(v, g = <span class="hljs-title function_">u</span>(g, f = <span class="hljs-title function_">u</span>(f, m, v, g, b[d + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>), m, v, b[d + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">2336552879</span>), f, m, b[d + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">4294925233</span>), g, f, b[d + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">2304563134</span>), v = <span class="hljs-title function_">u</span>(v, g = <span class="hljs-title function_">u</span>(g, f = <span class="hljs-title function_">u</span>(f, m, v, g, b[d + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>), m, v, b[d + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">4254626195</span>), f, m, b[d + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2792965006</span>), g, f, b[d + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>), v = <span class="hljs-title function_">o</span>(v, g = <span class="hljs-title function_">o</span>(g, f = <span class="hljs-title function_">o</span>(f, m, v, g, b[d + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">4129170786</span>), m, v, b[d + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3225465664</span>), f, m, b[d + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>), g, f, b[d + <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3921069994</span>), v = <span class="hljs-title function_">o</span>(v, g = <span class="hljs-title function_">o</span>(g, f = <span class="hljs-title function_">o</span>(f, m, v, g, b[d + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">3593408605</span>), m, v, b[d + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>), f, m, b[d + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">3634488961</span>), g, f, b[d + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3889429448</span>), v = <span class="hljs-title function_">o</span>(v, g = <span class="hljs-title function_">o</span>(g, f = <span class="hljs-title function_">o</span>(f, m, v, g, b[d + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>), m, v, b[d + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3275163606</span>), f, m, b[d + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">4107603335</span>), g, f, b[d + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>), v = <span class="hljs-title function_">o</span>(v, g = <span class="hljs-title function_">o</span>(g, f = <span class="hljs-title function_">o</span>(f, m, v, g, b[d + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">2850285829</span>), m, v, b[d + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">4243563512</span>), f, m, b[d + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>), g, f, b[d + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">2368359562</span>), v = <span class="hljs-title function_">l</span>(v, g = <span class="hljs-title function_">l</span>(g, f = <span class="hljs-title function_">l</span>(f, m, v, g, b[d + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">4294588738</span>), m, v, b[d + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">2272392833</span>), f, m, b[d + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>), g, f, b[d + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">4259657740</span>), v = <span class="hljs-title function_">l</span>(v, g = <span class="hljs-title function_">l</span>(g, f = <span class="hljs-title function_">l</span>(f, m, v, g, b[d + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">2763975236</span>), m, v, b[d + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>), f, m, b[d + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">4139469664</span>), g, f, b[d + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3200236656</span>), v = <span class="hljs-title function_">l</span>(v, g = <span class="hljs-title function_">l</span>(g, f = <span class="hljs-title function_">l</span>(f, m, v, g, b[d + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>), m, v, b[d + <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3936430074</span>), f, m, b[d + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">3572445317</span>), g, f, b[d + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>), v = <span class="hljs-title function_">l</span>(v, g = <span class="hljs-title function_">l</span>(g, f = <span class="hljs-title function_">l</span>(f, m, v, g, b[d + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">3654602809</span>), m, v, b[d + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3873151461</span>), f, m, b[d + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>), g, f, b[d + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3299628645</span>), v = <span class="hljs-title function_">i</span>(v, g = <span class="hljs-title function_">i</span>(g, f = <span class="hljs-title function_">i</span>(f, m, v, g, b[d + <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4096336452</span>), m, v, b[d + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>), f, m, b[d + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2878612391</span>), g, f, b[d + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">4237533241</span>), v = <span class="hljs-title function_">i</span>(v, g = <span class="hljs-title function_">i</span>(g, f = <span class="hljs-title function_">i</span>(f, m, v, g, b[d + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>), m, v, b[d + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">2399980690</span>), f, m, b[d + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">4293915773</span>), g, f, b[d + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">2240044497</span>), v = <span class="hljs-title function_">i</span>(v, g = <span class="hljs-title function_">i</span>(g, f = <span class="hljs-title function_">i</span>(f, m, v, g, b[d + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>), m, v, b[d + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">4264355552</span>), f, m, b[d + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2734768916</span>), g, f, b[d + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>), v = <span class="hljs-title function_">i</span>(v, g = <span class="hljs-title function_">i</span>(g, f = <span class="hljs-title function_">i</span>(f, m, v, g, b[d + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4149444226</span>), m, v, b[d + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">3174756917</span>), f, m, b[d + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>), g, f, b[d + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">3951481745</span>),<br>        f = <span class="hljs-title function_">r</span>(f, a),<br>        m = <span class="hljs-title function_">r</span>(m, s),<br>        v = <span class="hljs-title function_">r</span>(v, p),<br>        g = <span class="hljs-title function_">r</span>(g, h);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">32</span> == t ? <span class="hljs-title function_">c</span>(f) + <span class="hljs-title function_">c</span>(m) + <span class="hljs-title function_">c</span>(v) + <span class="hljs-title function_">c</span>(g) : <span class="hljs-title function_">c</span>(m) + <span class="hljs-title function_">c</span>(v)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> md5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>长房网登录DES加密解析</title>
      <link href="/2019/05/04/%E9%95%BF%E6%88%BF%E7%BD%91%E7%99%BB%E5%BD%95DES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/05/04/%E9%95%BF%E6%88%BF%E7%BD%91%E7%99%BB%E5%BD%95DES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>网站链接：<a href="http://eip.xxxxx.com/login.jsp">http://eip.xxxxx.com/login.jsp</a></p><p>登录接口：<a href="http://eip.xxxxx.com/j_acegi_security_check">http://eip.xxxxx.com/j_acegi_security_check</a></p><p>加密参数：<strong>j_password</strong></p><p><img src="/images/image-20230411175919900.png" alt="image-20230411175919900"></p></blockquote><h3 id="解析流程"><a href="#解析流程" class="headerlink" title="解析流程"></a>解析流程</h3><p>1.搜索关键字j_password，看到encrypt，直接进去查看函数，打上断点查看，发现是des对称加密</p><p><img src="/images/image-20230411180056235.png" alt="image-20230411180056235"></p><p><img src="/images/image-20230411180543218.png" alt="image-20230411180543218"></p><p>2.直接扣代码补全参数完成加密</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><br><span class="hljs-comment">http://eip.xxxx.com/login.jsp</span><br><span class="hljs-comment">1.可以通过搜索加密的值的方式来找到参与加密的value</span><br><span class="hljs-comment">2.可以强制让判断条件倾向与某一方</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CryptoJS</span> = <span class="hljs-title class_">CryptoJS</span> || <span class="hljs-keyword">function</span>(<span class="hljs-params">u, p</span>) &#123;<br>    <span class="hljs-keyword">var</span> d = &#123;&#125;<br>      , l = d.<span class="hljs-property">lib</span> = &#123;&#125;<br>      , s = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br>      , t = l.<span class="hljs-property">Base</span> = &#123;<br>        <span class="hljs-attr">extend</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            s.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-variable language_">this</span>;<br>            <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">new</span> s;<br>            a &amp;&amp; c.<span class="hljs-title function_">mixIn</span>(a);<br>            c.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">&quot;init&quot;</span>) || (c.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                c.<span class="hljs-property">$super</span>.<span class="hljs-property">init</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)<br>            &#125;<br>            );<br>            c.<span class="hljs-property">init</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = c;<br>            c.<span class="hljs-property">$super</span> = <span class="hljs-variable language_">this</span>;<br>            <span class="hljs-keyword">return</span> c<br>        &#125;,<br>        <span class="hljs-attr">create</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">extend</span>();<br>            a.<span class="hljs-property">init</span>.<span class="hljs-title function_">apply</span>(a, <span class="hljs-variable language_">arguments</span>);<br>            <span class="hljs-keyword">return</span> a<br>        &#125;,<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;,<br>        <span class="hljs-attr">mixIn</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c <span class="hljs-keyword">in</span> a)<br>                a.<span class="hljs-title function_">hasOwnProperty</span>(c) &amp;&amp; (<span class="hljs-variable language_">this</span>[c] = a[c]);<br>            a.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">&quot;toString&quot;</span>) &amp;&amp; (<span class="hljs-variable language_">this</span>.<span class="hljs-property">toString</span> = a.<span class="hljs-property">toString</span>)<br>        &#125;,<br>        <span class="hljs-attr">clone</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">init</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">extend</span>(<span class="hljs-variable language_">this</span>)<br>        &#125;<br>    &#125;<br>      , r = l.<span class="hljs-property">WordArray</span> = t.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, c</span>) &#123;<br>            a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">words</span> = a || [];<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sigBytes</span> = c != p ? c : <span class="hljs-number">4</span> * a.<span class="hljs-property">length</span><br>        &#125;,<br>        <span class="hljs-attr">toString</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">return</span> (a || v).<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>)<br>        &#125;,<br>        <span class="hljs-attr">concat</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">var</span> c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">words</span><br>              , e = a.<span class="hljs-property">words</span><br>              , j = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sigBytes</span>;<br>            a = a.<span class="hljs-property">sigBytes</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clamp</span>();<br>            <span class="hljs-keyword">if</span> (j % <span class="hljs-number">4</span>)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; a; k++)<br>                    c[j + k &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (e[k &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (k % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((j + k) % <span class="hljs-number">4</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">65535</span> &lt; e.<span class="hljs-property">length</span>)<br>                <span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; a; k += <span class="hljs-number">4</span>)<br>                    c[j + k &gt;&gt;&gt; <span class="hljs-number">2</span>] = e[k &gt;&gt;&gt; <span class="hljs-number">2</span>];<br>            <span class="hljs-keyword">else</span><br>                c.<span class="hljs-property">push</span>.<span class="hljs-title function_">apply</span>(c, e);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sigBytes</span> += a;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><br>        &#125;,<br>        <span class="hljs-attr">clamp</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">words</span><br>              , c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sigBytes</span>;<br>            a[c &gt;&gt;&gt; <span class="hljs-number">2</span>] &amp;= <span class="hljs-number">4294967295</span> &lt;&lt; <span class="hljs-number">32</span> - <span class="hljs-number">8</span> * (c % <span class="hljs-number">4</span>);<br>            a.<span class="hljs-property">length</span> = u.<span class="hljs-title function_">ceil</span>(c / <span class="hljs-number">4</span>)<br>        &#125;,<br>        <span class="hljs-attr">clone</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> a = t.<span class="hljs-property">clone</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            a.<span class="hljs-property">words</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">words</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">return</span> a<br>        &#125;,<br>        <span class="hljs-attr">random</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = [], e = <span class="hljs-number">0</span>; e &lt; a; e += <span class="hljs-number">4</span>)<br>                c.<span class="hljs-title function_">push</span>(<span class="hljs-number">4294967296</span> * u.<span class="hljs-title function_">random</span>() | <span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> r.<span class="hljs-title function_">init</span>(c,a)<br>        &#125;<br>    &#125;)<br>      , w = d.<span class="hljs-property">enc</span> = &#123;&#125;<br>      , v = w.<span class="hljs-property">Hex</span> = &#123;<br>        <span class="hljs-attr">stringify</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">var</span> c = a.<span class="hljs-property">words</span>;<br>            a = a.<span class="hljs-property">sigBytes</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = [], j = <span class="hljs-number">0</span>; j &lt; a; j++) &#123;<br>                <span class="hljs-keyword">var</span> k = c[j &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>;<br>                e.<span class="hljs-title function_">push</span>((k &gt;&gt;&gt; <span class="hljs-number">4</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br>                e.<span class="hljs-title function_">push</span>((k &amp; <span class="hljs-number">15</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>))<br>            &#125;<br>            <span class="hljs-keyword">return</span> e.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>)<br>        &#125;,<br>        <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = a.<span class="hljs-property">length</span>, e = [], j = <span class="hljs-number">0</span>; j &lt; c; j += <span class="hljs-number">2</span>)<br>                e[j &gt;&gt;&gt; <span class="hljs-number">3</span>] |= <span class="hljs-built_in">parseInt</span>(a.<span class="hljs-title function_">substr</span>(j, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">4</span> * (j % <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> r.<span class="hljs-title function_">init</span>(e,c / <span class="hljs-number">2</span>)<br>        &#125;<br>    &#125;<br>      , b = w.<span class="hljs-property">Latin1</span> = &#123;<br>        <span class="hljs-attr">stringify</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">var</span> c = a.<span class="hljs-property">words</span>;<br>            a = a.<span class="hljs-property">sigBytes</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = [], j = <span class="hljs-number">0</span>; j &lt; a; j++)<br>                e.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(c[j &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>));<br>            <span class="hljs-keyword">return</span> e.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>)<br>        &#125;,<br>        <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = a.<span class="hljs-property">length</span>, e = [], j = <span class="hljs-number">0</span>; j &lt; c; j++)<br>                e[j &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (a.<span class="hljs-title function_">charCodeAt</span>(j) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (j % <span class="hljs-number">4</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> r.<span class="hljs-title function_">init</span>(e,c)<br>        &#125;<br>    &#125;<br>      , x = w.<span class="hljs-property">Utf8</span> = &#123;<br>        <span class="hljs-attr">stringify</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-built_in">escape</span>(b.<span class="hljs-title function_">stringify</span>(a)))<br>            &#125; <span class="hljs-keyword">catch</span> (c) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Malformed UTF-8 data&quot;</span>);<br>            &#125;<br>        &#125;,<br>        <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">return</span> b.<span class="hljs-title function_">parse</span>(<span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(a)))<br>        &#125;<br>    &#125;<br>      , q = l.<span class="hljs-property">BufferedBlockAlgorithm</span> = t.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">reset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = <span class="hljs-keyword">new</span> r.<span class="hljs-property">init</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nDataBytes</span> = <span class="hljs-number">0</span><br>        &#125;,<br>        <span class="hljs-attr">_append</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> a &amp;&amp; (a = x.<span class="hljs-title function_">parse</span>(a));<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span>.<span class="hljs-title function_">concat</span>(a);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nDataBytes</span> += a.<span class="hljs-property">sigBytes</span><br>        &#125;,<br>        <span class="hljs-attr">_process</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">var</span> c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span><br>              , e = c.<span class="hljs-property">words</span><br>              , j = c.<span class="hljs-property">sigBytes</span><br>              , k = <span class="hljs-variable language_">this</span>.<span class="hljs-property">blockSize</span><br>              , b = j / (<span class="hljs-number">4</span> * k)<br>              , b = a ? u.<span class="hljs-title function_">ceil</span>(b) : u.<span class="hljs-title function_">max</span>((b | <span class="hljs-number">0</span>) - <span class="hljs-variable language_">this</span>.<span class="hljs-property">_minBufferSize</span>, <span class="hljs-number">0</span>);<br>            a = b * k;<br>            j = u.<span class="hljs-title function_">min</span>(<span class="hljs-number">4</span> * a, j);<br>            <span class="hljs-keyword">if</span> (a) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> q = <span class="hljs-number">0</span>; q &lt; a; q += k)<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doProcessBlock</span>(e, q);<br>                q = e.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, a);<br>                c.<span class="hljs-property">sigBytes</span> -= j<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> r.<span class="hljs-title function_">init</span>(q,j)<br>        &#125;,<br>        <span class="hljs-attr">clone</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> a = t.<span class="hljs-property">clone</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            a.<span class="hljs-property">_data</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span>.<span class="hljs-title function_">clone</span>();<br>            <span class="hljs-keyword">return</span> a<br>        &#125;,<br>        <span class="hljs-attr">_minBufferSize</span>: <span class="hljs-number">0</span><br>    &#125;);<br>    l.<span class="hljs-property">Hasher</span> = q.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: t.<span class="hljs-title function_">extend</span>(),<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(a);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reset</span>()<br>        &#125;,<br>        <span class="hljs-attr">reset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            q.<span class="hljs-property">reset</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doReset</span>()<br>        &#125;,<br>        <span class="hljs-attr">update</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_append</span>(a);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>();<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><br>        &#125;,<br>        <span class="hljs-attr">finalize</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            a &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_append</span>(a);<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doFinalize</span>()<br>        &#125;,<br>        <span class="hljs-attr">blockSize</span>: <span class="hljs-number">16</span>,<br>        <span class="hljs-attr">_createHelper</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">b, e</span>) &#123;<br>                <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> a.<span class="hljs-title function_">init</span>(e)).<span class="hljs-title function_">finalize</span>(b)<br>            &#125;<br>        &#125;,<br>        <span class="hljs-attr">_createHmacHelper</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">b, e</span>) &#123;<br>                <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> n.<span class="hljs-property">HMAC</span>.<span class="hljs-title function_">init</span>(a,e)).<span class="hljs-title function_">finalize</span>(b)<br>            &#125;<br>        &#125;<br>    &#125;);<br>    <span class="hljs-keyword">var</span> n = d.<span class="hljs-property">algo</span> = &#123;&#125;;<br>    <span class="hljs-keyword">return</span> d<br>&#125;(<span class="hljs-title class_">Math</span>);<br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> u = <span class="hljs-title class_">CryptoJS</span><br>      , p = u.<span class="hljs-property">lib</span>.<span class="hljs-property">WordArray</span>;<br>    u.<span class="hljs-property">enc</span>.<span class="hljs-property">Base64</span> = &#123;<br>        <span class="hljs-attr">stringify</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) &#123;<br>            <span class="hljs-keyword">var</span> l = d.<span class="hljs-property">words</span><br>              , p = d.<span class="hljs-property">sigBytes</span><br>              , t = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_map</span>;<br>            d.<span class="hljs-title function_">clamp</span>();<br>            d = [];<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>; r &lt; p; r += <span class="hljs-number">3</span>)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> w = (l[r &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (r % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">16</span> | (l[r + <span class="hljs-number">1</span> &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((r + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">8</span> | l[r + <span class="hljs-number">2</span> &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((r + <span class="hljs-number">2</span>) % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>, v = <span class="hljs-number">0</span>; <span class="hljs-number">4</span> &gt; v &amp;&amp; r + <span class="hljs-number">0.75</span> * v &lt; p; v++)<br>                    d.<span class="hljs-title function_">push</span>(t.<span class="hljs-title function_">charAt</span>(w &gt;&gt;&gt; <span class="hljs-number">6</span> * (<span class="hljs-number">3</span> - v) &amp; <span class="hljs-number">63</span>));<br>            <span class="hljs-keyword">if</span> (l = t.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">64</span>))<br>                <span class="hljs-keyword">for</span> (; d.<span class="hljs-property">length</span> % <span class="hljs-number">4</span>; )<br>                    d.<span class="hljs-title function_">push</span>(l);<br>            <span class="hljs-keyword">return</span> d.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>)<br>        &#125;,<br>        <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) &#123;<br>            <span class="hljs-keyword">var</span> l = d.<span class="hljs-property">length</span><br>              , s = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_map</span><br>              , t = s.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">64</span>);<br>            t &amp;&amp; (t = d.<span class="hljs-title function_">indexOf</span>(t),<br>            -<span class="hljs-number">1</span> != t &amp;&amp; (l = t));<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], r = <span class="hljs-number">0</span>, w = <span class="hljs-number">0</span>; w &lt; l; w++)<br>                <span class="hljs-keyword">if</span> (w % <span class="hljs-number">4</span>) &#123;<br>                    <span class="hljs-keyword">var</span> v = s.<span class="hljs-title function_">indexOf</span>(d.<span class="hljs-title function_">charAt</span>(w - <span class="hljs-number">1</span>)) &lt;&lt; <span class="hljs-number">2</span> * (w % <span class="hljs-number">4</span>)<br>                      , b = s.<span class="hljs-title function_">indexOf</span>(d.<span class="hljs-title function_">charAt</span>(w)) &gt;&gt;&gt; <span class="hljs-number">6</span> - <span class="hljs-number">2</span> * (w % <span class="hljs-number">4</span>);<br>                    t[r &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (v | b) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (r % <span class="hljs-number">4</span>);<br>                    r++<br>                &#125;<br>            <span class="hljs-keyword">return</span> p.<span class="hljs-title function_">create</span>(t, r)<br>        &#125;,<br>        <span class="hljs-attr">_map</span>: <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><br>    &#125;<br>&#125;<br>)();<br>(<span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">b, n, a, c, e, j, k</span>) &#123;<br>        b = b + (n &amp; a | ~n &amp; c) + e + k;<br>        <span class="hljs-keyword">return</span> (b &lt;&lt; j | b &gt;&gt;&gt; <span class="hljs-number">32</span> - j) + n<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">b, n, a, c, e, j, k</span>) &#123;<br>        b = b + (n &amp; c | a &amp; ~c) + e + k;<br>        <span class="hljs-keyword">return</span> (b &lt;&lt; j | b &gt;&gt;&gt; <span class="hljs-number">32</span> - j) + n<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">l</span>(<span class="hljs-params">b, n, a, c, e, j, k</span>) &#123;<br>        b = b + (n ^ a ^ c) + e + k;<br>        <span class="hljs-keyword">return</span> (b &lt;&lt; j | b &gt;&gt;&gt; <span class="hljs-number">32</span> - j) + n<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">b, n, a, c, e, j, k</span>) &#123;<br>        b = b + (a ^ (n | ~c)) + e + k;<br>        <span class="hljs-keyword">return</span> (b &lt;&lt; j | b &gt;&gt;&gt; <span class="hljs-number">32</span> - j) + n<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-title class_">CryptoJS</span>, r = t.<span class="hljs-property">lib</span>, w = r.<span class="hljs-property">WordArray</span>, v = r.<span class="hljs-property">Hasher</span>, r = t.<span class="hljs-property">algo</span>, b = [], x = <span class="hljs-number">0</span>; <span class="hljs-number">64</span> &gt; x; x++)<br>        b[x] = <span class="hljs-number">4294967296</span> * u.<span class="hljs-title function_">abs</span>(u.<span class="hljs-title function_">sin</span>(x + <span class="hljs-number">1</span>)) | <span class="hljs-number">0</span>;<br>    r = r.<span class="hljs-property">MD5</span> = v.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">_doReset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hash</span> = <span class="hljs-keyword">new</span> w.<span class="hljs-title function_">init</span>([<span class="hljs-number">1732584193</span>, <span class="hljs-number">4023233417</span>, <span class="hljs-number">2562383102</span>, <span class="hljs-number">271733878</span>])<br>        &#125;,<br>        <span class="hljs-attr">_doProcessBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">q, n</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; <span class="hljs-number">16</span> &gt; a; a++) &#123;<br>                <span class="hljs-keyword">var</span> c = n + a<br>                  , e = q[c];<br>                q[c] = (e &lt;&lt; <span class="hljs-number">8</span> | e &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">16711935</span> | (e &lt;&lt; <span class="hljs-number">24</span> | e &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">4278255360</span><br>            &#125;<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hash</span>.<span class="hljs-property">words</span><br>              , c = q[n + <span class="hljs-number">0</span>]<br>              , e = q[n + <span class="hljs-number">1</span>]<br>              , j = q[n + <span class="hljs-number">2</span>]<br>              , k = q[n + <span class="hljs-number">3</span>]<br>              , z = q[n + <span class="hljs-number">4</span>]<br>              , r = q[n + <span class="hljs-number">5</span>]<br>              , t = q[n + <span class="hljs-number">6</span>]<br>              , w = q[n + <span class="hljs-number">7</span>]<br>              , v = q[n + <span class="hljs-number">8</span>]<br>              , A = q[n + <span class="hljs-number">9</span>]<br>              , B = q[n + <span class="hljs-number">10</span>]<br>              , C = q[n + <span class="hljs-number">11</span>]<br>              , u = q[n + <span class="hljs-number">12</span>]<br>              , D = q[n + <span class="hljs-number">13</span>]<br>              , E = q[n + <span class="hljs-number">14</span>]<br>              , x = q[n + <span class="hljs-number">15</span>]<br>              , f = a[<span class="hljs-number">0</span>]<br>              , m = a[<span class="hljs-number">1</span>]<br>              , g = a[<span class="hljs-number">2</span>]<br>              , h = a[<span class="hljs-number">3</span>]<br>              , f = <span class="hljs-title function_">p</span>(f, m, g, h, c, <span class="hljs-number">7</span>, b[<span class="hljs-number">0</span>])<br>              , h = <span class="hljs-title function_">p</span>(h, f, m, g, e, <span class="hljs-number">12</span>, b[<span class="hljs-number">1</span>])<br>              , g = <span class="hljs-title function_">p</span>(g, h, f, m, j, <span class="hljs-number">17</span>, b[<span class="hljs-number">2</span>])<br>              , m = <span class="hljs-title function_">p</span>(m, g, h, f, k, <span class="hljs-number">22</span>, b[<span class="hljs-number">3</span>])<br>              , f = <span class="hljs-title function_">p</span>(f, m, g, h, z, <span class="hljs-number">7</span>, b[<span class="hljs-number">4</span>])<br>              , h = <span class="hljs-title function_">p</span>(h, f, m, g, r, <span class="hljs-number">12</span>, b[<span class="hljs-number">5</span>])<br>              , g = <span class="hljs-title function_">p</span>(g, h, f, m, t, <span class="hljs-number">17</span>, b[<span class="hljs-number">6</span>])<br>              , m = <span class="hljs-title function_">p</span>(m, g, h, f, w, <span class="hljs-number">22</span>, b[<span class="hljs-number">7</span>])<br>              , f = <span class="hljs-title function_">p</span>(f, m, g, h, v, <span class="hljs-number">7</span>, b[<span class="hljs-number">8</span>])<br>              , h = <span class="hljs-title function_">p</span>(h, f, m, g, A, <span class="hljs-number">12</span>, b[<span class="hljs-number">9</span>])<br>              , g = <span class="hljs-title function_">p</span>(g, h, f, m, B, <span class="hljs-number">17</span>, b[<span class="hljs-number">10</span>])<br>              , m = <span class="hljs-title function_">p</span>(m, g, h, f, C, <span class="hljs-number">22</span>, b[<span class="hljs-number">11</span>])<br>              , f = <span class="hljs-title function_">p</span>(f, m, g, h, u, <span class="hljs-number">7</span>, b[<span class="hljs-number">12</span>])<br>              , h = <span class="hljs-title function_">p</span>(h, f, m, g, D, <span class="hljs-number">12</span>, b[<span class="hljs-number">13</span>])<br>              , g = <span class="hljs-title function_">p</span>(g, h, f, m, E, <span class="hljs-number">17</span>, b[<span class="hljs-number">14</span>])<br>              , m = <span class="hljs-title function_">p</span>(m, g, h, f, x, <span class="hljs-number">22</span>, b[<span class="hljs-number">15</span>])<br>              , f = <span class="hljs-title function_">d</span>(f, m, g, h, e, <span class="hljs-number">5</span>, b[<span class="hljs-number">16</span>])<br>              , h = <span class="hljs-title function_">d</span>(h, f, m, g, t, <span class="hljs-number">9</span>, b[<span class="hljs-number">17</span>])<br>              , g = <span class="hljs-title function_">d</span>(g, h, f, m, C, <span class="hljs-number">14</span>, b[<span class="hljs-number">18</span>])<br>              , m = <span class="hljs-title function_">d</span>(m, g, h, f, c, <span class="hljs-number">20</span>, b[<span class="hljs-number">19</span>])<br>              , f = <span class="hljs-title function_">d</span>(f, m, g, h, r, <span class="hljs-number">5</span>, b[<span class="hljs-number">20</span>])<br>              , h = <span class="hljs-title function_">d</span>(h, f, m, g, B, <span class="hljs-number">9</span>, b[<span class="hljs-number">21</span>])<br>              , g = <span class="hljs-title function_">d</span>(g, h, f, m, x, <span class="hljs-number">14</span>, b[<span class="hljs-number">22</span>])<br>              , m = <span class="hljs-title function_">d</span>(m, g, h, f, z, <span class="hljs-number">20</span>, b[<span class="hljs-number">23</span>])<br>              , f = <span class="hljs-title function_">d</span>(f, m, g, h, A, <span class="hljs-number">5</span>, b[<span class="hljs-number">24</span>])<br>              , h = <span class="hljs-title function_">d</span>(h, f, m, g, E, <span class="hljs-number">9</span>, b[<span class="hljs-number">25</span>])<br>              , g = <span class="hljs-title function_">d</span>(g, h, f, m, k, <span class="hljs-number">14</span>, b[<span class="hljs-number">26</span>])<br>              , m = <span class="hljs-title function_">d</span>(m, g, h, f, v, <span class="hljs-number">20</span>, b[<span class="hljs-number">27</span>])<br>              , f = <span class="hljs-title function_">d</span>(f, m, g, h, D, <span class="hljs-number">5</span>, b[<span class="hljs-number">28</span>])<br>              , h = <span class="hljs-title function_">d</span>(h, f, m, g, j, <span class="hljs-number">9</span>, b[<span class="hljs-number">29</span>])<br>              , g = <span class="hljs-title function_">d</span>(g, h, f, m, w, <span class="hljs-number">14</span>, b[<span class="hljs-number">30</span>])<br>              , m = <span class="hljs-title function_">d</span>(m, g, h, f, u, <span class="hljs-number">20</span>, b[<span class="hljs-number">31</span>])<br>              , f = <span class="hljs-title function_">l</span>(f, m, g, h, r, <span class="hljs-number">4</span>, b[<span class="hljs-number">32</span>])<br>              , h = <span class="hljs-title function_">l</span>(h, f, m, g, v, <span class="hljs-number">11</span>, b[<span class="hljs-number">33</span>])<br>              , g = <span class="hljs-title function_">l</span>(g, h, f, m, C, <span class="hljs-number">16</span>, b[<span class="hljs-number">34</span>])<br>              , m = <span class="hljs-title function_">l</span>(m, g, h, f, E, <span class="hljs-number">23</span>, b[<span class="hljs-number">35</span>])<br>              , f = <span class="hljs-title function_">l</span>(f, m, g, h, e, <span class="hljs-number">4</span>, b[<span class="hljs-number">36</span>])<br>              , h = <span class="hljs-title function_">l</span>(h, f, m, g, z, <span class="hljs-number">11</span>, b[<span class="hljs-number">37</span>])<br>              , g = <span class="hljs-title function_">l</span>(g, h, f, m, w, <span class="hljs-number">16</span>, b[<span class="hljs-number">38</span>])<br>              , m = <span class="hljs-title function_">l</span>(m, g, h, f, B, <span class="hljs-number">23</span>, b[<span class="hljs-number">39</span>])<br>              , f = <span class="hljs-title function_">l</span>(f, m, g, h, D, <span class="hljs-number">4</span>, b[<span class="hljs-number">40</span>])<br>              , h = <span class="hljs-title function_">l</span>(h, f, m, g, c, <span class="hljs-number">11</span>, b[<span class="hljs-number">41</span>])<br>              , g = <span class="hljs-title function_">l</span>(g, h, f, m, k, <span class="hljs-number">16</span>, b[<span class="hljs-number">42</span>])<br>              , m = <span class="hljs-title function_">l</span>(m, g, h, f, t, <span class="hljs-number">23</span>, b[<span class="hljs-number">43</span>])<br>              , f = <span class="hljs-title function_">l</span>(f, m, g, h, A, <span class="hljs-number">4</span>, b[<span class="hljs-number">44</span>])<br>              , h = <span class="hljs-title function_">l</span>(h, f, m, g, u, <span class="hljs-number">11</span>, b[<span class="hljs-number">45</span>])<br>              , g = <span class="hljs-title function_">l</span>(g, h, f, m, x, <span class="hljs-number">16</span>, b[<span class="hljs-number">46</span>])<br>              , m = <span class="hljs-title function_">l</span>(m, g, h, f, j, <span class="hljs-number">23</span>, b[<span class="hljs-number">47</span>])<br>              , f = <span class="hljs-title function_">s</span>(f, m, g, h, c, <span class="hljs-number">6</span>, b[<span class="hljs-number">48</span>])<br>              , h = <span class="hljs-title function_">s</span>(h, f, m, g, w, <span class="hljs-number">10</span>, b[<span class="hljs-number">49</span>])<br>              , g = <span class="hljs-title function_">s</span>(g, h, f, m, E, <span class="hljs-number">15</span>, b[<span class="hljs-number">50</span>])<br>              , m = <span class="hljs-title function_">s</span>(m, g, h, f, r, <span class="hljs-number">21</span>, b[<span class="hljs-number">51</span>])<br>              , f = <span class="hljs-title function_">s</span>(f, m, g, h, u, <span class="hljs-number">6</span>, b[<span class="hljs-number">52</span>])<br>              , h = <span class="hljs-title function_">s</span>(h, f, m, g, k, <span class="hljs-number">10</span>, b[<span class="hljs-number">53</span>])<br>              , g = <span class="hljs-title function_">s</span>(g, h, f, m, B, <span class="hljs-number">15</span>, b[<span class="hljs-number">54</span>])<br>              , m = <span class="hljs-title function_">s</span>(m, g, h, f, e, <span class="hljs-number">21</span>, b[<span class="hljs-number">55</span>])<br>              , f = <span class="hljs-title function_">s</span>(f, m, g, h, v, <span class="hljs-number">6</span>, b[<span class="hljs-number">56</span>])<br>              , h = <span class="hljs-title function_">s</span>(h, f, m, g, x, <span class="hljs-number">10</span>, b[<span class="hljs-number">57</span>])<br>              , g = <span class="hljs-title function_">s</span>(g, h, f, m, t, <span class="hljs-number">15</span>, b[<span class="hljs-number">58</span>])<br>              , m = <span class="hljs-title function_">s</span>(m, g, h, f, D, <span class="hljs-number">21</span>, b[<span class="hljs-number">59</span>])<br>              , f = <span class="hljs-title function_">s</span>(f, m, g, h, z, <span class="hljs-number">6</span>, b[<span class="hljs-number">60</span>])<br>              , h = <span class="hljs-title function_">s</span>(h, f, m, g, C, <span class="hljs-number">10</span>, b[<span class="hljs-number">61</span>])<br>              , g = <span class="hljs-title function_">s</span>(g, h, f, m, j, <span class="hljs-number">15</span>, b[<span class="hljs-number">62</span>])<br>              , m = <span class="hljs-title function_">s</span>(m, g, h, f, A, <span class="hljs-number">21</span>, b[<span class="hljs-number">63</span>]);<br>            a[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] + f | <span class="hljs-number">0</span>;<br>            a[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] + m | <span class="hljs-number">0</span>;<br>            a[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] + g | <span class="hljs-number">0</span>;<br>            a[<span class="hljs-number">3</span>] = a[<span class="hljs-number">3</span>] + h | <span class="hljs-number">0</span><br>        &#125;,<br>        <span class="hljs-attr">_doFinalize</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span><br>              , n = b.<span class="hljs-property">words</span><br>              , a = <span class="hljs-number">8</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nDataBytes</span><br>              , c = <span class="hljs-number">8</span> * b.<span class="hljs-property">sigBytes</span>;<br>            n[c &gt;&gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">128</span> &lt;&lt; <span class="hljs-number">24</span> - c % <span class="hljs-number">32</span>;<br>            <span class="hljs-keyword">var</span> e = u.<span class="hljs-title function_">floor</span>(a / <span class="hljs-number">4294967296</span>);<br>            n[(c + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">15</span>] = (e &lt;&lt; <span class="hljs-number">8</span> | e &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">16711935</span> | (e &lt;&lt; <span class="hljs-number">24</span> | e &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">4278255360</span>;<br>            n[(c + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">14</span>] = (a &lt;&lt; <span class="hljs-number">8</span> | a &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">16711935</span> | (a &lt;&lt; <span class="hljs-number">24</span> | a &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">4278255360</span>;<br>            b.<span class="hljs-property">sigBytes</span> = <span class="hljs-number">4</span> * (n.<span class="hljs-property">length</span> + <span class="hljs-number">1</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>();<br>            b = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hash</span>;<br>            n = b.<span class="hljs-property">words</span>;<br>            <span class="hljs-keyword">for</span> (a = <span class="hljs-number">0</span>; <span class="hljs-number">4</span> &gt; a; a++)<br>                c = n[a],<br>                n[a] = (c &lt;&lt; <span class="hljs-number">8</span> | c &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">16711935</span> | (c &lt;&lt; <span class="hljs-number">24</span> | c &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">4278255360</span>;<br>            <span class="hljs-keyword">return</span> b<br>        &#125;,<br>        <span class="hljs-attr">clone</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> b = v.<span class="hljs-property">clone</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            b.<span class="hljs-property">_hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_hash</span>.<span class="hljs-title function_">clone</span>();<br>            <span class="hljs-keyword">return</span> b<br>        &#125;<br>    &#125;);<br>    t.<span class="hljs-property">MD5</span> = v.<span class="hljs-title function_">_createHelper</span>(r);<br>    t.<span class="hljs-property">HmacMD5</span> = v.<span class="hljs-title function_">_createHmacHelper</span>(r)<br>&#125;<br>)(<span class="hljs-title class_">Math</span>);<br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> u = <span class="hljs-title class_">CryptoJS</span><br>      , p = u.<span class="hljs-property">lib</span><br>      , d = p.<span class="hljs-property">Base</span><br>      , l = p.<span class="hljs-property">WordArray</span><br>      , p = u.<span class="hljs-property">algo</span><br>      , s = p.<span class="hljs-property">EvpKDF</span> = d.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: d.<span class="hljs-title function_">extend</span>(&#123;<br>            <span class="hljs-attr">keySize</span>: <span class="hljs-number">4</span>,<br>            <span class="hljs-attr">hasher</span>: p.<span class="hljs-property">MD5</span>,<br>            <span class="hljs-attr">iterations</span>: <span class="hljs-number">1</span><br>        &#125;),<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(d)<br>        &#125;,<br>        <span class="hljs-attr">compute</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">d, r</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>, s = p.<span class="hljs-property">hasher</span>.<span class="hljs-title function_">create</span>(), b = l.<span class="hljs-title function_">create</span>(), u = b.<span class="hljs-property">words</span>, q = p.<span class="hljs-property">keySize</span>, p = p.<span class="hljs-property">iterations</span>; u.<span class="hljs-property">length</span> &lt; q; ) &#123;<br>                n &amp;&amp; s.<span class="hljs-title function_">update</span>(n);<br>                <span class="hljs-keyword">var</span> n = s.<span class="hljs-title function_">update</span>(d).<span class="hljs-title function_">finalize</span>(r);<br>                s.<span class="hljs-title function_">reset</span>();<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; a &lt; p; a++)<br>                    n = s.<span class="hljs-title function_">finalize</span>(n),<br>                    s.<span class="hljs-title function_">reset</span>();<br>                b.<span class="hljs-title function_">concat</span>(n)<br>            &#125;<br>            b.<span class="hljs-property">sigBytes</span> = <span class="hljs-number">4</span> * q;<br>            <span class="hljs-keyword">return</span> b<br>        &#125;<br>    &#125;);<br>    u.<span class="hljs-property">EvpKDF</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">d, l, p</span>) &#123;<br>        <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">create</span>(p).<span class="hljs-title function_">compute</span>(d, l)<br>    &#125;<br>&#125;<br>)();<br><span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">lib</span>.<span class="hljs-property">Cipher</span> || <span class="hljs-keyword">function</span>(<span class="hljs-params">u</span>) &#123;<br>    <span class="hljs-keyword">var</span> p = <span class="hljs-title class_">CryptoJS</span><br>      , d = p.<span class="hljs-property">lib</span><br>      , l = d.<span class="hljs-property">Base</span><br>      , s = d.<span class="hljs-property">WordArray</span><br>      , t = d.<span class="hljs-property">BufferedBlockAlgorithm</span><br>      , r = p.<span class="hljs-property">enc</span>.<span class="hljs-property">Base64</span><br>      , w = p.<span class="hljs-property">algo</span>.<span class="hljs-property">EvpKDF</span><br>      , v = d.<span class="hljs-property">Cipher</span> = t.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: l.<span class="hljs-title function_">extend</span>(),<br>        <span class="hljs-attr">createEncryptor</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">create</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_ENC_XFORM_MODE</span>, e, a)<br>        &#125;,<br>        <span class="hljs-attr">createDecryptor</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">create</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_DEC_XFORM_MODE</span>, e, a)<br>        &#125;,<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a, b</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(b);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_xformMode</span> = e;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_key</span> = a;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reset</span>()<br>        &#125;,<br>        <span class="hljs-attr">reset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            t.<span class="hljs-property">reset</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doReset</span>()<br>        &#125;,<br>        <span class="hljs-attr">process</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_append</span>(e);<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>()<br>        &#125;,<br>        <span class="hljs-attr">finalize</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            e &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_append</span>(e);<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doFinalize</span>()<br>        &#125;,<br>        <span class="hljs-attr">keySize</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-attr">ivSize</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-attr">_ENC_XFORM_MODE</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">_DEC_XFORM_MODE</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">_createHelper</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">encrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">b, k, d</span>) &#123;<br>                    <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> k ? c : a).<span class="hljs-title function_">encrypt</span>(e, b, k, d)<br>                &#125;,<br>                <span class="hljs-attr">decrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">b, k, d</span>) &#123;<br>                    <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> k ? c : a).<span class="hljs-title function_">decrypt</span>(e, b, k, d)<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;);<br>    d.<span class="hljs-property">StreamCipher</span> = v.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">_doFinalize</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>(!<span class="hljs-number">0</span>)<br>        &#125;,<br>        <span class="hljs-attr">blockSize</span>: <span class="hljs-number">1</span><br>    &#125;);<br>    <span class="hljs-keyword">var</span> b = p.<span class="hljs-property">mode</span> = &#123;&#125;<br>      , x = <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a, b</span>) &#123;<br>        <span class="hljs-keyword">var</span> c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_iv</span>;<br>        c ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">_iv</span> = u : c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevBlock</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = <span class="hljs-number">0</span>; d &lt; b; d++)<br>            e[a + d] ^= c[d]<br>    &#125;<br>      , q = (d.<span class="hljs-property">BlockCipherMode</span> = l.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">createEncryptor</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">Encryptor</span>.<span class="hljs-title function_">create</span>(e, a)<br>        &#125;,<br>        <span class="hljs-attr">createDecryptor</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">Decryptor</span>.<span class="hljs-title function_">create</span>(e, a)<br>        &#125;,<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cipher</span> = e;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_iv</span> = a<br>        &#125;<br>    &#125;)).<span class="hljs-title function_">extend</span>();<br>    q.<span class="hljs-property">Encryptor</span> = q.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">processBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cipher</span><br>              , c = b.<span class="hljs-property">blockSize</span>;<br>            x.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, e, a, c);<br>            b.<span class="hljs-title function_">encryptBlock</span>(e, a);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevBlock</span> = e.<span class="hljs-title function_">slice</span>(a, a + c)<br>        &#125;<br>    &#125;);<br>    q.<span class="hljs-property">Decryptor</span> = q.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">processBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">e, a</span>) &#123;<br>            <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cipher</span><br>              , c = b.<span class="hljs-property">blockSize</span><br>              , d = e.<span class="hljs-title function_">slice</span>(a, a + c);<br>            b.<span class="hljs-title function_">decryptBlock</span>(e, a);<br>            x.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, e, a, c);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevBlock</span> = d<br>        &#125;<br>    &#125;);<br>    b = b.<span class="hljs-property">CBC</span> = q;<br>    q = (p.<span class="hljs-property">pad</span> = &#123;&#125;).<span class="hljs-property">Pkcs7</span> = &#123;<br>        <span class="hljs-attr">pad</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">4</span> * b, c = c - a.<span class="hljs-property">sigBytes</span> % c, d = c &lt;&lt; <span class="hljs-number">24</span> | c &lt;&lt; <span class="hljs-number">16</span> | c &lt;&lt; <span class="hljs-number">8</span> | c, l = [], n = <span class="hljs-number">0</span>; n &lt; c; n += <span class="hljs-number">4</span>)<br>                l.<span class="hljs-title function_">push</span>(d);<br>            c = s.<span class="hljs-title function_">create</span>(l, c);<br>            a.<span class="hljs-title function_">concat</span>(c)<br>        &#125;,<br>        <span class="hljs-attr">unpad</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            a.<span class="hljs-property">sigBytes</span> -= a.<span class="hljs-property">words</span>[a.<span class="hljs-property">sigBytes</span> - <span class="hljs-number">1</span> &gt;&gt;&gt; <span class="hljs-number">2</span>] &amp; <span class="hljs-number">255</span><br>        &#125;<br>    &#125;;<br>    d.<span class="hljs-property">BlockCipher</span> = v.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: v.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(&#123;<br>            <span class="hljs-attr">mode</span>: b,<br>            <span class="hljs-attr">padding</span>: q<br>        &#125;),<br>        <span class="hljs-attr">reset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            v.<span class="hljs-property">reset</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span><br>              , b = a.<span class="hljs-property">iv</span><br>              , a = a.<span class="hljs-property">mode</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_xformMode</span> == <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ENC_XFORM_MODE</span>)<br>                <span class="hljs-keyword">var</span> c = a.<span class="hljs-property">createEncryptor</span>;<br>            <span class="hljs-keyword">else</span><br>                c = a.<span class="hljs-property">createDecryptor</span>,<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_minBufferSize</span> = <span class="hljs-number">1</span>;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_mode</span> = c.<span class="hljs-title function_">call</span>(a, <span class="hljs-variable language_">this</span>, b &amp;&amp; b.<span class="hljs-property">words</span>)<br>        &#125;,<br>        <span class="hljs-attr">_doProcessBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_mode</span>.<span class="hljs-title function_">processBlock</span>(a, b)<br>        &#125;,<br>        <span class="hljs-attr">_doFinalize</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-property">padding</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_xformMode</span> == <span class="hljs-variable language_">this</span>.<span class="hljs-property">_ENC_XFORM_MODE</span>) &#123;<br>                a.<span class="hljs-title function_">pad</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">blockSize</span>);<br>                <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>(!<span class="hljs-number">0</span>)<br>            &#125; <span class="hljs-keyword">else</span><br>                b = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_process</span>(!<span class="hljs-number">0</span>),<br>                a.<span class="hljs-title function_">unpad</span>(b);<br>            <span class="hljs-keyword">return</span> b<br>        &#125;,<br>        <span class="hljs-attr">blockSize</span>: <span class="hljs-number">4</span><br>    &#125;);<br>    <span class="hljs-keyword">var</span> n = d.<span class="hljs-property">CipherParams</span> = l.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mixIn</span>(a)<br>        &#125;,<br>        <span class="hljs-attr">toString</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">return</span> (a || <span class="hljs-variable language_">this</span>.<span class="hljs-property">formatter</span>).<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>)<br>        &#125;<br>    &#125;)<br>      , b = (p.<span class="hljs-property">format</span> = &#123;&#125;).<span class="hljs-property">OpenSSL</span> = &#123;<br>        <span class="hljs-attr">stringify</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            <span class="hljs-keyword">var</span> b = a.<span class="hljs-property">ciphertext</span>;<br>            a = a.<span class="hljs-property">salt</span>;<br>            <span class="hljs-keyword">return</span> (a ? s.<span class="hljs-title function_">create</span>([<span class="hljs-number">1398893684</span>, <span class="hljs-number">1701076831</span>]).<span class="hljs-title function_">concat</span>(a).<span class="hljs-title function_">concat</span>(b) : b).<span class="hljs-title function_">toString</span>(r)<br>        &#125;,<br>        <span class="hljs-attr">parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) &#123;<br>            a = r.<span class="hljs-title function_">parse</span>(a);<br>            <span class="hljs-keyword">var</span> b = a.<span class="hljs-property">words</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-number">1398893684</span> == b[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-number">1701076831</span> == b[<span class="hljs-number">1</span>]) &#123;<br>                <span class="hljs-keyword">var</span> c = s.<span class="hljs-title function_">create</span>(b.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>));<br>                b.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>);<br>                a.<span class="hljs-property">sigBytes</span> -= <span class="hljs-number">16</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> n.<span class="hljs-title function_">create</span>(&#123;<br>                <span class="hljs-attr">ciphertext</span>: a,<br>                <span class="hljs-attr">salt</span>: c<br>            &#125;)<br>        &#125;<br>    &#125;<br>      , a = d.<span class="hljs-property">SerializableCipher</span> = l.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: l.<span class="hljs-title function_">extend</span>(&#123;<br>            <span class="hljs-attr">format</span>: b<br>        &#125;),<br>        <span class="hljs-attr">encrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c, d</span>) &#123;<br>            d = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(d);<br>            <span class="hljs-keyword">var</span> l = a.<span class="hljs-title function_">createEncryptor</span>(c, d);<br>            b = l.<span class="hljs-title function_">finalize</span>(b);<br>            l = l.<span class="hljs-property">cfg</span>;<br>            <span class="hljs-keyword">return</span> n.<span class="hljs-title function_">create</span>(&#123;<br>                <span class="hljs-attr">ciphertext</span>: b,<br>                <span class="hljs-attr">key</span>: c,<br>                <span class="hljs-attr">iv</span>: l.<span class="hljs-property">iv</span>,<br>                <span class="hljs-attr">algorithm</span>: a,<br>                <span class="hljs-attr">mode</span>: l.<span class="hljs-property">mode</span>,<br>                <span class="hljs-attr">padding</span>: l.<span class="hljs-property">padding</span>,<br>                <span class="hljs-attr">blockSize</span>: a.<span class="hljs-property">blockSize</span>,<br>                <span class="hljs-attr">formatter</span>: d.<span class="hljs-property">format</span><br>            &#125;)<br>        &#125;,<br>        <span class="hljs-attr">decrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c, d</span>) &#123;<br>            d = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(d);<br>            b = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parse</span>(b, d.<span class="hljs-property">format</span>);<br>            <span class="hljs-keyword">return</span> a.<span class="hljs-title function_">createDecryptor</span>(c, d).<span class="hljs-title function_">finalize</span>(b.<span class="hljs-property">ciphertext</span>)<br>        &#125;,<br>        <span class="hljs-attr">_parse</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;string&quot;</span> == <span class="hljs-keyword">typeof</span> a ? b.<span class="hljs-title function_">parse</span>(a, <span class="hljs-variable language_">this</span>) : a<br>        &#125;<br>    &#125;)<br>      , p = (p.<span class="hljs-property">kdf</span> = &#123;&#125;).<span class="hljs-property">OpenSSL</span> = &#123;<br>        <span class="hljs-attr">execute</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c, d</span>) &#123;<br>            d || (d = s.<span class="hljs-title function_">random</span>(<span class="hljs-number">8</span>));<br>            a = w.<span class="hljs-title function_">create</span>(&#123;<br>                <span class="hljs-attr">keySize</span>: b + c<br>            &#125;).<span class="hljs-title function_">compute</span>(a, d);<br>            c = s.<span class="hljs-title function_">create</span>(a.<span class="hljs-property">words</span>.<span class="hljs-title function_">slice</span>(b), <span class="hljs-number">4</span> * c);<br>            a.<span class="hljs-property">sigBytes</span> = <span class="hljs-number">4</span> * b;<br>            <span class="hljs-keyword">return</span> n.<span class="hljs-title function_">create</span>(&#123;<br>                <span class="hljs-attr">key</span>: a,<br>                <span class="hljs-attr">iv</span>: c,<br>                <span class="hljs-attr">salt</span>: d<br>            &#125;)<br>        &#125;<br>    &#125;<br>      , c = d.<span class="hljs-property">PasswordBasedCipher</span> = a.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">cfg</span>: a.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(&#123;<br>            <span class="hljs-attr">kdf</span>: p<br>        &#125;),<br>        <span class="hljs-attr">encrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, d, l</span>) &#123;<br>            l = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(l);<br>            d = l.<span class="hljs-property">kdf</span>.<span class="hljs-title function_">execute</span>(d, b.<span class="hljs-property">keySize</span>, b.<span class="hljs-property">ivSize</span>);<br>            l.<span class="hljs-property">iv</span> = d.<span class="hljs-property">iv</span>;<br>            b = a.<span class="hljs-property">encrypt</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, b, c, d.<span class="hljs-property">key</span>, l);<br>            b.<span class="hljs-title function_">mixIn</span>(d);<br>            <span class="hljs-keyword">return</span> b<br>        &#125;,<br>        <span class="hljs-attr">decrypt</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">b, c, d, l</span>) &#123;<br>            l = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cfg</span>.<span class="hljs-title function_">extend</span>(l);<br>            c = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parse</span>(c, l.<span class="hljs-property">format</span>);<br>            d = l.<span class="hljs-property">kdf</span>.<span class="hljs-title function_">execute</span>(d, b.<span class="hljs-property">keySize</span>, b.<span class="hljs-property">ivSize</span>, c.<span class="hljs-property">salt</span>);<br>            l.<span class="hljs-property">iv</span> = d.<span class="hljs-property">iv</span>;<br>            <span class="hljs-keyword">return</span> a.<span class="hljs-property">decrypt</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, b, c, d.<span class="hljs-property">key</span>, l)<br>        &#125;<br>    &#125;)<br>&#125;();<br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> u = <span class="hljs-title class_">CryptoJS</span>, p = u.<span class="hljs-property">lib</span>.<span class="hljs-property">BlockCipher</span>, d = u.<span class="hljs-property">algo</span>, l = [], s = [], t = [], r = [], w = [], v = [], b = [], x = [], q = [], n = [], a = [], c = <span class="hljs-number">0</span>; <span class="hljs-number">256</span> &gt; c; c++)<br>        a[c] = <span class="hljs-number">128</span> &gt; c ? c &lt;&lt; <span class="hljs-number">1</span> : c &lt;&lt; <span class="hljs-number">1</span> ^ <span class="hljs-number">283</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, c = <span class="hljs-number">0</span>; <span class="hljs-number">256</span> &gt; c; c++) &#123;<br>        <span class="hljs-keyword">var</span> k = j ^ j &lt;&lt; <span class="hljs-number">1</span> ^ j &lt;&lt; <span class="hljs-number">2</span> ^ j &lt;&lt; <span class="hljs-number">3</span> ^ j &lt;&lt; <span class="hljs-number">4</span><br>          , k = k &gt;&gt;&gt; <span class="hljs-number">8</span> ^ k &amp; <span class="hljs-number">255</span> ^ <span class="hljs-number">99</span>;<br>        l[e] = k;<br>        s[k] = e;<br>        <span class="hljs-keyword">var</span> z = a[e]<br>          , F = a[z]<br>          , G = a[F]<br>          , y = <span class="hljs-number">257</span> * a[k] ^ <span class="hljs-number">16843008</span> * k;<br>        t[e] = y &lt;&lt; <span class="hljs-number">24</span> | y &gt;&gt;&gt; <span class="hljs-number">8</span>;<br>        r[e] = y &lt;&lt; <span class="hljs-number">16</span> | y &gt;&gt;&gt; <span class="hljs-number">16</span>;<br>        w[e] = y &lt;&lt; <span class="hljs-number">8</span> | y &gt;&gt;&gt; <span class="hljs-number">24</span>;<br>        v[e] = y;<br>        y = <span class="hljs-number">16843009</span> * G ^ <span class="hljs-number">65537</span> * F ^ <span class="hljs-number">257</span> * z ^ <span class="hljs-number">16843008</span> * e;<br>        b[k] = y &lt;&lt; <span class="hljs-number">24</span> | y &gt;&gt;&gt; <span class="hljs-number">8</span>;<br>        x[k] = y &lt;&lt; <span class="hljs-number">16</span> | y &gt;&gt;&gt; <span class="hljs-number">16</span>;<br>        q[k] = y &lt;&lt; <span class="hljs-number">8</span> | y &gt;&gt;&gt; <span class="hljs-number">24</span>;<br>        n[k] = y;<br>        e ? (e = z ^ a[a[a[G ^ z]]],<br>        j ^= a[a[j]]) : e = j = <span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">var</span> H = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">16</span>, <span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">128</span>, <span class="hljs-number">27</span>, <span class="hljs-number">54</span>]<br>      , d = d.<span class="hljs-property">AES</span> = p.<span class="hljs-title function_">extend</span>(&#123;<br>        <span class="hljs-attr">_doReset</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_key</span>, c = a.<span class="hljs-property">words</span>, d = a.<span class="hljs-property">sigBytes</span> / <span class="hljs-number">4</span>, a = <span class="hljs-number">4</span> * ((<span class="hljs-variable language_">this</span>.<span class="hljs-property">_nRounds</span> = d + <span class="hljs-number">6</span>) + <span class="hljs-number">1</span>), e = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_keySchedule</span> = [], j = <span class="hljs-number">0</span>; j &lt; a; j++)<br>                <span class="hljs-keyword">if</span> (j &lt; d)<br>                    e[j] = c[j];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">var</span> k = e[j - <span class="hljs-number">1</span>];<br>                    j % d ? <span class="hljs-number">6</span> &lt; d &amp;&amp; <span class="hljs-number">4</span> == j % d &amp;&amp; (k = l[k &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | l[k &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | l[k &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | l[k &amp; <span class="hljs-number">255</span>]) : (k = k &lt;&lt; <span class="hljs-number">8</span> | k &gt;&gt;&gt; <span class="hljs-number">24</span>,<br>                    k = l[k &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | l[k &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | l[k &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | l[k &amp; <span class="hljs-number">255</span>],<br>                    k ^= H[j / d | <span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>                    e[j] = e[j - d] ^ k<br>                &#125;<br>            c = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_invKeySchedule</span> = [];<br>            <span class="hljs-keyword">for</span> (d = <span class="hljs-number">0</span>; d &lt; a; d++)<br>                j = a - d,<br>                k = d % <span class="hljs-number">4</span> ? e[j] : e[j - <span class="hljs-number">4</span>],<br>                c[d] = <span class="hljs-number">4</span> &gt; d || <span class="hljs-number">4</span> &gt;= j ? k : b[l[k &gt;&gt;&gt; <span class="hljs-number">24</span>]] ^ x[l[k &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>]] ^ q[l[k &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>]] ^ n[l[k &amp; <span class="hljs-number">255</span>]]<br>        &#125;,<br>        <span class="hljs-attr">encryptBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doCryptBlock</span>(a, b, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_keySchedule</span>, t, r, w, v, l)<br>        &#125;,<br>        <span class="hljs-attr">decryptBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, c</span>) &#123;<br>            <span class="hljs-keyword">var</span> d = a[c + <span class="hljs-number">1</span>];<br>            a[c + <span class="hljs-number">1</span>] = a[c + <span class="hljs-number">3</span>];<br>            a[c + <span class="hljs-number">3</span>] = d;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_doCryptBlock</span>(a, c, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_invKeySchedule</span>, b, x, q, n, s);<br>            d = a[c + <span class="hljs-number">1</span>];<br>            a[c + <span class="hljs-number">1</span>] = a[c + <span class="hljs-number">3</span>];<br>            a[c + <span class="hljs-number">3</span>] = d<br>        &#125;,<br>        <span class="hljs-attr">_doCryptBlock</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c, d, e, j, l, f</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> m = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nRounds</span>, g = a[b] ^ c[<span class="hljs-number">0</span>], h = a[b + <span class="hljs-number">1</span>] ^ c[<span class="hljs-number">1</span>], k = a[b + <span class="hljs-number">2</span>] ^ c[<span class="hljs-number">2</span>], n = a[b + <span class="hljs-number">3</span>] ^ c[<span class="hljs-number">3</span>], p = <span class="hljs-number">4</span>, r = <span class="hljs-number">1</span>; r &lt; m; r++)<br>                <span class="hljs-keyword">var</span> q = d[g &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ e[h &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] ^ j[k &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] ^ l[n &amp; <span class="hljs-number">255</span>] ^ c[p++]<br>                  , s = d[h &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ e[k &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] ^ j[n &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] ^ l[g &amp; <span class="hljs-number">255</span>] ^ c[p++]<br>                  , t = d[k &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ e[n &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] ^ j[g &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] ^ l[h &amp; <span class="hljs-number">255</span>] ^ c[p++]<br>                  , n = d[n &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ e[g &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] ^ j[h &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] ^ l[k &amp; <span class="hljs-number">255</span>] ^ c[p++]<br>                  , g = q<br>                  , h = s<br>                  , k = t;<br>            q = (f[g &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | f[h &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | f[k &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | f[n &amp; <span class="hljs-number">255</span>]) ^ c[p++];<br>            s = (f[h &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | f[k &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | f[n &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | f[g &amp; <span class="hljs-number">255</span>]) ^ c[p++];<br>            t = (f[k &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | f[n &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | f[g &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | f[h &amp; <span class="hljs-number">255</span>]) ^ c[p++];<br>            n = (f[n &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span> | f[g &gt;&gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">16</span> | f[h &gt;&gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>] &lt;&lt; <span class="hljs-number">8</span> | f[k &amp; <span class="hljs-number">255</span>]) ^ c[p++];<br>            a[b] = q;<br>            a[b + <span class="hljs-number">1</span>] = s;<br>            a[b + <span class="hljs-number">2</span>] = t;<br>            a[b + <span class="hljs-number">3</span>] = n<br>        &#125;,<br>        <span class="hljs-attr">keySize</span>: <span class="hljs-number">8</span><br>    &#125;);<br>    u.<span class="hljs-property">AES</span> = p.<span class="hljs-title function_">_createHelper</span>(d)<br>&#125;<br>)();<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">toHexString</span>(<span class="hljs-params">str</span>) &#123;<br>    <span class="hljs-keyword">var</span> temp = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-property">length</span>; i++) &#123;<br>        temp += str.<span class="hljs-title function_">charCodeAt</span>(i).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> temp<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">encodeType</span>) &#123;<br>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">&quot;D7B2A207E58708332042ECF61DA0641E&quot;</span>;<br>    <span class="hljs-keyword">if</span> (encodeType == <span class="hljs-literal">null</span> || encodeType == <span class="hljs-string">&#x27;aes&#x27;</span>) &#123;<br>        <span class="hljs-keyword">if</span> (str.<span class="hljs-property">length</span> &lt; <span class="hljs-number">32</span>) &#123;<br>            str += <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz1234567890&quot;</span><br>        &#125;<br>        str = str.<span class="hljs-title function_">toUpperCase</span>();<br>        <span class="hljs-keyword">var</span> key = &#123;&#125;;<br>        key.<span class="hljs-property">key</span> = str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>);<br>        key.<span class="hljs-property">iv</span> = str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">16</span>, <span class="hljs-number">32</span>);<br>        key.<span class="hljs-property">security</span> = <span class="hljs-string">&quot;\u4435\u5320\u4d35&quot;</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (str.<span class="hljs-property">length</span> &lt; <span class="hljs-number">16</span>) &#123;<br>            str += <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><br>        &#125;<br>        str = str.<span class="hljs-title function_">toUpperCase</span>();<br>        <span class="hljs-keyword">var</span> key = &#123;&#125;;<br>        key.<span class="hljs-property">key</span> = <span class="hljs-title function_">toHexString</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>));<br>        key.<span class="hljs-property">iv</span> = <span class="hljs-title function_">toHexString</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">8</span>, <span class="hljs-number">16</span>));<br>        key.<span class="hljs-property">security</span> = <span class="hljs-string">&quot;\u4445\u5320\u4d45&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> key<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">desEncrypt</span>(<span class="hljs-params">value</span>) &#123;<br>    keyObj = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;des&#x27;</span>);<br>    value = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(value, <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>.<span class="hljs-title function_">parse</span>(keyObj.<span class="hljs-property">key</span>), &#123;<span class="hljs-attr">iv</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>.<span class="hljs-title function_">parse</span>(keyObj.<span class="hljs-property">iv</span>)&#125;)<br>    <span class="hljs-keyword">return</span> keyObj.<span class="hljs-property">security</span> + value<br><br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">desEncrypt</span>(<span class="hljs-string">&quot;123456&quot;</span>))<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DES </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
