<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>极验滑块验证三个W超详细解密(2) | Spider Blog</title><meta name="author" content="LLi"><meta name="copyright" content="LLi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="书接上文 第二个w获取流程 第二个w也可以不用去获取，因为第二个w不涉及到验证码的获取和验证，至少现在还没有  点击验证码，获取到如下包，一个 ajax.php 和 get.php  4.第四个请求，携带解密后的w,用于识别验证码是否加载成功 接口地址：https:&#x2F;&#x2F;api.geetest.com&#x2F;ajax.php    第二个w解密流程第二个w要找到加密位置，需要看html页面，他是通过动态加">
<meta property="og:type" content="article">
<meta property="og:title" content="极验滑块验证三个W超详细解密(2)">
<meta property="og:url" content="http://example.com/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/index.html">
<meta property="og:site_name" content="Spider Blog">
<meta property="og:description" content="书接上文 第二个w获取流程 第二个w也可以不用去获取，因为第二个w不涉及到验证码的获取和验证，至少现在还没有  点击验证码，获取到如下包，一个 ajax.php 和 get.php  4.第四个请求，携带解密后的w,用于识别验证码是否加载成功 接口地址：https:&#x2F;&#x2F;api.geetest.com&#x2F;ajax.php    第二个w解密流程第二个w要找到加密位置，需要看html页面，他是通过动态加">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/image-20230527114721325.png">
<meta property="article:published_time" content="2023-03-05T13:06:05.000Z">
<meta property="article:modified_time" content="2024-05-24T10:43:21.225Z">
<meta property="article:author" content="LLi">
<meta property="article:tag" content="验证码">
<meta property="article:tag" content="极验">
<meta property="article:tag" content="滑块">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/image-20230527114721325.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '极验滑块验证三个W超详细解密(2)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-24 18:43:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/static/css/custom.css"><link rel="stylesheet" href="/static/css/footer.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Spider Blog"><span class="site-name">Spider Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">极验滑块验证三个W超详细解密(2)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2023-03-05T13:06:05.000Z" title="发表于 2023-03-05 21:06:05">2023-03-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/js%E9%80%86%E5%90%91/">js逆向</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="极验滑块验证三个W超详细解密(2)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p><strong>书接上文</strong></p>
<h3 id="第二个w获取流程"><a href="#第二个w获取流程" class="headerlink" title="第二个w获取流程"></a>第二个w获取流程</h3><blockquote>
<p>第二个w也可以不用去获取，因为第二个w不涉及到验证码的获取和验证，至少现在还没有</p>
</blockquote>
<p>点击验证码，获取到如下包，一个 ajax.php 和 get.php</p>
<p><img src="/images/image-20230527114721325.png" alt="image-20230527114721325"></p>
<h4 id="4-第四个请求，携带解密后的w-用于识别验证码是否加载成功"><a href="#4-第四个请求，携带解密后的w-用于识别验证码是否加载成功" class="headerlink" title="4.第四个请求，携带解密后的w,用于识别验证码是否加载成功"></a>4.第四个请求，携带解密后的w,用于识别验证码是否加载成功</h4><blockquote>
<p>接口地址：<a target="_blank" rel="noopener" href="https://api.geetest.com/ajax.php">https://api.geetest.com/ajax.php</a></p>
</blockquote>
<p><img src="/images/image-20230527115052238.png" alt="image-20230527115052238"></p>
<p><img src="/images/image-20230527115101034.png" alt="image-20230527115101034"></p>
<h3 id="第二个w解密流程"><a href="#第二个w解密流程" class="headerlink" title="第二个w解密流程"></a>第二个w解密流程</h3><p>第二个w要找到加密位置，需要看html页面，他是通过动态加载script标签，然后通过加载js来完成加密</p>
<p><img src="/images/image-20230527205716028.png" alt="image-20230527205716028"></p>
<p>打上断点，刷新页面,通过观察加载德script标签，发现并不是我们需要的请求，所以直接过掉</p>
<p><img src="/images/image-20230527205824553.png" alt="image-20230527205824553"></p>
<p><img src="/images/image-20230527210024419.png" alt="image-20230527210024419"></p>
<p>过掉所有断点后，我们再点击按钮，将验证码加载出来,这一次断点再次打上，通过观察会发现是我们要请求的接口，然后我们向上追栈</p>
<p><img src="/images/image-20230527210334696.png" alt="image-20230527210334696"></p>
<p>向上追一个栈，我们来到这个函数,我们分析一下 <code>[$_HCDk(340)]</code> 就是调用最上面的那个方法， 他传入了一个new le(f)，</p>
<p><img src="/images/image-20230527211333882.png" alt="image-20230527211333882"></p>
<p><img src="/images/image-20230527211503385.png" alt="image-20230527211503385"></p>
<p>往上面看,这里创建了几个参数，其中n已经包含了src，也就是在这里已经完成了w的加密，我们在上面打一下断点，看一下n在这里做了什么</p>
<p><img src="/images/image-20230527212047263.png" alt="image-20230527212047263"></p>
<p>在n下面重新打上断点后，进来发现n里面的script标签里面并没有src属性,第二步将n里面的script标签传给了r，再往下一步，发现是对s进行正则操作，我们看下s是什么,发现s就是我们想要的src,接下来 我们要找到这个s是怎么生成的了</p>
<p><img src="/images/image-20230527212445650.png" alt="image-20230527212445650"></p>
<p><img src="/images/image-20230527212626434.png" alt="image-20230527212626434"></p>
<p><img src="/images/image-20230527212847127.png" alt="image-20230527212847127"></p>
<p><img src="/images/image-20230527212939133.png" alt="image-20230527212939133"></p>
<p>我们在往上看，会发现s是传入进来的，我们也可以在这里打断点看一下是否是传进来就已经加密好，还是就是在这里加密的,经过测试会发现是传进来就加密好了，所以我们要去找是谁调用了这个函数，传入的第一个参数是什么，同样进行追栈</p>
<p><img src="/images/image-20230527213253183.png" alt="image-20230527213253183"></p>
<p><img src="/images/image-20230527213402609.png" alt="image-20230527213402609"></p>
<p>往上追一个栈之后来到这里,同样的，验证一下，发现n在进去函数c之前就已经完成了加密，所以我们追函数C的栈</p>
<p><img src="/../../../../imgs/image-20230527214330057.png" alt="image-20230527214330057"></p>
<p>就在下面，进来之后我们会发现i参数里面包含了该接口请求的所有参数包括加密的w参数，所以我们得去找一下i的来源,再往上看，D函数传入的参数包含i,同样的验证一下是否是传进来就加密好了</p>
<p><img src="/images/image-20230527214605844.png" alt="image-20230527214605844"></p>
<p><img src="/images/image-20230527214925324.png" alt="image-20230527214925324"></p>
<p>答案显而易见，我们再次追栈</p>
<p><img src="/images/image-20230527215036178.png" alt="image-20230527215036178"></p>
<p>来到上一个函数,继续验证,验证结果，继续朔源</p>
<p><img src="/images/image-20230527215519876.png" alt="image-20230527215519876"></p>
<p><img src="/images/image-20230527215612277.png" alt="image-20230527215612277"></p>
<p>发现还是传进来的，继续验证,验证完成，继续朔源</p>
<p><img src="/images/image-20230527215722044.png" alt="image-20230527215722044"></p>
<p><img src="/images/image-20230527215743104.png" alt="image-20230527215743104"></p>
<p><img src="/images/image-20230527215828871.png" alt="image-20230527215828871"></p>
<p>断点来到N的上面，我们会发现n在这里进行了组装</p>
<p><img src="/images/image-20230527221231133.png" alt="image-20230527221231133"></p>
<p><img src="/images/image-20230527221345196.png" alt="image-20230527221345196"></p>
<p>我们再看一下这个代码,t是this,而t[xxx(1481)] 等于我们想要的w,xxx(1481)肯定是做了混淆，但是可以肯定的是，在某一段代码里面肯定执行了，xxx(1481) &#x3D; w 的操作，xxx我们搜不到做了混淆，但是1481应该是可以搜索得到的</p>
<p><img src="/images/image-20230527221811251.png" alt="image-20230527221811251"></p>
<p>这里一共就三个，去掉本身那个，还有一个是一串数字，剩下的就只有这个符合我们的要求了，我们在这里打上断点。会发现 i[xxxx] &#x3D; w ，而i在上面, i就是this，而我们要完成的就是 <code>p[$_CGBDY(1303)](_[$_CGBDY(12)](r, i[$_CGBDY(1361)]()))</code> 的解密 </p>
<p><img src="/images/image-20230527222112657.png" alt="image-20230527222112657"></p>
<p><img src="/images/image-20230527222241640.png" alt="image-20230527222241640"></p>
<p><img src="/images/image-20230527222331169.png" alt="image-20230527222331169"></p>
<h3 id="第二个w获取流程-1"><a href="#第二个w获取流程-1" class="headerlink" title="第二个w获取流程"></a>第二个w获取流程</h3><p>我们先把w加密的这一段代码扣下来,前面五行也是跟之前一样毫无意义的循环，都是一样的值，直接删掉</p>
<p><img src="/images/image-20230529201246396.png" alt="image-20230529201246396"></p>
<p>删完之后我们来看一下这个控制流，发现会走所有的流程，所以我们直接精简一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[$_CGBCi(<span class="hljs-number">95</span>)](e[$_CGBDY(<span class="hljs-number">73</span>)]());<br>    <span class="hljs-keyword">var</span> r = $_CGBCi(<span class="hljs-number">226</span>);<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> $_DEFIu = <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">4</span>][<span class="hljs-number">14</span>];<br>            <span class="hljs-keyword">for</span> (; $_DEFIu !== <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">8</span>][<span class="hljs-number">12</span>];) &#123;<br>                <span class="hljs-keyword">switch</span> ($_DEFIu) &#123;<br>                    <span class="hljs-keyword">case</span> <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">4</span>][<span class="hljs-number">14</span>]:<br>                        <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span><br>                            , n = e[$_CGBHd(<span class="hljs-number">54</span>)]<br>                            , r = <span class="hljs-number">0</span>;<br>                        <span class="hljs-keyword">while</span> (n--)<br>                            t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[$_CGBIC(<span class="hljs-number">94</span>)](r++);<br>                        $_DEFIu = <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">0</span>][<span class="hljs-number">13</span>];<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">case</span> <span class="hljs-title class_">VIPVz</span>.$_Ds()[<span class="hljs-number">8</span>][<span class="hljs-number">13</span>]:<br>                        <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>                        <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[$_CGBIC(<span class="hljs-number">256</span>)]() - t[$_CGBIC(<span class="hljs-number">256</span>)]() &amp;&amp; (e = $_CGBIC(<span class="hljs-number">1474</span>)),<br>            r = $_CGBHd(<span class="hljs-number">764</span>) + i[$_CGBIC(<span class="hljs-number">1448</span>)] + $_CGBIC(<span class="hljs-number">1427</span>) + <span class="hljs-title function_">n</span>(o[$_CGBIC(<span class="hljs-number">73</span>)]() + <span class="hljs-title function_">n</span>(n[$_CGBHd(<span class="hljs-number">73</span>)]()) + <span class="hljs-title function_">n</span>(e[$_CGBHd(<span class="hljs-number">73</span>)]())) + $_CGBHd(<span class="hljs-number">1471</span>);<br>    &#125;(t[$_CGBDY(<span class="hljs-number">1440</span>)](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        i[$_CGBCi(<span class="hljs-number">1481</span>)] = p[$_CGBDY(<span class="hljs-number">1303</span>)](_[$_CGBDY(<span class="hljs-number">12</span>)](r, i[$_CGBDY(<span class="hljs-number">1361</span>)]()));<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/image-20230529202254446.png" alt="image-20230529202254446"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;toString&#x27;</span>]());<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + i[<span class="hljs-string">&#x27;$_CEG_&#x27;</span>] + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o[<span class="hljs-string">&#x27;toString&#x27;</span>]() + <span class="hljs-title function_">n</span>(n[<span class="hljs-string">&#x27;toString&#x27;</span>]()) + <span class="hljs-title function_">n</span>(e[<span class="hljs-string">&#x27;toString&#x27;</span>]())) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;<br>    (t[<span class="hljs-string">&#x27;shift&#x27;</span>](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        i[<span class="hljs-string">&#x27;$_CEEK&#x27;</span>] = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](_[<span class="hljs-string">&#x27;encrypt&#x27;</span>](r, i[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]()));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们先看一下 r ,o和n视乎是现成的，就在上面，我们看下 <code>o[&#39;toString&#39;]()</code>  和 <code>n[&#39;toString&#39;]()</code>，以及 <code>e[&#39;toString&#39;]()</code> 怀疑这里是否是做了代码检测，这里的运行结果肯定是会和我们精简话后的代码运行结果不一样的，我们直接把这三个的值给写死，直接复制控制台输出出来的</p>
<p><img src="/images/image-20230530100647305.png" alt="image-20230530100647305"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">e</span>) &#123;<br>    t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;toString&#x27;</span>]());<br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var...&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function ...&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;bbOy&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + i[<span class="hljs-string">&#x27;$_CEG_&#x27;</span>] + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(t[<span class="hljs-string">&#x27;shift&#x27;</span>](), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),i[<span class="hljs-string">&#x27;$_CEEK&#x27;</span>] = p[<span class="hljs-string">&#x27;$_HEf&#x27;</span>](_[<span class="hljs-string">&#x27;encrypt&#x27;</span>](r, i[<span class="hljs-string">&#x27;$_CCIl&#x27;</span>]()));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来 我们来找一下 <code>i[&#39;$_CEG_&#39;]</code> 是怎么生成的，源代码是<code>i[$_CGBIC(1448)]</code>，还是那个逻辑，从某个地方取值，那肯定会有从这个地方存值的操作，直接搜索1448，搜索出来的结果有三个我们直接在其它两个地方打断点</p>
<p><img src="/images/image-20230530101948282.png" alt="image-20230530101948282"></p>
<p>可以看到，在最开始的时候，做了一个赋值空字符串的操作，接下来就是一个大号的循环在循环里面做一个拼接的操作，这里一大串都是 for(;;) 也就是for循环里面的判断和自增条件，而真正的循环体只有最后一个拼接的操作</p>
<p><img src="/images/image-20230530103343268.png" alt="image-20230530103343268"></p>
<p>我们把代码复制出来，处理一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_i</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span><br>        , e = i[<span class="hljs-string">&#x27;$_BJJF&#x27;</span>][<span class="hljs-string">&#x27;$_BIBF&#x27;</span>]()<br>        , t = i[<span class="hljs-string">&#x27;$_BJJF&#x27;</span>][<span class="hljs-string">&#x27;$_BICQ&#x27;</span>]()<br>        , n = i[<span class="hljs-string">&#x27;$_BJCr&#x27;</span>][<span class="hljs-string">&#x27;$_BICQ&#x27;</span>]()<br>        , r = i[<span class="hljs-string">&#x27;$_BDHN&#x27;</span>][<span class="hljs-string">&#x27;$_BIBF&#x27;</span>]()<br>        , o = i[<span class="hljs-string">&#x27;$_EIk&#x27;</span>]<br>        , s = $_GY() - ot;<br>    result = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = [[<span class="hljs-string">&#x27;lang&#x27;</span>, o[<span class="hljs-string">&#x27;lang&#x27;</span>] || <span class="hljs-string">&#x27;zh-cn&#x27;</span>], [<span class="hljs-string">&#x27;type&#x27;</span>, <span class="hljs-string">&#x27;fullpage&#x27;</span>], [<span class="hljs-string">&#x27;tt&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t, n</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!t || !n)<br>            <span class="hljs-keyword">return</span> e;<br>        <span class="hljs-keyword">var</span> r, o = <span class="hljs-number">0</span>, i = e, s = t[<span class="hljs-number">0</span>], a = t[<span class="hljs-number">2</span>], c = t[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">while</span> (r = n[<span class="hljs-string">&#x27;substr&#x27;</span>](o, <span class="hljs-number">2</span>)) &#123;<br>            o += <span class="hljs-number">2</span>;<br>            <span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">parseInt</span>(r, <span class="hljs-number">16</span>)<br>                , l = <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](_)<br>                , u = (s * _ * _ + a * _ + c) % e[<span class="hljs-string">&#x27;length&#x27;</span>];<br>            i = i[<span class="hljs-string">&#x27;substr&#x27;</span>](<span class="hljs-number">0</span>, u) + l + i[<span class="hljs-string">&#x27;substr&#x27;</span>](u);<br>        &#125;<br>        <span class="hljs-keyword">return</span> i;<br>    &#125;(e, o[<span class="hljs-string">&#x27;c&#x27;</span>], o[<span class="hljs-string">&#x27;s&#x27;</span>]) || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;light&#x27;</span>, r || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-title function_">V</span>(p[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](t))], [<span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-title function_">V</span>(p[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](n))], [<span class="hljs-string">&#x27;hh&#x27;</span>, <span class="hljs-title function_">V</span>(n)], [<span class="hljs-string">&#x27;hi&#x27;</span>, <span class="hljs-title function_">V</span>(i[<span class="hljs-string">&#x27;$_CCGM&#x27;</span>])], [<span class="hljs-string">&#x27;vip_order&#x27;</span>, i[<span class="hljs-string">&#x27;vip_order&#x27;</span>] || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;ct&#x27;</span>, i[<span class="hljs-string">&#x27;ct&#x27;</span>] || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;ep&#x27;</span>, i[<span class="hljs-string">&#x27;$_CEHV&#x27;</span>]() || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;passtime&#x27;</span>, s || -<span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;rp&#x27;</span>, <span class="hljs-title function_">V</span>(o[<span class="hljs-string">&#x27;gt&#x27;</span>] + o[<span class="hljs-string">&#x27;challenge&#x27;</span>] + s)]], c = <span class="hljs-number">0</span>; c &lt; a[<span class="hljs-string">&#x27;length&#x27;</span>]; c++)<br>        result += <span class="hljs-string">&#x27;&quot;&#x27;</span> + a[c][<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;&quot;:&#x27;</span> + ge[<span class="hljs-string">&#x27;stringify&#x27;</span>](a[c][<span class="hljs-number">1</span>]) + <span class="hljs-string">&#x27;,&#x27;</span>;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>从上到下，我们先处理前面一大段赋值的操作，先看 <code>i[&#39;$_BJJF&#39;][&#39;$_BIBF&#39;]()</code>，进去打断点，我们先看一下</p>
<p><code>this[$_CDDIY(34)]</code> 很显然 这是一段轨迹的操作，下一段代码又将其制空，这一步操作没有意义，后面肯定是要对轨迹进行处理的，而这一段轨迹我们可以用算法生成，也可以直接复制，这一段轨迹来自于你对点击生成验证码的操作进行鼠标轨迹检测，这也就是为什么用selenium无法成功的原因</p>
<p><img src="/images/image-20230530113517383.png" alt="image-20230530113517383"></p>
<p><img src="/images/image-20230530113555853.png" alt="image-20230530113555853"></p>
<p>我们往下执行一步，输出一下 <code>this[$_CDDIY(917)](e)</code>,这里传递的值应该是上一步的时间差值，并没有对时时的时间进行计算，所以我们可以直接复制这个轨迹。到了这里，e参数的加密入口就处理好了，现在要解决的是 <code>this[&#39;$_BHIh&#39;](e)</code> 方法</p>
<p><img src="/images/image-20230530151150040.png" alt="image-20230530151150040"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BIBF_e</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> e = [<br>    [<br>        <span class="hljs-string">&quot;move&quot;</span>,<br>        <span class="hljs-number">1098</span>,<br>        <span class="hljs-number">239</span>,<br>        <span class="hljs-number">1685417642390</span>,<br>        <span class="hljs-string">&quot;pointermove&quot;</span><br>    ],<br> ..... <span class="hljs-comment">// 这里是复制的轨迹</span><br>];<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_HDc&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BHIh&#x27;</span>](e));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来就是扣代码的环节，把没必要的给删掉，需要注意的是  <code>ce([&#39;down&#39;, &#39;move&#39;, &#39;up&#39;, &#39;scroll&#39;])[&#39;$_EHc&#39;](p)</code> 这里需要在ce的原型链上添加新的方法，需要注意</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function ce(e) &#123;<br>    this[&#x27;$_BAEJ&#x27;] = e || [];<br>&#125;<br><br>ce.prototype = &#123;<br>    &quot;$_EHc&quot;: function (e) &#123;<br>        var t = this[&#x27;$_BAEJ&#x27;];<br>        if (t[&#x27;indexOf&#x27;])<br>            return t[&#x27;indexOf&#x27;](e);<br>        for (var n = 0, r = t[&#x27;length&#x27;]; n &lt; r; n += 1)<br>            if (t[n] === e)<br>                return n;<br>        return -1;<br>    &#125;<br>&#125;<br><br><br>function $_BHHD(e) &#123;<br>    var t = 32767;<br>    return &#x27;number&#x27; != typeof e ? e : (t &lt; e ? e = t : e &lt; -t &amp;&amp; (e = -t),<br>        Math[&#x27;round&#x27;](e));<br>&#125;<br><br>function $_BHJu(e) &#123;<br>    var t = &#x27;&#x27;<br>        , n = 0;<br>    (e || [])[&#x27;length&#x27;];<br>    while (!t &amp;&amp; e[n])<br>        t = e[n] &amp;&amp; e[n][4],<br>            n++;<br>    if (!t)<br>        return e;<br>    for (var r = &#x27;&#x27;, o = [&#x27;mouse&#x27;, &#x27;touch&#x27;, &#x27;pointer&#x27;, &#x27;MSPointer&#x27;], i = 0, s = o[&#x27;length&#x27;]; i &lt; s; i++)<br>        0 === t[&#x27;indexOf&#x27;](o[i]) &amp;&amp; (r = o[i]);<br>    for (var a = e[&#x27;slice&#x27;](), c = a[&#x27;length&#x27;] - 1; 0 &lt;= c; c--) &#123;<br>        var _ = a[c]<br>            , l = _[0];<br>        if (-1 &lt; new ce([&#x27;move&#x27;, &#x27;down&#x27;, &#x27;up&#x27;])[&#x27;$_EHc&#x27;](l))<br>            0 !== (_[4] || &#x27;&#x27;)[&#x27;indexOf&#x27;](r) &amp;&amp; a[&#x27;splice&#x27;](c, 1);<br>    &#125;<br>    return a;<br>&#125;<br><br>// 处理轨迹<br>function $_BHIh(e) &#123;<br>    var t = 0<br>        , n = 0<br>        , r = []<br>        , i = 0;<br>    if (e[&#x27;length&#x27;] &lt;= 0)<br>        return [];<br>    for (var s = null, a = null, c = $_BHJu(e), _ = c[&#x27;length&#x27;], l = _ &lt; 300 ? 0 : _ - 300; l &lt; _; l += 1) &#123;<br>        var u = c[l]<br>            , p = u[0];<br>        -1 &lt; new ce([&#x27;down&#x27;, &#x27;move&#x27;, &#x27;up&#x27;, &#x27;scroll&#x27;])[&#x27;$_EHc&#x27;](p) ? (s || (s = u),<br>            a = u,<br>            r[&#x27;push&#x27;]([p, [u[1] - t, u[2] - n], $_BHHD(i ? u[3] - i : i)]),<br>            t = u[1],<br>            n = u[2],<br>            i = u[3]) : -1 &lt; new ce([&#x27;blur&#x27;, &#x27;focus&#x27;, &#x27;unload&#x27;])[&#x27;$_EHc&#x27;](p) &amp;&amp; (r[&#x27;push&#x27;]([p, $_BHHD(i ? u[1] - i : i)]),<br>            i = u[1]);<br>    &#125;<br>    // o[aa(922)] = s,o[aa(978)] = a, 两个不不需要，直接删除<br>    return r;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后运行一下 <code>this[&#39;$_BHIh&#39;](e)</code>  控制台输出和我们的运行结果一致，这个方法就解决了，现在要解决的是 <code>this[&#39;$_HDc&#39;]($_BHIh(e))</code> 方法，这个方法比较长，需要扣仔细一点</p>
<p><img src="/images/image-20230530155302966.png" alt="image-20230530155302966"></p>
<p>抠出来的代码会精简很多，极验的控制流都是假的，直接把控制流的主体部分拿出来就可以了，抠出来运行一下看一下是否和浏览器的一样,验证结果没有问题，e参数解密完成。那就回到加密入口，去看一下t参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HDc</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> p = &#123;<br>        <span class="hljs-string">&quot;\u006d\u006f\u0076\u0065&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;\u0064\u006f\u0077\u006e&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;\u0075\u0070&quot;</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;\u0073\u0063\u0072\u006f\u006c\u006c&quot;</span>: <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;\u0066\u006f\u0063\u0075\u0073&quot;</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&quot;\u0062\u006c\u0075\u0072&quot;</span>: <span class="hljs-number">5</span>,<br>        <span class="hljs-string">&quot;\u0075\u006e\u006c\u006f\u0061\u0064&quot;</span>: <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;\u0075\u006e\u006b\u006e\u006f\u0077\u006e&quot;</span>: <span class="hljs-number">7</span><br>    &#125;;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = e[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">2</span>), r = <span class="hljs-string">&#x27;&#x27;</span>, o = n[<span class="hljs-string">&#x27;length&#x27;</span>] + <span class="hljs-number">1</span>; o &lt;= t; o += <span class="hljs-number">1</span>)<br>            r += <span class="hljs-string">&#x27;0&#x27;</span>;<br><br>        <span class="hljs-keyword">return</span> n = r + n;<br><br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = []<br>            , n = e[<span class="hljs-string">&#x27;length&#x27;</span>]<br>            , r = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (r &lt; n) &#123;<br>            <span class="hljs-keyword">var</span> o = e[r]<br>                , i = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-number">16</span> &lt;= i)<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">var</span> s = r + i + <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span> (n &lt;= s)<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">if</span> (e[s] !== o)<br>                    <span class="hljs-keyword">break</span>;<br>                i += <span class="hljs-number">1</span>;<br>            &#125;<br>            r = r + <span class="hljs-number">1</span> + i;<br>            <span class="hljs-keyword">var</span> a = p[o];<br>            <span class="hljs-number">0</span> != i ? (t[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-number">8</span> | a),<br>                t[<span class="hljs-string">&#x27;push&#x27;</span>](i - <span class="hljs-number">1</span>)) : t[<span class="hljs-string">&#x27;push&#x27;</span>](a);<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-title function_">h</span>(<span class="hljs-number">32768</span> | n, <span class="hljs-number">16</span>), _ = <span class="hljs-string">&#x27;&#x27;</span>, l = <span class="hljs-number">0</span>, u = t[<span class="hljs-string">&#x27;length&#x27;</span>]; l &lt; u; l += <span class="hljs-number">1</span>)<br>            _ += <span class="hljs-title function_">h</span>(t[l], <span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">return</span> c + _;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = e[<span class="hljs-string">&#x27;length&#x27;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            n[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">t</span>(e[r]));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">e, t</span>) &#123;<br>        e = <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">32767</span><br>                , n = (e = <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-keyword">return</span> t &lt; e ? t : e &lt; -t ? -t : e;<br>            &#125;))[<span class="hljs-string">&#x27;length&#x27;</span>]<br>                , r = <span class="hljs-number">0</span><br>                , o = [];<br>            <span class="hljs-keyword">while</span> (r &lt; n) &#123;<br>                <span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span><br>                    , s = e[r]<br>                    , a = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](s);<br>                <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (n &lt;= r + i)<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">if</span> (e[r + i] !== s)<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-number">127</span> &lt;= a || <span class="hljs-number">127</span> &lt;= i)<br>                        <span class="hljs-keyword">break</span>;<br>                    i += <span class="hljs-number">1</span>;<br>                &#125;<br>                <span class="hljs-number">1</span> &lt; i ? o[<span class="hljs-string">&#x27;push&#x27;</span>]((s &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">49152</span> : <span class="hljs-number">32768</span>) | i &lt;&lt; <span class="hljs-number">7</span> | a) : o[<span class="hljs-string">&#x27;push&#x27;</span>](s),<br>                    r += i;<br>            &#125;<br>            <span class="hljs-keyword">return</span> o;<br>        &#125;(e);<br>        <span class="hljs-keyword">var</span> n, r = [], o = [];<br>        <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;ceil&#x27;</span>](<span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e, t</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> === e ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;log&#x27;</span>](e) / <span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;log&#x27;</span>](t);<br>            &#125;(<span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](e) + <span class="hljs-number">1</span>, <span class="hljs-number">16</span>));<br>            <span class="hljs-number">0</span> === t &amp;&amp; (t = <span class="hljs-number">1</span>),<br>                r[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">h</span>(t - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)),<br>                o[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-title function_">h</span>(<span class="hljs-title class_">Math</span>[<span class="hljs-string">&#x27;abs&#x27;</span>](e), <span class="hljs-number">4</span> * t));<br>        &#125;);<br>        <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>)<br>            , s = o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>);<br>        <span class="hljs-keyword">return</span> n = t ? <span class="hljs-title function_">_</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">e, t</span>) &#123;<br>            <span class="hljs-keyword">var</span> n = [];<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">_</span>(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-title function_">t</span>(e) &amp;&amp; n[<span class="hljs-string">&#x27;push&#x27;</span>](e);<br>            &#125;),<br>                n;<br>        &#125;(e, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> != e &amp;&amp; e &gt;&gt; <span class="hljs-number">15</span> != <span class="hljs-number">1</span>;<br>        &#125;), <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> ? <span class="hljs-string">&#x27;1&#x27;</span> : <span class="hljs-string">&#x27;0&#x27;</span>;<br>        &#125;)[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;&#x27;</span>) : <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-title function_">h</span>(<span class="hljs-number">32768</span> | e[<span class="hljs-string">&#x27;length&#x27;</span>], <span class="hljs-number">16</span>) + i + s + n;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], n = [], r = [], o = [], i = <span class="hljs-number">0</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>]; i &lt; s; i += <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">var</span> a = e[i]<br>                , c = a[<span class="hljs-string">&#x27;length&#x27;</span>];<br>            t[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">0</span>]),<br>                n[<span class="hljs-string">&#x27;push&#x27;</span>](<span class="hljs-number">2</span> === c ? a[<span class="hljs-number">1</span>] : a[<span class="hljs-number">2</span>]),<br>            <span class="hljs-number">3</span> === c &amp;&amp; (r[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]),<br>                o[<span class="hljs-string">&#x27;push&#x27;</span>](a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]));<br>        &#125;<br>        <span class="hljs-keyword">var</span> _ = <span class="hljs-title function_">f</span>(t) + <span class="hljs-title function_">g</span>(n, !<span class="hljs-number">1</span>) + <span class="hljs-title function_">g</span>(r, !<span class="hljs-number">0</span>) + <span class="hljs-title function_">g</span>(o, !<span class="hljs-number">0</span>)<br>            , l = _[<span class="hljs-string">&#x27;length&#x27;</span>];<br>        <span class="hljs-keyword">return</span> l % <span class="hljs-number">6</span> != <span class="hljs-number">0</span> &amp;&amp; (_ += <span class="hljs-title function_">h</span>(<span class="hljs-number">0</span>, <span class="hljs-number">6</span> - l % <span class="hljs-number">6</span>)),<br>            <span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;&#x27;</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>] / <span class="hljs-number">6</span>, r = <span class="hljs-number">0</span>; r &lt; n; r += <span class="hljs-number">1</span>)<br>                    t += <span class="hljs-string">&#x27;()*,-./0123456789:?@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~&#x27;</span>[<span class="hljs-string">&#x27;charAt&#x27;</span>](<span class="hljs-built_in">parseInt</span>(e[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">6</span> * r, <span class="hljs-number">6</span> * (r + <span class="hljs-number">1</span>)), <span class="hljs-number">2</span>));<br>                <span class="hljs-keyword">return</span> t;<br>            &#125;(_);<br>    &#125;(e);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/image-20230530161827587.png" alt="image-20230530161827587"></p>
<p><code>t = i[$_CFJHp(1378)][$_CFJHp(1419)]()</code> 我们看一下这个函数，直接看return <code>this[$_CDEDb(34)]</code> 是一个空数组，<code>this[$_CDEDb(942)]</code> 就在上面，也就是我们上一步做的轨迹加密，但是这一次它传入了一个空数组，所以这个方法我们可以这样写,验证一下，没有问题，这一步其实也可以写死</p>
<p><img src="/images/image-20230530162730718.png" alt="image-20230530162730718"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 参数t的加密入口</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BICQ_t</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> $_HDc([]);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/image-20230530163052621.png" alt="image-20230530163052621"></p>
<p>接下来看参数n  <code>n = i[$_CFJIy(1313)][$_CFJIy(1419)]()</code>,其中 <code>n[$_CEAIT(34)]</code> 其实就是上一个w里面那两个数组中包含浏览器指纹的那个，而下面的 <code>n[$_CEAHd(1374)]()</code> 就是另一个数组，所以 这两个数组都可以直接复制过来，里面的时间戳改成 <code>new Date().getTime()</code> 就好了</p>
<p><img src="/images/image-20230530174631647.png" alt="image-20230530174631647"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_BICQ_n</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">this</span>,<br>        r = &#123;<br>    <span class="hljs-string">&quot;STYLE&quot;</span>: <span class="hljs-number">2</span>,<br>    <span class="hljs-string">&quot;SCRIPT&quot;</span>: <span class="hljs-number">6</span>,<br>    <span class="hljs-string">&quot;A&quot;</span>: <span class="hljs-number">1</span>,<br>   <br>    <span class="hljs-string">&quot;hardwareConcurrency&quot;</span>: <span class="hljs-number">16</span>,<br>    <span class="hljs-string">&quot;jsFonts&quot;</span>: <span class="hljs-string">&quot;Arial,ArialBlack,ArialNarrow,Calibri,Cambria,CambriaMath,ComicSansMS,Consolas,Courier,CourierNew,Georgia,Helvetica,Impact,LucidaConsole,LucidaSansUnicode,MicrosoftSansSerif,MSGothic,MSPGothic,MSSansSerif,MSSerif,PalatinoLinotype,SegoePrint,SegoeScript,SegoeUI,SegoeUILight,SegoeUISemibold,SegoeUISymbol,Tahoma,Times,TimesNewRoman,TrebuchetMS,Verdana,Wingdings&quot;</span>,<br>    <span class="hljs-string">&quot;mediaDevices&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;timestamp&quot;</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(),<br>    <span class="hljs-string">&quot;touchEvent&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;performanceTiming&quot;</span>: -<span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;internalip&quot;</span>: -<span class="hljs-number">1</span><br>&#125;,  <span class="hljs-comment">// 浏览器指纹</span><br>        o = [];<br>    array1 = [<br>    <span class="hljs-string">&quot;textLength&quot;</span>,<br>    <span class="hljs-string">&quot;HTMLLength&quot;</span>,<br><br>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(array1)[<span class="hljs-string">&#x27;$_EAz&#x27;</span>](<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = r[e];<br>        o[<span class="hljs-string">&#x27;push&#x27;</span>](n[<span class="hljs-string">&#x27;$_BIHL&#x27;</span>](t) ? n[<span class="hljs-string">&#x27;$_BIDi&#x27;</span>] : t);&#125;),<br>        o[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;magic data&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后我们再看一下 <code>new ce(n[$_CEAHd(1374)]())[$_CEAHd(19)]</code> 是个什么东西，ce方法 我们在前面已经扣下来了，现在我们在ce方法的原型方法上再加上一个 $_EAz方法</p>
<p><img src="/images/image-20230530175301839.png" alt="image-20230530175301839"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;$_EAz&quot;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;$_BAEJ&quot;</span>];<br>        <span class="hljs-keyword">if</span> (t[<span class="hljs-string">&quot;map&quot;</span>])<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(t[<span class="hljs-string">&quot;map&quot;</span>](e));<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = [], r = <span class="hljs-number">0</span>, o = t[<span class="hljs-string">&quot;length&quot;</span>]; r &lt; o; r += <span class="hljs-number">1</span>)<br>            n[r] = <span class="hljs-title function_">e</span>(t[r], r, <span class="hljs-variable language_">this</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">ce</span>(n);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>这下n也加密完成了，我们看一下加密结果, 没什么问题</p>
<p><img src="/images/image-20230530180525444.png" alt="image-20230530180525444"></p>
<p>接下来就看一下r参数 <code>r = i[&#39;$_BDHN&#39;][&#39;$_BIBF&#39;]()</code> ，看一下这个是什么方法，简化一下</p>
<p><img src="/images/image-20230530180849252.png" alt="image-20230530180849252"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span>  <span class="hljs-title function_">$_BIBF_r</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGq&#x27;</span>] || [];<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGq&#x27;</span>] = [],<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGIZ&#x27;</span>] = <span class="hljs-number">0</span>,<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_BGJn&#x27;</span>] = [],<br>    (y || b || w) &amp;&amp; (e = e[<span class="hljs-string">&#x27;slice&#x27;</span>](<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)),<br>    e[<span class="hljs-string">&#x27;join&#x27;</span>](<span class="hljs-string">&#x27;|&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们先看一下 <code>this[&#39;$_BGq&#39;]</code> 是什么，这里貌似是一个固定的值, 这里也可以直接写死，</p>
<p><img src="/images/image-20230530183918615.png" alt="image-20230530183918615"></p>
<p><img src="/images/image-20230530184002052.png" alt="image-20230530184002052"></p>
<p>再看一下 <code>o = i[$_CFJIy(336)]</code> 参数o，发现其实是上面两个请求的返回值，所以这边也是可以直接写死的</p>
<p><img src="/images/image-20230530184253163.png" alt="image-20230530184253163"></p>
<p><img src="/images/image-20230530184337456.png" alt="image-20230530184337456"></p>
<p>最后一个参数 s <code>s = $_GY() - ot</code> 参数s应该是两个时间戳相减，这个差值可以随机，也可以写死，这里我们直接写死</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs javascript">, o = &#123;<br>    <span class="hljs-string">&quot;$_CAAU&quot;</span>: <span class="hljs-number">1685443121545</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;https://&quot;</span>,<br>    <span class="hljs-string">&quot;gt&quot;</span>: <span class="hljs-string">&quot;019924a82c70bb123aae90d483087f94&quot;</span>,<br>    <span class="hljs-string">&quot;challenge&quot;</span>: <span class="hljs-string">&quot;cb2ede0a2b0a27d9559714c0ce37dc5b&quot;</span>,<br>    <span class="hljs-string">&quot;offline&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;new_captcha&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;product&quot;</span>: <span class="hljs-string">&quot;popup&quot;</span>,<br>    <span class="hljs-string">&quot;width&quot;</span>: <span class="hljs-string">&quot;300px&quot;</span>,<br>    <span class="hljs-string">&quot;https&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;api_server&quot;</span>: <span class="hljs-string">&quot;api.geetest.com&quot;</span>,<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;fullpage&quot;</span>,<br>    <span class="hljs-string">&quot;static_servers&quot;</span>: [<br>        <span class="hljs-string">&quot;static.geetest.com&quot;</span>,<br>        <span class="hljs-string">&quot;dn-staticdown.qbox.me&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-string">&quot;/static/js/beeline.1.0.1.js&quot;</span>,<br>    <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-string">&quot;/static/js/voice.1.2.3.js&quot;</span>,<br>    <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-string">&quot;/static/js/click.3.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;fullpage&quot;</span>: <span class="hljs-string">&quot;/static/js/fullpage.9.1.4.js&quot;</span>,<br>    <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-string">&quot;/static/js/slide.7.9.0.js&quot;</span>,<br>    <span class="hljs-string">&quot;geetest&quot;</span>: <span class="hljs-string">&quot;/static/js/geetest.6.0.9.js&quot;</span>,<br>    <span class="hljs-string">&quot;aspect_radio&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;slide&quot;</span>: <span class="hljs-number">103</span>,<br>        <span class="hljs-string">&quot;click&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;voice&quot;</span>: <span class="hljs-number">128</span>,<br>        <span class="hljs-string">&quot;beeline&quot;</span>: <span class="hljs-number">50</span><br>    &#125;,<br>    <span class="hljs-string">&quot;cc&quot;</span>: <span class="hljs-number">16</span>,<br>    <span class="hljs-string">&quot;supportWorker&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;$_FF_&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;pt&quot;</span>: <span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-string">&quot;aeskey&quot;</span>: <span class="hljs-string">&quot;77266c508c6b7371&quot;</span>,<br>    <span class="hljs-string">&quot;theme&quot;</span>: <span class="hljs-string">&quot;wind&quot;</span>,<br>    <span class="hljs-string">&quot;theme_version&quot;</span>: <span class="hljs-string">&quot;1.5.8&quot;</span>,<br>    <span class="hljs-string">&quot;logo&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;feedback&quot;</span>: <span class="hljs-string">&quot;https://www.geetest.com/contact#report&quot;</span>,<br>    <span class="hljs-string">&quot;c&quot;</span>: [<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">58</span>,<br>        <span class="hljs-number">98</span>,<br>        <span class="hljs-number">36</span>,<br>        <span class="hljs-number">43</span>,<br>        <span class="hljs-number">95</span>,<br>        <span class="hljs-number">62</span>,<br>        <span class="hljs-number">15</span>,<br>        <span class="hljs-number">12</span><br>    ],<br>    <span class="hljs-string">&quot;s&quot;</span>: <span class="hljs-string">&quot;302a3836&quot;</span>,<br>    <span class="hljs-string">&quot;i18n_labels&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;copyright&quot;</span>: <span class="hljs-string">&quot;由极验提供技术支持&quot;</span>,<br>        <span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;网络不给力&quot;</span>,<br>        <span class="hljs-string">&quot;error_content&quot;</span>: <span class="hljs-string">&quot;请点击此处重试&quot;</span>,<br>        <span class="hljs-string">&quot;error_title&quot;</span>: <span class="hljs-string">&quot;网络超时&quot;</span>,<br>        <span class="hljs-string">&quot;fullpage&quot;</span>: <span class="hljs-string">&quot;智能检测中&quot;</span>,<br>        <span class="hljs-string">&quot;goto_cancel&quot;</span>: <span class="hljs-string">&quot;取消&quot;</span>,<br>        <span class="hljs-string">&quot;goto_confirm&quot;</span>: <span class="hljs-string">&quot;前往&quot;</span>,<br>        <span class="hljs-string">&quot;goto_homepage&quot;</span>: <span class="hljs-string">&quot;是否前往验证服务Geetest官网&quot;</span>,<br>        <span class="hljs-string">&quot;loading_content&quot;</span>: <span class="hljs-string">&quot;智能验证检测中&quot;</span>,<br>        <span class="hljs-string">&quot;next&quot;</span>: <span class="hljs-string">&quot;正在加载验证&quot;</span>,<br>        <span class="hljs-string">&quot;next_ready&quot;</span>: <span class="hljs-string">&quot;请完成验证&quot;</span>,<br>        <span class="hljs-string">&quot;read_reversed&quot;</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&quot;ready&quot;</span>: <span class="hljs-string">&quot;点击按钮进行验证&quot;</span>,<br>        <span class="hljs-string">&quot;refresh_page&quot;</span>: <span class="hljs-string">&quot;页面出现错误啦！要继续操作，请刷新此页面&quot;</span>,<br>        <span class="hljs-string">&quot;reset&quot;</span>: <span class="hljs-string">&quot;请点击重试&quot;</span>,<br>        <span class="hljs-string">&quot;success&quot;</span>: <span class="hljs-string">&quot;验证成功&quot;</span>,<br>        <span class="hljs-string">&quot;success_title&quot;</span>: <span class="hljs-string">&quot;通过验证&quot;</span><br>    &#125;<br>&#125;  <span class="hljs-comment">// 先写死</span><br>        , s = <span class="hljs-number">67777</span>; <br></code></pre></td></tr></table></figure>

<p>然后接着往下面看,中间这一部分就让他自己算，我们直接看下面的，直接看 V和p方法</p>
<p><img src="/images/image-20230530184734204.png" alt="image-20230530184734204"></p>
<p><img src="/images/image-20230530184755299.png" alt="image-20230530184755299"></p>
<p>这是p方法,精简一下, 我们把 <code>this[&#39;$_HCh&#39;]</code> 和 <code>this[&#39;$_GHz&#39;]</code> 补一下，其实这一步的操作和第一个w获取参数i的操作一模一样,正常扣代码就行</p>
<p><img src="/images/image-20230530195315039.png" alt="image-20230530195315039"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">p</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_HCh&#x27;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&#x27;$_GHz&#x27;</span>](e));<br>    <span class="hljs-keyword">return</span> t[<span class="hljs-string">&#x27;res&#x27;</span>] + t[<span class="hljs-string">&#x27;end&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HBw</span>(<span class="hljs-params">e, t</span>) &#123;<br>    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GJz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&#x27;</span>;<br>    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&#x27;length&#x27;</span>] ? <span class="hljs-string">&#x27;.&#x27;</span> : t[<span class="hljs-string">&#x27;charAt&#x27;</span>](e);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_HCh</span>(<span class="hljs-params">e, o</span>) &#123;<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>;<br>    o || (o = i);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">function</span> (<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)<br>            <span class="hljs-number">1</span> === $_HBw(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBw(e, r));<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>, s = e[<span class="hljs-string">&#x27;length&#x27;</span>], a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;<br>        <span class="hljs-keyword">var</span> c;<br>        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)<br>            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">235</span>));<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;<br>            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">19220</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,<br>                n += $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">7274496</span>)) + $_GJz(<span class="hljs-title function_">t</span>(c, <span class="hljs-number">9483264</span>)),<br>                r = <span class="hljs-string">&#x27;.&#x27;</span> + <span class="hljs-string">&#x27;.&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;\u0072\u0065\u0073&quot;</span>: n,<br>        <span class="hljs-string">&quot;\u0065\u006e\u0064&quot;</span>: r<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$_GHz</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], n = <span class="hljs-number">0</span>, r = e[<span class="hljs-string">&#x27;length&#x27;</span>]; n &lt; r; n += <span class="hljs-number">1</span>)<br>        t[<span class="hljs-string">&#x27;push&#x27;</span>](e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](n));<br>    <span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着 我们来扣V方法，这个V方法其实是个md5加密，我们可以导包或者直接扣也i选哪个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">V</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">c</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">return</span> e &lt;&lt; t | e &gt;&gt;&gt; <span class="hljs-number">32</span> - t;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">var</span> n, r, o, i, a;<br>        <span class="hljs-keyword">return</span> o = <span class="hljs-number">2147483648</span> &amp; e,<br>        i = <span class="hljs-number">2147483648</span> &amp; t,<br>        a = (<span class="hljs-number">1073741823</span> &amp; e) + (<span class="hljs-number">1073741823</span> &amp; t),<br>        (n = <span class="hljs-number">1073741824</span> &amp; e) &amp; (r = <span class="hljs-number">1073741824</span> &amp; t) ? <span class="hljs-number">2147483648</span> ^ a ^ o ^ i : n | r ? <span class="hljs-number">1073741824</span> &amp; a ? <span class="hljs-number">3221225472</span> ^ a ^ o ^ i : <span class="hljs-number">1073741824</span> ^ a ^ o ^ i : a ^ o ^ i;<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">t</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; t | ~e &amp; n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e &amp; n | t &amp; ~n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> e ^ t ^ n;<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t, n, r, o, i, a</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">u</span>(<span class="hljs-title function_">c</span>(e = <span class="hljs-title function_">u</span>(e, <span class="hljs-title function_">u</span>(<span class="hljs-title function_">u</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>            <span class="hljs-keyword">return</span> t ^ (e | ~n);<br>        &#125;(t, n, r), o), a)), i), t);<br>    &#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">i</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, n = <span class="hljs-string">&#x27;&#x27;</span>, r = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt;= <span class="hljs-number">3</span>; t++)<br>            n += (r = <span class="hljs-string">&#x27;0&#x27;</span> + (e &gt;&gt;&gt; <span class="hljs-number">8</span> * t &amp; <span class="hljs-number">255</span>)[<span class="hljs-string">&#x27;toString&#x27;</span>](<span class="hljs-number">16</span>))[<span class="hljs-string">&#x27;substr&#x27;</span>](r[<span class="hljs-string">&#x27;length&#x27;</span>] - <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">return</span> n;<br>    &#125;<br>    <span class="hljs-keyword">var</span> a, s, l, _, f, p, h, d, g, v;<br>    <span class="hljs-keyword">for</span> (a = <span class="hljs-keyword">function</span> <span class="hljs-title function_">m</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = n + <span class="hljs-number">8</span>, o = <span class="hljs-number">16</span> * (<span class="hljs-number">1</span> + (r - r % <span class="hljs-number">64</span>) / <span class="hljs-number">64</span>), i = <span class="hljs-title class_">Array</span>(o - <span class="hljs-number">1</span>), a = <span class="hljs-number">0</span>, s = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (s &lt; n)<br>            a = s % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>            i[t = (s - s % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = i[t] | e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](s) &lt;&lt; a,<br>            s++;<br>        <span class="hljs-keyword">return</span> a = s % <span class="hljs-number">4</span> * <span class="hljs-number">8</span>,<br>        i[t = (s - s % <span class="hljs-number">4</span>) / <span class="hljs-number">4</span>] = i[t] | <span class="hljs-number">128</span> &lt;&lt; a,<br>        i[o - <span class="hljs-number">2</span>] = n &lt;&lt; <span class="hljs-number">3</span>,<br>        i[o - <span class="hljs-number">1</span>] = n &gt;&gt;&gt; <span class="hljs-number">29</span>,<br>        i;<br>    &#125;(e = <span class="hljs-keyword">function</span> <span class="hljs-title function_">w</span>(<span class="hljs-params">e</span>) &#123;<br>        e = e[<span class="hljs-string">&#x27;replace&#x27;</span>](<span class="hljs-regexp">/\r\n/g</span>, <span class="hljs-string">&#x27;\n&#x27;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-string">&#x27;&#x27;</span>, n = <span class="hljs-number">0</span>; n &lt; e[<span class="hljs-string">&#x27;length&#x27;</span>]; n++) &#123;<br>            <span class="hljs-keyword">var</span> r = e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](n);<br>            r &lt; <span class="hljs-number">128</span> ? t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r) : (<span class="hljs-number">127</span> &lt; r &amp;&amp; r &lt; <span class="hljs-number">2048</span> ? t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> | <span class="hljs-number">192</span>) : (t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">12</span> | <span class="hljs-number">224</span>),<br>            t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](r &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>)),<br>            t += <span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;fromCharCode&#x27;</span>](<span class="hljs-number">63</span> &amp; r | <span class="hljs-number">128</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> t;<br>    &#125;(e)),<br>    h = <span class="hljs-number">1732584193</span>,<br>    d = <span class="hljs-number">4023233417</span>,<br>    g = <span class="hljs-number">2562383102</span>,<br>    v = <span class="hljs-number">271733878</span>,<br>    s = <span class="hljs-number">0</span>; s &lt; a[<span class="hljs-string">&#x27;length&#x27;</span>]; s += <span class="hljs-number">16</span>)<br>        d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">o</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">r</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">n</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(d = <span class="hljs-title function_">t</span>(_ = d, g = <span class="hljs-title function_">t</span>(f = g, v = <span class="hljs-title function_">t</span>(p = v, h = <span class="hljs-title function_">t</span>(l = h, d, g, v, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">3614090360</span>), d, g, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">3905402710</span>), h, d, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">606105819</span>), v, h, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">3250441966</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">4118548399</span>), d, g, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">1200080426</span>), h, d, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2821735955</span>), v, h, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">4249261313</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1770035416</span>), d, g, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">2336552879</span>), h, d, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">4294925233</span>), v, h, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">2304563134</span>), g = <span class="hljs-title function_">t</span>(g, v = <span class="hljs-title function_">t</span>(v, h = <span class="hljs-title function_">t</span>(h, d, g, v, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">1804603682</span>), d, g, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">4254626195</span>), h, d, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">2792965006</span>), v, h, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">1236535329</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">4129170786</span>), d, g, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3225465664</span>), h, d, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">643717713</span>), v, h, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3921069994</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">3593408605</span>), d, g, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">9</span>, <span class="hljs-number">38016083</span>), h, d, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">3634488961</span>), v, h, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">3889429448</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">568446438</span>), d, g, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">3275163606</span>), h, d, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">4107603335</span>), v, h, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">1163531501</span>), g = <span class="hljs-title function_">n</span>(g, v = <span class="hljs-title function_">n</span>(v, h = <span class="hljs-title function_">n</span>(h, d, g, v, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">2850285829</span>), d, g, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">4243563512</span>), h, d, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">1735328473</span>), v, h, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">2368359562</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">4294588738</span>), d, g, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">2272392833</span>), h, d, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">1839030562</span>), v, h, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">4259657740</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">2763975236</span>), d, g, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">1272893353</span>), h, d, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">4139469664</span>), v, h, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3200236656</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">681279174</span>), d, g, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3936430074</span>), h, d, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">3572445317</span>), v, h, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">23</span>, <span class="hljs-number">76029189</span>), g = <span class="hljs-title function_">r</span>(g, v = <span class="hljs-title function_">r</span>(v, h = <span class="hljs-title function_">r</span>(h, d, g, v, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">3654602809</span>), d, g, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">3873151461</span>), h, d, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">530742520</span>), v, h, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">3299628645</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4096336452</span>), d, g, a[s + <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">1126891415</span>), h, d, a[s + <span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2878612391</span>), v, h, a[s + <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">4237533241</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1700485571</span>), d, g, a[s + <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">2399980690</span>), h, d, a[s + <span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">4293915773</span>), v, h, a[s + <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">2240044497</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">1873313359</span>), d, g, a[s + <span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">4264355552</span>), h, d, a[s + <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">2734768916</span>), v, h, a[s + <span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">1309151649</span>), g = <span class="hljs-title function_">o</span>(g, v = <span class="hljs-title function_">o</span>(v, h = <span class="hljs-title function_">o</span>(h, d, g, v, a[s + <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">4149444226</span>), d, g, a[s + <span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">3174756917</span>), h, d, a[s + <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">718787259</span>), v, h, a[s + <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">3951481745</span>),<br>        h = <span class="hljs-title function_">u</span>(h, l),<br>        d = <span class="hljs-title function_">u</span>(d, _),<br>        g = <span class="hljs-title function_">u</span>(g, f),<br>        v = <span class="hljs-title function_">u</span>(v, p);<br>    <span class="hljs-keyword">return</span> (<span class="hljs-title function_">i</span>(h) + <span class="hljs-title function_">i</span>(d) + <span class="hljs-title function_">i</span>(g) + <span class="hljs-title function_">i</span>(v))[<span class="hljs-string">&#x27;toLowerCase&#x27;</span>]();<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着 我们把后面的一些参数补起来</p>
<p><img src="/images/image-20230530201940323.png" alt="image-20230530201940323"></p>
<p><code>i[&#39;$_CCGM&#39;]</code> 是第一个w里面算的指纹，我们直接把它给拿过来，这里可能会有问题，因为如果我们拿第一个w里面指纹生成的方式，就相当于是重新生成的，而这里应该是拿上一次的指纹</p>
<p><img src="/images/image-20230530202325058.png" alt="image-20230530202325058"></p>
<p>接着来看 <code>i[&#39;$_CEHV&#39;]()</code>，看一下ren的值，搜一下，这里有可能是GPU的信息，这里应该也是指纹信息,fp和lp这里有两个时间戳，有可能又是检测鼠标移动，我们可以把一个值设定成当前时间，另一个值把这两个值得差值给加上，而下面的tm的值，我们也算和当前时间的时间差，完成是这样的</p>
<p><img src="/images/image-20230530205438042.png" alt="image-20230530205438042"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();<br>$_CEHV = &#123;<br>    <span class="hljs-string">&quot;v&quot;</span>: <span class="hljs-string">&quot;9.1.4&quot;</span>,<br>    <span class="hljs-string">&quot;te&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;$_BBy&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;ven&quot;</span>: <span class="hljs-string">&quot;Google Inc. (Google)&quot;</span>,<br>    <span class="hljs-string">&quot;ren&quot;</span>: <span class="hljs-string">&quot;ANGLE (Google, Vulkan 1.3.0 (SwiftShader Device (Subzero) (0x0000C0DE)), SwiftShader driver)&quot;</span>,<br>    <span class="hljs-string">&quot;fp&quot;</span>: [<br>        <span class="hljs-string">&quot;move&quot;</span>,<br>        <span class="hljs-number">413</span>,<br>        <span class="hljs-number">59</span>,<br>        now,<br>        <span class="hljs-string">&quot;pointermove&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;lp&quot;</span>: [<br>        <span class="hljs-string">&quot;up&quot;</span>,<br>        <span class="hljs-number">224</span>,<br>        <span class="hljs-number">303</span>,<br>        now + <span class="hljs-number">992</span>,<br>        <span class="hljs-string">&quot;pointerup&quot;</span><br>    ],<br>    <span class="hljs-string">&quot;em&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;ph&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;cp&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;ek&quot;</span>: <span class="hljs-string">&quot;11&quot;</span>,<br>        <span class="hljs-string">&quot;wd&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;nt&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;si&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;sc&quot;</span>: <span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-string">&quot;tm&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;a&quot;</span>: now - <span class="hljs-number">2367</span>,<br>        <span class="hljs-string">&quot;b&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;c&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span>,<br>        <span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;e&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;f&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span>,<br>        <span class="hljs-string">&quot;g&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&quot;h&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;i&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span>,<br>        <span class="hljs-string">&quot;j&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;k&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-string">&quot;l&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span>,<br>        <span class="hljs-string">&quot;m&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span>,<br>        <span class="hljs-string">&quot;n&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span>,<br>        <span class="hljs-string">&quot;o&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span>,<br>        <span class="hljs-string">&quot;p&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;q&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span>,<br>        <span class="hljs-string">&quot;r&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span>,<br>        <span class="hljs-string">&quot;s&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;t&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span>,<br>        <span class="hljs-string">&quot;u&quot;</span>: now - <span class="hljs-number">2367</span> + <span class="hljs-number">168</span> + <span class="hljs-number">167</span> + <span class="hljs-number">4</span> + <span class="hljs-number">6</span> + <span class="hljs-number">35</span> + <span class="hljs-number">16</span> + <span class="hljs-number">2</span> + <span class="hljs-number">12</span> + <span class="hljs-number">3</span> + <span class="hljs-number">18</span> + <span class="hljs-number">65</span><br>    &#125;,<br>    <span class="hljs-string">&quot;dnf&quot;</span>: <span class="hljs-string">&quot;dnf&quot;</span>,<br>    <span class="hljs-string">&quot;by&quot;</span>: <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>o参数里面没用的参数可以删掉，后面还有个 <code>ge[&#39;stringify&#39;]</code> ，这个和第一个w里面一样，这里就是个json,stringify，然后运行一下，看上去好像没什么问题，我们回到最开始的加密入口,看下r值能不能获取到,这样r也能获取到，接下来就是加密算法的部分了</p>
<p><img src="/images/image-20230530211649323.png" alt="image-20230530211649323"></p>
<p><img src="/images/image-20230530212158586.png" alt="image-20230530212158586"></p>
<p>最后一段 <code>return p[&#39;$_HEf&#39;](_[&#39;encrypt&#39;](r, i[&#39;$_CCIl&#39;]()))</code> 我们将断点打到下面来,然后去看一下 <code>i[$_CGBDY(1361)]</code>  是什么, 点进去之后能很明显的看到 又是判断aeskey是否存在，不存在就生成，如果存在就直接返回，那么我们可以直接用上一次加密的aeskey，而这里应该要的就是上一次生成的aeskey，而不是重新生成，那么我们就需要通过传参获取上一次的aeskey</p>
<p><img src="/images/image-20230530212500902.png" alt="image-20230530212500902"></p>
<p><img src="/images/image-20230530212601815.png" alt="image-20230530212601815"></p>
<p>我们直接把第一次w加密的aes算法拿过来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">e, t, n</span>) &#123;<br>    <span class="hljs-keyword">var</span> key = t;<br>    <span class="hljs-keyword">var</span> iv = <span class="hljs-string">&quot;0000000000000000&quot;</span>;<br><br>    key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(key);<br>    iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(iv);<br>    <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(e, key, &#123;<br>        <span class="hljs-attr">iv</span>: iv,<br>        <span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span><br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> o = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;words&#x27;</span>];<br>    <span class="hljs-keyword">var</span> i = r[<span class="hljs-string">&#x27;ciphertext&#x27;</span>][<span class="hljs-string">&#x27;sigBytes&#x27;</span>];<br>    <span class="hljs-keyword">var</span> s = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; i; a++) &#123;<br>        <span class="hljs-keyword">var</span> c = o[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - a % <span class="hljs-number">4</span> * <span class="hljs-number">8</span> &amp; <span class="hljs-number">255</span>;<br>        s[<span class="hljs-string">&#x27;push&#x27;</span>](c);<br>    &#125;<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来 <code>p[&#39;$_HEf&#39;]</code> 的操作也是和第一w生成时 <code>$_HEf(o)</code> 的操作一样，所以我们也可以直接拿过来，最后我们将浏览器中的aeskey拿过来，测试一下, 没什么问题，我们再将代码整理一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">aeskey</span>) &#123;  <span class="hljs-comment">// 通过传参获取上一次加密的aeskey</span><br>    <span class="hljs-comment">// t[&#x27;push&#x27;](e[&#x27;toString&#x27;]());</span><br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var $_CGBHd=VIPVz.$_CG,$_CGBGV=[&#x27;$_CGCAl&#x27;].concat($_CGBHd),$_CGBIC=$_CGBGV[1];$_CGBGV.shift();var $_CGBJu=$_CGBGV[0];function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;100&lt;new Date()[$_CGBIC(256)]()-t[$_CGBIC(256)]()&amp;&amp;(e=$_CGBIC(1474)),r=$_CGBHd(764)+i[$_CGBIC(1448)]+$_CGBIC(1427)+n(o[$_CGBIC(73)]()+n(n[$_CGBHd(73)]())+n(e[$_CGBHd(73)]()))+$_CGBHd(1471);&#125;&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;bbOy&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br><br>        <span class="hljs-number">100</span> &lt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()[<span class="hljs-string">&#x27;getTime&#x27;</span>]() - t[<span class="hljs-string">&#x27;getTime&#x27;</span>]() &amp;&amp; (e = <span class="hljs-string">&#x27;qwe&#x27;</span>),<br>            r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + <span class="hljs-title function_">get_i</span>() + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(<span class="hljs-string">&#x27;bbOy&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><br>    <span class="hljs-keyword">return</span> $_HEf(<span class="hljs-title function_">encrypt1</span>(r, aeskey));<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">second_w</span>(<span class="hljs-string">&quot;691f5ba419b5614f&quot;</span>))<br></code></pre></td></tr></table></figure>

<p><img src="/images/image-20230530214145454.png" alt="image-20230530214145454"></p>
<p>我们修改一下第一个w生成的结果，将里面的指纹信息和aeskey一起返回出来</p>
<p><img src="/images/image-20230530215924185.png" alt="image-20230530215924185"></p>
<p>我们前面的o参数里面，还有一个s的值，该值是从上一个请求结果里面获取的,我们还需要把它给拿过来</p>
<p><img src="/images/image-20230530220559036.png" alt="image-20230530220559036"></p>
<p><img src="/images/image-20230530220643792.png" alt="image-20230530220643792"></p>
<p>这段指纹呢，我们也直接用上一次加密完成的</p>
<p><img src="/images/image-20230530222043837.png" alt="image-20230530222043837"></p>
<p>最终的结果也是没有问题,</p>
<p><img src="/images/image-20230530223855182.png" alt="image-20230530223855182"></p>
<p>python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> execjs<br><span class="hljs-keyword">import</span> requests<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1..js&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>first_js = execjs.<span class="hljs-built_in">compile</span>(f.read())<br>f2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;2...js&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>second_js = execjs.<span class="hljs-built_in">compile</span>(f2.read())<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">jsonp_data</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-comment"># jsonp_re = re.compile(r&quot;\((?P&lt;code&gt;.*)\)&quot;, re.S)</span><br>    <span class="hljs-comment"># jsonp_str = jsonp_re.search(text, re.S).group(&quot;code&quot;)</span><br>    <span class="hljs-comment"># return json.loads(jsonp_str)</span><br>    jsonp_re = re.findall(<span class="hljs-string">r&quot;\((.*)\)&quot;</span>, text)<br>    <span class="hljs-keyword">return</span> json.loads(jsonp_re[<span class="hljs-number">0</span>])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_time</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)<br><br><br>session = requests.session()<br>headers = &#123;<br>    <span class="hljs-string">&#x27;authority&#x27;</span>: <span class="hljs-string">&#x27;www.geetest.com&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,<br>    <span class="hljs-string">&#x27;accept-language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,<br>    <span class="hljs-string">&#x27;cache-control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-comment"># &#x27;cookie&#x27;: &#x27;461cca3146ff093d059dee9439aa6b26=6eee86d2-3925-4a45-9ad3-cf28de229505&#x27;,</span><br>    <span class="hljs-string">&#x27;pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>    <span class="hljs-string">&#x27;referer&#x27;</span>: <span class="hljs-string">&#x27;https://www.geetest.com/demo/slide-popup.html&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua&#x27;</span>: <span class="hljs-string">&#x27;&quot;Microsoft Edge&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not-A.Brand&quot;;v=&quot;24&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="hljs-string">&#x27;?0&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="hljs-string">&#x27;&quot;Windows&quot;&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-mode&#x27;</span>: <span class="hljs-string">&#x27;cors&#x27;</span>,<br>    <span class="hljs-string">&#x27;sec-fetch-site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>    <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.50&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-requested-with&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span>,<br>&#125;<br><br>params = &#123;<br>    <span class="hljs-string">&#x27;t&#x27;</span>: get_time(),<br>&#125;<br><span class="hljs-comment"># 第一个请求，用于注册验证码,获取贯穿始终的gt</span><br>register_res = session.get(<span class="hljs-string">&#x27;https://www.geetest.com/demo/gt/register-slide&#x27;</span>, params=params, headers=headers).json()<br>challenge = register_res[<span class="hljs-string">&#x27;challenge&#x27;</span>]<br>gt = register_res[<span class="hljs-string">&#x27;gt&#x27;</span>]<br><br><span class="hljs-comment"># 第二个请求，用于返回加载验证码的js</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br>load_res = session.get(<span class="hljs-string">&#x27;https://apiv6.geetest.com/gettype.php&#x27;</span>, params=params, headers=headers)<br><br><span class="hljs-comment"># 第三个请求，需要解密第一个w，该请求同样也是为了加载验证码</span><br><br>params_dict = first_js.call(<span class="hljs-string">&#x27;cul_first_w&#x27;</span>, gt, challenge)<br><br>load_res2 = session.get(<br>    <span class="hljs-string">&#x27;https://apiv6.geetest.com/get.php&#x27;</span>, headers=headers, params=params_dict[<span class="hljs-string">&#x27;msg&#x27;</span>]<br>)<br><span class="hljs-comment"># 获取到第一个w里面返回的各种值，然后放到第二个w里面进行参与加密</span><br>aeskey = params_dict[<span class="hljs-string">&#x27;aeskey&#x27;</span>]<br>finger_print = params_dict[<span class="hljs-string">&#x27;finger_print&#x27;</span>]<br>sec = jsonp_data(load_res2.text)[<span class="hljs-string">&#x27;data&#x27;</span>][<span class="hljs-string">&#x27;s&#x27;</span>]<br><br>W = second_js.call(<span class="hljs-string">&#x27;second_w&#x27;</span>, aeskey, gt, challenge, sec, finger_print)<br><span class="hljs-comment"># print(W)</span><br>params = &#123;<br>    <span class="hljs-string">&#x27;gt&#x27;</span>: gt,<br>    <span class="hljs-string">&#x27;challenge&#x27;</span>: challenge,<br>    <span class="hljs-string">&#x27;lang&#x27;</span>: <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>    <span class="hljs-string">&#x27;pt&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;client_type&#x27;</span>: <span class="hljs-string">&#x27;web&#x27;</span>,<br>    <span class="hljs-string">&#x27;w&#x27;</span>: W,<br>    <span class="hljs-string">&#x27;callback&#x27;</span>: <span class="hljs-string">&#x27;geetest_&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(get_time()),<br>&#125;<br><span class="hljs-comment"># 第四次请求，需要解密第二个w,同样用于加载验证码</span><br>load_res3 = session.get(<br>    <span class="hljs-string">&#x27;https://api.geetest.com/ajax.php&#x27;</span>, headers=headers, params=params<br>)<br><span class="hljs-built_in">print</span>(load_res3.text)<br></code></pre></td></tr></table></figure>

<p>js代码太长了，这里只给出入口的js代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">second_w</span>(<span class="hljs-params">aeskey,gt,challenge,sec,finger_print</span>) &#123;  <span class="hljs-comment">// 通过传参获取上一次加密的aeskey</span><br>    <span class="hljs-comment">// t[&#x27;push&#x27;](e[&#x27;toString&#x27;]());</span><br>    o_tostring = <span class="hljs-string">&quot;function o(e,t)&#123;var $_CGBHd=VIPVz.$_CG,$_CGBGV=[&#x27;$_CGCAl&#x27;].concat($_CGBHd),$_CGBIC=$_CGBGV[1];$_CGBGV.shift();var $_CGBJu=$_CGBGV[0];function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;100&lt;new Date()[$_CGBIC(256)]()-t[$_CGBIC(256)]()&amp;&amp;(e=$_CGBIC(1474)),r=$_CGBHd(764)+i[$_CGBIC(1448)]+$_CGBIC(1427)+n(o[$_CGBIC(73)]()+n(n[$_CGBHd(73)]())+n(e[$_CGBHd(73)]()))+$_CGBHd(1471);&#125;&quot;</span><br>    n_tostring = <span class="hljs-string">&#x27;function n(e)&#123;var $_DEFIu=VIPVz.$_Ds()[4][14];for(;$_DEFIu!==VIPVz.$_Ds()[8][12];)&#123;switch($_DEFIu)&#123;case VIPVz.$_Ds()[4][14]:var t=5381,n=e[$_CGBHd(54)],r=0;while(n--)t=(t&lt;&lt;5)+t+e[$_CGBIC(94)](r++);$_DEFIu=VIPVz.$_Ds()[0][13];break;case VIPVz.$_Ds()[8][13]:return t&amp;=~(1&lt;&lt;31);break;&#125;&#125;&#125;&#x27;</span><br>    e_tostring = <span class="hljs-string">&#x27;qwe&#x27;</span><br>    <span class="hljs-keyword">var</span> r = <span class="hljs-string">&#x27;&#x27;</span>;<br>    !<span class="hljs-keyword">function</span> <span class="hljs-title function_">o</span>(<span class="hljs-params">e, t</span>) &#123;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">var</span> t = <span class="hljs-number">5381</span>, n = e[<span class="hljs-string">&#x27;length&#x27;</span>], r = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n--)<br>                t = (t &lt;&lt; <span class="hljs-number">5</span>) + t + e[<span class="hljs-string">&#x27;charCodeAt&#x27;</span>](r++);<br>            <span class="hljs-keyword">return</span> t &amp;= ~(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// 100 &lt; new Date()[&#x27;getTime&#x27;]() - t[&#x27;getTime&#x27;]() &amp;&amp; (e = &#x27;qwe&#x27;),</span><br>       r = <span class="hljs-string">&#x27;&#123;&#x27;</span> + <span class="hljs-title function_">get_i</span>(gt,challenge,sec,finger_print) + <span class="hljs-string">&#x27;&quot;captcha_token&quot;:&quot;&#x27;</span> + <span class="hljs-title function_">n</span>(o_tostring + <span class="hljs-title function_">n</span>(n_tostring) + <span class="hljs-title function_">n</span>(e_tostring)) + <span class="hljs-string">&#x27;&quot;&#125;&#x27;</span>;<br>    &#125;(<span class="hljs-string">&#x27;bbOy&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><br>    <span class="hljs-keyword">return</span> $_HEf(<span class="hljs-title function_">encrypt1</span>(r, aeskey));<br>&#125;<br></code></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">LLi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/">http://example.com/2023/03/05/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Spider Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%AA%8C%E8%AF%81%E7%A0%81/">验证码</a><a class="post-meta__tags" href="/tags/%E6%9E%81%E9%AA%8C/">极验</a><a class="post-meta__tags" href="/tags/%E6%BB%91%E5%9D%97/">滑块</a></div><div class="post_share"><div class="social-share" data-image="/images/image-20230527114721325.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/04/11/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-3/" title="极验滑块验证三个W超详细解密(3)"><img class="cover" src="/images/image-20230527115446875.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">极验滑块验证三个W超详细解密(3)</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/04/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-1/" title="极验滑块验证三个W超详细解密(1)"><img class="cover" src="/images/image-20230527110525991.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">极验滑块验证三个W超详细解密(1)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/04/11/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-3/" title="极验滑块验证三个W超详细解密(3)"><img class="cover" src="/images/image-20230527115446875.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-11</div><div class="title">极验滑块验证三个W超详细解密(3)</div></div></a></div><div><a href="/2023/03/04/%E6%9E%81%E9%AA%8C%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E4%B8%89%E4%B8%AAW%E8%B6%85%E8%AF%A6%E7%BB%86%E8%A7%A3%E5%AF%86-1/" title="极验滑块验证三个W超详细解密(1)"><img class="cover" src="/images/image-20230527110525991.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-04</div><div class="title">极验滑块验证三个W超详细解密(1)</div></div></a></div><div><a href="/2022/04/08/%E5%AE%89%E5%B1%85%E5%AE%A2%E6%BB%91%E5%9D%97%E9%AA%8C%E8%AF%81%E7%A0%81AES%E5%8A%A0%E5%AF%86%E8%A7%A3%E6%9E%90/" title="安居客滑块验证码AES加密解析"><img class="cover" src="/images/image-20230410193002735.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-08</div><div class="title">安居客滑块验证码AES加密解析</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">LLi</div><div class="author-info__description">a spider man</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/aaLiuQ"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/aaLiuQ" target="_blank" title="Github"><i class="fab fa-github" style="color: #4a7dbe;"></i></a><a class="social-icon" href="mailto:1984145803@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_40138248" target="_blank" title="Csdn"><i class="fas fa-c" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">生而为虫，我很抱歉</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AAw%E8%8E%B7%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">第二个w获取流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%AC%AC%E5%9B%9B%E4%B8%AA%E8%AF%B7%E6%B1%82%EF%BC%8C%E6%90%BA%E5%B8%A6%E8%A7%A3%E5%AF%86%E5%90%8E%E7%9A%84w-%E7%94%A8%E4%BA%8E%E8%AF%86%E5%88%AB%E9%AA%8C%E8%AF%81%E7%A0%81%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E6%88%90%E5%8A%9F"><span class="toc-number">1.1.</span> <span class="toc-text">4.第四个请求，携带解密后的w,用于识别验证码是否加载成功</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AAw%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">第二个w解密流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AAw%E8%8E%B7%E5%8F%96%E6%B5%81%E7%A8%8B-1"><span class="toc-number">3.</span> <span class="toc-text">第二个w获取流程</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/05/12/%E5%B0%8F%E9%BB%91%E7%9B%92%E5%92%8C%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%BF%87frida%E6%A3%80%E6%B5%8B/" title="小黑盒和哔哩哔哩过frida检测"><img src="/images/image-20240524101621104.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小黑盒和哔哩哔哩过frida检测"/></a><div class="content"><a class="title" href="/2024/05/12/%E5%B0%8F%E9%BB%91%E7%9B%92%E5%92%8C%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%BF%87frida%E6%A3%80%E6%B5%8B/" title="小黑盒和哔哩哔哩过frida检测">小黑盒和哔哩哔哩过frida检测</a><time datetime="2024-05-12T10:32:42.000Z" title="发表于 2024-05-12 18:32:42">2024-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/08/jd-app%E5%85%B3%E9%94%AE%E5%AD%97%E6%90%9C%E7%B4%A2ep%E5%92%8Csign%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96%E8%A7%A3%E6%9E%90/" title="jd app ep和sign参数获取解析"><img src="/images/image-20240529104332702.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jd app ep和sign参数获取解析"/></a><div class="content"><a class="title" href="/2023/07/08/jd-app%E5%85%B3%E9%94%AE%E5%AD%97%E6%90%9C%E7%B4%A2ep%E5%92%8Csign%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96%E8%A7%A3%E6%9E%90/" title="jd app ep和sign参数获取解析">jd app ep和sign参数获取解析</a><time datetime="2023-07-08T12:15:05.000Z" title="发表于 2023-07-08 20:15:05">2023-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/16/Frida%E5%8A%9F%E8%83%BD%E8%84%9A%E6%9C%AC/" title="Frida功能脚本"><img src="/images/frida.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Frida功能脚本"/></a><div class="content"><a class="title" href="/2023/06/16/Frida%E5%8A%9F%E8%83%BD%E8%84%9A%E6%9C%AC/" title="Frida功能脚本">Frida功能脚本</a><time datetime="2023-06-16T08:13:15.000Z" title="发表于 2023-06-16 16:13:15">2023-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/15/Frida%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Frida学习笔记"><img src="/images/frida.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Frida学习笔记"/></a><div class="content"><a class="title" href="/2023/06/15/Frida%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Frida学习笔记">Frida学习笔记</a><time datetime="2023-06-15T08:13:15.000Z" title="发表于 2023-06-15 16:13:15">2023-06-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/11/Frida%E5%8F%8D%E8%B0%83%E8%AF%95%E5%BA%94%E5%AF%B9%E6%96%B9%E6%A1%88/" title="Frida反调试应对方案"><img src="/images/frida.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Frida反调试应对方案"/></a><div class="content"><a class="title" href="/2023/06/11/Frida%E5%8F%8D%E8%B0%83%E8%AF%95%E5%BA%94%E5%AF%B9%E6%96%B9%E6%A1%88/" title="Frida反调试应对方案">Frida反调试应对方案</a><time datetime="2023-06-11T04:13:15.000Z" title="发表于 2023-06-11 12:13:15">2023-06-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer_button"><ul class="buttons"><li class="icon Email"><span class="bubble">Email</span><a href="mailto:1984145803@qq.com"><i class="fa-solid fa-envelope"></i></a></li><li class="icon QQ"><span class="bubble">QQ</span><a href="tencent://Message/?Uin=198414&amp;websiteName=q-zone.qq.com&amp;Menu=yes"><i class="fa-brands fa-qq"></i></a></li><li class="icon top"><span class="bubble">top</span><a href="#"><i class="fa-solid fa-angle-up"></i></a></li><li class="icon github"><span class="bubble">Github</span><a target="_blank" rel="noopener" href="https://github.com/aaLiuQ"><i class="fab fa-github"></i></a></li><li class="icon CSDN"><span class="bubble">CSDN</span><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40138248"><i class="fa-solid fa-copyright"></i></a></li></ul></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>